<!--
	   ____                           ___ ________________    _______ __
	  / __/_ _____ __ _  ___  ___    / _ /_  __/_  __/ __/___/ ___/ //_/
	 _\ \/ // (_-</  ' \/ _ \/ _ \  / __ |/ /   / /  > _/_ _/ /__/ ,<   
	/___/\_, /___/_/_/_/\___/_//_/ /_/ |_/_/   /_/  |_____/ \___/_/|_|  
		/___/                                                           
	author:	ionstorm
	project:	https://github.com/ion-storm/sysmon-config
	license:	Creative Commons Attribution 4.0 | You may privatize, fork, edit, teach, publish, or deploy for commercial use - with attribution in the text.
	Methodology: Detect the Most Techniques per Data source in MITRE ATT&CK.
				 Provide Visibility into Forensic Artifact Events for UEBA.
				 Detect Exploitation events with wide CVE Coverage.
				 Risk Scoring of CVE, UEBA, Forensic, MITRE ATT&CK Events.
				 
				 Primary Tags:
				 Attack: Mitre ATT&CK Identifier
				 Technique: Mitre ATT&CK Technique
				 Tactic: Mitre ATT&CK Tactic
				 DS: Mitre ATT&CK Datasource
				 Alert: Alert Text for SIEM/XDR
				 Info: Informational Alert Text
				 Level: The level field contains one of five string values. It describes the criticality of a triggered rule. 
				 While low and medium level events have an informative character, events with high and critical level should 
				 lead to immediate reviews by security analysts.
				 Desc: Description of non-alerting UEBA/Behavioral Based Rules
				 Forensic: Forensic Artifacts
				 CVE: CVE Vulnerability Identification
				 FP: False Positive Rate
				 Author: Author of rule
				 
				 Additional Tag Details:
				 Rapid Response Tags: (for EDR/XDR/SIEM Response & Automation)
				 kp=y 	Kill process with child processes
				 kpp=y 	Kill Parent Processes & all Child Processes
				 kc=y    Kill network connections
				 ki=y    Kill Injected Thread
				 sd=y 	Shutdown System
				 fw=y	Add Windows Firewall Rule to block inbound/outbound network connectivity from process
				 yara=y  Yara Scan file
				 ydel=y  Delete on Yara Detection
				 rf=y    Restore Deleted File
				 nr=y 	Null route ip
				 iso=y Isolate Host
				 SD=y Service Desk Ticket
				 SOC=y SOC Ticket Creation
				 
				 Risk Score ratings: (Risk=??)
				 Low Risk: 1-39
				 Medium Risk: 40-69
				 High Risk: 70-89
				 Critical Risk: 90-100
				 
				 Levels: (from Sigma)
				 (0) informational: Rule is intended for enrichment of events, e.g. by tagging them. No case or alerting should be triggered 
				 by such rules because it is expected that a huge amount of events will match these rules.
				 (1) low: Notable event but rarely an incident. Low rated events can be relevant in high numbers or combination with others. 
				 Immediate reaction shouldn't be necessary, but a regular review is recommended.
				 (2) medium: Relevant event that should be reviewed manually on a more frequent basis.
				 (3) high: Relevant event that should trigger an internal alert and requires a prompt review.
				 (4) critical: Highly relevant event that indicates an incident. Critical events should be reviewed immediately.
				 
				 False Positive Rates: (FP=?)
				 (0) Zero False Positives rate
				 (1) Some False Positives rate
				 (2) Medium False Positive rate
				 (3) High False Positive rate
				 
				 Properly Escape in XML:
				 < &lt;
				 > &gt;
				 " &quot;
				 ' &apos;
				 & &amp;
				 
				 Other Notes:
				 The Rulename field has a hard limit of 255 characters, make the best of the size available, shorten tags and descriptions as needed.
				 Add exclusions in line enclosed within a Compound rule rather than a global exclusion list.
				 
				 Contribution Guidelines:
				 Always submit new rule requests/pull requests in this format where possible, if the rule is highly accurate and should fire off a SIEM Alert replace Desc= with Alert=, 
				 See Risk ratings and levels above for guidance.  
				 Example Rule:
				<Rule name="Attack=None,Technique=None,Tactic=None,DS=None,Level=0,Risk=10,Desc=Your Description Here,Author=YourTwitter/Github" groupRelation="and">
					<Your Rule Here/>
				</Rule> 
-->
<Sysmon schemaversion="4.83">
	<HashAlgorithms>md5,sha1,sha256,imphash</HashAlgorithms>
	<CheckRevocation/>
	<EventFiltering>
	<!--SYSMON EVENT ID 1 : PROCESS CREATION [ProcessCreate]-->
	<RuleGroup name="RG=ProcessCreate Include Group" groupRelation="or">
		<ProcessCreate onmatch="include">
			<!--MITRE ATT&CK TACTIC: Reconnaissance-->
			<!--MITRE ATT&CK TECHNIQUE: Active Scanning-->
			<Rule name="Attack=T1595.002,Technique=Vulnerability Scanning,Tactic=Reconnaissance,DS=Process: Process Creation,Level=3,Alert=Nessus Scan Detected,Risk=100" groupRelation="or">
				<ParentCommandLine condition="contains any">TEMP\nessus_;nessus_task_list</ParentCommandLine>
				<CommandLine condition="contains any">TEMP\nessus_;nessus_task_list</CommandLine>
			</Rule>
			<Rule name="Attack=T1595.002,Technique=Vulnerability Scanning,Tactic=Reconnaissance,DS=Process: Process Creation,Level=4,Alert=Port Scan Tool Detected,Risk=100" groupRelation="or">
				<CommandLine condition="contains any">rcpping;tcpping;tcping;routerscan;grabff;Port-Scan;netscan;\nmap;ipscan;nacmdline.exe</CommandLine>
				<OriginalFileName condition="is any">advanced_port_scanner.exe;rcpping.exe;nc.exe;nc64.exe;netcat.exe;ncat.exe;nmap.exe;zenmap.exe;advanced_ip_scanner.exe</OriginalFileName>
				<Product condition="contains any">Network Scanner;Advanced IP Scanner</Product>
			</Rule>
			<Rule name="Attack=T1087,Technique=Account Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=4,Alert=ADFind.exe Discovery,Risk=100" groupRelation="or">
				<OriginalFileName condition="contains">adfind</OriginalFileName>
				<Product condition="contains">adfind</Product>
				<CommandLine condition="contains any">-gcb -sc;/gcb /sc;-f (objectcategory=;/f (objectcategory=;trustdmp</CommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Gather Victim Host Information-->
			<!--MITRE ATT&CK TECHNIQUE: Gather Victim Identity Information-->
			<!--MITRE ATT&CK TECHNIQUE: Gather Victim Network Information-->
			<!--MITRE ATT&CK TECHNIQUE: Gather Victim Org Information-->
			<!--MITRE ATT&CK TECHNIQUE: Phishing for Information-->
			<!--MITRE ATT&CK TECHNIQUE: Search Closed Sources-->
			<!--MITRE ATT&CK TECHNIQUE: Search Open Technical Databases-->
			<!--MITRE ATT&CK TECHNIQUE: Search Open Websites/Domains-->
			<!--MITRE ATT&CK TECHNIQUE: Search Victim-Owned Websites-->

			<!--MITRE ATT&CK TACTIC: Resource Development-->
			<Rule name="Attack=T1587,Technique=Develop Capabilities,Tactic=Resource Development,Level=3,DS=Process: Process Creation,Alert=PurpleSharp Indicator,Risk=40" groupRelation="or">
				<CommandLine condition="contains any">PurpleSharp;xyz123456</CommandLine> 
				<OriginalFileName condition="contains any">PurpleSharp</OriginalFileName> 
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Acquire Infrastructure-->
			<!--MITRE ATT&CK TECHNIQUE: Compromise Accounts-->
			<!--MITRE ATT&CK TECHNIQUE: Compromise Infrastructure-->
			<CommandLine name="Attack=T1584.002,Technique=Compromise Infrastructure: DNS Server,Tactic=Resource Development,DS=Process: Process Creation,Level=4,Alert=DNSCMD DLL exec" condition="contains">/serverlevelplugindll</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: Develop Capabilities-->
			<Rule name="Attack=T1587.003,Technique=Develop Capabilities: Digital Certificates,Tactic=Resource Development,Level=3,DS=Process: Process Creation,Alert=netsh adding SSL Certificate,Risk=40" groupRelation="and">
				<CommandLine condition="contains all">add;sslcert;http</CommandLine> 
			</Rule>
			<CommandLine name="Attack=T1016,Technique=System Network Connections Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=netsh removing SSL Certificate,Risk=40" condition="contains">http del sslcert</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: Establish Accounts-->
			<!--MITRE ATT&CK TECHNIQUE: Obtain Capabilities-->
			<!--MITRE ATT&CK TECHNIQUE: Stage Capabilities-->

			<!--MITRE ATT&CK TACTIC: Initial Access-->
			<Rule name="Attack=T1566.001,Technique=Phishing: Spear Phishing Attachment,Tactic=Initial Access,DS=Process: Process Creation,Level=0,Alert=Executed files within Outlook Attachments,Risk=30" groupRelation="and">
				<Image condition="contains">C:\Users\</Image>
				<Image condition="contains">Content.Outlook</Image>
			</Rule>
			<Rule name="Attack=T1566.001,Technique=Phishing: Spear Phishing Attachment,Tactic=Initial Access,DS=Process: Process Creation,Level=0,Alert=Arbitrary Shell Command Execution Via Settingcontent-Ms,Risk=30" groupRelation="and">
				<CommandLine condition="contains">.SettingContent-ms</CommandLine>
				<CommandLine condition="excludes">immersivecontrolpanel</CommandLine>
			</Rule>
			<Rule name="Attack=T1566.001,Technique=Phishing: Spear Phishing Attachment,Tactic=Initial Access,DS=Process: Process Creation,Level=0,Alert=Suspicious HWP Sub Processes,Risk=70" groupRelation="and">
				<ParentImage condition="image">Hwp.exe</ParentImage>
				<Image condition="image">gbb.exe</Image>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Drive-by Compromise-->
			<Rule name="Attack=T1189,Technique=Drive-by Compromise,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=Browser Exploitation Detected,Risk=100" groupRelation="and">
				<ParentImage condition="contains any">iexplore.exe;chrome.exe;firefox.exe;browser_broker.exe;vivaldi.exe;microsoftedge.exe;microsoftedgecp.exe;msedge.exe;brave.exe;vivaldi.exe</ParentImage>
				<Image condition="contains any">tracert.exe;csc.exe;cscript.exe;wscript.exe;cmd.exe;powershell.exe;bash.exe;scrcons.exe;schtasks.exe;hh.exe;regsvr32.exe;regsvcs.exe;sh.exe;wmic.exe;mshta.exe;rundll32.exe;msiexec.exe;forfiles.exe;scriptrunner.exe;mftrace.exe;AppVLP.exe;svchost.exe;MicroScMgmt.exe;FLTLDR.exe;wmic.exe;Microsoft.Workflow.Compiler.exe;atbroker.exe;bginfo.exe;certutil.exe;csi.exe;dnx.exe;cdb.exe;bitsadmin.exe;forfiles.exe;fsi.exe;ftp.exe;hostname.exe;gpresult.exe;ipconfig.exe;nbtstat.exe;ping.exe;pwsh.exe;qprocess.exe;quser.exe;qwinsta.exe;reg.exe;svchost.exe;installutil.exe;pwsh.exe;msxsl.exe;ieexec.exe;msdt.exe;verclsid.exe</Image>
				<ParentCommandLine condition="excludes any">apt-config</ParentCommandLine>
			</Rule>
			<Rule name="Attack=T1189,Technique=Drive-by Compromise,Tactic=Initial Access,DS=Process: Process Creation,Level=3,Alert=Exploiting SetupComplete.cmd,CVE=CVE-2019-1378,Risk=70" groupRelation="and">
				<CommandLine condition="contains any">cmd.exe /c C:\Windows\Setup\Scripts\SetupComplete.cmd;cmd.exe /c C:\Windows\Setup\Scripts\PartnerSetupComplete.cmd</CommandLine>
				<Image condition="excludes">C:\Windows\Setup</Image>
				<Image condition="excludes">C:\Windows\SysWOW64</Image>
				<Image condition="excludes">C:\Windows\System32</Image>
				<Image condition="excludes">C:\Windows\WinSxS</Image>
			</Rule>
			<Rule name="Attack=T1189,Technique=Drive-by Compromise,Tactic=Initial Access,DS=Process: Process Creation,Level=3,Alert=IE Exploitation CVE-2019-1388,Risk=70" groupRelation="and">
				<ParentImage condition="image">consent.exe</ParentImage>
				<CommandLine condition="contains">http</CommandLine>
				<Image condition="image">iexplore.exe</Image>
				<User condition="contains">SYSTEM</User>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Exploit Public-Facing Application-->
			<Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=IIS Web Server Exploitation Detected,Risk=100" groupRelation="and">
				<ParentImage condition="image">w3wp.exe</ParentImage>
				<Image condition="excludes any">\csc.exe;\TranscodingService.exe;\werfault.exe;\appcmd.exe</Image>
				<!--Add wider coverage than specific lolbins, add exclusions above carefully, could be noisy, if too noisy comment above and uncomment below and add more lolbins-->
				<!--<Image condition="contains any">arp.exe;at.exe;cscript.exe;wscript.exe;cmd.exe;powershell.exe;bash.exe;scrcons.exe;schtasks.exe;hh.exe;regsvr32.exe;sh.exe;ping.exe;whoami.exe;net.exe;net1.exe;systeminfo.exe;bitsadmin.exe;dsget.exe;dsquery.exe;find.exe;findstr.exe;fsutil.exe;hostname.exe;ipconfig.exe;nbtstat.exe;net.exe;net1.exe;netdom.exe;netsh.exe;netstat.exe;nltest.exe;nslookup.exe;ntdutil.exe;pathping.exe;qprocess.exe;query.exe;qwinsta.exe;reg.exe;rundll32.exe;sc.exe;schtasks.exe;systeminfo.exe;tasklist.exe;tracert.exe;ver.exe;vssadmin.exe;wevtutil.exe;whoami.exe;wmic.exe;wusa.exe;certutil.exe</Image>-->
			</Rule>
			<Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=Suspicious IIS Module Registration,Risk=100,Author=Florian Roth/@ionstorm" groupRelation="and">
				<ParentImage condition="image">w3wp.exe</ParentImage>
				<Image condition="image">appcmd.exe</Image>
				<CommandLine condition="contains any">appcmd.exe add module;system.enterpriseservices.internal.publish;\gacutil.exe /I;gacutil.exe -I</CommandLine>
			</Rule>
			<Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=Web Server Exploitation Detected,Risk=100" groupRelation="and">
				<ParentImage condition="contains any">apache;php-cgi.exe;nginx.exe;httpd.exe;tomcat;php.exe</ParentImage>
				<Image condition="contains any">arp.exe;at.exe;cscript.exe;wscript.exe;cmd.exe;powershell.exe;bash.exe;scrcons.exe;schtasks.exe;hh.exe;regsvr32.exe;sh.exe;ping.exe;whoami.exe;net.exe;net1.exe;systeminfo.exe;bitsadmin.exe;dsget.exe;dsquery.exe;find.exe;findstr.exe;fsutil.exe;hostname.exe;ipconfig.exe;nbtstat.exe;net.exe;net1.exe;netdom.exe;netsh.exe;netstat.exe;nltest.exe;nslookup.exe;ntdutil.exe;pathping.exe;qprocess.exe;query.exe;qwinsta.exe;reg.exe;rundll32.exe;sc.exe;schtasks.exe;systeminfo.exe;tasklist.exe;tracert.exe;ver.exe;vssadmin.exe;wevtutil.exe;whoami.exe;wmic.exe;wusa.exe;certutil.exe</Image>
			</Rule>
			<Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=Web Server Spawned cmd shell,Risk=100" groupRelation="and">
				<Image condition="image">cmd.exe</Image>				
				<CommandLine condition="excludes any">ping 127.0.0.1</CommandLine>				
				<CurrentDirectory condition="is">c:\windows\system32\inetsrv\</CurrentDirectory>				
			</Rule>
			<Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,CVE=CVE-2020-1350,DS=Process: Process Creation,Level=4,Alert=DNS Remote Code Execution,Risk=100" groupRelation="and">
				<ParentCommandLine condition="contains all">svchost.exe;termsvcs</ParentCommandLine>
				<Image condition="excludes any">rdpclip.exe;csrss.exe;wininit.exe</Image>
			</Rule>
			<Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,CVE=CVE-2020-1350,DS=Process: Process Creation,Level=4,Alert=DNS Remote Code Execution,Risk=100" groupRelation="and">
				<ParentImage condition="image">dns.exe</ParentImage>
				<Image condition="excludes any">werfault.exe;conhost.exe;dnscmd.exe;dns.exe</Image>
			</Rule>
			<Rule name="Attack=T1190,Tactic=Initial Access,Technique=Exploit Public-Facing Application,CVE=CVE-2019-0708,DS=Process: Process Creation,Level=4,Alert=Terminal Service Process Spawn,Risk=100" groupRelation="and">
				<ParentImage condition="contains any">UMWorkerProcess.exe;UMService.exe</ParentImage>
				<CommandLine condition="excludes any">perfenabled</CommandLine>
			</Rule>
			<Rule name="Attack=T1190,Tactic=Initial Access,Technique=Exploit Public-Facing Application,CVE=CVE-2021-26857,DS=Process: Process Creation,Level=4,Alert=HAFNIUM APT Exchange UMS Process,Risk=100" groupRelation="and">
				<ParentImage condition="contains any">UMWorkerProcess.exe;UMService.exe</ParentImage>
				<CommandLine condition="excludes any">perfenabled</CommandLine>
				<Image condition="excludes any">wemgr.exe;werfault.exe</Image>
			</Rule>
			<Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=wwwroot Web Server Exploitation Detected,Risk=100" groupRelation="and">
				<Image condition="contains any">\wwwroot\</Image>
			</Rule>
			<Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=Atlassian Confluence Remote Exploit,Risk=100,CVE=CVE-2021-26084" groupRelation="and">
				<ParentImage condition="end with">\Atlassian\Confluence\jre\bin\java.exe</ParentImage>
				<CommandLine condition="contains any">cmd;powershell;certutil;curl;whoami;ipconfig;mshta;wscript;cscript;rundll32;bitsadmin</CommandLine>
			</Rule>
			<Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=Desktop Central Remote Exploit,Risk=100,CVE=CVE-2020-10189,Author=Florian Roth" groupRelation="and">
				<ParentImage condition="end with">DesktopCentral_Server\jre\bin\java.exe</ParentImage>
				<CommandLine condition="contains any">cmd;powershell;certutil;curl;whoami;ipconfig;mshta;wscript;cscript;rundll32;bitsadmin</CommandLine>
			</Rule>
			<Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=Generic Java Webapp Remote Exploit,Risk=100" groupRelation="and">
				<ParentImage condition="image">\jre\bin\java.exe</ParentImage>
				<Image condition="contains any">cmd;powershell;pwsh;certutil;curl;whoami;ipconfig;mshta;wscript;cscript;rundll32;bitsadmin;pwsh.exe;bitsadmin;hh.exe;wmic.exe;rundll32.exe;forfiles.exe;scriptrunner.exe;mftrace.exe;AppVLP.exe;curl.exe</Image>
				<!--Allow Confluence Rule to fire-->
				<ParentImage condition="excludes">\Atlassian\Confluence\jre\bin\java.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=Process: Process Creation,Level=3,Alert=SQL Server Exploitation Detected,Risk=100" groupRelation="and">
				<ParentImage condition="contains any">sqlservr</ParentImage>
				<Image condition="contains any">arp.exe;at.exe;cscript.exe;wscript.exe;cmd.exe;powershell;bash.exe;scrcons.exe;schtasks.exe;hh.exe;regsvr32.exe;sh.exe;ping.exe;whoami.exe;net.exe;net1.exe;systeminfo.exe;bitsadmin.exe;dsget.exe;dsquery.exe;find.exe;findstr.exe;fsutil.exe;hostname.exe;ipconfig.exe;nbtstat.exe;net.exe;net1.exe;netdom.exe;netsh.exe;netstat.exe;nltest.exe;nslookup.exe;ntdutil.exe;pathping.exe;qprocess.exe;query.exe;qwinsta.exe;reg.exe;rundll32.exe;sc.exe;schtasks.exe;systeminfo.exe;tasklist.exe;tracert.exe;ver.exe;vssadmin.exe;wevtutil.exe;whoami.exe;wmic.exe;wusa.exe;sh.exe;bash.exe</Image>
			</Rule>
			<Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=Generic Java keytool Exploit,Risk=100" groupRelation="and">
				<ParentImage condition="image">keytool.exe</ParentImage>
				<Image condition="contains any">cmd;powershell;pwsh;certutil;curl;whoami;ipconfig;mshta;wscript;cscript;rundll32;bitsadmin;pwsh.exe;bitsadmin;hh.exe;wmic.exe;rundll32.exe;forfiles.exe;scriptrunner.exe;mftrace.exe;AppVLP.exe;curl.exe</Image>
			</Rule>
			<Rule name="Attack=T1190,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=Apache Spark Exploit,CVE=CVE-2022-33891,Risk=100" groupRelation="and">
				<ParentImage condition="contains any">bash.exe;cmd.exe;powershell.exe;pwsh.exe</ParentImage>
				<CommandLine condition="contains any">id -Gn `;id /Gn `;id -Gn ';id /Gn '</CommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: External Remote Services-->
			<Rule name="Attack=T1133,Technique=External Remote Services,Tactic=Initial Access,DS=Process: Process Creation,Level=2,Alert=Screenconnect Remote Access,Risk=50" groupRelation="and">
				<CommandLine condition="contains all">e=Access&amp;;y=Guest&amp;;&amp;p=;&amp;c=;&amp;k=</CommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Hardware Additions-->
			<!--MITRE ATT&CK TECHNIQUE: Phishing-->
			<!--MITRE ATT&CK TECHNIQUE: Replication Through Removable Media-->
			<!--MITRE ATT&CK TECHNIQUE: Supply Chain Compromise-->
			<!--MITRE ATT&CK TECHNIQUE: Trusted Relationship-->
			<!--MITRE ATT&CK TECHNIQUE: Valid Accounts -->
			
			<!--MITRE ATT&CK TACTIC: Execution-->
			<Rule name="Attack=T1047,Technique=Windows Management Instrumentation,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=WMI Execution Detected,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains">wmic.exe</OriginalFileName>
				<CommandLine condition="contains all">process;call;create</CommandLine>
			</Rule>
			<Rule name="Attack=T1047,Technique=Windows Management Instrumentation,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Suspicious WMIC Commands,Risk=30" groupRelation="and">
				<OriginalFileName condition="contains">wmic.exe</OriginalFileName>
				<CommandLine condition="contains any">call set priority;call terminate;product get name;bios, get serialNumber;BIOS GET SERIALNUMBER;onboarddevice get;useraccount where name;useraccount get;path win32_networkadapter where index=;process list;useraccount get /ALL;useraccount list;qfe get description,installedOn /format:csv;process get caption,executablepath,commandline;service get name,displayname,pathname,startmode;share list;win32_share</CommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Command and Scripting Interpreter-->
			<Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Suspicious Console Host Execution Locations,Risk=30" groupRelation="and">
				<ParentImage condition="contains any">C:\Users\;$Recycle;\Temp\;\Downloads\</ParentImage>
				<CommandLine condition="is">\??\C:\WINDOWS\system32\conhost.exe 0xffffffff -ForceV1</CommandLine>
				<Image condition="image">conhost.exe</Image>
			</Rule>
			<Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Suspicious Console Host Parents,Risk=30" groupRelation="and">
				<ParentImage condition="contains any">svchost.exe;lsass.exe;services.exe;smss.exe;winlogon.exe;explorer.exe;dllhost.exe;rundll32.exe;regsvr32.exe;userinit.exe;winit.exe;spoolsv.exe;wermgr.exe;csrss.exe;ctfmon.exe;werfault.exe</ParentImage>
				<Image condition="image">conhost.exe</Image>
			</Rule>
			<Rule name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=3,DS=Process: Process Creation,Alert=Suspicious Console Host children,Risk=30" groupRelation="and">
				<ParentImage condition="image">conhost.exe</ParentImage>
				<Image condition="excludes any">:\Windows\splwow64.exe;:\Windows\System32\WerFault.exe;:\Windows\System32\conhost.exe</Image>
			</Rule>
			<Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,UEBA=Execution Command Line tools by user,Risk=45" groupRelation="and">
				<Image condition="contains any">\cmd.exe;WindowsTerminal;powershell</Image>
				<ParentImage condition="image">explorer.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1059.001,Technique=Powershell,Tactic=Execution,DS=Process: Process Creation,UEBA=Powershell as cmd.exe child process,Risk=39" groupRelation="and">
				<ParentImage condition="image">cmd.exe</ParentImage>
				<Image condition="contains any">powershell.exe;powershell_ise.exe</Image>
				<CommandLine condition="excludes">Get-ItemProperty HKLM:\software\wow6432node\microsoft\windows\currentversion\uninstall\</CommandLine>
				<CommandLine condition="excludes">mysql server</CommandLine>
				<CommandLine condition="excludes">select-object displayversion,displayname</CommandLine>
			</Rule>
			<Rule name="Attack=T1059.001,Technique=Powershell,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Powershell ran from Scripting Utilities,Risk=50" groupRelation="and">
				<ParentImage condition="contains any">cscript.exe;wscript.exe</ParentImage>
				<Image condition="contains any">powershell.exe;powershell_ise.exe</Image>
			</Rule>
			<Rule name="Attack=T1059.001,Technique=Powershell,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Powershell ran from cscript or wscript,Risk=50" groupRelation="and">
				<ParentImage condition="contains any">cscript.exe;wscript.exe</ParentImage>
				<Image condition="contains any">powershell.exe;powershell_ise.exe</Image>
			</Rule>
			<Rule name="Attack=T1059,Technique=Scripting,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Powershell Launched from mshta,Risk=100" groupRelation="and">
				<Image condition="contains any">powershell.exe;powershell_ise.exe</Image>
				<ParentImage condition="image">mshta.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1059,Technique=Visual Basic,Tactic=Execution,DS=Process: Process Creation,UEBA=Suspicious WSCRIPT Command Line,Risk=50" groupRelation="and">
				<Image condition="contains any">wscript.exe;cscript.exe</Image>
				<CommandLine condition="excludes any">IEX;Net.WebClient;ospp.vbs;powershell;slmgr.vbs;spiceworks_upload</CommandLine>
			</Rule>
			<Rule name="Attack=T1059,Technique=Scripting,Tactic=Execution,DS=Process: Process Creation,Level=2,Alert=Suspicious wscript commands,Risk=60" groupRelation="and">
				<Image condition="image">wscript.exe</Image>
				<CommandLine condition="contains">.jse</CommandLine>
				<CommandLine condition="contains">.js</CommandLine>
				<CommandLine condition="contains">.vba</CommandLine>
				<CommandLine condition="contains">.vbe</CommandLine>
			</Rule>
			<Rule name="Attack=T1059,Technique=Scripting,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Suspicious scripting to dll commands,Risk=70" groupRelation="and">
				<ParentImage condition="contains any">\wscript.exe;\cscript.exe</ParentImage>
				<Image condition="contains any">\rundll32.exe;regsvr32.exe</Image>
			</Rule>
			<Rule name="Attack=T1059,Technique=Scripting,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Suspicious rundll32 commands,Risk=70" groupRelation="and">
				<Image condition="contains any">\rundll32.exe;regsvr32.exe</Image>
				<CommandLine condition="excludes any">.dll;.cpl;.ocx;localserver;enable-speech-input;auto-scan-plugin;enable-media-stream;CastMediaRouteProvider;-eoim;/eoim</CommandLine><!--Already have localserver com detection-->
				<CommandLine condition="excludes all">setupapi;InstallHinfSection;DefaultInstall;SplunkUniversalForwarder\bin\spl;rundll32.exe "C:\Windows\Installer\MSI</CommandLine>
				<CommandLine condition="excludes all">\MSI;.tmp",zzzInvokeManagerCustomActionOutOfProc</CommandLine>
			</Rule>
			<Rule name="Attack=T1059,Technique=Scripting,Tactic=Execution,DS=Process: Process Creation,Level=2,Alert=cscript execution,Risk=60" groupRelation="and">
				<Image condition="image">cscript.exe</Image>
				<CommandLine condition="contains">.js</CommandLine>
				<CommandLine condition="contains">.jse</CommandLine>
				<CommandLine condition="contains">.vba</CommandLine>
				<CommandLine condition="contains">.vbe</CommandLine>
			</Rule>
			<Rule name="Attack=T1059,Technique=Scripting,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Suspicious or Malicious mshta exec,Risk=70" groupRelation="and">
				<CommandLine condition="contains any">mshta vbscript:CreateObject("Wscript.Shell");mshta vbscript:Execute("Execute;mshta vbscript:CreateObject("Wscript.Shell").Run("mshta.exe;javascript:a=</CommandLine>
				<CommandLine condition="contains any">.jpg;.png;.lnk;.xls;.doc;.zip;.sct;.hta</CommandLine>
			</Rule>
			<Rule name="Attack=T1059.003,Technique=Scripting,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Possible WinNTI Malware,Risk=100" groupRelation="and">
				<ParentImage condition="contains any">C:\Windows\Temp\hpqhvind.exe;C:\ProgramData\DRM\;Test.exe</ParentImage>
				<Image condition="contains any">C:\ProgramData\DRM;wmplayer.exe;C:\ProgramData\DRM\CLR\CLR.EXE</Image>
			</Rule>
			<Rule name="Attack=T1204,Technique=User Execution,DS=Process: Process Creation,Tactic=Execution,UEBA=Registry Editor Opened by user,Risk=70" groupRelation="and">
				<Image condition="image">regedit.exe</Image>
				<ParentImage condition="image">explorer.exe</ParentImage>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,UEBA=Unusual Child Process,Risk=30" groupRelation="and">
				<Image condition="contains any">\svchost.exe;\taskhostw.exe;\userinit.exe;\smss.exe;\csrss.exe;\wininit.exe;\winlogon.exe;\lsass.exe;\logonui.exe;\services.exe</Image>
				<Image condition="contains any">C:\windows\System32\;C:\windows\syswow64\</Image>
				<ParentImage condition="excludes any">\wininit.exe;\winlogon.exe;\services.exe;\dwm.exe;System;\smss.exe;\svchost.exe</ParentImage>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,UEBA=Unusual Print Spooler Child Process,Risk=30" groupRelation="and">
				<ParentImage condition="contains any">\spoolsv.exe;\PrintIsolationHost.exe</ParentImage>
				<Image condition="excludes any">C:\Windows\System32\spoolsv.exe;\GPLGS\gswin32c.exe;C:\Windows\System32\spool\drivers\;\bin\gswin64c.exe;C:\PROGRA~2\CUTEPD~1\;C:\Windows\EEFPrinter.exe</Image>
				<CommandLine condition="excludes any">C:\Windows\system32\spool\DRIVERS</CommandLine>
				<Company condition="excludes any">Brother Industries;Thomson Reuters</Company>
			</Rule>
			<ParentCommandLine name="Attack=T1059.001,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Metasploit Detection,Risk=90" condition="contains">COMSPEC</ParentCommandLine>
			<CommandLine name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=ScriptFile execution" condition="contains">ScriptFile</CommandLine>
			<CommandLine name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Execution from 7z Archive File,Risk=50" condition="contains">\Temp\7z</CommandLine><!-- exec from 7zip -->
			<CommandLine name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Execution from Explorer Archive File,Risk=50" condition="contains">\Temp\Temp1_</CommandLine><!-- exec from explorer -->
			<CommandLine name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Execution from winrar Archive File,Risk=50" condition="contains">\Temp\Rar$</CommandLine><!-- exec from winrar -->
			<!--MITRE ATT&CK TECHNIQUE: Command and Scripting Interpreter: Powershell-->
			<Rule name="Attack=T1059.001,Technique=Scripting,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Powershell Launched from users folder,Risk=60" groupRelation="and">
				<Image condition="contains any">powershell.exe;powershell_ise.exe</Image>
				<ParentImage condition="begin with">C:\users\</ParentImage>
				<ParentImage condition="excludes">Microsoft VS Code\Code.exe</ParentImage>
				<ParentImage condition="excludes">\Deployment tool extract\setupodt.exe</ParentImage>
			</Rule>
			<CommandLine name="Attack=T1059.001,Technique=PowerShell,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=invoke-shellcode,Risk=100" condition="contains">Shellcode</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: Command and Scripting Interpreter: Python-->
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=4,Alert=IronPython,Tactic=Privilege Escalation" condition="image">ipy.exe</Image>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Python Execution,Tactic=Privilege Escalation" condition="image">python.exe</Image>
			<!--MITRE ATT&CK TECHNIQUE: Command and Scripting Interpreter: Javascript-->
			<CommandLine name="Attack=T1059.007,Technique=PowerShell,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=JAVA DLL exec" condition="contains">-agentpath:</CommandLine>
			<CommandLine name="Attack=T1059.007,Technique=PowerShell,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=JAVA DLL exec" condition="contains">-agentlib:</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: Container Administration Command-->
			<!--MITRE ATT&CK TECHNIQUE: Deploy Container-->
			<!--MITRE ATT&CK TECHNIQUE: Exploitation for Client Execution-->
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Office Exploitation Detection,Risk=100" groupRelation="and">
				<ParentImage condition="contains any">winword.exe;excel.exe;powerpnt.exe;outlook.exe;msaccess.exe;mspub.exe;visio.exe;notepad.exe;wordpad.exe;eqnedt32.exe;wordview.exe</ParentImage>
				<Image condition="contains any">tracert.exe;csc.exe;cscript.exe;wscript.exe;cmd.exe;powershell.exe;bash.exe;scrcons.exe;schtasks.exe;hh.exe;regsvr32.exe;regsvcs.exe;sh.exe;wmic.exe;mshta.exe;rundll32.exe;msiexec.exe;forfiles.exe;scriptrunner.exe;mftrace.exe;AppVLP.exe;svchost.exe;MicroScMgmt.exe;FLTLDR.exe;wmic.exe;Microsoft.Workflow.Compiler.exe;atbroker.exe;bginfo.exe;certutil.exe;csi.exe;dnx.exe;cdb.exe;bitsadmin.exe;forfiles.exe;fsi.exe;ftp.exe;hostname.exe;gpresult.exe;ipconfig.exe;nbtstat.exe;ping.exe;pwsh.exe;qprocess.exe;quser.exe;qwinsta.exe;reg.exe;svchost.exe;installutil.exe;pwsh.exe;msxsl.exe;ieexec.exe;msdt.exe;verclsid.exe;msidb.exe</Image>
				<CommandLine condition="excludes all">.cmd;-</CommandLine>
				<CommandLine condition="excludes">C:\Windows\system32\spool\DRIVERS\</CommandLine>
				<CommandLine condition="excludes">PhotoViewer.dll</CommandLine>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Desc=Outlook Attachments Executed suspicious html attachment,Risk=50" groupRelation="and">
				<ParentImage condition="image">outlook.exe</ParentImage>
				<CommandLine condition="excludes any">http:;https:;ftp:;mailto:;tel:</CommandLine>
				<CommandLine condition="end with">.html</CommandLine>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Desc=Outlook Attachments Executed suspicious html attachment 2,Risk=50" groupRelation="and">
				<ParentImage condition="image">outlook.exe</ParentImage>
				<CommandLine condition="excludes any">http:;https:;ftp:;mailto:;tel:</CommandLine>
				<CommandLine condition="end with">.html"</CommandLine>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Desc=Outlook Attachments Executed suspicious html attachment 2,Risk=50" groupRelation="and">
				<ParentImage condition="image">outlook.exe</ParentImage>
				<CommandLine condition="excludes any">http:;https:;ftp:;mailto:;tel:</CommandLine>
				<CommandLine condition="end with">.html"</CommandLine>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Desc=Outlook Attachments Executed pfd attachment,Risk=50" groupRelation="and">
				<ParentImage condition="image">outlook.exe</ParentImage>
				<CommandLine condition="end with">.pdf"</CommandLine>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Desc=Outlook Attachments Executed pfd attachment 2,Risk=50" groupRelation="and">
				<ParentImage condition="image">outlook.exe</ParentImage>
				<CommandLine condition="end with">.pdf</CommandLine>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Desc=Outlook Attachments Executed iso attachment,Risk=50" groupRelation="and">
				<ParentImage condition="image">outlook.exe</ParentImage>
				<CommandLine condition="end with">.iso"</CommandLine>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Desc=Outlook Attachments Executed iso attachment 2,Risk=50" groupRelation="and">
				<ParentImage condition="image">outlook.exe</ParentImage>
				<CommandLine condition="end with">.iso</CommandLine>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Desc=Outlook Link Clicks,Risk=50" groupRelation="and">
				<ParentImage condition="image">outlook.exe</ParentImage>
				<Image condition="contains any">\iexplore.exe;\chrome.exe;\firefox.exe;\MicrosoftEdge;browser_broker.exe;\vivaldi.exe;\brave.exe;\opera.exe;BrowserAssist.exe;\msedgewebview;\msedge.exe</Image>
				<CommandLine condition="contains any">http:;https:;ftp:;mailto:;tel:</CommandLine>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Desc=Outlook Attachments Executed to Common Download locations,Risk=50" groupRelation="and">
				<ParentImage condition="image">outlook.exe</ParentImage>
				<CommandLine condition="excludes any">http:;https:;ftp:;mailto:;tel:</CommandLine>
				<CommandLine condition="contains any">\Content.Outlook\;\Downloads\;\Documents\;:\Users\Public\;\Desktop\</CommandLine>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Desc=Outlook Execution to UNC File Path,Risk=50" groupRelation="and">
				<ParentImage condition="image">outlook.exe</ParentImage>
				<CommandLine condition="contains any">\\</CommandLine>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Alert=Office Spawning exe within: User Home Dirs,Risk=80" groupRelation="and">
				<ParentImage condition="contains any">winword.exe;excel.exe;powerpnt.exe;outlook.exe;msaccess.exe;mspub.exe;visio.exe;notepad.exe;wordpad.exe;eqnedt32.exe;wordview.exe</ParentImage>
				<Image condition="begin with">C:\Users\</Image>
				<Image condition="end with">.exe</Image>
				<Product condition="excludes">Zoom Video</Product>
				<Product condition="excludes">Firefox</Product>
				<Product condition="excludes">Microsoft Edge</Product>
				<Product condition="excludes">Microsoft Teams</Product>
				<Image condition="excludes">GrammarlyAddInSetupe</Image>
				<Image condition="excludes">Teams.exe</Image>
				<Image condition="excludes">Zoom.exe</Image>
				<Image condition="excludes">browser_broker.exe</Image>
				<Image condition="excludes">chrome.exe</Image>
				<Image condition="excludes">edge.exe</Image>
        <Image condition="excludes">msedge.exe</Image>
				<Image condition="excludes">firefox.exe</Image>
				<Image condition="excludes">iexplore.exe</Image>
				<Image condition="excludes">vivaldi.exe</Image>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Desc=Office Spawning exe within: ProgramData,Risk=70" groupRelation="and">
				<ParentImage condition="contains any">winword.exe;excel.exe;powerpnt.exe;outlook.exe;msaccess.exe;mspub.exe;visio.exe;notepad.exe;wordpad.exe;eqnedt32.exe;wordview.exe</ParentImage>
				<Image condition="begin with">C:\ProgramData\</Image>
				<Product condition="excludes">Firefox</Product>
				<Product condition="excludes">Microsoft Edge</Product>
				<Product condition="excludes">Microsoft Teams</Product>
				<Product condition="excludes">Zoom Video</Product>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Desc=Execution from within Zip File,Risk=70" groupRelation="and">
				<CommandLine condition="contains">.zip\</CommandLine>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Adobe Exploitation Detection,Risk=80" groupRelation="and">
				<ParentImage condition="contains any">acrobat.exe;acrord32.exe</ParentImage>
				<Image condition="contains any">tracert.exe;csc.exe;cscript.exe;wscript.exe;cmd.exe;powershell.exe;bash.exe;scrcons.exe;schtasks.exe;hh.exe;regsvr32.exe;regsvcs.exe;sh.exe;wmic.exe;mshta.exe;rundll32.exe;msiexec.exe;forfiles.exe;scriptrunner.exe;mftrace.exe;AppVLP.exe;svchost.exe;MicroScMgmt.exe;FLTLDR.exe;wmic.exe;Microsoft.Workflow.Compiler.exe;atbroker.exe;bginfo.exe;certutil.exe;csi.exe;dnx.exe;cdb.exe;bitsadmin.exe;forfiles.exe;fsi.exe;ftp.exe;hostname.exe;gpresult.exe;ipconfig.exe;nbtstat.exe;ping.exe;pwsh.exe;qprocess.exe;quser.exe;qwinsta.exe;reg.exe;svchost.exe;installutil.exe;pwsh.exe;msxsl.exe;ieexec.exe;msdt.exe;verclsid.exe</Image>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Office MSHTML Exploit,Risk=100,CVE=CVE-2021-40444" groupRelation="and">
				<ParentImage condition="contains any">winword.exe;powerpnt.exe;excel.exe</ParentImage>
				<Image condition="image">control.exe</Image>
				<CommandLine condition="excludes any">input.dll</CommandLine>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Follina msdt Exploit,Risk=100,CVE=CVE-2022-30190" groupRelation="and">
				<Image condition="image">msdt.exe</Image>
				<OriginalFileName condition="is">msdt.exe</OriginalFileName>
				<CommandLine condition="contains all">BrowseForFile=;PCWDiagnostic</CommandLine>
				<CommandLine condition="contains any">/af;-af</CommandLine>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=msdt via answer file,Risk=100,CVE=CVE-2022-30190" groupRelation="and">
				<Image condition="image">msdt.exe</Image>
				<ParentImage condition="is not">pcwrun.exe</ParentImage>
				<CommandLine condition="contains">PCWDiagnostic</CommandLine>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=msdt via diagcab file,Risk=100,CVE=CVE-2022-30190" groupRelation="and">
				<Image condition="image">msdt.exe</Image>
				<CommandLine condition="contains any">/cab;-cab</CommandLine>
				<CommandLine condition="contains">.diagcab</CommandLine>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=MSDT Executed with Suspicious Parent,Risk=100,CVE=CVE-2022-30190" groupRelation="and">
				<ParentImage condition="contains any">powershell.exe;pwsh.exe;cmd.exe;mshta.exe;cscript.exe;wscript.exe;wsl.exe;rundll32.exe;regsvr32.exe</ParentImage>
				<Image condition="image">msdt.exe</Image>
			</Rule>
			<ParentImage condition="image" name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Exploit - Equation Editor starts application,CVE=CVE-2017-11882">EQNEDT32.EXE</ParentImage> <!-- https://app.any.run/tasks/dfea0112-6fbe-4091-9161-1e8f25f611b0/-->
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=EPS Processing 0day,Risk=100,CVE=CVE-2017-0261" groupRelation="and">
				<ParentImage condition="contains any">winword.exe;excel.exe;powerpnt.exe</ParentImage>
				<Image condition="image">FLTLDR.EXE</Image>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Inter-Process Communication-->
			<CommandLine name="Attack=T1559.002,Technique=Dynamic Data Exchange,Tactic=Execution,DS=Process: Process Creation," condition="contains any">/dde;-dde</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: Native API-->
			<!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
			<Rule name="Attack=T1053.005,Technique=Scheduled Task/Job: Scheduled Task,Tactic=Execution,DS=Process: Process Creation,Level=2,Alert=Scheduled Task Created,Risk=100" groupRelation="and">
				<Image condition="image">schtasks.exe</Image>
				<CommandLine condition="contains any">/create;-create;/change;-change</CommandLine>
				<CurrentDirectory condition="excludes">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\</CurrentDirectory>
			</Rule>
			<OriginalFileName name="Attack=T1053.005,Technique=Scheduled Task/Job: Scheduled Task,Tactic=Execution,DS=Process: Process Creation,Level=2,Alert=Scheduled Task Created,Risk=1" condition="is">taskeng.exe</OriginalFileName>
			<Rule name="Attack=T1053.005,Technique=Scheduled Task,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Schtasks task Run,Risk=60" groupRelation="and">
				<Image condition="image">schtasks.exe</Image>
				<CommandLine condition="contains any">/Run;-run</CommandLine>
				<CommandLine condition="excludes">Sentinel\AutoRepair</CommandLine>
				<CurrentDirectory condition="excludes">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\</CurrentDirectory>
			</Rule>
			<Rule name="Attack=T1053.005,Technique=Scheduled Task/Job: Scheduled Task,Tactic=Persistence,DS=Process: Process Creation,Level=2,Alert=Child process from schtasks" groupRelation="and">
				<ParentImage condition="image">schtasks.exe</ParentImage>
				<ParentCommandLine condition="excludes">schtasks /TN RtkAudUService64_BG</ParentCommandLine>
				<ParentCommandLine condition="excludes any">-change;/change;-delete;/delete;-create;/create</ParentCommandLine>
			</Rule>
			<Image name="Attack=T1053.002,Technique=Scheduled Task/Job: At,Tactic=Persistence,DS=Process: Process Creation,Level=2,Alert=at.exe Task scheduler execution" condition="image">at.exe</Image>
			<ParentImage name="Attack=T1053.002,Technique=Scheduled Task/Job: At,Tactic=Execution/Persistence/Privledge Escalation,DS=Process: Process Creation,Level=2,Alert=at.exe Task scheduler execution" condition="image">at.exe</ParentImage>
			<Rule name="Attack=T1053.005,Technique=Scheduled Task/Job: Scheduled Task,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Scheduled Task Started,Risk=0" groupRelation="and">
				<ParentImage condition="image">C:\Windows\System32\svchost.exe</ParentImage>
				<ParentCommandLine condition="contains all">netsvcs;-p;-s;Schedule</ParentCommandLine>
				<CommandLine condition="excludes all">netsvcs;-p;-s;Schedule</CommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Shared Modules-->
			<!--MITRE ATT&CK TECHNIQUE: Software Deployment Tools-->
			<!--MITRE ATT&CK TECHNIQUE: System Services-->
			<Rule name="Attack=T1569.002,Technique=Service Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Service Stop detected,Risk=0" groupRelation="and">
				<OriginalFileName condition="contains any">net.exe;net1.exe;net2.exe</OriginalFileName>
				<CommandLine condition="contains">stop</CommandLine>
				<ParentCommandLine condition="excludes">tvsu_tmp</ParentCommandLine>
			</Rule>
			<Rule name="Attack=T1569.002,Technique=Service Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=NET.EXE Service Start detected,Risk=30" groupRelation="and">
				<OriginalFileName condition="contains any">net.exe;net1.exe;net2.exe</OriginalFileName>
				<CommandLine condition="contains">start</CommandLine>
				<ParentCommandLine condition="excludes">tvsu_tmp</ParentCommandLine>
			</Rule>
			<Rule name="Attack=T1569.002,Technique=Service Execution,Tactic=Execution/Lateral Movement,DS=Process: Process Creation,Level=3,Alert=Impacket Detection 1,Risk=100" groupRelation="and">
				<ParentImage condition="contains any">wmiprvse.exe;mmc.exe;explorer.exe;services.exe</ParentImage>
				<CommandLine condition="contains all">&#38;1;cmd.exe;\\127.0.0.1\;/Q /c</CommandLine>
			</Rule>
			<Rule name="Attack=T1569.002,Technique=Service Execution,Tactic=Execution/Lateral Movement,DS=Process: Process Creation,Level=3,Alert=Impacket Detection 2,Risk=100" groupRelation="and">
				<ParentImage condition="contains any">wmiprvse.exe;mmc.exe;explorer.exe;services.exe</ParentImage>
				<CommandLine condition="contains all">&#38;1;cmd.exe;\\127.0.0.1\;-Q -c</CommandLine>
			</Rule>
			<Rule name="Attack=T1035,Technique=Service Execution,Tactic=Execution/Lateral Movement,DS=Process: Process Creation,Level=4,Alert=PowerSploit/Empire Persistence,Risk=100" groupRelation="and">
				<CommandLine condition="contains all">schtasks;Create;ONLOGON;TN;Updater;TR;powershell</CommandLine>
			</Rule>
			<Rule name="Attack=T1543.003,Technique=Windows Service,Tactic=Persistence/Privilege Escalation,DS=Process: Process Creation,Level=2,Alert=Service added via SC,Risk=100" groupRelation="and">
				<Image condition="image">sc.exe</Image>
				<CommandLine condition="contains">create</CommandLine>
				<CurrentDirectory condition="excludes any">\NIC_Emulex_Firmware\;C:\Windows\Temp\ExchangeSetup\</CurrentDirectory>
			</Rule>
			<Rule name="Attack=T1543.003,Technique=Windows Service,Tactic=Persistence/Privilege Escalation,DS=Process: Process Creation,Level=2,Alert=Service binpath modification,Risk=100" groupRelation="and">
				<Image condition="image">sc.exe</Image>
				<CommandLine condition="contains all">config;binpath</CommandLine>
			</Rule>
			<Rule name="Attack=T1543.003,Technique=Windows Service,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Shell as System Service,Risk=100" groupRelation="and">
				<Image condition="contains any">cmd.exe;powershell.exe</Image>
				<ParentImage condition="image">services.exe</ParentImage>
			</Rule>
			<CommandLine name="Attack=T1543.003,Technique=Windows Service,Tactic=Persistence,DS=Process: Process Creation,Level=2,Alert=Service added via Powershell,Risk=50" condition="contains">new-service</CommandLine>
			<ParentImage name="Attack=T1035,Technique=Service Execution,Tactic=Execution/Lateral Movement,DS=Process: Process Creation,Level=4,Alert=PSEXESVC Child Process,Risk=100" condition="image">psexesvc.exe</ParentImage>
			<Rule name="Attack=T1035,Technique=Service Execution,Tactic=Execution/Lateral Movement,DS=Process: Process Creation,Level=4,Alert=PSexec Execution,Risk=100" groupRelation="or">
				<Description condition="contains">Execute processes remotely</Description>
				<Image condition="contains">psexe</Image>
				<Description condition="contains">PsExec Service</Description> 
				<Description condition="contains">PsExec Launched</Description> 
			</Rule>
			<Rule name="Attack=T1035,Technique=Service Execution,Tactic=Execution/Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Sysinternals Initial Tool Execution,Risk=100" groupRelation="or">
				<CommandLine condition="contains">accepteula</CommandLine>
			</Rule>
			<Rule name="Attack=T1035,Technique=Service Execution,Tactic=Execution/Lateral Movement,DS=Process: Process Creation,Level=4,Alert=PSexec SYSTEM Execution,Risk=100" groupRelation="and">
				<Description condition="contains">Execute processes remotely</Description>
				<CommandLine condition="contains any">-s;/s</CommandLine>
			</Rule>
			<ParentImage name="Attack=T1035,Technique=Service Execution,Tactic=Execution/Lateral Movement,DS=Process: Process Creation,Level=4,Alert=PSexec Child Process,Risk=100" condition="image">psexec.exe</ParentImage>
			<ParentImage name="Attack=T1035,Technique=Service Execution,Tactic=Execution/Lateral Movement,DS=Process: Process Creation,Level=2,Alert=PSKill Execution,Risk=100" condition="image">pskill.exe</ParentImage>
			<Image name="Attack=T1035,Technique=Service Execution,Tactic=Execution,DS=Process: Process Creation,Level=2,Alert=PsKill Command" condition="contains">pskill</Image>
			<Rule name="Attack=T1569.002,Technique=System Services: Service Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Suspicious Network Service Child Processes,Risk=75" groupRelation="and">
				<ParentCommandLine condition="is">C:\WINDOWS\system32\svchost.exe -k NetworkService -p</ParentCommandLine>
			</Rule>
			<Rule name="Attack=T1569.002,Technique=System Services: Service Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Suspicious LanmanWorkstation Child Processes,Risk=75" groupRelation="and">
				<ParentCommandLine condition="is">C:\WINDOWS\System32\svchost.exe -k NetworkService -p -s LanmanWorkstation</ParentCommandLine>
			</Rule>
			<Rule name="Attack=T1569.002,Technique=System Services: Service Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Suspicious Network List Service Child Processes,Risk=75" groupRelation="and">
				<ParentCommandLine condition="is">C:\WINDOWS\System32\svchost.exe -k netprofm -p -s netprofm</ParentCommandLine>
			</Rule>
			<Rule name="Attack=T1569.002,Technique=System Services: Service Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Remote Procedure Call Service Anomaly,Risk=75" groupRelation="and">
				<ParentCommandLine condition="contains all">C:\WINDOWS\system32\svchost.exe;RPCSS</ParentCommandLine>
			</Rule>
			<Rule name="Attack=T1569.002,Technique=System Services: Service Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Remote Procedure Call Service Crash detected,Risk=75" groupRelation="and">
				<ParentCommandLine condition="contains all">C:\WINDOWS\system32\svchost.exe;RPCSS</ParentCommandLine>
				<Image condition="image">werfault.exe</Image>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: User Execution-->
			<Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=AstraRoth Command Line detection" groupRelation="and">
				<CommandLine condition="contains">&amp;&amp; type</CommandLine>
				<CommandLine condition="contains">&gt;</CommandLine>
				<CommandLine condition="contains">cmd.exe" /c cd</CommandLine>
			</Rule>
			<Rule  name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Suspicious or Malicious Command Line events" groupRelation="and">
				<CommandLine condition="contains any">ntdsutil;/set {default} recoveryenabled no;telnet ;-dumpcr;putty;bash.exe;pssh;shareenum;sekurlsa;reg save;reg  save;psscan;shellexec;vbscript:createobject;/output:clipboard;root\\default;root\\subscription;Wmiclass;WmiCl'+'as'+'s;export-mft;ApplicationImpersonation</CommandLine>
			</Rule>
			<Rule  name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Powershell Suspicious or Malicious events" groupRelation="or">
				<CommandLine condition="contains any">ERROR kuhl;windows/meterpreter;InjectDLL;ReflectiveLoader;Koadic.;@subtee;-donate-level=;stratum+tcp;Win32_TaskService;FilterToConsumerBinding;Invoke-Stager;Invoke-FruityC2;smbscanner;Invoke-ReverseDNSLookup;Invoke-ARPScan;Invoke-Paranoia;Find-TrustedDocuments;Find-Fruit;Get-RickAstley;PowerView;Invoke-Tater;Get-System;Get-SiteListPassword;PowerBreach;Invoke-BackdoorLNK;Install-SSP;Get-SecurityPackages;Invoke-SSHCommand;Invoke-PsExec;Invoke-InveighRelay;Set-Wallpaper;Invoke-VoiceTroll;Invoke-ThunderStruck;Exploit-Jboss;Invoke-PowerDump;Invoke-DCSync;Get-VaultCredential;Set-MacAttribute;New-HoneyHash;MailRaider;Invoke-RunAs;Invoke-PSInject;Invoke-EgressCheck;Invoke-NetRipper;Invoke-Inveigh;Get-Screenshot;Get-IndexedItem;Get-FoxDump'Get-Clipboard;Get-ChromeDump;Start-CaptureServer;Add-Persistence;Add-Exfiltration;Invoke-PowerShellWMI;Invoke-PowerShellTCP;Invoke-PoshRatHttp;Show-TargetScreen;Get-PassHashes;Get-LSASecret;Check-VM;Remove-Update;Enabled-DuplicateToken;Invoke-ADSBackdoor;Gupt-Backdoor;Add-ScrnSaveBackdoor;Add-RegBackdoor;Get-Unconstrained;Get-RegAlwaysInstallElevated;Get-ApplicationHost;Get-WebConfig;Get-UnattendedInstallFile;Get-VulnAutoRun;Get-RegAutoLogon;Install-ServiceBinary;Invoke-ServiceAbuse;Get-ServicePermission;Get-ServiceFilePermission;Get-ServiceUnquoted;Invoke-DowngradeAccount;Invoke-ACLScanner;Find-GPOLocation;Invoke-UserHunter;Invoke-ReflectivePEInjectionInvoke-ReflectivePEInjection;Invoke-ReflectivePEInjection;VolumeShadowCopyTools;Out-Minidump;Invoke-TokenManipulation;Invoke-DllInjection;Invoke-SessionGopher;Invoke-Shellcode;Invoke-WmiCommand;Get-GPPPassword;Get-Keystrokes;Get-TimedScreenshot;Get-VaultCredential;Invoke-CredentialInjection;Invoke-NinjaCopy</CommandLine>
				<ParentCommandLine condition="contains any">ERROR kuhl;windows/meterpreter;InjectDLL;ReflectiveLoader;Koadic.;@subtee;-donate-level=;stratum+tcp;Win32_TaskService;FilterToConsumerBinding;Invoke-Stager;Invoke-FruityC2;smbscanner;Invoke-ReverseDNSLookup;Invoke-ARPScan;Invoke-Paranoia;Find-TrustedDocuments;Find-Fruit;Get-RickAstley;PowerView;Invoke-Tater;Get-System;Get-SiteListPassword;PowerBreach;Invoke-BackdoorLNK;Install-SSP;Get-SecurityPackages;Invoke-SSHCommand;Invoke-PsExec;Invoke-InveighRelay;Set-Wallpaper;Invoke-VoiceTroll;Invoke-ThunderStruck;Exploit-Jboss;Invoke-PowerDump;Invoke-DCSync;Get-VaultCredential;Set-MacAttribute;New-HoneyHash;MailRaider;Invoke-RunAs;Invoke-PSInject;Invoke-EgressCheck;Invoke-NetRipper;Invoke-Inveigh;Get-Screenshot;Get-IndexedItem;Get-FoxDump'Get-Clipboard;Get-ChromeDump;Start-CaptureServer;Add-Persistence;Add-Exfiltration;Invoke-PowerShellWMI;Invoke-PowerShellTCP;Invoke-PoshRatHttp;Show-TargetScreen;Get-PassHashes;Get-LSASecret;Check-VM;Remove-Update;Enabled-DuplicateToken;Invoke-ADSBackdoor;Gupt-Backdoor;Add-ScrnSaveBackdoor;Add-RegBackdoor;Get-Unconstrained;Get-RegAlwaysInstallElevated;Get-ApplicationHost;Get-WebConfig;Get-UnattendedInstallFile;Get-VulnAutoRun;Get-RegAutoLogon;Install-ServiceBinary;Invoke-ServiceAbuse;Get-ServicePermission;Get-ServiceFilePermission;Get-ServiceUnquoted;Invoke-DowngradeAccount;Invoke-ACLScanner;Find-GPOLocation;Invoke-UserHunter;Invoke-ReflectivePEInjectionInvoke-ReflectivePEInjection;Invoke-ReflectivePEInjection;VolumeShadowCopyTools;Out-Minidump;Invoke-TokenManipulation;Invoke-DllInjection;Invoke-SessionGopher;Invoke-Shellcode;Invoke-WmiCommand;Get-GPPPassword;Get-Keystrokes;Get-TimedScreenshot;Get-VaultCredential;Invoke-CredentialInjection;Invoke-NinjaCopy</ParentCommandLine>
			</Rule>
			<CommandLine name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Ramnit Banker Malware,Risk=100" condition="contains">--disable-http2 --disable-quic</CommandLine>
			<CommandLine name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=DNSpionage Link click,Risk=100" condition="contains">/Client/Login?id=</CommandLine>
			<ParentCommandLine name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Emotet Child Process Detected" condition="contains">JABzA</ParentCommandLine>
			<Rule  name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Malicious Hash Detected" groupRelation="or">
				<Hashes condition="contains any">2f40abbb4f78e77745f0e657a19903fc953cc664;478dc5a5f934c62a9246f7d1fc275868f568bc07;37b4496e650b3994312c838435013560b3ca8571;37b4496e650b3994312c838435013560b3ca8571;e8542c07b2af63ee7e72ce5d97d91036c5da56e2b091aa2afe737b224305d230;08c34c6ac9186b61d9f29a77ef5e618067e0bc9fe85cab1ad25dc6049c376949;5fc4b0076eac7aa7815302b0c3158076e3569086c4c6aa2f71cd258238440d14;bef59b9a3e00a14956e0cd4a1f3e7524448cbe5d3cc1295d95a15b83a3579c59;2c1d3d0a9c6f76726994b88589219cb8d9c39dd9924bc8d2d02bf41d955fe326;1a2ab4df156ccd685f795baee7df49f8e701f271d3e5676b507112e30ce03c42;758598370c3b84c6fbb452e3d7119f700f970ed566171e879d3cb41102154272;5c776a33568f4c16fee7140c249c0d2b1e0798a96c7a01bfd2d5684e58c9bb32;c96ed56bf7ee85a4398cc43a98b4db86d3da311c619f17c8540ae424ca6546e1;c96ed56bf7ee85a4398cc43a98b4db86d3da311c619f17c8540ae424ca6546e1;36dd195269979e01a29e37c488928497;7d9d29c1c03461608bcab930fef2f568;807d86da63f0db1fc746d1f0b05bc357;849a2b0dc80aeca3d175c139efe5221c;86A4CAC227078B9C95C560C8F0370BF0;98908ce6f80ecc48628c8d2bf5b2a50c;a4b42c2c95d1f2ff12171a01c86cd64f;4abe604916c04fe3dd8b9cb3d501d3f;eac3e3ece94bc84e922ec077efb15edd;128CECC59C91C0D0574BC1075FE7CB40;88777aacd5f16599547926a4c9202862;0f49621b06f2cdaac8850c6e9581a594;17a36ac3e31f3a18936552aff2c80249;322cb39bc049aa69136925137906d855;2010f38ef300be4349e7bc287e720b1ecec678cacbf0ea0556bcf765f6e073ec;cd4b9d0f2d1c0468750855f0ed352c1ed6d4f512d66e0e44ce308688235295b5;5b102bf4d997688268bab45336cead7cdf188eb0d6355764e53b4f62e1cdf30c;b017b9fc2484ce0a5629ff1fed15bca9f62f942eafbb74da6a40f40337187b04;6a251ed6a2c6a0a2be11f2a945ec68c814d27e2b6ef445f4b2c7a779620baa11;3d129263f6a48647f103a04446fb0c2f;37cd353621b0f4fc6981b50071c94f01;1b60021baedc3f9201bcdb40e9b87f62;71345b139166482acaa568ac8816c7bc;5E022694C0DBD1FBBC263D608E577949;304772c80b157a916c7041f2f15939fb;291ff87948e45914424cec9510c297da;b8fcd4a3902064907fb19e0da3ca7aed72a7e6d1f94d971d1ee7a4d3af6a800d;965884f19026913b2c57b8cd4a86455a61383de01dabb69c557f45bb848f6c26;4a069c1abe5aca148d5a8fdabc26751e;dc5733c013378fa418d13773f5bfe6f1;c579341f86f7e962719c7113943bb6e4;d326e629a90e78825645963b35e53a6a;5E022694C0DBD1FBBC263D608E577949;53841a0c6a3ff92976db08bfdf95e083;dc7e564809d6c2a2f3457c3c9b91f22b;5470f0644589685000154cb7d3f60280acb16e39ca961cce2c016078b303bc1b;FE2CA1BE3BDA2A757036A89E54CC02DB;FE2CA1BE3BDA2A757036A89E54CC02DB</Hashes>
			</Rule>
			<Hashes name="Attack=T1353,Technique=Post Compromise Tool Development,Tactic=Build Capabilities,DS=Process: Process Creation,Level=4,Alert=TajMahal APT Tool Detection,Risk=100" condition="contains any">22d142f11cf2a30ea4953e1fffb0fa7e;2317d65da4639f4246de200650a70753;27612cb03c89158225ca201721ea1aad;412956675fbc3f8c51f438c1abc100eb;daf2da52475fd8981b19ec3c321a983c;490a140093b5870a47edc29f33542fd2;51a7068640af42c3a7c1b94f1c11ab9d;533340c54bd25256873b3dca34d7f74e;684eca6b62d69ce899a3ec3bb04d0a5b;69a19abf5ba56ee07cdd3425b07cf8bf;6cfd131fef548fcd60fbcdb59317df8e;72dc98449b45a7f1ccdef27d51e31e91;7c733607a0932b1b9a9e27cd6ab55fe0;7d5265e814843b24fcb3787768129040;80c37e062aa4c94697f287352acf2e9d;815f1f8a7bc1e6f94cb5c416e381a110;a43d3b31575846fa4c3992b4143a06da;08e82dc7bae524884b7dc2134942aadb;7bcd736a2394fc49f3e27b3987cce640;57314359df11ffdf476f809671ec0275;b72737b464e50aa3664321e8e001ff32;ce8ce92fb6565181572dce00d69c24f8;5985087678414143d33ffc6e8863b887;84730a6e426fbd3cf6b821c59674c8a0;d5377dc1821c935302c065ad8432c0d2;d8f1356bebda9e77f480a6a60eab36bb;92f8e3f0f1f7cc49fad797a62a169acd;9003cfaac523e94d5479dc6a10575e60;df91b86189adb0a11c47ce2405878fa1;e17bd40f5b5005f4a0c61f9e79a9d8c2;c1e7850da5604e081b9647b58248d7e8;99828721ac1a0e32e4582c3f615d6e57;f559c87b4a14a4be1bd84df6553aaf56;b9c208ea8115232bfd9ec2c62f32d6b8;061089d8cb0ca58e660ce2e433a689b3;0e9afd3a870906ebf34a0b66d8b07435;9c115e9a81d25f9d88e7aaa4313d9a8f;520ee02668a1c7b7c262708e12b1ba6b;7bfba2c69bed6b160261bdbf2b826401;77a745b07d9c453650dd7f683b02b3ed;3a771efb7ba2cd0df247ab570e1408b2;0969b2b399a8d4cd2d751824d0d842b4;fc53f2cd780cd3a01a4299b8445f8511;4e39620afca6f60bb30e031ddc5a4330;bfe3f6a79cad5b9c642bb56f8037c43b;3dfebce4703f30eed713d795b90538b5;9793afcea43110610757bd3b800de517;36db24006e2b492cafb75f2663f241b2;21feb6aa15e02bb0cddbd544605aabad;21feb6aa15e02bb0cddbd544605aabad;649ef1dd4a5411d3afcf108d57ff87af;320b2f1d9551b5d1df4fb19bd9ab253a;3d75c72144d873b3c1c4977fbafe9184;b9cf4301b7b186a75e82a04e87b30fe4;b4e67706103c3b8ee148394ebee3f268;7bfbd72441e1f2ed48fbc0f33be00f24;cdb303f61a47720c7a8c5086e6b2a743;2a6f7ec77ab6bd4297e7b15ae06e2e61;8403a28e0bffa9cc085e7b662d0d5412;3ffd2915d285ad748202469d4a04e1f5;04078ef95a70a04e95bda06cc7bec3fa;235d427f94630575a4ea4bff180ecf5d;8035a8a143765551ca7db4bc5efb5dfd;cacaa3bf3b2801956318251db5e90f3c;1aadf739782afcae6d1c3e4d1f315cbd;c3e255888211d74cc6e3fb66b69bbffb;d9e9f22988d43d73d79db6ee178d70a4;16ab79fb2fd92db0b1f38bedb2f02ed8;8da15a97eaf69ff7ee184fc446f19cf1;ffc7305cb24c1955f9625e525d58aeee;c0e72eb4c9f897410c795c1b360090ef;9ad6fa6fdedb2df8055b3d30bd6f64f1;44619a88a6cff63523163c6a4cf375dd;a571660c9cf1696a2f4689b2007a12c7;81229c1e272218eeda14892fa8425883;0ac48cfa2ff8351365e99c1d26e082ad;afcdf79be1557326c854b6e20cb900a7</Hashes> <!-- https://securelist.com/project-tajmahal/90240/ -->
			<Hashes name="Attack=T1353,Technique=Post Compromise Tool Development,Tactic=Build Capabilities,DS=Process: Process Creation,Level=3,Alert=Windows-Credential Editor Detection,Risk=70" condition="contains">a53a02b997935fd8eedcb5f7abab9b9f</Hashes> <!-- https://securelist.com/project-tajmahal/90240/ -->
			<Hashes name="Attack=T1353,Technique=Post Compromise Tool Development,Tactic=Build Capabilities,DS=Process: Process Creation,Level=3,Alert=Windows-Credential Editor Detection,Risk=70" condition="contains">e96a73c7bf33a464c510ede582318bf2</Hashes> <!-- https://securelist.com/project-tajmahal/90240/ -->
			<Image name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Emotet Execution Detected,Risk=100" condition="contains">serialfunc.exe</Image>
			<Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Emotet Command Line detection" groupRelation="and">
				<CommandLine condition="contains any">e PAA;en PAA;enc PAA;enco PAA;encode PAA;encoded PAA;encodedco PAA;encodedcom PAA;encodedcomm PAA;encodedcomma PAA;encodedcomman PAA;encodedcommand PAA;e IAA;en IAA;enc IAA;enco IAA;encode IAA;encoded IAA;encodedco IAA;encodedcom IAA;encodedcomm IAA;encodedcomma IAA;encodedcomman IAA;encodedcommand IAA;e JAB;en JAB;enc JAB;enco JAB;encode JAB;encoded JAB;encodedco JAB;encodedcom JAB;encodedcomm JAB;encodedcomma JAB;encodedcomman JAB;encodedcommand JAB;e cwBFAFQA;en cwBFAFQA;enc cwBFAFQA;enco cwBFAFQA;encode cwBFAFQA;encoded cwBFAFQA;encodedco cwBFAFQA;encodedcom cwBFAFQA;encodedcomm cwBFAFQA;encodedcomma cwBFAFQA;encodedcomman cwBFAFQA;encodedcommand cwBFAFQA;e SQBFAF;en SQBFAF;enc SQBFAF;enco SQBFAF;encode SQBFAF;encoded SQBFAF;encodedco SQBFAF;encodedcom SQBFAF;encodedcomm SQBFAF;encodedcomma SQBFAF;encodedcomman SQBFAF;encodedcommand SQBFAF;e UwBFAFQA;en UwBFAFQA;enc UwBFAFQA;enco UwBFAFQA;encode UwBFAFQA;encoded UwBFAFQA;encodedco UwBFAFQA;encodedcom UwBFAFQA;encodedcomm UwBFAFQA;encodedcomma UwBFAFQA;encodedcomman UwBFAFQA;encodedcommand UwBFAFQA;e IABpAE4AdgBPAEsAZQAt;en IABpAE4AdgBPAEsAZQAt;enc IABpAE4AdgBPAEsAZQAt;enco IABpAE4AdgBPAEsAZQAt;encode IABpAE4AdgBPAEsAZQAt;encoded IABpAE4AdgBPAEsAZQAt;encodedco IABpAE4AdgBPAEsAZQAt;encodedcom IABpAE4AdgBPAEsAZQAt;encodedcomm IABpAE4AdgBPAEsAZQAt;encodedcomma IABpAE4AdgBPAEsAZQAt;encodedcomman IABpAE4AdgBPAEsAZQAt;encodedcommand IABpAE4AdgBPAEsAZQAt;e SQBmACgAJAB;en SQBmACgAJAB;enc SQBmACgAJAB;enco SQBmACgAJAB;encode SQBmACgAJAB;encoded SQBmACgAJAB;encodedco SQBmACgAJAB;encodedcom SQBmACgAJAB;encodedcomm SQBmACgAJAB;encodedcomma SQBmACgAJAB;encodedcomman SQBmACgAJAB;encodedcommand SQBmACgAJAB;e J;en J;enc J;enco J;encode J;encoded J;encodedco J;encodedcom J;encodedcomm J;encodedcomma J;encodedcomman J;encodedcommand J;e SUVY;en SUVY;enc SUVY;enco SUVY;encode SUVY;encoded SUVY;encodedco SUVY;encodedcom SUVY;encodedcomm SUVY;encodedcomma SUVY;encodedcomman SUVY;encodedcommand SUVY;e aWV4;en aWV4;enc aWV4;enco aWV4;encode aWV4;encoded aWV4;encodedco aWV4;encodedcom aWV4;encodedcomm aWV4;encodedcomma aWV4;encodedcomman aWV4;encodedcommand aWV4;e dmFy;en dmFy;enc dmFy;enco dmFy;encode dmFy;encoded dmFy;encodedco dmFy;encodedcom dmFy;encodedcomm dmFy;encodedcomma dmFy;encodedcomman dmFy;encodedcommand dmFy;e dgBhA;en dgBhA;enc dgBhA;enco dgBhA;encode dgBhA;encoded dgBhA;encodedco dgBhA;encodedcom dgBhA;encodedcomm dgBhA;encodedcomma dgBhA;encodedcomman dgBhA;encodedcommand dgBhA;e R2V0;en R2V0;enc R2V0;enco R2V0;encode R2V0;encoded R2V0;encodedco R2V0;encodedcom R2V0;encodedcomm R2V0;encodedcomma R2V0;encodedcomman R2V0;encodedcommand R2V0;e IAAgAH;en IAAgAH;enc IAAgAH;enco IAAgAH;encode IAAgAH;encoded IAAgAH;encodedco IAAgAH;encodedcom IAAgAH;encodedcomm IAAgAH;encodedcomma IAAgAH;encodedcomman IAAgAH;encodedcommand IAAgAH;e TVq;en TVq;enc TVq;enco TVq;encode TVq;encoded TVq;encodedco TVq;encodedcom TVq;encodedcomm TVq;encodedcomma TVq;encodedcomman TVq;encodedcommand TVq;e aQBIA;en aQBIA;enc aQBIA;enco aQBIA;encode aQBIA;encoded aQBIA;encodedco aQBIA;encodedcom aQBIA;encodedcomm aQBIA;encodedcomma aQBIA;encodedcomman aQBIA;encodedcommand aQBIA;e UEs;en UEs;enc UEs;enco UEs;encode UEs;encoded UEs;encodedco UEs;encodedcom UEs;encodedcomm UEs;encodedcomma UEs;encodedcomman UEs;encodedcommand UEs;e H4s;en H4s;enc H4s;enco H4s;encode H4s;encoded H4s;encodedco H4s;encodedcom H4s;encodedcomm H4s;encodedcomma H4s;encodedcomman H4s;encodedcommand H4s;e dXNpbm;en dXNpbm;enc dXNpbm;enco dXNpbm;encode dXNpbm;encoded dXNpbm;encodedco dXNpbm;encodedcom dXNpbm;encodedcomm dXNpbm;encodedcomma dXNpbm;encodedcomman dXNpbm;encodedcommand dXNpbm;e cwBhA;en cwBhA;enc cwBhA;enco cwBhA;encode cwBhA;encoded cwBhA;encodedco cwBhA;encodedcom cwBhA;encodedcomm cwBhA;encodedcomma cwBhA;encodedcomman cwBhA;encodedcommand cwBhA;JABzA</CommandLine>
			</Rule>
			<Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Emotet Command Line detection 2" groupRelation="and">
				<CommandLine condition="contains all">FromBase64String</CommandLine>
				<CommandLine condition="contains any">JAB;SUVY;aWV4;dmFy;dgBhA;R2V0;SQBFAF;TVq;aQBIA;UEs;H4s;dXNpbm;cwBhA</CommandLine>
			</Rule>
			<Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Emotet Command Line detection 3" groupRelation="and">
				<CommandLine condition="contains any">/v Word experienced;/v Excel experienced;-v Word experienced;-v Excel experienced</CommandLine>
			</Rule>
			<Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Emotet Command Line detection 4" groupRelation="and">
				<CommandLine condition="contains any">JABlAG4AdgA6AHUAcwBlAHIAcAByAG8AZgBpAGwAZQ;QAZQBuAHYAOgB1AHMAZQByAHAAcgBvAGYAaQBsAGUA;kAGUAbgB2ADoAdQBzAGUAcgBwAHIAbwBmAGkAbABlA;IgAoACcAKgAnACkAOwAkA;IAKAAnACoAJwApADsAJA;iACgAJwAqACcAKQA7ACQA</CommandLine>
			</Rule>
			<Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Obfuscated Emotet Command Line detection" groupRelation="and">
				<CommandLine condition="contains any">e^;^en^;^nc</CommandLine>
			</Rule>
			<Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Suspicious Obfuscation Character" groupRelation="and">
				<CommandLine condition="contains">^</CommandLine>
			</Rule>
			<Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Suspicious Directory Traversal" groupRelation="and">
				<CommandLine condition="contains any">..\;\..</CommandLine>
			</Rule>
			<Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Formbook detections" groupRelation="and">
				<CommandLine condition="contains any">\cmd.exe /c del "C:\Users\*\AppData\Local\Temp\*.exe;\cmd.exe /c del "C:\Users\*\Desktop\*.exe;\cmd.exe -c del "C:\Users\*\AppData\Local\Temp\*.exe;\cmd.exe -c del "C:\Users\*\Desktop\*.exe</CommandLine>
			</Rule>
			<CommandLine name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=QBot Process Creation,Risk=100" condition="contains any">ping.exe -n 6 127.0.0.1 &#38;ping.exe /n 6 127.0.0.1 &#38; type</CommandLine>
			<CommandLine name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Powershell RAW ping,Risk=100" condition="contains">System.Net.Networkinformation.ping</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: Windows Management Instrumentation-->
			<Image name="Attack=T1158,Technique=Windows Management Instrumentation,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Mofcomp execution or persistence,Risk=50" condition="image">mofcomp.exe</Image>

			<!--MITRE ATT&CK TACTIC: Persistence-->
			<!--MITRE ATT&CK TECHNIQUE: Account Manipulation-->
			<Rule name="Attack=T1098,Technique=Account Manipulation,Tactic=Credential Access/Persistence,DS=Process: Process Creation,Level=3,Alert=Account Manipulation,Risk=80" groupRelation="and">
				<Image condition="contains any">net.exe;net1.exe;net2.exe</Image>
				<CommandLine condition="contains any">user;group;localgroup</CommandLine>
				<CommandLine condition="contains any">remove;delete;active;del</CommandLine>
				<ParentCommandLine condition="excludes">tvsu_tmp</ParentCommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: BITS Jobs-->
			<!--MITRE ATT&CK TECHNIQUE: Boot or Logon Autostart Execution-->
			<!--MITRE ATT&CK TECHNIQUE: Boot or Logon Initialization Scripts-->
			<!--MITRE ATT&CK TECHNIQUE: Browser Extensions-->
			<!--MITRE ATT&CK TECHNIQUE: Compromise Client Software Binary-->
			<!--MITRE ATT&CK TECHNIQUE: Create Account-->
			<Rule name="Attack=T1098,Technique=Create Account,Tactic=Persistence,DS=Process: Process Creation,Level=3,Alert=Account Created,Risk=80" groupRelation="and">
				<Image condition="contains any">net.exe;net1.exe;net2.exe</Image>
				<CommandLine condition="contains">user</CommandLine>
				<CommandLine condition="contains any">add</CommandLine>
				<ParentCommandLine condition="excludes">tvsu_tmp</ParentCommandLine>
			</Rule>
			<Image name="Attack=T1136,Technique=Create Account,Tactic=Persistence,Alert=Account Creation via command line,Alert=Account creation with dsmod,Risk=100" condition="image">dsmod.exe</Image>
			<Image name="Attack=T1136,Technique=Create Account,Tactic=Persistence,DS=Process: Process Creation,Level=3,Alert=Account Creation via command line,Alert=Account creation with dsadd,Risk=100" condition="image">dsadd.exe</Image>
			<!--MITRE ATT&CK TECHNIQUE: Create or Modify System Process-->
			<!--MITRE ATT&CK TECHNIQUE: Event Triggered Execution-->
			<Rule name="Attack=T1183,Technique=Image File Execution Options Injection,Tactic=Defense Evasion/Execution,DS=Process: Process Creation,Level=0,Alert=SilentProcessExit Execution from werfault S-Flag,Risk=75" groupRelation="and">
				<ParentImage condition="image">WerFault.exe</ParentImage>
				<ParentCommandLine condition="contains any">-s;/s</ParentCommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: External Remote Services-->
			<!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
			<!--MITRE ATT&CK TECHNIQUE: Implant Internal Image-->
			<!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
			<!--MITRE ATT&CK TECHNIQUE: Office Application Startup-->
			<!--MITRE ATT&CK TECHNIQUE: Pre-OS Boot-->
			<!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
			<!--MITRE ATT&CK TECHNIQUE: Server Software Component-->
			<!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
			<!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->

			<!--MITRE ATT&CK TACTIC: Privilege Escalation-->
			<Rule name="Attack=S0154,Tactic=Cobalt Strike,Technique=Malware,DS=Process: Process Creation,Level=4,Alert=Cobalt Strike GetSystem escalation Detected" groupRelation="and">
				<Image condition="image">cmd.exe</Image>
				<CommandLine condition="contains all">echo;\pipe\;&gt;</CommandLine>
			</Rule>
			<Rule name="Attack=S0154,Tactic=Cobalt Strike,Technique=Malware,DS=Process: Process Creation,Level=4,Alert=Cobalt Strike PSexec dll copy detected" groupRelation="and">
				<Image condition="image">cmd.exe</Image>
				<CommandLine condition="contains all">/c;copy;dll;\\;admin$</CommandLine>
			</Rule>
			<Rule name="Attack=S0154,Tactic=Cobalt Strike,Technique=Malware,DS=Process: Process Creation,Level=4,Alert=Cobalt Strike Exec DLL Detected" groupRelation="and">
				<Image condition="image">rundll32.exe</Image>
				<CommandLine condition="contains all">,;StartW</CommandLine>
			</Rule>
			<Rule name="Attack=S0154,Tactic=Cobalt Strike,Technique=Malware,DS=Process: Process Creation,Level=4,Alert=Cobalt Strike Susp activity 1" groupRelation="and">
				<Image condition="image">rundll32.exe</Image>
				<CommandLine condition="contains all">,;update;appdata;temp;/i:</CommandLine>
			</Rule>
			<Rule name="Attack=S0154,Tactic=Cobalt Strike,Technique=Malware,DS=Process: Process Creation,Level=4,Alert=Cobalt Strike Susp activity 2" groupRelation="and">
				<Image condition="image">rundll32.exe</Image>
				<CommandLine condition="contains all">,;update;appdata;temp;-i:</CommandLine>
			</Rule>
			<Rule name="Attack=T1548,Tactic=Defense Evasion,Technique=Abuse Elevation Control Mechanism,DS=Process: Process Creation,Level=3,Alert=CMSTPLUA UAC Bypass Child Processes" groupRelation="and">
				<ParentImage condition="image">dllhost.exe</ParentImage>
				<ParentCommandLine condition="contains any">{3E5FC7F9-9A51-4367-9063-A120244FBEC7};{3E000D72-A845-4CD9-BD83-80C07C3B881F};{D2E7041B-2927-42fb-8E9F-7CE93B6DC937};{02B49784-1CA2-436C-BC08-72FA3956507D};{BEF590BE-11A6-442A-A85B-656C1081E04C}</ParentCommandLine>
			</Rule>
			<Rule name="Attack=T1548,Tactic=Defense Evasion,Technique=Abuse Elevation Control Mechanism,DS=Process: Process Creation,Level=3,Alert=CMSTPLUA UAC Bypass" groupRelation="and">
				<Image condition="image">dllhost.exe</Image>
				<CommandLine condition="contains any">{3E5FC7F9-9A51-4367-9063-A120244FBEC7};{3E000D72-A845-4CD9-BD83-80C07C3B881F};{D2E7041B-2927-42fb-8E9F-7CE93B6DC937};{02B49784-1CA2-436C-BC08-72FA3956507D};{BEF590BE-11A6-442A-A85B-656C1081E04C}</CommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Abuse Elevation Control Mechanism-->
			<Rule name="Attack=T1548,Technique=Abuse Elevation Control Mechanism,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Abused Debug priviledge by Arbitrary Parent Process,Risk=100" groupRelation="and">
				<ParentImage condition="contains any">winlogon.exe;services.exe;lsass.exe;csrss.exe;wininit.exe;spoolsv.exe;searchindexer.exe</ParentImage>
				<Image condition="contains any">powershell.exe;pwsh.exe;cmd.exe</Image>
				<User condition="contains any">AUTHORI;AUTORI</User>
				<CommandLine condition="excludes any">route ; ADD </CommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Abuse Elevation Control Mechanism: Bypass User Account Control-->
			<Rule name="Attack=T1548.002,Technique=Abuse Elevation Control Mechanism: Bypass User Account Control,Tactic=Defense Evasion/Privilege Escalation,DS=Process: Process Creation,Risk=20" groupRelation="and">
				<ParentImage condition="image">eventvwr.exe</ParentImage>
				<Image condition="is not">c:\windows\system32\mmc.exe</Image>
			</Rule>
			<ParentImage name="Attack=T1548.002,Technique=Abuse Elevation Control Mechanism: Bypass User Account Control,Tactic=Defense Evasion/Privilege Escalation,DS=Process: Process Creation," condition="image">fodhelper.exe</ParentImage>
			<Image name="Attack=T1118,Technique=InstallUtil,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=InstallUtil" condition="image">InstallUtil.exe</Image>
			<CommandLine name="Attack=T1548.002,Technique=Abuse Elevation Control Mechanism: Bypass User Account Control,Tactic=Defense Evasion/Privilege Escalation,DS=Process: Process Creation,Level=4,Alert=UAC Bypass" condition="contains">Invoke-PsUaCme</CommandLine>
			<CommandLine name="Attack=T1548.002,Technique=Abuse Elevation Control Mechanism: Bypass User Account Control,Tactic=Defense Evasion/Privilege Escalation,DS=Process: Process Creation,Level=4,Alert=UAC Bypass" condition="contains">BypassUAC</CommandLine>
			<CommandLine name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Powerup Command Line events" condition="contains">PowerUp</CommandLine>
			<OriginalFileName name="Attack=T1548.002,Technique=Bypass User Account Control,Tactic=Defense Evasion,DS=Process: Process Creation" condition="is">computerdefaults.exe</OriginalFileName>
			<OriginalFileName name="Attack=T1548.002,Technique=Bypass User Account Control,Tactic=Defense Evasion,DS=Process: Process Creation" condition="is">dism.exe</OriginalFileName>
			<ParentImage name="Attack=T1548.002,Technique=Bypass User Account Control,Tactic=Defense Evasion,DS=Process: Process Creation" condition="image">fodhelper.exe</ParentImage>
			<!--MITRE ATT&CK TECHNIQUE: Access Token Manipulation-->
			<Rule name="Attack=T1134.001,Technique=Access Token Manipulation: Token Impersonation/Theft,Tactic=Privilege Escalation,Risk=90,DS=Process: Process Creation,Level=3,Alert=Priv Escalation to System" groupRelation="and">
				<ParentUser condition="contains any">NT AUTHORITY\NETWORK SERVICE;NT AUTHORITY\LOCAL SERVICE;SERVICE LOCAL;ERVICE RÉSEAU;NETZWERKDIENST;LOKALER DIENST;NETZWERKDIENST;SERVICIO DE RED;ERVICIO LOC</ParentUser>
				<User condition="contains any">NT AUTHORITY\SYSTEM;СИСТЕМА;NT-AUTORITÄT\SYSTEM;AUTORITE NT\SYSTEM</User>
			</Rule>
			<ParentCommandLine name="Attack=T1134.001,Technique=Access Token Manipulation: Token Impersonation/Theft,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=1,Desc=Possible Token manipulation" condition="begin with">c:\windows\system32\svchost.exe -k netsvcs -s Appinfo</ParentCommandLine>
			<Image name="Attack=T1134,Technique=Access Token Manipulation,Tactic=NA,DS=Process: Process Creation,Level=2,Alert=Token Manipulation with runas.exe,Risk=70" condition="image">runas.exe</Image> 
			<!--MITRE ATT&CK TECHNIQUE: Boot or Logon Autostart Execution-->
			<!--MITRE ATT&CK TECHNIQUE: Boot or Logon Initialization Scripts-->
			<!--MITRE ATT&CK TECHNIQUE: Create or Modify System Process-->
			<!--MITRE ATT&CK TECHNIQUE: Domain Policy Modification-->
			<!--MITRE ATT&CK TECHNIQUE: Escape to Host-->
			<!--MITRE ATT&CK TECHNIQUE: Event Triggered Execution-->
			<Rule name="Attack=T1546.008,Technique=Accessibility Features,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Utilman Lock Screen Bypass,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains">Cmd.Exe</OriginalFileName>
				<ParentImage condition="image">winlogon.exe</ParentImage>
				<Image condition="image">utilman.exe</Image>
			</Rule>
			<Rule name="Attack=T1546.008,Technique=Accessibility Features,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=sethc.exe Lock Screen Bypass,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains">Cmd.Exe</OriginalFileName>
				<ParentImage condition="image">winlogon.exe</ParentImage>
				<Image condition="image">sethc.exe</Image>
			</Rule>
			<Rule name="Attack=T1546.008,Technique=Accessibility Features,Tactic=Persistence/Privilege Escalation,DS=Process: Process Creation,Level=4,Alert=Utilman Priv Escalation" groupRelation="and">
				<ParentImage condition="image">utilman.exe</ParentImage>
				<Image condition="excludes any">C:\Windows\System32\ATBroker.exe;Magnify.exe;C:\Windows\System32\osk.exe</Image>
			</Rule>
			<ParentImage name="Attack=T1015,Technique=Accessibility Features,Tactic=Persistence Privilege Escalation,DS=Process: Process Creation,Level=0,Desc=SETHC Priv Escalation" condition="image">sethc.exe</ParentImage>
			<ParentImage name="Attack=T1015,Technique=Accessibility Features,Tactic=Persistence/Privilege Escalation,DS=Process: Process Creation" condition="image">osk.exe</ParentImage>
			<ParentImage name="Attack=T1015,Technique=Accessibility Features,Tactic=Persistence/Privilege Escalation,DS=Process: Process Creation" condition="image">Magnify.exe</ParentImage>
			<ParentImage name="Attack=T1015,Technique=Accessibility Features,Tactic=Persistence/Privilege Escalation,DS=Process: Process Creation" condition="image">DisplaySwitch.exe</ParentImage>
			<ParentImage name="Attack=T1015,Technique=Accessibility Features,Tactic=Persistence/Privilege Escalation,DS=Process: Process Creation" condition="image">Narrator.exe</ParentImage>
			<ParentImage name="Attack=T1015,Technique=Accessibility Features,Tactic=Persistence/Privilege Escalation,DS=Process: Process Creation" condition="image">AtBroker.exe</ParentImage>
			<!--MITRE ATT&CK TECHNIQUE: Event Triggered Execution: Application Shimming-->
			<Image name="Attack=T1138,Technique=Application Shimming,Tactic=Persistence/Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Application Shimming" condition="image">sdbinst.exe</Image>
			<!--MITRE ATT&CK TECHNIQUE: Exploitation for Privilege Escalation-->
			<Rule name="Attack=T1546.008,Technique=Exploitation for Privilege Escalation,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=0,Desc=Dwm Exploitation" groupRelation="and">
				<ParentImage condition="image">dwm.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1546.008,Technique=Exploitation for Privilege Escalation,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=4,Alert=7zip Priv Escalation Detection,CVE=CVE-2022-29072" groupRelation="and">
				<Image condition="image">cmd.exe</Image>
				<ParentImage condition="image">7zFM.exe</ParentImage>
				<CommandLine condition="excludes any">;/c;-c</CommandLine>
			</Rule>
			<Rule name="Attack=T1546.008,Technique=Exploitation for Privilege Escalation,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=4,Alert=Possible InstallerFileTakeOver LPE,CVE=CVE-2021-41379" groupRelation="and">
				<Image condition="image">cmd.exe</Image>
				<ParentImage condition="image">elevation_service.exe</ParentImage>
				<IntegrityLevel condition="contains">System</IntegrityLevel>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
			<!--MITRE ATT&CK TECHNIQUE: Process Injection-->
			<!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
			<!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->

			<!--MITRE ATT&CK TACTIC: Defense Evasion-->
			<Image condition="contains">unknown process</Image>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Alert=WSL Execution" condition="contains">\LocalState\rootfs\</Image>
			<ParentImage name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Alert=WSL Execution" condition="contains">\LocalState\rootfs\</ParentImage>			
			<!--MITRE ATT&CK TECHNIQUE: Abuse Elevation Control Mechanism-->
			<!--MITRE ATT&CK TECHNIQUE: Access Token Manipulation-->
			<!--MITRE ATT&CK TECHNIQUE: BITS Jobs-->
			<!--MITRE ATT&CK TECHNIQUE: Build Image on Host-->
			<!--MITRE ATT&CK TECHNIQUE: Debugger Evasion-->
			<!--MITRE ATT&CK TECHNIQUE: Deobfuscate/Decode Files or Information-->
			<!--MITRE ATT&CK TECHNIQUE: Deploy Container-->
			<!--MITRE ATT&CK TECHNIQUE: Direct Volume Access-->
			<!--MITRE ATT&CK TECHNIQUE: Domain Policy Modification-->
			<Rule name="Attack=T1484.001,Technique=Group Policy Modification,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Auditpol System Audit Policy Change - Should be set via group policy instead" groupRelation="and">
				<OriginalFileName condition="contains">auditpol</OriginalFileName>
				<CommandLine condition="contains any">/set;-set;/restore;-restore;/clear;-clear;/remove;-remove;/resourceSACL;-resourceSACL</CommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Execution Guardrails-->
			<!--MITRE ATT&CK TECHNIQUE: Exploitation for Defense Evasion-->
			<!--MITRE ATT&CK TECHNIQUE: File and Directory Permissions Modification-->
			<!--MITRE ATT&CK TECHNIQUE: Hide Artifacts-->
			<Rule name="Attack=T1164.001,Technique=Hidden Files and Directories,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Hidden/SuperHidden File or Folder created" groupRelation="and">
				<CommandLine condition="contains any">+s;+h</CommandLine>
				<Image condition="image">attrib.exe</Image>
			</Rule>
			<Rule name="Attack=T1164.001,Technique=Hidden Files and Directories,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Powershell Hidden File or Folder created" groupRelation="and">
				<CommandLine condition="contains all">Hidden;Attributes</CommandLine>
				<Image condition="image">powershell.exe</Image>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
			<!--MITRE ATT&CK TECHNIQUE: Impair Defenses-->
			<Rule name="Attack=T1562,Technique=Impair Defenses,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Stealth Sysmon Change Detected,Risk=100" groupRelation="and">
				<Product condition="is">Sysinternals Sysmon</Product>
				<CommandLine condition="contains any">/u;/c;-u;-c</CommandLine>
				<CurrentDirectory condition="excludes">C:\ProgramdData\sysmon\</CurrentDirectory>
			</Rule>
			<Rule name="Attack=T1562.001,Technique=Disabling Security Tools,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Windows Defender tampering,Risk=50" groupRelation="and">
				<Image condition="image">MpCmdRun.exe</Image>
				<CommandLine condition="contains any">Add-MpPreference;RemoveDefinitions;DisableIOAVProtection</CommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Impair Defenses: Disable or Modify Tools:  Disable Windows Event Logging-->
			<Rule name="Attack=T1562.002,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=SysmonEnte Detection,DS=Process: Process Creation,Level=4,Risk=100" groupRelation="and">
				<Hashes condition="contains">IMPHASH=84B763C45C0E4A3E7CA5548C710DB4EE</Hashes>
			</Rule>
			<Rule name="Attack=T1562.002,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=SysmonQuiet Detection,DS=Process: Process Creation,Level=4,Risk=100" groupRelation="and">
				<Hashes condition="contains">IMPHASH=19584675D94829987952432E018D5056</Hashes>
			</Rule>
			<Rule name="Attack=T1562.002,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=SharpEvtMute Detection,DS=Process: Process Creation,Level=4,Risk=100" groupRelation="and">
				<Hashes condition="contains">IMPHASH=330768a4f172e10acb6287b87289d83b</Hashes>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Impair Defenses: Disable or Modify Tools-->
			<Image condition="image" name="Attack=T1089,Technique=Disabling Security Tools,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=PSTools PSKill,Risk=80">PsKill.exe</Image>
			<Rule name="Attack=T1089,Technique=Disabling Security Tools,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Disabling of Windows Defender Features,Risk=100" groupRelation="and">
				<CommandLine condition="contains any">Set-MpPreference;Add-MpPreference;Remove-MpPreference;MpCmdRun.exe</CommandLine>
				<CommandLine condition="contains any">RemoveDefinitions;RemoveDynamicSignature;DisableIOAVProtection;DisableRealTimeMonitoring;DisableBehaviorMonitoring;DisableBlockAtFirstSeen;DisableIOAVProtection;DisablePrivacyMode;DisableScriptScanning;DisableRealtimeMonitoring;DisableScanningNetworkFiles;DisableScanningMappedNetworkDrivesForFullScan;DisableRestorePoint;DisableRemovableDriveScanning;SignatureDisableUpdateOnStartupWithoutEngine;DisableIntrusionPreventionSystem;DisableScanOnRealtimeEnable;DisableArchiveScanning;DisableIntrusionPreventionSystem;DisableScriptScanning;DisableOnAccessProtection;ExclusionExtension;ExclusionPath;ExclusionProcess;ThreatDefaultAction;TamperProtection</CommandLine>
			</Rule>
			<CommandLine name="Attack=T1629.003,Technique=Impair Defenses: Disable or Modify Tools,Tactic=Defense Evasion,DS=Process: Process Creation,Level=2,Alert=netsh ipv6 modification,Risk=40" condition="contains">interface ipv6 set</CommandLine>
			<CommandLine name="Attack=T1629.003,Technique=Impair Defenses: Disable or Modify Tools,Tactic=Defense Evasion,DS=Process: Process Creation,Level=2,Alert=netsh ipv4 modification,Risk=40" condition="contains">interface ipv4 set</CommandLine>
			<Image name="Attack=T1089,Technique=Disabling Security Tools,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Command Line task kill 2,Risk=30" condition="image">taskkill.exe</Image>
			<!--MITRE ATT&CK TECHNIQUE: Impair Defenses: Disable or Modify System Firewall-->
			<CommandLine name="Attack=T1562.004,Technique=Disable or Modify System Firewall,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=netsh Firewall Rule Deletion,Risk=40" condition="contains">firewall delete</CommandLine> 
			<CommandLine name="Attack=T1562.004,Technique=Disable or Modify System Firewall,Tactic=Defense Evasion,DS=Process: Process Creation,Level=2,Alert=netsh Firewall Rule Creation,Risk=40" condition="contains">firewall add</CommandLine> 
			<CommandLine name="Attack=T1562.004,Technique=Disable or Modify System Firewall,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=netsh firewall disablement,Risk=40" condition="contains">firewall set opmode disable</CommandLine>
			<CommandLine name="Attack=T1562.004,Technique=Disable or Modify System Firewall,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Possible Arp Spoofing attacks" condition="contains">Core Networking - Router Solicitation</CommandLine>
			<CommandLine name="Attack=T1562.004,Technique=Disable or Modify System Firewall,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Windows Firewall Modifications,Risk=40" condition="contains">netsh advfirewall firewall</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: Indicator Removal on Host-->
			<Rule name="Attack=T1070.001,Technique=Clear Windows Event Logs,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Eventlog Removal on Host,Risk=100" groupRelation="and">
				<Image condition="image">wevtutil.exe</Image>
				<CommandLine condition="contains"> cl </CommandLine>
				<CommandLine condition="excludes">wevtutil im</CommandLine>
				<CommandLine condition="excludes">wevtutil.exe im</CommandLine>
				<CurrentDirectory condition="excludes">ClickToRun</CurrentDirectory>
			</Rule>
			<Rule name="Attack=T1562.006,Technique=Indicator Blocking,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Risk=50" groupRelation="and">
				<OriginalFileName condition="is">fltMC.exe</OriginalFileName>
				<CommandLine condition="contains any">detach;unload</CommandLine>
			</Rule>
			<Rule name="Attack=T1070,Technique=Indicator Removal on Host,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=IIS Log disablement,Risk=80" groupRelation="and">
				<OriginalFileName condition="is">appcmd.exe</OriginalFileName>
				<CommandLine condition="contains all">DontLog;True</CommandLine>
				<Image condition="excludes">iisetup.exe</Image>
			</Rule>
			<Rule name="Attack=T1070,Technique=Impair Defenses: Indicator Removal on Host,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Usagelog Env Tampering,Risk=70" groupRelation="or">
				<CommandLine condition="contains all">set;NGenAssemblyUsageLog</CommandLine>
				<CommandLine condition="contains all">New-ItemProperty;NGenAssemblyUsageLog</CommandLine>
				<CommandLine condition="contains all">reg;add;dword;NGenAssemblyUsageLog</CommandLine>
				<CommandLine condition="contains all">$env;NGenAssemblyUsageLog</CommandLine>
			</Rule>
			<Rule name="Attack=T1070,Technique=Impair Defenses: Indicator Removal on Host,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=COMPlus_ETWEnabled Env Tampering,Risk=70" groupRelation="or">
				<CommandLine condition="contains all">set;COMPlus_ETWEnabled</CommandLine>
				<CommandLine condition="contains all">New-ItemProperty;COMPlus_ETWEnabled</CommandLine>
				<CommandLine condition="contains all">reg;add;dword;COMPlus_ETWEnabled</CommandLine>
				<CommandLine condition="contains all">$env;COMPlus_ETWEnabled</CommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Indirect Command Execution-->
			<Rule name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Windows Subsystem For Linux exec,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains any">bash.exe;wsl.exe;ubuntu.exe;kali.exe</OriginalFileName>
				<CommandLine condition="contains any">-e;/e;-u root;--exec bash;dev/tcp;~ -d;~ /d</CommandLine>
			</Rule>
			<Image name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Windows Subsystem For Linux,Risk=20" condition="image">wsl.exe</Image>
			<ParentImage name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Windows Subsystem For Linux,Risk=20" condition="image">wsl.exe</ParentImage>
			<Image name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Alert=Windows Subsystem For Linux,Risk=20" condition="image">wslhost.exe</Image>
			<ParentImage name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Alert=Windows Subsystem For Linux,Risk=20" condition="image">wslhost.exe</ParentImage>
			<Image name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Alert=Ubuntu Windows Subsystem For Linux,Risk=20" condition="image">ubuntu.exe</Image>
			<ParentImage name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Alert=Ubuntu Windows Subsystem For Linux,Risk=20" condition="image">ubuntu.exe</ParentImage>
			<Image name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Kali Windows Subsystem For Linux,Risk=100" condition="image">kali.exe</Image>
			<ParentImage name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Kali Windows Subsystem For Linux,Risk=100" condition="image">kali.exe</ParentImage>
			<CommandLine name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Windows Subsystem For Linux,Risk=100" condition="contains any">distro-id;vm-id</CommandLine>

			<Image name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=2,Alert=Indirect Command Execution" condition="image">pcalua.exe</Image>
			<ParentImage name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=2,Alert=Indirect Command Execution" condition="image">pcalua.exe</ParentImage>
			<Image name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Bash on Windows Execution,Risk=30" condition="image">bash.exe</Image>
			<ParentImage name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Bash on windows execution,Risk=30" condition="image">bash.exe</ParentImage>
			<Image name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Indirect Command Execution with forfiles" condition="image">forfiles.exe</Image>
			<ParentImage name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Indirect command execution forfiles child process" condition="image">forfiles.exe</ParentImage>
			<Image name="Attack=T1059,Technique=Command-Line Interface,Tactic=Execution,DS=Process: Process Creation" condition="end with">.com</Image>
			<CommandLine name="Attack=T1202,Technique=Indirect Command Execution,Tactic=Execution,DS=Process: Process Creation,Level=2,Alert=Scriptrunner exec" condition="contains">-appvscript</CommandLine>

			<!--MITRE ATT&CK TECHNIQUE: Masquerading-->
			<Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=suspicious execution path,Risk=30" groupRelation="and">
				<Image condition="contains any">C:\Users\NetworkService\;C:\Users\NetworkService\;HarddiskVolumeShadowCopy;C:\Users\Default\;C:\Users\Public;C:\Users\Guest\;\administrateur\;C:\Windows\Media\;C:\Windows\addins\;tsclient\;\htdocs\;\config\systemprofile\;C:\PerfLogs\;c:\windows\ServiceProfiles\;C:\Intel\Logs\;C:\Windows\repair\;C:\Windows\Help\;$Recycle;C:\Windows\Debug\;C:\Windows\Security\;C:\Windows\Fonts\;\wwwroot\;\Contacts;C:\Windows\vss\</Image>
			</Rule>
			<Rule name="Attack=T1036.007,Technique=Masquerading: Double File Extension,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Alert=Double File Extension,Risk=100" groupRelation="or">
				<Image condition="end with">      .exe</Image>
				<Image condition="end with">.7z.exe</Image>
				<Image condition="end with">.doc.exe</Image>
				<Image condition="end with">.doc.exe</Image>
				<Image condition="end with">.docx.exe</Image>
				<Image condition="end with">.ico.exe</Image>
				<Image condition="end with">.iso.exe</Image>
				<Image condition="end with">.lnk.exe</Image>
				<Image condition="end with">.pdf.exe</Image>
				<Image condition="end with">.ppt.exe</Image>
				<Image condition="end with">.pptx.exe</Image>
				<Image condition="end with">.rar.exe</Image>
				<Image condition="end with">.rtf.exe</Image>
				<Image condition="end with">.txt.exe</Image>
				<Image condition="end with">.xls.exe</Image>
				<Image condition="end with">.xlsx.exe</Image>
				<Image condition="end with">.zip.exe</Image>
				<Image condition="end with">______.exe</Image>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
			<!--MITRE ATT&CK TECHNIQUE: Modify Cloud Compute Infrastructure-->
			<!--MITRE ATT&CK TECHNIQUE: Modify Registry-->
			<CommandLine name="Attack=T1112,Technique=Modify Registry,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Registry Class changes with reg.exe,Risk=40" condition="contains">reg add hkcu\software\classes\</CommandLine>
			<CommandLine name="Attack=T1112,Technique=Modify Registry,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Registry Class changes with reg.exe,Risk=40" condition="contains">reg.exe add hkcu\software\classes\</CommandLine> 
			<ParentCommandLine name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Remote Registry Activity,Risk=39" condition="begin with">C:\WINDOWS\system32\svchost.exe -k localService -s RemoteRegistry</ParentCommandLine>
			<Rule name="Attack=T1112,Technique=Modify Registry,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Alternate Data Streams with Regedit" groupRelation="and">
				<OriginalFileName condition="is">regedit.exe</OriginalFileName>
				<CommandLine condition="contains">:</CommandLine>
			</Rule>
			<Rule name="Attack=T1112,Technique=Modify Registry,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=REG Registry Deletions" groupRelation="and">
				<Image condition="image">reg.exe</Image>
				<CommandLine condition="contains">delete </CommandLine>
			</Rule>
			<Rule name="Attack=T1112,Technique=Modify Registry,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Regedit Registry Deletions" groupRelation="and">
				<Image condition="image">regedit.exe</Image>
				<CommandLine condition="contains any">/d;-d</CommandLine>
			</Rule>
			<Rule name="Attack=T1112,Technique=Modify Registry,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Powershell Registry Deletions" groupRelation="and">
				<CommandLine condition="contains any">HKCU:;HKLM</CommandLine>
				<CommandLine condition="contains">remove-item</CommandLine>
			</Rule>
			<Rule name="Attack=T1112,Technique=Modify Registry,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Powershell Registry Modifications" groupRelation="and">
				<CommandLine condition="contains any">HKCU:;HKLM</CommandLine>
				<CommandLine condition="contains">set-item;new-item</CommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Modify System Image-->
			<!--MITRE ATT&CK TECHNIQUE: Network Boundary Bridging-->
			<!--MITRE ATT&CK TECHNIQUE: Obfuscated Files or Information-->
			<Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Suspicious Code Page Switch,Risk=50" groupRelation="and">
				<Image condition="image">chcp.exe</Image>
				<CommandLine condition="contains">936</CommandLine>
				<CommandLine condition="contains">1256</CommandLine>
				<CommandLine condition="contains">864</CommandLine>
				<CommandLine condition="contains">1258</CommandLine>
				<CommandLine condition="contains">855</CommandLine>
				<CommandLine condition="contains">866</CommandLine>
			</Rule>
			<Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Powershell Encoded Command Detected,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains">powershell.exe</OriginalFileName>
				<CommandLine condition="contains any">-e ;-en;-enc;-enco;-encod;-encode;-encoded;-encodedc;-encodedco;-encodedcom;-encodedcomm;-encodedcomma;-encodedcomman;-encodedcommand;/e ;/en;/enc;/enco;/encod;/encode;/encoded;/encodedc;/encodedco;/encodedcom;/encodedcomm;/encodedcomma;/encodedcomman;/encodedcommand</CommandLine>
			</Rule>
			<Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Powershell Hidden Command,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains">powershell.exe</OriginalFileName>
				<CommandLine condition="contains any">-w h;-wi h;-win h;-wind h;-windo h;-window h;-windows h;-windowst h;-windowsty h;-windowstyl h;-windowstyle h;/w h;/wi h;/win h;/wind h;/windo h;/window h;/windows h;/windowst h;/windowsty h;/windowstyl h;/windowstyle h</CommandLine>
			</Rule>
			<Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Powershell Execution Policy Bypass,Risk=75" groupRelation="and">
				<OriginalFileName condition="contains">powershell.exe</OriginalFileName>
				<CommandLine condition="contains any">-ex;/ex</CommandLine>
				<CommandLine condition="contains">bypass</CommandLine>
			</Rule>
			<Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Powershell non-interactive Command" groupRelation="and">
				<OriginalFileName condition="contains">powershell.exe</OriginalFileName>
				<CommandLine condition="contains any">-noni;/noni</CommandLine>
				<CommandLine condition="excludes">Import-Module FileServerResourceManager</CommandLine>
				<CurrentDirectory condition="excludes">C:\Program Files\LogicMonitor</CurrentDirectory>
			</Rule>
			<Rule name="Attack=T1027,Tactic=Defense Evasion,Technique=Obfuscated Files or Information,DS=Process: Process Creation,Level=4,Alert=Powershell Obfuscation Command,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains">powershell.exe</OriginalFileName>
				<CommandLine condition="contains any">hextobin;iex;io.filestream;system.text;base64;system.io;io.file;IMAGE_SUBSYSTEM_WINDOWS_GUI;IMAGE_NT_OPTIONAL_HDR32;IMAGE_NT_OPTIONAL_HDR64;DllCharacteristicsType;GetDelegateForFunctionPointer;WriteProcessMemory;ReadProcessMemory;ImpersonateSelf;AdjustTokenPrivileges;NtCreateThreadEx;CreateRemoteThread;io.seek;iwr;-bxor;invoke-expression;remove.to.string;shellcode;System.Net.WebClient;System.Net.WebRequest;System.Net.SecurityProtocolType;unicode;-useb;msxml2.serverxmlhttp;wscript.shell;-comobject;frombase64;io.compression;system.convert;io.streamreader;io.memorystream;compression.gzipstream;text.encoding;executioncontext;text.enc;convertto-securestring;runtime.interop;verbosepreference;[[string]]::join</CommandLine>
			</Rule>
			<Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Powershell Encoded Offsets,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains">powershell.exe</OriginalFileName>
				<CommandLine condition="contains any">SUVYI;aWV4I;SQBFAFgA;aQBlA;TW96aWxsYS;1vemlsbGEv;Nb3ppbGxhL;TQBvAHoAaQBsAGwAYQAv;0AbwB6AGkAbABsAGEAL;BNAG8AegBpAGwAbABhAC;UwB0AGE</CommandLine>
			</Rule>
			<Rule name="Attack=T1001,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Obfuscated Suspicious or Malicious Commands,Risk=70" groupRelation="and">
				<CommandLine condition="contains any">C^om^S^pEc;^c^o^m^S^p^E^c^;Wscript.Shell;-ComObject;MsXml2.ServerXmlHttp;Remove.ToString;System.Convert;-UseB;[Byte[];^h^t^t^p;h"t"t"p</CommandLine>
			</Rule>
			<CommandLine name="Attack=T1001,Technique=Obfuscated Files or Information with IwAjACMAd,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Common Base 64 encoded cmds" condition="contains any">IwAjACMAd;IyM=;SUVYI;aWV4I;SQBFAFgA;aQBlAHgA;TW96aWxsYS;1vemlsbGEv;Nb3ppbGxhL;TQBvAHoAaQBsAGwAYQAv;0AbwB6AGkAbABsAGEAL;BNAG8AegBpAGwAbABhAC</CommandLine>
			<CommandLine name="Attack=T1001,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Alert=Obfuscated Hidden Powershell,Risk=70" condition="contains any">WindowStyle Hidden function;WindowStyle Hidden;windowstyle h;windowstyl h;windowsty h;windowst h;windows h;window h;windo h;wind h;win h;wi h;-w h;/w h;win hi;win hid;win hidd;win hidde;win hidden</CommandLine>
			<CommandLine name="Attack=T1001,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Command Line Obfuscation,Risk=75" condition="contains">^</CommandLine>
			<CommandLine name="Attack=T1001,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Type CON Command Line Redirection" condition="contains">TYPE CON ></CommandLine>
			<CommandLine name="Attack=T1001,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Copy CON Command Line Redirection" condition="contains">copy CON ></CommandLine>
			<Rule name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Common Obfuscated Commands,Risk=100" groupRelation="and">
				<CommandLine condition="contains any">FromBase64String;action=create keyvalue=;VerbosePreference.ToString;SecureString;CSharpCodeProvider;runtime.interopservices.marshal;system.globalization.numberstyles;system.reflection.assembly;hextobin;VerbosePreference.ToString;system.text.encoding;io.filestream;io.filestream;io.seekorigin;text.encoding;unicode.getstring;FromBase64;[Convert]::;System.IO.File]::ReadAllText;|iex</CommandLine>
				<CommandLine condition="excludes all">ngen.exe;install</CommandLine>
			</Rule>

			<Rule name="Attack=T1105,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=CertUtil Decode,Risk=80" groupRelation="and">
				<OriginalFileName condition="contains">certutil</OriginalFileName>
				<CommandLine condition="contains any">decode;encode</CommandLine>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Ping in Hexadecimal,Risk=60" groupRelation="and">
				<Image name="Attack=T1027,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Ping in Hexadecimal" condition="image">ping.exe</Image>
				<CommandLine condition="contains">0x</CommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Obfuscated Files or Information: Compile After Delivery-->
			<Rule name="Attack= T1127.001,Technique=Trusted Developer Utilities Proxy Execution ,Tactic=Defnse Evasion,DS=Process: Process Creation,Level=4,Alert=CSC Suspicious Location,Risk=60" groupRelation="and">
				<Image condition="image">csc.exe</Image>
				<CommandLine condition="contains any">\AppData\;\Windows\Temp\</CommandLine>
			</Rule>
			<Rule name="Attack=T1027.004,Technique=Compile After Delivery,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent of Csc.exe,Risk=80" groupRelation="and">
				<Image condition="image">csc.exe</Image>
				<ParentImage condition="image">wscript.exe</ParentImage>
				<ParentImage condition="image">cscript.exe</ParentImage>
				<ParentImage condition="image">mshta.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1027.004,Technique=Compile After Delivery,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=MOFComp compilation of .Mof File,Risk=80" groupRelation="and">
				<Image condition="image">mofcomp.exe</Image>
				<CommandLine condition="contains">.mof</CommandLine>
				<CurrentDirectory condition="excludes">C:\WINDOWS\Installer\MSI</CurrentDirectory>
				<ParentImage condition="excludes">MsMpEng.exe</ParentImage>
				<ParentImage condition="excludes">aspnet_regiis.exe</ParentImage>
				<ParentImage condition="excludes">msiexec.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1027.004,Technique=Compile After Delivery,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=CSC Compilation,Risk=80" groupRelation="and">
				<ParentImage condition="image">csc.exe</ParentImage>
				<CommandLine condition="contains any">out:;target:library</CommandLine>
			</Rule>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Workflow Compiler https://posts.specterops.io/arbitrary-unsigned-code-execution-vector-in-microsoft-workflow-compiler-exe-3d9294bc5efb" condition="contains">Microsoft.Workflow.Compiler.exe</Image>
			<!--MITRE ATT&CK TECHNIQUE: Plist File Modification-->
			<!--MITRE ATT&CK TECHNIQUE: Pre-OS Boot-->
			<!--MITRE ATT&CK TECHNIQUE: Process Injection-->
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of Autochk,Risk=30" groupRelation="and">
				<Image condition="image">autochk.exe</Image>
				<ParentImage condition="excludes any">\smss.exe;\fontdrvhost.exe;\dwm.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of SMSS,Risk=30" groupRelation="and">
				<Image condition="contains any">\consent.exe;\Runtimebroker.exe;\TiWorker.exe</Image>
				<ParentImage condition="excludes">\svchost.exe</ParentImage>
				<ParentImage condition="is not">-</ParentImage>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of consent/runtimebroke/tiworker,Risk=30" groupRelation="and">
				<Image condition="contains any">\consent.exe;\Runtimebroker.exe;\TiWorker.exe</Image>
				<ParentImage condition="excludes any">svchost.exe</ParentImage>
				<ParentImage condition="is not">-</ParentImage>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of searchindexer,Risk=30" groupRelation="and">
				<Image condition="image">SearchProtocolHost.exe</Image>
				<ParentImage condition="excludes any">\SearchIndexer.exe;\dllhost.exe</ParentImage>
				<ParentImage condition="is not">-</ParentImage>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of dllhost,Risk=30" groupRelation="and">
				<Image condition="image">dllhost.exe</Image>
				<ParentImage condition="excludes any">\services.exe;\svchost.exe</ParentImage>
				<ParentImage condition="is not">-</ParentImage>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of smss,Risk=30" groupRelation="and">
				<Image condition="image">smss.exe</Image>
				<ParentImage condition="excludes">\smss.exe</ParentImage>
				<ParentImage condition="is not">System</ParentImage>
				<ParentImage condition="is not">-</ParentImage>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of csrss,Risk=30" groupRelation="and">
				<Image condition="image">csrss.exe</Image>
				<ParentImage condition="is not">-</ParentImage>
				<ParentImage condition="excludes any">\smss.exe;svchost.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of wininit,Risk=30" groupRelation="and">
				<Image condition="image">wininit.exe</Image>
				<ParentImage condition="is not">-</ParentImage>
				<ParentImage condition="excludes">\smss.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of winlogon,Risk=30" groupRelation="and">
				<Image condition="image">winlogon.exe</Image>
				<ParentImage condition="excludes">\smss.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of lsass/LsaIso,Risk=30" groupRelation="and">
				<Image condition="contains any">\lsass.exe;LsaIso.exe</Image>
				<ParentImage condition="excludes">\wininit.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of LogonUI,Risk=30" groupRelation="and">
				<Image condition="image">LogonUI.exe</Image>
				<ParentImage condition="excludes any">\wininit.exe;\winlogon.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of services,Risk=30" groupRelation="and">
				<Image condition="image">services.exe</Image>
				<ParentImage condition="excludes">\wininit.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of svchost,Risk=30" groupRelation="and">
				<Image condition="image">svchost.exe</Image>
				<ParentImage condition="is not">-</ParentImage>
				<ParentImage condition="excludes any">\MsMpEng.exe;\services.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of spoolsv,Risk=30" groupRelation="and">
				<Image condition="image">spoolsv.exe</Image>
				<ParentImage condition="excludes">\services.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of taskhost,Risk=30" groupRelation="and">
				<Image condition="image">taskhost.exe</Image>
				<ParentImage condition="excludes any">\services.exe;\svchost.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of userinit,Risk=30" groupRelation="and">
				<Image condition="image">userinit.exe</Image>
				<ParentImage condition="excludes any">\dwm.exe;\winlogon.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Parent process of wmiprvse/wsmprovhost/winrshost,Risk=30" groupRelation="and">
				<Image condition="contains any">\wmiprvse.exe;\wsmprovhost.exe;\winrshost.exe</Image>
				<ParentImage condition="is not">-</ParentImage>
				<ParentImage condition="excludes any">\svchost.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Child process of SearchProtocolHost/taskhost/csrss,Risk=30" groupRelation="and">
				<ParentImage condition="contains any">\SearchProtocolHost.exe;\taskhost.exe;\csrss.exe</ParentImage>
				<Image condition="excludes any">\werfault.exe;\wermgr.exe;\WerFaultSecure.exe</Image>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Child process of SearchProtocolHost/taskhost/csrss,Risk=30" groupRelation="and">
				<ParentImage condition="image">autochk.exe</ParentImage>
				<Image condition="excludes any">\chkdsk.exe;\doskey.exe;\WerFault.exe</Image>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Child process of smss,Risk=30" groupRelation="and">
				<ParentImage condition="image">smss.exe</ParentImage>
				<Image condition="excludes any">\autochk.exe;\smss.exe;\csrss.exe;\wininit.exe;\winlogon.exe;\setupcl.exe;\WerFault.exe</Image>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Child process of wermgr,Risk=30" groupRelation="and">
				<ParentImage condition="image">wermgr.exe</ParentImage>
				<Image condition="excludes any">\WerFaultSecure.exe;\wermgr.exe;\WerFault.exe</Image>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Possible wermgr injection,Risk=30" groupRelation="and">
				<Image condition="image">wermgr.exe</Image>
				<CommandLine condition="end with">wermgr.exe</CommandLine>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Possible qbot injection,Risk=30" groupRelation="and">
				<ParentImage condition="contains any">\rundll32.exe;\regsvr32.exe</ParentImage>
				<Image condition="contains any">\explorer.exe;\wermgr.exe;\msra.exe;\OneDriveSetup.exe;\mobsync.exe;\xwizard.exe</Image>
				<CommandLine condition="end with">.exe</CommandLine>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Privilege Escalation,DS=Process: Process Creation,Level=3,Alert=Suspicious Child process of conhost,Risk=30" groupRelation="and">
				<ParentImage condition="image">conhost.exe</ParentImage>
				<Image condition="excludes any">\mscorsvw.exe;\wermgr.exe;\WerFault.exe;\WerFaultSecure.exe</Image>
			</Rule>
			<Rule name="Attack=T1055,Technique=Powershell Injection Persistence Bypass - Execution - Lateral Movement - Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Powershell Injection persistence bypass,Risk=50" groupRelation="and">
				<CommandLine condition="contains">System.Management.Automation</CommandLine>
				<CommandLine condition="excludes all">"C:\Windows\Microsoft.NET\Framework\;\ngen.exe;install</CommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Reflective Code Loading-->
			<!--MITRE ATT&CK TECHNIQUE: Rogue Domain Controller-->
			<!--MITRE ATT&CK TECHNIQUE: Rootkit-->
			<!--MITRE ATT&CK TECHNIQUE: Subvert Trust Controls-->
			<!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution-->
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=InstallUtil 1" groupRelation="and">
				<OriginalFileName name="Attack=T1218,Technique=Signed Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Risk=50" condition="is">InstallUtil.exe</OriginalFileName>
				<CommandLine condition="contains all">/logfile=;/LogToConsole=false;/U</CommandLine>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=InstallUtil 2" groupRelation="and">
				<OriginalFileName name="Attack=T1218,Technique=Signed Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Risk=50" condition="is">InstallUtil.exe</OriginalFileName>
				<CommandLine condition="contains all">-logfile=;-LogToConsole=false;-U</CommandLine>
			</Rule>
			<Rule name="Attack=T1218.013,Technique=Mavinject,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Mavinject Detected,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains any">Mavinject.exe;mavinject64.exe</OriginalFileName>
				<CommandLine condition="contains">INJECTRUNNING</CommandLine>
			</Rule>
			<Rule name="Attack=T1218.003,Technique=CMSTP,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=CMSTP UAC Bypass Detected 1,Risk=100" groupRelation="and">
				<OriginalFileName condition="is">CMSTP.exe</OriginalFileName>
				<CommandLine condition="contains all">/ni;/s</CommandLine>
			</Rule>
			<Rule name="Attack=T1218.003,Technique=CMSTP,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=CMSTP UAC Bypass Detected 2,Risk=100" groupRelation="and">
				<OriginalFileName condition="is">CMSTP.exe</OriginalFileName>
				<CommandLine condition="contains all">/ns;/s</CommandLine>
			</Rule>
			<Rule name="Attack=T1218.003,Technique=CMSTP,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=CMSTP UAC Bypass Detected 3,Risk=100" groupRelation="and">
				<OriginalFileName condition="is">CMSTP.exe</OriginalFileName>
				<CommandLine condition="contains all">-ni;-s</CommandLine>
			</Rule>
			<Rule name="Attack=T1218.003,Technique=CMSTP,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=CMSTP UAC Bypass Detected 4,Risk=100" groupRelation="and">
				<OriginalFileName condition="is">CMSTP.exe</OriginalFileName>
				<CommandLine condition="contains all">-ns;-s</CommandLine>
			</Rule>
			<Rule name="Attack=T1218.002,Technique=Control Panel,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Control_Rundll Detected,Risk=50" groupRelation="and">
				<CommandLine condition="contains all">rundll32.exe;shell32.dll;_RunDLL</CommandLine>
				<Image condition="is not">C:\Windows\ImmersiveControlPanel\SystemSettings.exe</Image>
			</Rule>
			<Rule name="Attack=T1218.008,Technique=Signed Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Odbcconf Signed Binary Proxy Execution,Risk=50" groupRelation="and">
				<Image condition="image">odbcconf.exe</Image>
				<CommandLine condition="contains any">/S /A {REGSVR;-S -A {REGSVR</CommandLine>
			</Rule>
			<CommandLine name="Attack=T1218,Technique=Signed Script Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Script:http Detected,Risk=75" condition="contains">script:http</CommandLine>
			<CommandLine name="Attack=T1218,Technique=Signed Script Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Register-cimprovider exec,Risk=100" condition="contains">Register-cimprovider</CommandLine>
			<CommandLine name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="contains">Scriptrunner.exe -appvscript</CommandLine>
			<CommandLine name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="contains">bginfo</CommandLine>
			<CommandLine name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="contains">cbd</CommandLine>
			<CommandLine name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=runscripthelper LOLBAS,Risk=40" condition="contains">runscripthelper.exe surfacecheck</CommandLine>
			<CommandLine name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=xwizard LOLBAS,Risk=40" condition="contains">xwizard RunWizard</CommandLine>
			<CommandLine name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=PresentationHost exec,Risk=100" condition="contains">PresentationHost</CommandLine>
			<CommandLine name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=VBoxDrvInst.exe exec,Risk=100" condition="contains">driver executeinf</CommandLine>
			<CommandLine name="Attack=T1218.002,Technique=Control Panel Items,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Control Panel Execution,Risk=75" condition="contains any">control.exe /name;control.exe -name</CommandLine>
			<CommandLine name="Attack=T1218.002,Technique=Control Panel Items,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Control Panel Execution,Risk=75" condition="contains">Control_RunDLL</CommandLine>
			<Image name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="image">SyncAppvPublishingServer.exe</Image>
			<OriginalFileName name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="contains">Scriptrunner.exe</OriginalFileName>
			<OriginalFileName name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="is">ATBroker.exe</OriginalFileName>
			<OriginalFileName name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="is">Appvlp.exe</OriginalFileName>
			<OriginalFileName name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="is">InfDefaultInstall.EXE</OriginalFileName>
			<OriginalFileName name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="is">PresentationHost.exe</OriginalFileName>
			<OriginalFileName name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="is">RegisterCimProvider2.exe</OriginalFileName>
			<OriginalFileName name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="is">RegisterCimProvider.exe</OriginalFileName>
			<OriginalFileName name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="is">ScriptRunner.exe</OriginalFileName>
			<OriginalFileName name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="is">csi.exe</OriginalFileName>
			<OriginalFileName name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="is">extexport.exe</OriginalFileName>
			<OriginalFileName name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="is">msconfig.EXE</OriginalFileName>
			<OriginalFileName name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="is">rasdlui.exe</OriginalFileName>
			<OriginalFileName name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="is">tttracer.exe</OriginalFileName>
			<OriginalFileName name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="is">verclsid.exe</OriginalFileName>
			<OriginalFileName name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="is">wab.exe</OriginalFileName>
			<OriginalFileName name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Register-cimprovider.exe,Risk=100" condition="contains">Register-cimprovider.exe</OriginalFileName>
			<ParentCommandLine name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="contains">csi.exe</ParentCommandLine>
			<ParentCommandLine name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="contains">devtoolslauncher.exe LaunchForDeploy</ParentCommandLine>
			<ParentCommandLine name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="is">bginfo</ParentCommandLine>
			<ParentImage name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="image">devtoolslauncher.exe</ParentImage>
			<ParentImage name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="image">wab.exe</ParentImage>
			<ParentImage name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation" condition="image">wsreset.exe</ParentImage>
			<!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: CMSTP-->
			<CommandLine name="Attack=T1218.003,Technique=System Binary Proxy Execution,Tactic=Defense Evasion,DS=Process: Process Creation" condition="contains any">cmstp.exe /ni /s;cmstp.exe -ni -s</CommandLine>
			<CommandLine name="Attack=T1218.003,Technique=System Binary Proxy Execution,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=cmstp" condition="contains any">cmstp /ni /s;cmstp -ni -s</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Mavinject-->
			<Image name="Attack=T1218,Technique=Mavinject,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Mavinject Process Injection" condition="image">Mavinject.exe</Image>
			<CommandLine name="Attack=T1218,Technique=Mavinject,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Mavinject Process Injection" condition="contains">INJECTRUNNING</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Regsvr32-->
			<Rule name="Attack=T1117,Technique=Regsvr32,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Potential rundll32.exe DllRegisterServer execution,Risk=70" groupRelation="and">
				<Image condition="image">rundll32.exe</Image>
				<CommandLine condition="contains">DllRegisterServer</CommandLine>
				<CommandLine condition="excludes any">xapauthenticodesip.dll</CommandLine>
			</Rule>
			<Rule name="Attack=T1117,Technique=Regsvr32,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Suspicious Regsvr32 loading in Appdata temp" groupRelation="and">
				<Image condition="image">regsvr32.exe</Image> 
				<CommandLine condition="contains all">C:\Users;Appdata;Temp</CommandLine> 
			</Rule>
			<Rule name="Attack=T1117,Technique=Regsvr32,Tactic=Defense Evasion/Execution,DS=Process: Process Creation,Level=4,Alert=Suspicious Regsvr32 loading in Public User folder" groupRelation="and">
				<Image condition="image">regsvr32.exe</Image> 
				<CommandLine condition="contains all">C:\Users;Public</CommandLine> 
			</Rule>
			<Description name="Attack=T1117,Technique=Regsvr32,Tactic=Execution,DS=Process: Process Creation" condition="contains">Microsoft(C) Register Server</Description>
			<Image name="Attack=T1218,Technique=Signed Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=SyncAppvPublishingServer Applocker Bypass" condition="image">SyncAppvPublishingServer.exe</Image>
			<Image name="Attack=T1218,Technique=Signed Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=control panel execution" condition="image">control.exe</Image>
			<Image name="Attack=T1218,Technique=Signed Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=rasautou execution" condition="image">rasautou.exe</Image>
			<CommandLine name="Attack=T1196,Technique=Control Panel Items,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Control Panel Execution" condition="contains any">control.exe /name;control.exe -name</CommandLine>
			<CommandLine name="Attack=T1196,Technique=Control Panel Items,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Control Panel Execution" condition="contains">Control_RunDLL</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: MsiExec-->
			<Rule name="Attack=T1218,Technique=Signed Binary Proxy Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Msiexec.exe DllRegisterServer execution,Risk=70" groupRelation="and">
				<Image condition="image">msiexec.exe</Image>
				<CommandLine condition="contains any">/y;-y</CommandLine>
				<CommandLine condition="excludes">C:\Windows\SysWOW64\DartSock.dll</CommandLine>
				<CommandLine condition="excludes">C:\Windows\SysWOW64\ImageViewer2.OCX</CommandLine>
				<CommandLine condition="excludes">C:\Windows\SysWOW64\SysTray.ocx</CommandLine>
				<CommandLine condition="excludes">C:\Windows\SysWOW64\tdbg6.ocx</CommandLine>
				<CommandLine condition="excludes">C:\Windows\SysWOW64\tdbg7.ocx</CommandLine>
				<CommandLine condition="excludes">C:\Windows\SysWOW64\tdbg7.ocx</CommandLine>
				<CommandLine condition="excludes">C:\Windows\SysWOW64\todg7.ocx</CommandLine>
				<CommandLine condition="excludes">C:\Windows\SysWOW64\todgub7.dll</CommandLine>
				<CommandLine condition="excludes">C:\Windows\SysWOW64\xarraydb.ocx</CommandLine>
			</Rule>
			<Rule name="Attack=T1218,Technique=Signed Binary Proxy Execution,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=MSIExec Signed Binary Proxy Execution,Risk=70" groupRelation="and">
				<Image condition="image">msiexec.exe</Image>
				<CommandLine condition="contains any">/i;-i</CommandLine>
				<CommandLine condition="contains any">http</CommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Rundll32-->
			<Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Rundll32 Suspicious call by Ordinal,Risk=80" groupRelation="and">
				<OriginalFileName condition="is">RUNDLL32.EXE</OriginalFileName>
				<CommandLine condition="contains all">,;#</CommandLine>
				<CommandLine condition="excludes">C:\Windows\resources\themes\Aero\AeroLite.msstyles</CommandLine>
				<CommandLine condition="excludes">uxtheme.dll</CommandLine>
				<CommandLine condition="excludes">ImageView_Fullscreen</CommandLine>
				<CommandLine condition="excludes">EDGEHTML.dll</CommandLine>
				<CommandLine condition="excludes">PhotoViewer.dll</CommandLine>
				<CurrentDirectory condition="excludes">\AppData\Local\WebEx\WebEx\</CurrentDirectory>
			</Rule>
			<Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Rundll32 Single Threaded Apartment Switch - check for com hijacks,Risk=75" groupRelation="and">
				<OriginalFileName condition="is">RUNDLL32.EXE</OriginalFileName>
				<CommandLine condition="contains any">-sta;/sta</CommandLine>
			</Rule>
			<Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Rundll32 localserver Switch - check for com hijacks,Risk=75" groupRelation="and">
				<OriginalFileName condition="is">RUNDLL32.EXE</OriginalFileName>
				<CommandLine condition="contains any">-localserver;/localserver</CommandLine>
			</Rule>
			<Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Suspicious OpenAs_RunDLL,Risk=30" groupRelation="and">
				<OriginalFileName condition="is">RUNDLL32.EXE</OriginalFileName>
				<CommandLine condition="contains all">shell32.dll;OpenAs_RunDLL</CommandLine>
			</Rule>
			<Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Executing Powershell,Risk=70" groupRelation="and">
				<ParentImage condition="image">RUNDLL32.EXE</ParentImage>
				<OriginalFileName condition="contains">powershell</OriginalFileName>
			</Rule>
			<Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Suspicious OpenURL Commands" groupRelation="and">
				<OriginalFileName condition="is">RUNDLL32.EXE</OriginalFileName>
				<CommandLine condition="contains all">url.dll;OpenURL</CommandLine>
			</Rule>
			<Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Suspicious FileProtocolHandler Commands" groupRelation="and">
				<OriginalFileName condition="is">RUNDLL32.EXE</OriginalFileName>
				<CommandLine condition="contains all">url.dll;FileProtocolHandler</CommandLine>
			</Rule>
			<Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Suspicious RouteTheCall Commands" groupRelation="and">
				<OriginalFileName condition="is">RUNDLL32.EXE</OriginalFileName>
				<CommandLine condition="contains all">zipfldr.dll;RouteTheCall</CommandLine>
			</Rule>
			<Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Suspicious Control_RunDLL Commands" groupRelation="and">
				<OriginalFileName condition="is">RUNDLL32.EXE</OriginalFileName>
				<CommandLine condition="contains all">Shell32.dll;Control_RunDLL</CommandLine>
			</Rule>
			<Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Suspicious javascript Commands" groupRelation="and">
				<OriginalFileName condition="is">RUNDLL32.EXE</OriginalFileName>
				<CommandLine condition="contains">javascript:</CommandLine>
			</Rule>
			<Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Suspicious RegisterXLL Commands" groupRelation="and">
				<OriginalFileName condition="is">RUNDLL32.EXE</OriginalFileName>
				<CommandLine condition="contains">RegisterXLL</CommandLine>
			</Rule>
			<Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Suspicious Rundll32 loading in Public User folder" groupRelation="and">
				<Image condition="image">rundll32.exe</Image> 
				<CommandLine condition="contains all">C:\Users;Public</CommandLine>
				<ParentCommandLine condition="excludes any">rdpinit.exe</ParentCommandLine> 
				<ParentImage condition="excludes any">rdpinit.exe;G2MInstaller;GoToMeeting;LogMeIn;firefox.exe</ParentImage> 
			</Rule>
			<Rule name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Suspicious Rundll32 loading in Appdata Temp" groupRelation="and">
				<Image condition="image">rundll32.exe</Image>
				<CommandLine condition="contains all">C:\Users;Appdata;Temp</CommandLine>
				<CommandLine condition="excludes any">ImageView_</CommandLine>
				<ParentCommandLine condition="excludes any">rdpinit.exe</ParentCommandLine>
				<ParentImage condition="excludes any">rdpinit.exe;G2MInstaller;GoToMeeting;LogMeIn;firefox.exe</ParentImage>
			</Rule>
			<CommandLine name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=LOLbin" condition="contains all">advpack.dll;LaunchINFSection</CommandLine>
			<CommandLine name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=LOLbin" condition="contains all">ieadvpack.dll;LaunchINFSection</CommandLine>
			<CommandLine name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=LOLbin" condition="contains all">syssetup.dll;SetupInfObjectInstallAction</CommandLine>
			<CommandLine name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=LOLbin" condition="contains all">setupapi.dll;InstallHinfSection</CommandLine>
			<CommandLine condition="contains">InstallHinfSection</CommandLine>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=infDefaultInstall" condition="image">infDefaultInstall.exe</Image>
			<CommandLine name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=APT28 CHOPSTICK Detection,Risk=70" condition="contains">rundll32.exe "C:\Windows\twain_64.dll"</CommandLine>
			<CommandLine name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Shdocvw exec via rundll32,Risk=70" condition="contains all">shdocvw.dll;OpenURL</CommandLine>
			<CommandLine name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Testing advpack exec,Risk=70" condition="contains all">advpack.dll;RegisterOCX</CommandLine>
			<CommandLine name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=EDR Bypass,Risk=100" condition="contains all">Zipfldr.dll;RouteTheCall</CommandLine>
			<CommandLine name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=EDR Bypass,Risk=100" condition="contains all">url.dll;FileProtocolHandler</CommandLine>
			<CommandLine name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=EDR Bypass technique FileProtocolHandler,Risk=100" condition="contains all">url.dll;FileProtocolHandler</CommandLine>
			<CommandLine name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=EDR Bypass OpenURLA,Risk=100" condition="contains all">OpenURLA;file:</CommandLine>
			<CommandLine name="Attack=T1218.011,Technique=Rundll32,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=EDR Bypass OpenURLA,Risk=100" condition="contains all">OpenURL;file:</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: MSHTA-->
			<Rule name="Attack=T1059,Technique=Scripting,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Suspicious child processes of mshta,Risk=100" groupRelation="and">
				<ParentImage condition="image">mshta.exe</ParentImage>
				<Image condition="contains any">cmd.exe;powershell.exe;wscript.exe;cscript.exe;sh.exe;bash.exe;reg.exe;regsvr32.exe;bitsadmin</Image>
			</Rule>
			<Rule name="Attack=T1170,Technique=MSHTA,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=MSHTA Execution,Risk=100" groupRelation="and">
				<Image condition="image">mshta.exe</Image>
			</Rule>
			<CommandLine name="Attack=T1170,Technique=MSHTA,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=MSHTA Execution" condition="contains">RunHTMLApplication</CommandLine>
			<CommandLine name="Attack=T1170,Technique=MSHTA,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=MSHTA Execution" condition="contains">mshtml</CommandLine>
			<CommandLine name="Attack=T1170,Technique=MSHTA,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=MSHTA Execution" condition="contains">vbscript:CreateObject</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Odbcconf-->
			<Image name="Attack=T1218.008,Technique=System Binary Proxy Execution,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=Possible driver load with odbcconf,Risk=40" condition="image">odbcconf.exe</Image>

			<!--MITRE ATT&CK TECHNIQUE: System Script Proxy Execution-->
			<CommandLine name="Attack=T1216,Technique=System Script Proxy Execution,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=manage-bde.wsf exec,Risk=100" condition="contains">manage-bde.wsf</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: Template Injection-->
			<!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
			<!--MITRE ATT&CK TECHNIQUE: Trusted Developer Utilities Proxy Execution-->
			<Rule name="Attack=T1127.001,Technique=Trusted Developer Utilities,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Powershell Calling MSBuild" groupRelation="and">
				<ParentImage condition="contains any">powershell.exe;powershell_ise.exe</ParentImage>
				<Image condition="image">msbuild.exe</Image>
			</Rule>
			<Rule name="Attack=T1127.001,Technique=Trusted Developer Utilities,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=MSBuild Calling RegAsm" groupRelation="and">
				<ParentImage condition="image">msbuild.exe</ParentImage>
				<Image condition="image">regasm.exe</Image>
			</Rule>
			<Rule name="Attack=T1127.001,Technique=Trusted Developer Utilities,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=MSBuild Calling useinit" groupRelation="and">
				<ParentImage condition="image">msbuild.exe</ParentImage>
				<Image condition="image">userinit.exe</Image>
			</Rule>
			<Rule name="Attack=T1127.001,Technique=Trusted Developer Utilities,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=MSBuild Building from xml - Silent Trinity" groupRelation="and">
				<ParentImage condition="image">msbuild.exe</ParentImage>
				<ParentCommandLine condition="contains">.xml</ParentCommandLine>
			</Rule>
			<Rule name="Attack=T1127.001,Technique=Trusted Developer Utilities,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=RegAsm Parent process" groupRelation="and">
				<ParentImage condition="image">regasm.exe</ParentImage>
				<Image condition="excludes">\conhost.exe</Image>
			</Rule>
			<Rule name="Attack=T1127.001,Technique=Trusted Developer Utilities,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=MSBuild building from lnk file" groupRelation="and">
				<Image condition="image">msbuild.exe</Image>
				<CommandLine condition="contains">.lnk</CommandLine>
			</Rule>
			<CommandLine name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=.csproj execution" condition="contains">.csproj</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: Unused/Unsupported Cloud Regions-->
			<!--MITRE ATT&CK TECHNIQUE: Use Alternate Authentication Material-->
			<!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->
			<!--MITRE ATT&CK TECHNIQUE: Virtualization/Sandbox Evasion-->
			<!--MITRE ATT&CK TECHNIQUE: Weaken Encryption-->
			<!--MITRE ATT&CK TECHNIQUE: XSL Script Processing-->
			<Image name="Attack=T1220,Technique=XSL Script Processing,Tactic=Defense Evasion Execution,DS=Process: Process Creation,Level=4,Alert=XSL Script Processing" condition="image">msxsl.exe</Image>
			<ParentImage name="Attack=T1220,Technique=XSL Script Processing,Tactic=Defense Evasion Execution,DS=Process: Process Creation,Level=4,Alert=XSL Script Processing" condition="image">msxsl.exe</ParentImage>
			<!--MITRE ATT&CK TACTIC: Credential Access-->
			<!--MITRE ATT&CK TECHNIQUE: Adversary-in-the-Middle-->
			<!--MITRE ATT&CK TECHNIQUE: Brute Force-->
			<!--MITRE ATT&CK TECHNIQUE: Credentials from Password Stores-->
			<!--MITRE ATT&CK TECHNIQUE: Exploitation for Credential Access-->
			<!--MITRE ATT&CK TECHNIQUE: Forced Authentication-->
			<!--MITRE ATT&CK TECHNIQUE: Forge Web Credentials-->
			<!--MITRE ATT&CK TECHNIQUE: Input Capture-->
			<CommandLine name="Attack=T1056.001,Technique=Input Capture: Keylogging,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Possible Hawkeye Keylogger Detected" condition="contains">/stext</CommandLine>
			<CommandLine name="Attack=T1056.001,Technique=Input Capture: Keylogging,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Possible Keylogger Detected" condition="contains">keylog</CommandLine>
			<CommandLine name="Attack=T1056.001,Technique=Input Capture: Keylogging,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Possible Keylogger Detected" condition="contains">keyscan_</CommandLine>
			<CommandLine name="Attack=T1056.001,Technique=Input Capture: Keylogging,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Possible Keylogger Detected" condition="contains">Get-Keystrokes</CommandLine>
			<CommandLine name="Attack=T1056.001,Technique=Input Capture: Keylogging,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Possible Keylogger Detected" condition="contains">/scomma</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
			<!--MITRE ATT&CK TECHNIQUE: Multi-Factor Authentication Interception-->
			<!--MITRE ATT&CK TECHNIQUE: Multi-Factor Authentication Request Generation-->
			<!--MITRE ATT&CK TECHNIQUE: Network Sniffing-->
			<Rule name="Attack=T1040,Technique=Network Sniffing,Tactic=Credential Access/Discovery,DS=Process: Process Creation,Level=4,Alert=Network Sniffing tool Detected,Risk=100" groupRelation="and">
				<CommandLine condition="contains">sniff</CommandLine>
				<CommandLine condition="excludes">C:\Program Files\Adobe\</CommandLine>
			</Rule>
			<Rule name="Attack=T1040,Technique=Network Sniffing,Tactic=Credential Access/Discovery,DS=Process: Process Creation,Level=4,Alert=PCAP Sniffing tool Detected,Risk=100" groupRelation="or">
				<OriginalFileName condition="is any">tcpdump.exe;tcpdump.c;tshark.exe;tshark.c;windump.exe;windump.c;wireshark.c;wireshark.exe</OriginalFileName>
				<CommandLine condition="contains any">windump;tshark;tcpdump;windump;wireshark</CommandLine>
				<CommandLine condition="contains all">netsh;trace;start;capture=yes</CommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: OS Credential Dumping-->
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Access with vss shadow copy,Risk=100" groupRelation="and">
				<Image condition="image">vssadmin.exe</Image>
				<CommandLine condition="contains any">create;shadow</CommandLine>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential access with wmic shadow copy creation,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains">wmic.exe</OriginalFileName>
				<CommandLine condition="contains all">shadowcopy;call;create</CommandLine>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential access with wmic esentutl,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains">wmic.exe</OriginalFileName>
				<CommandLine condition="contains all">call;create;esentutl;vss</CommandLine>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Powershell shadow copy creation,Risk=100" groupRelation="and">
				<CommandLine condition="contains all">win32_shadowcopy;create;clientaccessible</CommandLine>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Symlink to Shadowcopy,Risk=100" groupRelation="and">
				<CommandLine condition="contains all">mklink;GLOBALROOT;Shadow</CommandLine>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Copy of NTDS.dit from vss shadow copy,Risk=100" groupRelation="or">
				<CommandLine condition="contains all">copy;NTDS\ntds.dit</CommandLine>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=ntdsutil credential dumping,Risk=100" groupRelation="or">
				<Image condition="image">ntdsutil.exe</Image>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Copy of SYSTEM Registry from vss shadow copy,Risk=100" groupRelation="or">
				<CommandLine condition="contains all">copy;System32\config\SYSTEM</CommandLine>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Malicious Reg Save Credential Dumping,Risk=100" groupRelation="or">
				<CommandLine condition="contains all">reg;save;HKLM</CommandLine>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Command Mimikatz,Risk=100" groupRelation="and">
				<CommandLine condition="contains any">mimikatz;mimidrv;mimilove;mimilib;sekurlsa;lsadump;dumpcreds;privilege::;token::;logonpasswords;mimikittenz;mimiauth;::;kerberos::;misc::skeleton;privilege::debug;dpapi::cred;vault::cred;lsadump;misc::;Krbtgt;TOKEN::;invoke-mimi</CommandLine>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=3,Alert=Possible credential modification or disclosure with cmdkey,Risk=30" groupRelation="and">
				<OriginalFileName condition="contains">cmdkey</OriginalFileName>
			</Rule>
			<OriginalFileName name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=3,Alert=Credential Dumping Command rpcping,Risk=100" condition="is">rpcping.exe</OriginalFileName>
			<CommandLine name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Command nltest,Risk=100" condition="contains">nltest.exe</CommandLine>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Suspicious Cred Dumping Commands,Risk=60" groupRelation="and">
				<CommandLine condition="contains any">-ma lsass.exe;Do-Exfiltration;Powersploit;GPPPassword;gpprefdecrypt;gsecdump;hashdump;laZagne;ntds.dit;ppldump;pwdump;pwdumpx;secretsdump;/listcreds:;-listcreds:</CommandLine>
			</Rule>
			<CommandLine name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Via vaultcli.dll" condition="contains">VaultCloseVault</CommandLine>
			<CommandLine name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Via vaultcli.dll" condition="contains">VaultEnumerateItem</CommandLine>
			<CommandLine name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Via vaultcli.dll" condition="contains">VaultFree</CommandLine>
			<CommandLine name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Via vaultcli.dll" condition="contains">VaultGetItem</CommandLine>
			<CommandLine name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Via vaultcli.dll" condition="contains">VaultOpenVault</CommandLine>
			<CommandLine name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Via vaultcli.dll" condition="contains">Vaultcmd</CommandLine>
			<CommandLine name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Via vaultcli.dll" condition="contains">vaultcli.dll</CommandLine>
			<CommandLine name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping from firefox" condition="contains">select * from moz_login</CommandLine>
			<CommandLine name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping" condition="contains">Invoke-WinEnum</CommandLine>
			<CommandLine name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Dumping Cached Credentials,Risk=100" condition="contains">System.Net.CredentialCache</CommandLine>
			<CommandLine name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=0,Desc=VSS Shadow file Created" condition="contains">create shadow</CommandLine>
			<CommandLine name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Dumping,DS=Process: Process Creation,Level=4,Alert=Credential Theft: netsh wlan password export in cleartext,Risk=100" condition="contains all">wlan;export;profile;key=clear</CommandLine>
			<CommandLine name="Attack=T1003.006,Technique=Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Command DCsync,Risk=100" condition="contains">dcsync</CommandLine>
			<CommandLine name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credentials in Registry" condition="contains any">HKCU /f password;HKCU -f password</CommandLine>
			<CommandLine name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credentials in Registry" condition="contains any">HKLM /f password;HKLM -f password</CommandLine>
			<Image name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Command nltest,Risk=60" condition="image">nltest.exe</Image>
			<Image name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Command" condition="image">ProcDump.exe</Image>
			<OriginalFileName name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Credential Dumping Command" condition="contains">ProcDump</OriginalFileName>
			<!--MITRE ATT&CK TECHNIQUE: Steal Application Access Token-->
			<!--MITRE ATT&CK TECHNIQUE: Steal or Forge Kerberos Tickets-->
			<CommandLine name="Attack=T1558,Technique=Steal or Forge Kerberos Tickets,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Steal or Forge Kerberos Tickets,Risk=70" condition="contains any">asktgt;asktgs</CommandLine>
			<CommandLine name="Attack=T1558,Technique=Steal or Forge Kerberos Tickets,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Steal or Forge Kerberos Tickets,Risk=70" condition="contains any">createnetonly /program:;createnetonly -program:</CommandLine>
			<CommandLine name="Attack=T1558,Technique=Steal or Forge Kerberos Tickets,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Steal or Forge Kerberos Tickets,Risk=70" condition="contains any">dump /service:krbtgt;dump -service:krbtgt</CommandLine>
			<CommandLine name="Attack=T1558,Technique=Steal or Forge Kerberos Tickets,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Steal or Forge Kerberos Tickets,Risk=70" condition="contains any">harvest /interval:;harvest -interval:</CommandLine>
			<CommandLine name="Attack=T1558,Technique=Steal or Forge Kerberos Tickets,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Steal or Forge Kerberos Tickets,Risk=70" condition="contains any">renew /ticket:;renew -ticket:</CommandLine>
			<CommandLine name="Attack=T1558,Technique=Steal or Forge Kerberos Tickets,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Steal or Forge Kerberos Tickets,Risk=70" condition="contains">asreproast</CommandLine>
			<CommandLine name="Attack=T1558,Technique=Steal or Forge Kerberos Tickets,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Steal or Forge Kerberos Tickets,Risk=70" condition="contains">impersonateuser:</CommandLine>
			<CommandLine name="Attack=T1558,Technique=Steal or Forge Kerberos Tickets,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Steal or Forge Kerberos Tickets,Risk=70" condition="contains">kerberoast</CommandLine>
			<CommandLine name="Attack=T1558,Technique=Steal or Forge Kerberos Tickets,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Steal or Forge Kerberos Tickets,Risk=70" condition="contains">ptt /ticket:</CommandLine>
			<Image name="Attack=T1558,Technique=Steal or Forge Kerberos Tickets,Tactic=Credential Access,DS=Process: Process Creation,Level=4,Alert=Kerberos Ticket Disclosure with klist,Risk=70" condition="image">klist.exe</Image>
			<Image name="Attack=T1558,Technique=Steal or Forge Kerberos Tickets,Tactic=Credential Access,DS=Process: Process Creation,Level=0,Desc=Kerberos Ticket Disclosure,Risk=30" condition="image">hh.exe</Image>
			<!--MITRE ATT&CK TECHNIQUE: Steal Web Session Cookie-->
			<!--MITRE ATT&CK TECHNIQUE: Unsecured Credentials-->
			<Rule name="Attack=T1552,Technique=Unsecured Credentials,Tactic=Credential Access,DS=Process: Process Creation,Level=3,Alert=Possible disclosure with IIS appcmd,Risk=100" groupRelation="and">
				<OriginalFileName condition="is">appcmd.exe</OriginalFileName>
				<CommandLine condition="contains all">list;text;password</CommandLine>
			</Rule>
			<!--MITRE ATT&CK TACTIC: Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Account Discovery -->
			<Image name="Attack=T1087,Technique=Account Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=User enumeration/Discovery,Risk=30" condition="image">quser.exe</Image>
			<Rule name="Attack=T1087,Technique=Account Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=User or Group Discovery,Risk=50" groupRelation="and">
				<OriginalFileName condition="contains any">net.exe;net1.exe;net2.exe</OriginalFileName>
				<CommandLine condition="contains any">group;localgroup; user</CommandLine>
				<CommandLine condition="excludes">/domain</CommandLine>
				<CommandLine condition="excludes">SUService</CommandLine>
				<CommandLine condition="excludes">\users</CommandLine>
				<ParentCommandLine condition="excludes">tvsu_tmp</ParentCommandLine>
			</Rule>
			<Rule name="Attack=T1087,Technique=Account Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=Domain User or Group Discovery,Risk=50" groupRelation="and">
				<OriginalFileName condition="contains any">net.exe;net1.exe;net2.exe</OriginalFileName>
				<CommandLine condition="contains any">group;localgroup; user</CommandLine>
				<CommandLine condition="contains any">/domain</CommandLine>
				<CommandLine condition="excludes">SUService</CommandLine>
				<CommandLine condition="excludes">\users</CommandLine>
				<ParentCommandLine condition="excludes">tvsu_tmp</ParentCommandLine>
			</Rule>
			<Rule name="Attack=T1087,Technique=Account Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=4,Alert=Sharphound Discovery,Risk=100" groupRelation="or">
				<CommandLine condition="contains any">sharphound;bloodhound;azurehound;CollectionMethod;encryptzip;randomizefilenames;dumpcomputerstatus</CommandLine>
				<Company condition="contains any">sharphound;bloodhound</Company>
				<Description condition="contains any">sharphound;bloodhound</Description>
				<Image condition="contains any">sharphound;bloodhound</Image>
				<OriginalFileName condition="contains any">sharphound;bloodhound</OriginalFileName>
				<ParentImage condition="contains any">sharphound;bloodhound</ParentImage>
				<Product condition="contains any">sharphound;bloodhound</Product>
			</Rule>
			<CommandLine name="Attack=T1087,Technique=Account Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=DSclient Discovery,Risk=70" condition="contains any">dscl . list /Groups;dscl . list -Groups</CommandLine>
			<CommandLine name="Attack=T1087,Technique=Account Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=DSclient Discovery,Risk=70" condition="contains any">dscl . list /Users;dscl . list -Users</CommandLine>
			<Image name="Attack=T1087,Technique=Account Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=DSQuery.EXE Discovery,Risk=70" condition="image">dsquery.exe</Image>
			<Image name="Attack=T1087,Technique=Account Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=Query.EXE Discovery,Risk=30" condition="image">query.exe</Image>
			<!--MITRE ATT&CK TECHNIQUE: Application Window Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Browser Bookmark Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Cloud Infrastructure Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Cloud Service Dashboard-->
			<!--MITRE ATT&CK TECHNIQUE: Cloud Service Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Cloud Storage Object Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Container and Resource Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Debugger Evasion-->
			<!--MITRE ATT&CK TECHNIQUE: Domain Trust Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: File and Directory Discovery-->
			<Image name="Attack=T1083,Technique=File and Directory Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=directory structure disclosure,Risk=30" condition="end with">tree.com</Image>
			<!--MITRE ATT&CK TECHNIQUE: Group Policy Discovery-->
			<Rule name="Attack=T1484.001,Technique=Group Policy Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=Auditpol System/GP Audit Policy Discovery" groupRelation="and">
				<OriginalFileName condition="contains">auditpol</OriginalFileName>
				<CommandLine condition="contains any">/get;-get;/list;-list;/backup;-backup</CommandLine>
			</Rule>
			<Image name="Attack=T1484.001,Technique=Group Policy Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=Group Policy Discovery with GPResult" condition="contains any">gpresult.exe</Image>
			<CommandLine name="Attack=T1484.001,Technique=Group Policy Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=Group Policy Discovery with Powershell" condition="contains any">get-gpo;get-gpresult;get-gpreg</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: Network Service Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Network Share Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Network Sniffing-->
			<!--MITRE ATT&CK TECHNIQUE: Password Policy Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Peripheral Device Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Permission Groups Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Process Discovery-->
			<Image name="Attack=T1057,Technique=Process Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=Process Discovery,Risk=0" condition="image">tasklist.exe</Image>
			<Image name="Attack=T1057,Technique=Process Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=Process Discovery,Risk=0" condition="image">qprocess.exe</Image>
			<!--MITRE ATT&CK TECHNIQUE: Query Registry-->
			<CommandLine name="Attack=T1012,Technique=Query Registry,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=System information discovery with reg.exe,Risk=20" condition="contains">reg query</CommandLine>
			<CommandLine name="Attack=T1012,Technique=Query Registry,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=System information discovery with reg.exe,Risk=20" condition="contains">reg.exe query</CommandLine>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Remote Driver Querying" condition="image">driverquery.exe</Image>

			<!--MITRE ATT&CK TECHNIQUE: Remote System Discovery-->
			<Image name="Attack=T1018,Technique=Remote System Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=Traceroute Remote System Discovery,MitreURL=https://attack.mitre.org/techniques/T1018/,Risk=30" condition="image">tracert.exe</Image>
			<Image name="Attack=T1018,Technique=Remote System Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=Pathping Remote System Discovery,MitreURL=https://attack.mitre.org/techniques/T1018/,Risk=30" condition="image">pathping.exe</Image>
			<!--MITRE ATT&CK TECHNIQUE: Software Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Software Discovery: Security Software Discovery-->
			<Rule name="Attack=T1063,Technique=Security Software Discovery,Tactic=Discovery,DS=Process: Process Creation,Alert=Sysmon Detection with driver altitude" groupRelation="or">
				<CommandLine condition="contains all">find;385201</CommandLine>
				<CommandLine condition="contains all">select-string;385201</CommandLine>
			</Rule>
			<Rule name="Attack=T1063,Technique=Security Software Discovery,Tactic=Discovery,DS=Process: Process Creation,Alert=Antivirus/edr/siem Discovery" groupRelation="or">
				<CommandLine condition="contains all">find;virus</CommandLine>
				<CommandLine condition="contains all">select-string;virus</CommandLine>
				<CommandLine condition="contains all">process;Description;virus</CommandLine>
				<CommandLine condition="contains all">find;cb</CommandLine>
				<CommandLine condition="contains all">select-string;cb</CommandLine>
				<CommandLine condition="contains all">process;Description;cb</CommandLine>
				<CommandLine condition="contains all">find;defender</CommandLine>
				<CommandLine condition="contains all">select-string;defender</CommandLine>
				<CommandLine condition="contains all">process;Description;defender</CommandLine>
				<CommandLine condition="contains all">find;crowdstrike</CommandLine>
				<CommandLine condition="contains all">select-string;crowdstrike</CommandLine>
				<CommandLine condition="contains all">process;Description;crowdstrike</CommandLine>
				<CommandLine condition="contains all">find;sentinel</CommandLine>
				<CommandLine condition="contains all">select-string;sentinel</CommandLine>
				<CommandLine condition="contains all">process;Description;sentinel</CommandLine>
				<CommandLine condition="contains all">find;nessusd</CommandLine>
				<CommandLine condition="contains all">select-string;nessusd</CommandLine>
				<CommandLine condition="contains all">process;Description;nessusd</CommandLine>
				<CommandLine condition="contains all">find;td-agent</CommandLine>
				<CommandLine condition="contains all">select-string;td-agent</CommandLine>
				<CommandLine condition="contains all">process;Description;td-agent</CommandLine>
				<CommandLine condition="contains all">find;cbagentd</CommandLine>
				<CommandLine condition="contains all">select-string;cbagentd</CommandLine>
				<CommandLine condition="contains all">process;Description;cbagentd</CommandLine>
				<CommandLine condition="contains all">find;sysmon</CommandLine>
				<CommandLine condition="contains all">select-string;sysmon</CommandLine>
				<CommandLine condition="contains all">process;Description;sysmon</CommandLine>
				<CommandLine condition="contains all">find;winlogbeat</CommandLine>
				<CommandLine condition="contains all">select-string;winlogbeat</CommandLine>
				<CommandLine condition="contains all">process;Description;winlogbeat</CommandLine>
				<CommandLine condition="contains all">find;winlogbeat</CommandLine>
				<CommandLine condition="contains all">select-string;winlogbeat</CommandLine>
				<CommandLine condition="contains all">process;Description;winlogbeat</CommandLine>
				<CommandLine condition="contains all">find;csfalcon</CommandLine>
				<CommandLine condition="contains all">select-string;csfalcon</CommandLine>
				<CommandLine condition="contains all">process;Description;csfalcon</CommandLine>
				<CommandLine condition="contains all">find;splunk</CommandLine>
				<CommandLine condition="contains all">select-string;splunk</CommandLine>
				<CommandLine condition="contains all">process;Description;splunk</CommandLine>
				<CommandLine condition="contains all">find;sidecar</CommandLine>
				<CommandLine condition="contains all">select-string;sidecar</CommandLine>
				<CommandLine condition="contains all">process;Description;sidecar</CommandLine>
			</Rule>
			<Rule name="Attack=T1063,Technique=Security Software Discovery,Tactic=Discovery,DS=Process: Process Creation" groupRelation="or">
				<OriginalFileName name="Attack=T1063,Technique=Security Software Discovery,Tactic=Discover,DS=Process: Process Creationy" condition="is">fltMC.exe</OriginalFileName>
				<CommandLine name="Attack=T1063,Technique=Security Software Discovery,Tactic=Discovery,DS=Process: Process Creation" condition="contains">misc::mflt</CommandLine>
			</Rule>
			<CommandLine name="Attack=T1016,Technique=Security Software Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=AV Product detection via WMI,Risk=30" condition="contains">AntiVirusProduct</CommandLine>
			<CommandLine name="Attack=T1016,Technique=Security Software Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=Security Settings via WMI,Risk=30" condition="contains">root\SecurityCenter2</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: System Information Discovery-->
			<Image name="Attack=T1016,Technique=System Information Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=System Information Discovery,Risk=30" condition="image">sysinfo.exe</Image>
			<CommandLine name="Attack=T1016,Technique=System Information Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=System Information Discovery,Risk=30" condition="image">systeminfo</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: System Location Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: System Network Configuration Discovery-->
			<Rule name="Attack=T1016,Technique=System Network Configuration Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=Network Connection Discovery with netsh,Risk=60" groupRelation="and">
				<Image condition="image">netsh.exe</Image>
				<CommandLine condition="contains any">get;list;show</CommandLine>
			</Rule>
			<Rule name="Attack=T1016,Technique=System Network Configuration Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=Network Connection Changes with netsh,Risk=60" groupRelation="and">
				<Image condition="image">netsh.exe</Image>
				<CommandLine condition="excludes any">get;list;show</CommandLine>
			</Rule>
			<Image name="Attack=T1016,Technique=System Network Configuration Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=ipconfig discovery,Risk=20" condition="image">ipconfig.exe</Image>
			<!--MITRE ATT&CK TECHNIQUE: System Network Connections Discovery-->
			<Image name="Attack=T1049,Technique=System Network Connections Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=System Network Connections Discovery,Risk=0" condition="image">netstat.exe</Image>
			<CommandLine name="Attack=T1049,Technique=System Network Connections Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=ARP Table Lookup Detected,Risk=30" condition="contains">arp -a</CommandLine> 
			<CommandLine name="Attack=T1049,Technique=System Network Connections Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=ARP Table Lookup Detected,Risk=30" condition="contains">arp.exe -a</CommandLine> 
			<CommandLine name="Attack=T1049,Technique=System Network Connections Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=ARP Table Lookup Detected,Risk=30" condition="contains">arp  -a</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: System Owner/User Discovery-->
			<Rule name="Attack=T1033,Technique=System Owner/User Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=Account Discovery,Risk=50" groupRelation="and">
				<Image condition="contains any">whoami.exe;whoami1.exe</Image>
			</Rule>
			<Rule name="Attack=T1033,Technique=System Owner/User Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=3,Alert=WMIC Account Discovery,Risk=30" groupRelation="and">
				<OriginalFileName condition="contains">wmic.exe</OriginalFileName>
				<CommandLine condition="contains all">get;useraccount</CommandLine>
			</Rule>
			<Rule name="Attack=T1016,Technique=System Network Connections Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=DNS encryption enabled with netsh,Risk=40" groupRelation="and">
				<Image condition="image">netsh.exe</Image>
				<CommandLine condition="contains any">add;set</CommandLine>
				<CommandLine condition="contains any">encryption;dohtemplate</CommandLine>
			</Rule>
			<Rule name="Attack=T1016,Technique=System Network Connections Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=Network Connection modifications with netsh,Risk=40" groupRelation="and">
				<Image condition="image">netsh.exe</Image>
				<CommandLine condition="contains any">add;del;set</CommandLine>
			</Rule>
			<Rule name="Attack=T1049,Technique=System Network Connections Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=NBTStat DNS Lookup,Risk=30" groupRelation="and">
				<CommandLine condition="contains">nbtstat</CommandLine> 
				<CommandLine condition="excludes">nessus</CommandLine> 
			</Rule>
			<Rule name="Attack=T1016,Technique=System Network Configuration Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=route.exe discovery,Risk=60" groupRelation="and">
				<Image condition="image">route.exe</Image>
				<CommandLine condition="contains">print</CommandLine>
			</Rule>
			<Rule name="Attack=T1016,Technique=System Network Configuration Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=0,Desc=Route Modification,Risk=40" groupRelation="and">
				<Image condition="image">route.exe</Image>
				<CommandLine condition="contains any">ADD;DEL;CHANGE;-f</CommandLine>
			</Rule>
			<Image name="Attack=T1033,Technique=System Owner/User Discovery,Tactic=Discovery,DS=Process: Process Creation,Level=2,Alert=User enumeration with qwinsta" condition="image">qwinsta.exe</Image>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=rwinsta" condition="image">rwinsta.exe</Image>
			
			<!--MITRE ATT&CK TECHNIQUE: System Service Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: System Time Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Virtualization/Sandbox Evasion-->

			<!--MITRE ATT&CK TACTIC: Lateral Movement-->
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Possible Lateral Movmt via Office Application,Risk=80" groupRelation="and">
				<ParentImage condition="contains">Microsoft Office\root\Office</ParentImage>
				<Image condition="excludes">Microsoft Office\root\Office</Image>
				<ParentCommandLine condition="contains all">automation;Embedding</ParentCommandLine>
			</Rule>
			<Rule name="Attack=T1021.002,Tactic=Lateral Movement,Technique=SMB/Windows Admin Shares,DS=Process: Process Creation,Level=3,Alert=Command Ran over Admin Share" groupRelation="and">
				<CommandLine condition="contains">admin$</CommandLine>
				<CommandLine condition="excludes any">davclnt.dll</CommandLine>
				<ParentCommandLine condition="excludes any">WebClientGroup</ParentCommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Exploitation of Remote Services-->
			<!--MITRE ATT&CK TECHNIQUE: Internal Spearphishing-->
			<!--MITRE ATT&CK TECHNIQUE: Lateral Tool Transfer-->
			<!--MITRE ATT&CK TECHNIQUE: Remote Service Session Hijacking-->
			<!--MITRE ATT&CK TECHNIQUE: Remote Service Session Hijacking: RDP Hijacking-->
			<CommandLine name="Attack=T1563.002,Technique=RDP Hijacking,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Remote Desktop Shadow Alert,Risk=100" condition="contains any">/shadow;-shadow</CommandLine>
			<CommandLine name="Attack=T1563.002,Technique=RDP Hijacking,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Remote Desktop Shadow with no Consent alert" condition="contains">noConsentPrompt</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: Remote Services-->
			<Rule name="Attack=T1076,Technique=Remote Desktop Protocol,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=RDP Hijack Detected" groupRelation="and">
				<ParentImage name="Attack=T1076,Technique=Remote Desktop Protocol,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=RDP Hijack Detected,Risk=100" condition="image">tscon.exe</ParentImage>
				<CommandLine condition="contains">dest:rdp-tcp:</CommandLine>
			</Rule>
			<Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Powershell Executed via WMI from recent Emotet Variants,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains">powershell.exe</OriginalFileName>
				<ParentImage condition="image">WmiPrvSE.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Emotet Executed via WMI,Risk=100" groupRelation="and">
				<ParentImage condition="image">WmiPrvSE.exe</ParentImage>
				<Image condition="contains">\Users\</Image>
			</Rule>
			<Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=Network Detective System Scan Detected,Risk=100" groupRelation="and">
				<Image condition="contains">NetworkDetective</Image>
				<ParentImage condition="image">WmiPrvSE.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=Remote Tenable Malware Scan Detected,Risk=100" groupRelation="and">
				<Image condition="image">sc.exe</Image>
				<CommandLine condition="contains">tenable</CommandLine>
				<ParentImage condition="image">WmiPrvSE.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=CMD.exe Executed via WMI from recent Emotet Variants,Risk=100" groupRelation="and">
				<Image condition="image">cmd.exe</Image>
				<ParentImage condition="image">WmiPrvSE.exe</ParentImage>
				<CommandLine condition="excludes any">do_vbsUpload;Spiceworks</CommandLine>
			</Rule>
			<Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=regsvr32.exe Executed via WMI,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains">regsvr32.exe</OriginalFileName>
				<ParentImage condition="image">WmiPrvSE.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=CMD Executed via WMI,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains">cmd.exe</OriginalFileName>
				<ParentImage condition="image">WmiPrvSE.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Powershell Executed via WMI from recent Emotet Variants,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains">powershell.exe</OriginalFileName>
				<ParentImage condition="image">WmiPrvSE.exe</ParentImage>
			</Rule>
			<Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=RSAT Tool Launch,Risk=100" groupRelation="and">
				<CommandLine condition="contains">dsa.msc</CommandLine>
			</Rule>
			<Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=HyperV Remote Management Tool Launch,Risk=100" groupRelation="and">
				<CommandLine condition="contains">virtmgmt.msc</CommandLine>
			</Rule>
			<Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=Potential Malicious Remote WMI Execution Detected,Risk=100" groupRelation="and">
				<ParentImage condition="image">wmiprvse.exe</ParentImage>
				<Image condition="excludes">CompMgmtLauncher.exe</Image>
				<Image condition="excludes">DismHost.exe</Image>
				<Image condition="excludes">Microsoft.NET\Framework</Image>
				<Image condition="excludes">NetEvtFwdr.exe</Image>
				<Image condition="excludes">ServerManager.exe</Image>
				<Image condition="excludes">WerFault.exe</Image>
				<Image condition="excludes">chcp.com</Image>
				<Image condition="excludes">g2mupdate.exe</Image>
				<Image condition="excludes">slack.exe</Image>
			</Rule>
			<Rule name="Attack=T1021.006,Technique=Remote Services: Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=Suspicious Processes Spawned by WinRM,Risk=100" groupRelation="and">
				<ParentImage condition="image">wsmprovhost.exe</ParentImage>
				<Image condition="image">cmd.exe</Image>
				<Image condition="image">sh.exe</Image>
				<Image condition="image">bash.exe</Image>
				<Image condition="image">wsl.exe</Image>
				<Image condition="image">powershell.exe</Image>
				<Image condition="image">powershell_ise.exe</Image>
				<Image condition="image">schtasks.exe</Image>
				<Image condition="image">at.exe</Image>
				<Image condition="image">certutil.exe</Image>
				<Image condition="image">mshta.exe</Image>
				<Image condition="image">whoami.exe</Image>
				<Image condition="image">ping.exe</Image>
				<Image condition="image">ping.exe</Image>
				<Image condition="image">bitsadmin.exe</Image>
			</Rule>
			<Image name="Attack=T1021.006,Technique=Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=Windows Remote Management Execution" condition="end with">winrm.cmd</Image>
			<Image name="Attack=T1021.006,Technique=Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=WINRS remote shell execution,Risk=100" condition="image">winrs.exe</Image>
			<Image name="Attack=T1021.006,Technique=Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=WINRS remote shell execution,Risk=100" condition="image">winrshost.exe</Image>
			<Image name="Attack=T1021.006,Technique=Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=2,Alert=Waitfor.exe Execution bypass" condition="image">waitfor.exe</Image>
			<Image name="Attack=T1021.006,Technique=Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=Windows Remote Management execution" condition="image">wsmprovhost.exe</Image>
			<ParentImage name="Attack=T1021.006,Technique=Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=WINRS remote shell execution,Risk=100" condition="image">winrshost.exe</ParentImage>
			<ParentImage name="Attack=T1021.006,Technique=Windows Remote Management,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=Windows Remote Management execution" condition="image">wsmprovhost.exe</ParentImage>
			<Rule name="Attack=T1021.006,Technique=Remote WMIC/Execution,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Potential Malicious Document Execution,Risk=90" groupRelation="and">
				<ParentImage condition="image">wmiprvse.exe</ParentImage>
				<Image condition="image">mshta.exe</Image>
			</Rule>
			<Rule name="Attack=T1021.004,Technique=Remote Services,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Secure Shell Execution,Risk=80" groupRelation="and">
				<Image condition="contains any">ssh.exe;putty.exe;kitty.exe;kitty_portable.exe</Image>
			</Rule>
			<Product name="Attack=T1021.004,Technique=Remote Services,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=Putty utility detected,Risk=60">PuTTY suite</Product>
			<Rule name="Attack=T1021.004,Technique=Remote Services,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=Secure Shell FTP Execution,Risk=80" groupRelation="and">
				<Image condition="contains any">sftp;psftp</Image>
			</Rule>
			<Rule name="Attack=T1021.002,Technique=Remote Services,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Possible SMBExec via Metasploit,Risk=100" groupRelation="and">
				<CommandLine condition="is">rundll32.exe</CommandLine>
			</Rule>
			<Rule name="Attack=T1021.002,Technique=Remote Services,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Trickbot,Risk=100" groupRelation="and">
				<Image condition="image">rundll32.exe</Image>
				<CommandLine condition="contains all">..\;,</CommandLine>
			</Rule>
			<Rule name="Attack=T1021.002,Technique=Remote Services,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Trickbot 2,Risk=100" groupRelation="and">
				<Image condition="image">rundll32.exe</Image>
				<CommandLine condition="contains all">,StartW</CommandLine>
			</Rule>
			<Image name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Remote Shutdown with Psexec" condition="contains">psshutdown</Image>
			<Image name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Sysinternals PSService" condition="contains">psservice</Image>
			<Image name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=Sysinternals PsPasswd" condition="contains">PsPasswd</Image>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Remote Desktop" condition="image">mstsc.exe</Image>
			<Image name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=Telnet Terminal Emulator" condition="image">telnet.exe</Image>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=3,Alert=TFTP Execution" condition="image">tftp.exe</Image>
			<CommandLine name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Process: Process Creation,Level=3,Alert=IIS powershellcustomhost exec" condition="contains">powershellcustomhost</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: Remote Services: Distributed Component Object Model-->
			<Rule name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation" groupRelation="and">
				<ParentCommandLine condition="contains">-Embedding</ParentCommandLine>
				<ParentImage condition="is">c:\windows\system32\mmc.exe</ParentImage>
			</Rule>
			<CommandLine name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=4,Alert=CrackmapExec - Malicious Command Line events,Tactic=Privilege Escalation" condition="contains all">--execm;atexec</CommandLine>
			<CommandLine name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: Background Intelligent Transfer Control Class 1.0" condition="contains">{4991d34b-80a1-4291-83b6-3328366b9097}</CommandLine>
			<CommandLine name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: Excel.Application" condition="contains">{00020812-0000-0000-C000-000000000046}</CommandLine> 	  
			<CommandLine name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: HTML Application" condition="contains">{40AEEAB6-8FDA-41e3-9A5F-8350D4CFCA91}</CommandLine>
			<CommandLine name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: MMC20.APPLICATION" condition="contains">{7e0423cd-1119-0928-900c-e6d4a52a0715}</CommandLine>
			<CommandLine name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: Outlook.Application" condition="contains">{0006F04A-0000-0000-C000-000000000046}</CommandLine>
			<CommandLine name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: Powerpoint.Application" condition="contains">{048EB43E-2059-422F-95E0-557DA96038AF}</CommandLine>
			<CommandLine name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: Shell.Application" condition="contains">{13709620-C279-11CE-A49E-444553540000}</CommandLine>
			<CommandLine name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: ShellBrowserWindow" condition="contains">{c08afd90-f2a1-11d1-8455-00a0c91f3880}</CommandLine>
			<CommandLine name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: ShellWindows" condition="contains">9BA05972-F6A8-11CF-A442-00A0C90A8F39</CommandLine>
			<CommandLine name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: Visio.Application" condition="contains">{00021A20-0000-0000-C000-000000000046}</CommandLine>
			<CommandLine name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: WScript.Shell" condition="contains">{72C24DD5-D70A-438B-8A42-98424B88AFB8}</CommandLine>
			<CommandLine name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM: Word.Application" condition="contains">{00020906-0000-0000-C000-000000000046}</CommandLine>
			<CommandLine name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=Execution - Suspicious Cmdline - JScript Engine CLSID">{cc5bbec3-db4a-4bed-828d-08d78ee3e1ed}</CommandLine>
			<CommandLine name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=Execution - Unusual Scripting Engine in use - chakra.dll">{1b7cd997-e5ff-4932-a7a6-2a9e636da385}</CommandLine>
			<CommandLine name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=Execution - Unusual Scripting Engine in use - jscript9.dll">{16d51579-a30b-4c8b-a276-0ff4dc41e755}</CommandLine>
			<CommandLine name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=Rundll32 DCOM: CommandLine Execution" condition="contains any">rundll32.exe -sta;rundll32.exe /sta;rundll32 -sta;rundll32 /sta</CommandLine>
			<CommandLine name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=Rundll32 DCOM: CommandLine Execution" condition="contains all">shell32.dll;SHCreateLocalServerRunDll</CommandLine>
			<ParentCommandLine name="Attack=T1021.003,Technique=Distributed Component Object Model,Tactic=Lateral Movement,DS=Process: Process Creation,Level=0,Desc=DCOM Launch" condition="contains any">-k DcomLaunch;/k DcomLaunch</ParentCommandLine>
			<!--MITRE ATT&CK TECHNIQUE: Replication Through Removable Media-->
			<!--MITRE ATT&CK TECHNIQUE: Software Deployment Tools-->
			<!--MITRE ATT&CK TECHNIQUE: Taint Shared Content-->
			<!--MITRE ATT&CK TECHNIQUE: Use Alternate Authentication Material-->

			<!--MITRE ATT&CK TACTIC: Collection-->
			<!--MITRE ATT&CK TECHNIQUE: Adversary-in-the-Middle-->
			<!--MITRE ATT&CK TECHNIQUE: Archive Collected Data-->
			<Rule name="Attack=T1195,Technique=Archive Collected Data,Tactic=Collection,DS=Process: Process Creation,Level=4,Alert=Dark Halo Protected zip file creation,Risk=100" groupRelation="and">
				<Image condition="image">7z.exe</Image>
				<CommandLine condition="contains any">a -mx9 -r0 -p;a -v500m -mx9 -r0 -p</CommandLine>
			</Rule>
			<Rule name="Attack=T1195,Technique=Archive Collected Data,Tactic=Collection,DS=Process: Process Creation,Level=4,Alert=7z Renamed,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains">7z</OriginalFileName>
				<Image condition="excludes">7z</Image>
			</Rule>
			<Rule name="Attack=T1195,Technique=Archive Collected Data,Tactic=Collection,DS=Process: Process Creation,Level=4,Alert=Winrar Renamed,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains">winrar</OriginalFileName>
				<Image condition="excludes">winrar</Image>
			</Rule>
			<Rule name="Attack=T1195,Technique=Archive Collected Data,Tactic=Collection,DS=Process: Process Creation,Level=4,Alert=Winrar Renamed,Risk=100" groupRelation="and">
				<Product condition="contains">winrar</Product>
				<Image condition="excludes">winrar</Image>
			</Rule>
			<Rule name="Attack=T1195,Technique=Archive Collected Data,Tactic=Collection,DS=Process: Process Creation,Level=4,Alert=Winzip Renamed,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains">winzip</OriginalFileName>
				<Image condition="excludes">winzip</Image>
			</Rule>
			<Rule name="Attack=T1195,Technique=Archive Collected Data,Tactic=Collection,DS=Process: Process Creation,Level=4,Alert=Powershell Compress-Archive,Risk=100" groupRelation="and">
				<CommandLine condition="contains">Compress-Archive</CommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Audio Capture-->
			<CommandLine name="Attack=T1123,Technique=Audio Capture,Tactic=Collection,DS=Process: Process Creation,Level=4,Alert=Audio Capture Detected,Risk=100" condition="contains">WindowsAudioDevice-Powershell-Cmdlet</CommandLine>
			<CommandLine name="Attack=T1123,Technique=Audio Capture,Tactic=Collection,DS=Process: Process Creation,Level=4,Alert=Audio Capture Detected,Risk=100" condition="contains">SoundRecorder.exe</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: Automated Collection-->
			<!--MITRE ATT&CK TECHNIQUE: Browser Session Hijacking-->
			<!--MITRE ATT&CK TECHNIQUE: Clipboard Data-->
			<Image name="Attack=T1115,Technique=Clipboard Data,Tactic=Collection,DS=Process: Process Creation,Level=3,Alert=Data injected into clipboard,Risk=30" condition="image">clip.exe</Image>
			<CommandLine name="Attack=T1115,Technique=Clipboard Data,Tactic=Collection,DS=Process: Process Creation,Level=3,Alert=Data pulled from clipboard,Risk=40" condition="contains">get-clipboard</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: Data from Cloud Storage Object-->
			<!--MITRE ATT&CK TECHNIQUE: Data from Configuration Repository-->
			<!--MITRE ATT&CK TECHNIQUE: Data from Information Repositories-->
			<!--MITRE ATT&CK TECHNIQUE: Data from Local System-->
			<!--MITRE ATT&CK TECHNIQUE: Data from Network Shared Drive-->
			<!--MITRE ATT&CK TECHNIQUE: Data from Removable Media-->
			<!--MITRE ATT&CK TECHNIQUE: Data Staged-->
			<!--MITRE ATT&CK TECHNIQUE: Email Collection-->
			<Rule name="Attack=T1114,Technique=Email Collection,Tactic=Collection,DS=Process: Process Creation,Level=4,Alert=Possible Email Collection/Exfiltration,Risk=70" groupRelation="and">
				<CommandLine condition="contains">New-MailboxExportRequest</CommandLine>
			</Rule>
			<Rule name="Attack=T1114,Technique=Email Collection,Tactic=Collection,DS=Process: Process Creation,Level=4,Alert=New Exchange Management Role could be used for email exfiltration,Risk=70" groupRelation="and">
				<CommandLine condition="contains all">add-pssnapin;exchange;new-managementroleassignment;applicationimpersonation</CommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Input Capture-->
			<!--MITRE ATT&CK TECHNIQUE: Screen Capture-->
			<CommandLine name="Attack=T1001,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Screencapture Commands,Risk=100" condition="contains">screencapture</CommandLine>
			<CommandLine name="Attack=T1001,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Screencapture Commands,Risk=100" condition="contains">system.drawing.Imaging</CommandLine>			
			<CommandLine name="Attack=T1001,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Screencapture Commands,Risk=100" condition="contains">system.drawing.bitmap</CommandLine>
			<CommandLine name="Attack=T1001,Technique=Obfuscated Files or Information,Tactic=Defense Evasion,DS=Process: Process Creation,Level=4,Alert=Screencapture Commands,Risk=100" condition="contains">system.windows.forms.screen</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: Video Capture-->
			<!--MITRE ATT&CK TACTIC: Command and Control-->
			<!--MITRE ATT&CK TECHNIQUE: Application Layer Protocol-->
			<!--MITRE ATT&CK TECHNIQUE: Communication Through Removable Media-->
			<!--MITRE ATT&CK TECHNIQUE: Data Encoding-->
			<Rule name="Attack=T1132,Technique=Data Encoding,Tactic=Command and Control,DS=Process: Process Creation,Level=4,Alert=base64 encoded URL https or http offset,Risk=80" groupRelation="and">
				<CommandLine condition="contains any">odHRwczovL;aHR0cDovL;h0dHA6Ly;odHRwOi8v;aHR0cHM6Ly;h0dHBzOi8v</CommandLine>
				<Image condition="excludes any">ie_to_edge_stub.exe;chrome.exe;firefox.exe;iexplore.exe;brave.exe;vivaldi.exe;msedge.exe;webex;teams.exe;goto opener.exe;lynx.exe;\Webex\webexAppLauncherLatest.exe;\WebEx\webexAppLauncher.exe;\WebEx\Applications\webexAppLauncher.exe;WebEx\webex.exe</Image>
				<CommandLine condition="excludes any">wbx:;/SITE_TOKEN=;msteams:;PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48cmVxdWVzdCBwcm90b2NvbD0iMy4wIiB1cGRhdGVyPSJPbWFoYSI</CommandLine>
				<OriginalFileName condition="excludes any">msedgeupdate.dll</OriginalFileName>
			</Rule>
			<Rule name="Attack=T1132,Technique=Data Encoding,Tactic=Command and Control,DS=Process: Process Creation,Level=4,Alert=Double Base64 encoded executable,Risk=90" groupRelation="and">
				<CommandLine condition="contains any">VFZvQUFBQ;RWb0FBQU;UVm9BQUFB;VFZxQUFBR;RWcUFBQU;UVnFBQUFF;VFZwUUFBS;RWcFFBQU;UVnBRQUFJ;VFZxUUFBT;RWcVFBQU;UVnFRQUFN;VFZwVEFRR;RWcFRBUU;UVnBUQVFF</CommandLine>
			</Rule>
			<Rule name="Attack=T1132,Technique=Data Encoding,Tactic=Command and Control,DS=Process: Process Creation,Level=4,Alert=base64 encoded powershell" groupRelation="and">
				<Image condition="image">powershell.exe</Image>
				<CommandLine condition="contains any">AAAAYInlM;OiCAAAAYInlM;OiJAAAAYInlM;RwBlAHQAL;WwBOAGUAdAAuAFM;W05ldC5TZXJ2aWNl</CommandLine>
			</Rule>
			<Rule name="Attack=T1132,Technique=Data Encoding,Tactic=Command and Control,DS=Process: Process Creation,Level=4,Alert=Cyrillic Letter obfuscation,Risk=100" groupRelation="and">
				<CommandLine condition="contains any">Г;И;К;П;д;и;к;л;л;н;н;о;ф;ե;թ;յ;ն;ն;ն;ն;տ;ւ;ք</CommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Data Obfuscation-->
			<!--MITRE ATT&CK TECHNIQUE: Dynamic Resolution-->
			<!--MITRE ATT&CK TECHNIQUE: Encrypted Channel-->
			<!--MITRE ATT&CK TECHNIQUE: Fallback Channels-->
			<!--MITRE ATT&CK TECHNIQUE: Ingress Tool Transfer-->
			<Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Process: Process Creation,Level=4,Alert=Certutil file transfer,Risk=100" groupRelation="and">
				<Image condition="image">certutil.exe</Image>
				<CommandLine condition="contains all">urlcache;split;f</CommandLine>
			</Rule>
			<Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Process: Process Creation,Level=4,Alert=Command Line file transfer,Risk=100" groupRelation="and">
				<CommandLine condition="contains any">DownloadFile;DownloadString;Net.WebClient;System.Net.WebRequest;System.Net.SecurityProtocolType;Invoke-Expression;Invoke-WebRequest</CommandLine>
				<Image condition="contains any">powershell.exe;cmd.exe</Image>
			</Rule>
			<Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Process: Process Creation,Level=4,Alert=BitsAdmin File Transfers,Risk=70" groupRelation="and">
				<OriginalFileName condition="is">bitsadmin.exe</OriginalFileName>
				<CommandLine condition="contains any">CREATE;TRANSFER;DOWNLOAD;UPLOAD;ADDFILE;SetNotifyFlags;SetNotifyCmdLine;SetMinRetryDelay;SetCustomHeaders;RESUME</CommandLine>
				<CommandLine condition="excludes all">util;setieproxy;localsystem;AUTODETECT</CommandLine>
			</Rule>
			<Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Process: Process Creation,Level=4,Alert=BitsAdmin File Transfers 2,Risk=70" groupRelation="and">
				<Description condition="contains">BITS administration utility</Description>
				<CommandLine condition="contains any">CREATE;TRANSFER;DOWNLOAD;UPLOAD;ADDFILE;SetNotifyFlags;SetNotifyCmdLine;SetMinRetryDelay;SetCustomHeaders;RESUME</CommandLine>
			</Rule>
			<Rule name="Attack=T1105,Tactic=Command And Control,Technique=Ingress Tool Transfer,DS=Process: Process Creation,Level=4,Alert=Linux Ingress transfer tools on Windows,Risk=30" groupRelation="and">
				<Image condition="contains any">\curl.exe;\wget.exe;\www.exe</Image>
			</Rule>
			<Rule name="Attack=T1105,Tactic=Command And Control,Technique=Ingress Tool Transfer,DS=Process: Process Creation,Level=4,Alert=Linux Ingress transfer tools on Windows,Risk=30" groupRelation="and">
				<Image condition="contains any">\curl.exe;\wget.exe;\www.exe</Image>
			</Rule>
			<Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=Certutil file download 1,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains">certutil</OriginalFileName>
				<CommandLine condition="contains all">split;f</CommandLine>
			</Rule>
			<Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=Certutil file download 2,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains">certutil</OriginalFileName>
				<CommandLine condition="contains any">verifyctl;URL</CommandLine>
			</Rule>
			<Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=Potential Ingress Tool Transfer and tool usage within suspicious folders,Risk=100" groupRelation="and">
				<CurrentDirectory condition="contains any">C:\Perflogs\;C:\Users\Public\;C:\root\</CurrentDirectory>
			</Rule>
			<Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=Potential Ingress Tool Transfer and tool usage within suspicious folders,Risk=100" groupRelation="and">
				<Image condition="contains any">C:\Perflogs\;C:\Users\Public\;C:\root\</Image>
			</Rule>
			<CommandLine name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=BitsAdmin File Transfers,Risk=70" condition="image">start-bitstransfer</CommandLine>
			<CommandLine name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=Expand File copy,Risk=70" condition="contains">expand \\</CommandLine>
			<CommandLine name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=Expand File copy,Risk=70" condition="contains">expand.exe \\</CommandLine>
			<CommandLine name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=Ingress Tool Transfer with ieexec,Risk=70" condition="contains">ieexec http</CommandLine>
			<CommandLine name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=Ingress Tool Transfer with ieexec,Risk=70" condition="contains">ieexec.exe http</CommandLine>
			<CommandLine name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=Ingress Tool Transfer with Powercat,Risk=100" condition="contains">powercat</CommandLine>
			<CommandLine name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=esentutl Ingress Tool Transfer,Risk=70" condition="contains any">esentutl /y \\;esentutl -y \\</CommandLine>
			<CommandLine name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=esentutl Ingress Tool Transfer,Risk=70" condition="contains any">esentutl.exe /y \\;esentutl.exe -y \\</CommandLine>
			<CommandLine name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=extrac32 Ingress Tool Transfer,Risk=70" condition="contains">extrac32 \\</CommandLine>
			<CommandLine name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=extrac32 Ingress Tool Transfer,Risk=70" condition="contains">extrac32.exe \\</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: Multi-Stage Channels-->
			<!--MITRE ATT&CK TECHNIQUE: Non-Application Layer Protocol-->
			<!--MITRE ATT&CK TECHNIQUE: Non-Standard Port-->
			<!--MITRE ATT&CK TECHNIQUE: Protocol Tunneling-->
			<!--MITRE ATT&CK TECHNIQUE: Proxy-->
			<CommandLine name="Attack=T1090,Technique=Connection Proxy,Tactic=Command and Control,DS=Process: Process Creation,Level=4,Alert=NetSH PortProxy,Risk=70" condition="contains">portproxy</CommandLine>
			<Image name="Attack=T1090.003,Technique=Proxy: Multi-hop Proxy,Tactic=Command and Control,DS=Process: Process Creation,Level=4,Alert=Tor Detected,Risk=100" condition="image">tor.exe</Image>
			<!--MITRE ATT&CK TECHNIQUE: Remote Access Software-->
			<Image name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Process: Process Creation,Level=0,Desc=Teamviewer Unattended Session" condition="image">TeamViewer_Desktop.exe</Image>
			<Rule name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Process: Process Creation,Level=4,Alert=PSExec Command,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains any">psexec</OriginalFileName>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
			<!--MITRE ATT&CK TECHNIQUE: Web Service-->

			<!--MITRE ATT&CK TACTIC: Exfiltration-->
			<Rule name="Attack=T1020,Technique=Automated Exfiltration,Tactic=Exfiltration,DS=Process: Process Creation,Level=0,Desc=SCP Data exfiltration detected,Risk=100" groupRelation="and">
				<Image condition="contains any">winscp.exe;winscp.com;scp.exe;pscp</Image>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Automated Exfiltration-->
			<Rule name="Attack=T1020,Technique=Automated Exfiltration,Tactic=Impact,DS=Process: Process Creation,Level=0,Desc=Data exfiltration Tool detected 3,Risk=100" groupRelation="and">
				<CommandLine condition="contains any">bitch.exe;bitch.bat;bitch_lasagna.exe;Admin Cracker.exe;BulletsPassView.exe;ChromePass.exe;Dialupass.exe;LSASecretsView.exe;OpenedFilesView.exe;OperaPassView.exe;PasswordFox.exe;ProduKey.exe;RouterPassView.exe;USBDeview.exe;USBStealer.exe;VNCPassView.exe;WebBrowserPassView.exe;WirelessKeyView.exe;WirelessKeyView.exe;empv.exe;netpass.exe;pspv.exe;usbdll.exe;rdpv.exe;WirelessKeyView.exe;lasagna.exe;all -vvv &gt;&gt;;rsync -r</CommandLine>
			</Rule>
			<Rule name="Attack=T1020,Technique=Automated Exfiltration,Tactic=Impact,DS=Process: Process Creation,Level=0,Desc=CredsLeaker exfiltration tool detected,Risk=100" groupRelation="and">
				<CommandLine condition="contains any">CredsLeaker;Windows.Security.Credentials.UI.CredentialPicker;function Leaker;function Await</CommandLine>
			</Rule>
			<Rule name="Attack=T1020,Technique=Automated Exfiltration,Tactic=Impact,DS=Process: Process Creation,Level=0,Desc=merlin CnC exfiltration detected 4,Risk=100" groupRelation="and">
				<CommandLine condition="contains any">.exe -url https://;dll,Run https://;Invoke-Merlin;-m SimpleHTTPServer;/m SimpleHTTPServer</CommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Data Transfer Size Limits-->
			<!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Alternative Protocol-->
			<Rule name="Attack=T1048,Technique=Exfiltration Over Alternative Protocol,Tactic=Exfiltration,DS=Process: Process Creation,Level=4,Alert=DNS Exfil detected,Risk=100" groupRelation="and">
				<CommandLine condition="contains any">-q=txt;/q=txt</CommandLine>
				<Image condition="image">nslookup.exe</Image>
			</Rule>
			<Rule name="Attack=T1567.002,Technique=Exfiltration to Cloud Storage,Tactic=Exfiltration,DS=Process: Process Creation,Level=4,Alert=Rclone detected,Risk=100" groupRelation="or">
				<OriginalFileName condition="contains any">rclone</OriginalFileName>
				<Description condition="contains any">Rsync for cloud storage</Description>
				<Product condition="contains any">rclone</Product>
				<Company condition="contains any">rclone</Company>
				<Image condition="contains any">\rclone</Image>
			</Rule>
			<Rule name="Attack=T1048,Technique=Exfiltration Over Alternative Protocol,Tactic=Exfiltration,DS=Process: Process Creation,Level=4,Alert=S3browser detected,Risk=100" groupRelation="or">
				<OriginalFileName condition="contains any">s3browser</OriginalFileName>
				<Description condition="contains any">s3browser</Description>
				<Product condition="contains any">s3browser</Product>
				<Image condition="contains any">s3browser</Image>
			</Rule>
			<Rule name="Attack=T1048,Technique=Exfiltration Over Alternative Protocol,Tactic=Exfiltration,DS=Process: Process Creation,Level=4,Alert=FTP exfiltration detected,Risk=100" groupRelation="or">
				<CommandLine condition="contains any">add-ftp;.UploadFile(</CommandLine>
				<Image condition="contains any">ftp.exe</Image>
			</Rule>
			<Rule name="Attack=T1048,Tactic=Exfiltration,Technique=Exfiltration to Cloud Storage,DS=Process: Process Creation,Level=0,Desc=Webdav Share Mounted" groupRelation="and">
				<Image condition="image">rundll32.exe</Image>
				<CommandLine condition="contains all">davclnt.dll;DavSetCookie</CommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Exfiltration Over C2 Channel-->
			<!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Other Network Medium-->
			<!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Physical Medium-->
			<!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Web Service-->

			<!--MITRE ATT&CK TECHNIQUE: Scheduled Transfer-->
			<!--MITRE ATT&CK TECHNIQUE: Transfer Data to Cloud Account-->

			<!--MITRE ATT&CK TACTIC: Impact-->
			<Rule name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Possible Ransomware Command Detected,Risk=100" groupRelation="and">
				<Image condition="image">bcdedit.exe</Image>
				<CommandLine condition="contains">safeboot</CommandLine>
			</Rule>
			<Rule name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Possible Ransomware Command Detected,Risk=100" groupRelation="and">
				<Image condition="image">bootcfg.exe</Image>
				<CommandLine condition="contains">safeboot</CommandLine>
			</Rule>
			<Rule name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Possible Ransomware Virtual Machine,Risk=60" groupRelation="and">
				<CommandLine condition="contains any">-startvm;vrun.exe -vm</CommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Account Access Removal-->
			<!--MITRE ATT&CK TECHNIQUE: Data Destruction-->
			<Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Data Destruction with vssadmin Detected,Risk=100" groupRelation="and">
				<Image condition="image">vssadmin.exe</Image>
				<CommandLine condition="contains any">delete;resize</CommandLine>
			</Rule>
			<Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Data Destruction with wmic shadowcopy delete Detected,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains">wmic.exe</OriginalFileName>
				<CommandLine condition="contains all">shadowcopy;delete</CommandLine>
			</Rule>
			<Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Data Destruction with wbadmin Detected,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains">wbadmin.exe</OriginalFileName>
				<CommandLine condition="contains all">SYSTEMSTATEBACKUP;delete</CommandLine>
			</Rule>
			<Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Data Destruction with wmic shadowstorage Detected,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains">wmic.exe</OriginalFileName>
				<CommandLine condition="contains">wmic shadowstorage SET MaxSpace=</CommandLine>
			</Rule>
			<Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Destructive WMIC Commands Detected,Risk=100" groupRelation="and">
				<OriginalFileName condition="contains">wmic.exe</OriginalFileName>
				<CommandLine condition="contains any">cleareventlog;call disable;nteventlog where filename</CommandLine>
			</Rule>
			<Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=0,Alert=Data Destruction with diskpart" groupRelation="and">
				<OriginalFileName condition="contains">diskpart.exe</OriginalFileName>
				<CommandLine condition="contains any">format;clean;delete;remove</CommandLine>
			</Rule>
			<Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=0,Alert=Data Destruction with manage-bde.exe" groupRelation="and">
				<OriginalFileName condition="contains">manage-bde.exe</OriginalFileName>
				<CommandLine condition="contains any">changepin;changepassword;changekey;wipefreespace;lock;/on;-on;/off;-off;-add;/add;-pw;/pw</CommandLine>
			</Rule>
			<Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=0,Alert=Data Destruction with manage-bde.wsf" groupRelation="and">
				<CommandLine condition="contains">manage-bde.wsf</CommandLine>
				<CommandLine condition="contains any">changepin;changepassword;changekey;wipefreespace;lock;/on;-on;/off;-off;-add;/add;-pw;/pw</CommandLine>
			</Rule>
			<CommandLine name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=3,Alert=Data Destruction with format" condition="begin with">format </CommandLine>
			<CommandLine name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=3,Alert=Data Destruction with format" condition="begin with">format </CommandLine>
			<CommandLine name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Data Destruction with bcdedit Detected,Risk=100" condition="contains">bootstatuspolicy ignoreallfailures</CommandLine>
			<CommandLine name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Data Destruction with bcdedit Detected,Risk=100" condition="contains">recoveryenabled No</CommandLine>
			<CommandLine name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Data Destruction with get-wmiobject Detected,Risk=100" condition="contains">Win32_Shadowcopy</CommandLine>
			<CommandLine name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Data Destruction with sdelete Detected,Risk=100" condition="contains">sdelete</CommandLine>
			<CommandLine name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Data Destruction with wbadmin Detected,Risk=100" condition="contains">delete catalog</CommandLine>
			<CommandLine name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Data Destruction with wbadmin Detected,Risk=100" condition="contains">wbadmin delete catalog</CommandLine>
			<CommandLine name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=0,Desc=Data Destruction with erase Detected,Risk=100" condition="contains">erase</CommandLine>
			<CommandLine name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=2,Alert=vShadow Commands" condition="contains">-nw -exec=</CommandLine>
			<CommandLine name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Alert=vShadow Commands" condition="contains">-p -nw</CommandLine>
			<Image name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Data Destruction with shred Detected,Risk=100" condition="contains">shred</Image>
			<ParentImage name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Diskshadow Execution,Risk=70" condition="contains">diskshadow</ParentImage>
			<Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=3,Alert=Command Line File Deletion,Risk=100" groupRelation="or">
				<CommandLine condition="contains all"> del ; /f </CommandLine>
				<CommandLine condition="contains all"> del ; -f </CommandLine>
				<CommandLine condition="contains all"> rmdir ; /s ; /q </CommandLine>
				<CommandLine condition="contains all"> rmdir ; -s ; -q </CommandLine>
				<CommandLine condition="contains all"> rd ; /s ; /q </CommandLine>
				<CommandLine condition="contains all"> rd ; -s ; -q </CommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Data Encrypted for Impact-->
			<CommandLine name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=Process: Process Creation,Level=3,Alert=Potential Ransomware indicator" condition="contains">usn deletejournal</CommandLine>
			<!--MITRE ATT&CK TECHNIQUE: Data Manipulation-->
			<!--MITRE ATT&CK TECHNIQUE: Defacement-->
			<!--MITRE ATT&CK TECHNIQUE: Disk Wipe-->
			<Rule name="Attack=T1107,Technique=File Deletion,Tactic=Defense Evasion,DS=Process: Process Creation,Level=3,Alert=FSUtil USN Journal Deletion,Risk=60" groupRelation="and">
				<Image condition="image">fsutil.exe</Image>
				<CommandLine condition="contains">deletejournal</CommandLine>
				<CommandLine condition="contains">usn</CommandLine>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Endpoint Denial of Service-->
			<!--MITRE ATT&CK TECHNIQUE: Firmware Corruption-->
			<!--MITRE ATT&CK TECHNIQUE: Inhibit System Recovery-->
			<!--MITRE ATT&CK TECHNIQUE: Network Denial of Service-->
			<!--MITRE ATT&CK TECHNIQUE: Resource Hijacking-->
			<!--MITRE ATT&CK TECHNIQUE: Service Stop-->
			<!--MITRE ATT&CK TECHNIQUE: System Shutdown/Reboot-->
			<CommandLine name="Attack=T1059,Technique=Command-Line Interface,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Malicious Keywords from Exploitation Frameworks,Author=Florian Roth" condition="contains any">AdjustTokenPrivileges;IMAGE_NT_OPTIONAL_HDR64_MAGIC;LSA_UNICODE_STRING;Management.Automation.RuntimeException;Metasploit;Microsoft.Win32.UnsafeNativeMethods;Mimikatz;MiniDumpWriteDump;Net.Sockets.SocketFlags;PAGE_EXECUTE_READ;ReadProcessMemory.Invoke;Reflection.Assembly;Runtime.InteropServices;SECURITY_DELEGATION;SE_PRIVILEGE_ENABLED;System.Runtime.InteropServices;System.Security.Cryptography;TOKEN_ADJUST_PRIVILEGES;TOKEN_ALL_ACCESS;TOKEN_ASSIGN_PRIMARY;TOKEN_DUPLICATE;TOKEN_ELEVATION;TOKEN_IMPERSONATE;TOKEN_INFORMATION_CLASS;TOKEN_PRIVILEGES;TOKEN_QUERY;powerkatz</CommandLine>
			<!--Crypto Currency Miner Detections-->
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=4,Alert=Crypto Currency Miner Detected,Attack=T1496,Technique=Resource Hijacking,Tactic=Impact" groupRelation="or">
				<CommandLine condition="contains any">ahashpool;blazepool;blockmasters;blockmasterscoins;ccminer;cgminer;coinhive;hashrefinery;minergate;miningpoolhubcoins;nicehash;poolname;poolpassword;poolurl;rainbowminer;sgminer;stratum+tcp;xmrMiner;xmrig;yiimp;zergpool;zergpoolcoins;zpool</CommandLine>
				<Description condition="contains any">CPU miner;GPU miner;Lime Miner;XMRig CPU miner; miner</Description>
			</Rule>
			<Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=Process: Process Creation,Level=4,Alert=Solarwinds/FireEye sunburst hashes,Risk=100" groupRelation="and">
				<Hashes condition="contains any">b91ce2fa41029f6955bff20079468448;02af7cec58b9a5da1c542b5a32151ba1;2c4a910a1299cdae2a4e55988a2f102e;846e27a652a5e1bfbd0ddd38a16dc865;4f2eb62fa529c0283b28d05ddd311fae;56ceb6d0011d87b6e4d7023d7ef85676</Hashes>
			</Rule>
			<Hashes condition="end with" name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=plink.exe 64bit imphash matched,Risk=40">87AECF008D87EC86EC8B00A2394B3E6C</Hashes>
			<Hashes condition="end with" name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=plunk.exe 32bit imphash matched,Risk=40">FB3F0D0DE8B80EA8CFAB2A025EC6B833</Hashes>
			<Hashes condition="end with" name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=putty.exe 64bit imphash matched,Risk=40">F4067FBF7FFF6945D0BB485B727B39AA</Hashes>
			<Hashes name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Generic APT Hash Detection,Risk=100" condition="contains any">4a069c1abe5aca148d5a8fdabc26751e;c96ed56bf7ee85a4398cc43a98b4db86d3da311c619f17c8540ae424ca6546e1;304772c80b157a916c7041f2f15939fb;291ff87948e45914424cec9510c297da;a4b42c2c95d1f2ff12171a01c86cd64f;98908ce6f80ecc48628c8d2bf5b2a50c;849a2b0dc80aeca3d175c139efe5221c;807d86da63f0db1fc746d1f0b05bc357;322cb39bc049aa69136925137906d855;86A4CAC227078B9C95C560C8F0370BF0;36dd195269979e01a29e37c488928497;7d9d29c1c03461608bcab930fef2f568;eac3e3ece94bc84e922ec077efb15edd;b4abe604916c04fe3dd8b9cb3d501d3f;88777aacd5f16599547926a4c9202862;128CECC59C91C0D0574BC1075FE7CB40;17a36ac3e31f3a18936552aff2c80249;0f49621b06f2cdaac8850c6e9581a594;3d129263f6a48647f103a04446fb0c2f;71345b139166482acaa568ac8816c7bc;1b60021baedc3f9201bcdb40e9b87f62;5E022694C0DBD1FBBC263D608E577949;cd4b9d0f2d1c0468750855f0ed352c1ed6d4f512d66e0e44ce308688235295b5;b017b9fc2484ce0a5629ff1fed15bca9f62f942eafbb74da6a40f40337187b04;2010f38ef300be4349e7bc287e720b1ecec678cacbf0ea0556bcf765f6e073ec;6a251ed6a2c6a0a2be11f2a945ec68c814d27e2b6ef445f4b2c7a779620baa11;5b102bf4d997688268bab45336cead7cdf188eb0d6355764e53b4f62e1cdf30c;37cd353621b0f4fc6981b50071c94f01;daf2da52475fd8981b19ec3c321a983c;afcdf79be1557326c854b6e20cb900a7;2f40abbb4f78e77745f0e657a19903fc953cc664;37b4496e650b3994312c838435013560b3ca8571;478dc5a5f934c62a9246f7d1fc275868f568bc07;1a2ab4df156ccd685f795baee7df49f8e701f271d3e5676b507112e30ce03c42;2c1d3d0a9c6f76726994b88589219cb8d9c39dd9924bc8d2d02bf41d955fe326;5c776a33568f4c16fee7140c249c0d2b1e0798a96c7a01bfd2d5684e58c9bb32;5fc4b0076eac7aa7815302b0c3158076e3569086c4c6aa2f71cd258238440d14;08c34c6ac9186b61d9f29a77ef5e618067e0bc9fe85cab1ad25dc6049c376949;758598370c3b84c6fbb452e3d7119f700f970ed566171e879d3cb41102154272;bef59b9a3e00a14956e0cd4a1f3e7524448cbe5d3cc1295d95a15b83a3579c59;c96ed56bf7ee85a4398cc43a98b4db86d3da311c619f17c8540ae424ca6546e1;c96ed56bf7ee85a4398cc43a98b4db86d3da311c619f17c8540ae424ca6546e1;e8542c07b2af63ee7e72ce5d97d91036c5da56e2b091aa2afe737b224305d230;0ac48cfa2ff8351365e99c1d26e082ad;0e9afd3a870906ebf34a0b66d8b07435;1aadf739782afcae6d1c3e4d1f315cbd;2a6f7ec77ab6bd4297e7b15ae06e2e61;3a771efb7ba2cd0df247ab570e1408b2;3d75c72144d873b3c1c4977fbafe9184;3dfebce4703f30eed713d795b90538b5;3ffd2915d285ad748202469d4a04e1f5;4e39620afca6f60bb30e031ddc5a4330;6cfd131fef548fcd60fbcdb59317df8e;7bcd736a2394fc49f3e27b3987cce640;7bfba2c69bed6b160261bdbf2b826401;7bfbd72441e1f2ed48fbc0f33be00f24;7c733607a0932b1b9a9e27cd6ab55fe0;7d5265e814843b24fcb3787768129040;08e82dc7bae524884b7dc2134942aadb;8da15a97eaf69ff7ee184fc446f19cf1;9ad6fa6fdedb2df8055b3d30bd6f64f1;9c115e9a81d25f9d88e7aaa4313d9a8f;16ab79fb2fd92db0b1f38bedb2f02ed8;21feb6aa15e02bb0cddbd544605aabad;21feb6aa15e02bb0cddbd544605aabad;22d142f11cf2a30ea4953e1fffb0fa7e;36db24006e2b492cafb75f2663f241b2;51a7068640af42c3a7c1b94f1c11ab9d;69a19abf5ba56ee07cdd3425b07cf8bf;72dc98449b45a7f1ccdef27d51e31e91;77a745b07d9c453650dd7f683b02b3ed;80c37e062aa4c94697f287352acf2e9d;92f8e3f0f1f7cc49fad797a62a169acd;235d427f94630575a4ea4bff180ecf5d;320b2f1d9551b5d1df4fb19bd9ab253a;490a140093b5870a47edc29f33542fd2;520ee02668a1c7b7c262708e12b1ba6b;649ef1dd4a5411d3afcf108d57ff87af;684eca6b62d69ce899a3ec3bb04d0a5b;815f1f8a7bc1e6f94cb5c416e381a110;0969b2b399a8d4cd2d751824d0d842b4;2317d65da4639f4246de200650a70753;04078ef95a70a04e95bda06cc7bec3fa;8035a8a143765551ca7db4bc5efb5dfd;8403a28e0bffa9cc085e7b662d0d5412;9003cfaac523e94d5479dc6a10575e60;9793afcea43110610757bd3b800de517;27612cb03c89158225ca201721ea1aad;44619a88a6cff63523163c6a4cf375dd;061089d8cb0ca58e660ce2e433a689b3;81229c1e272218eeda14892fa8425883;84730a6e426fbd3cf6b821c59674c8a0;533340c54bd25256873b3dca34d7f74e;57314359df11ffdf476f809671ec0275;99828721ac1a0e32e4582c3f615d6e57;412956675fbc3f8c51f438c1abc100eb;5985087678414143d33ffc6e8863b887;a43d3b31575846fa4c3992b4143a06da;a571660c9cf1696a2f4689b2007a12c7;b4e67706103c3b8ee148394ebee3f268;b9c208ea8115232bfd9ec2c62f32d6b8;b9cf4301b7b186a75e82a04e87b30fe4;b72737b464e50aa3664321e8e001ff32;bfe3f6a79cad5b9c642bb56f8037c43b;c0e72eb4c9f897410c795c1b360090ef;c1e7850da5604e081b9647b58248d7e8;c3e255888211d74cc6e3fb66b69bbffb;cacaa3bf3b2801956318251db5e90f3c;cdb303f61a47720c7a8c5086e6b2a743;ce8ce92fb6565181572dce00d69c24f8;d8f1356bebda9e77f480a6a60eab36bb;d9e9f22988d43d73d79db6ee178d70a4;d5377dc1821c935302c065ad8432c0d2;df91b86189adb0a11c47ce2405878fa1;e17bd40f5b5005f4a0c61f9e79a9d8c2;f559c87b4a14a4be1bd84df6553aaf56;fc53f2cd780cd3a01a4299b8445f8511;ffc7305cb24c1955f9625e525d58aeee</Hashes>
			<Hashes name="Attack=T1353,Technique=Post Compromise Tool Development,Tactic=Build Capabilities,DS=Process: Process Creation,Level=4,Alert=Windows Credential Editor Detection,Risk=70" condition="contains any">e96a73c7bf33a464c510ede582318bf2;a53a02b997935fd8eedcb5f7abab9b9f</Hashes>
			<Hashes name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Ransomware Hash Detection,Risk=100" condition="contains any">d326e629a90e78825645963b35e53a6a;c579341f86f7e962719c7113943bb6e4;dc5733c013378fa418d13773f5bfe6f1;b8fcd4a3902064907fb19e0da3ca7aed72a7e6d1f94d971d1ee7a4d3af6a800d;965884f19026913b2c57b8cd4a86455a61383de01dabb69c557f45bb848f6c26;4a069c1abe5aca148d5a8fdabc26751e;dc7e564809d6c2a2f3457c3c9b91f22b;FE2CA1BE3BDA2A757036A89E54CC02DB;5470f0644589685000154cb7d3f60280acb16e39ca961cce2c016078b303bc1b</Hashes>
			<Hashes name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=Process: Process Creation,Level=4,Alert=Ursniff Bank Malware,Risk=100" condition="contains">53841a0c6a3ff92976db08bfdf95e083</Hashes>
			<!--UEBA Activities-->
			<Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Zoom: passwordless meeting Start,Risk=30" groupRelation="and">
				<CommandLine condition="contains">zoommtg</CommandLine>
				<CommandLine condition="excludes">pwd=</CommandLine>
			</Rule>
			<Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Zoom: Video and Audio Session Start" groupRelation="and">
				<CommandLine condition="contains">zoommtg</CommandLine>
				<CommandLine condition="contains">zc=0</CommandLine>
			</Rule>
			<Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Zoom: Screen Share,Risk=70" groupRelation="and">
				<CommandLine condition="contains">zoommtg</CommandLine>
				<CommandLine condition="contains">zc=1</CommandLine>
			</Rule>
			<Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Microsoft Teams URL clicked" groupRelation="and">
				<CommandLine condition="contains">msteams:</CommandLine>
			</Rule>
			<Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Webex URL clicked" groupRelation="and">
				<CommandLine condition="contains">wbx:</CommandLine>
			</Rule>
			<Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Executed files within Downloads,Risk=30" groupRelation="and">
				<Image condition="contains">C:\Users\</Image>
				<Image condition="contains">\Downloads\</Image>
			</Rule>
			<Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Executed files on Desktop,Risk=10" groupRelation="and">
				<Image condition="contains">C:\Users\</Image>
				<Image condition="contains">\Desktop\</Image>
			</Rule>
			<Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Linux tools installed on windows,Risk=30" groupRelation="and">
				<Image condition="contains any">\awk.exe;\sed.exe</Image>
			</Rule>
			<Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Suspicious Execution Locations,Risk=30" groupRelation="and">
				<Image condition="contains any">C:\Users\Public\;$Recyclebin;\Desktop\;\Content.Outlook\</Image>
			</Rule>
			<Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=3,Desc=Suspicious Execution extensions,Risk=30" groupRelation="and">
				<Image condition="contains any">C:\Users\Public\;$Recyclebin;\Desktop\;\Content.Outlook\;\Downloads\</Image>
				<CommandLine condition="contains any">.html;.hta;.iso;.js;.bat;.cmd;.cmdline;.vbs;.vb;.vbe;.reg;.com</CommandLine>
			</Rule>
			<CommandLine condition="contains">listena</CommandLine>
			<CommandLine name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=LOLBins" condition="contains any">-s -n -u -i:http:</CommandLine>
			<CommandLine name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=LOLBins" condition="contains any">/s /n /u /i:http:</CommandLine>
			<CommandLine name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Interesting Command Line Events" condition="begin with">assoc </CommandLine>
			<CommandLine name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Interesting Command Line Events" condition="begin with">del </CommandLine>
			<CommandLine name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Interesting Command Line Events" condition="begin with">expand </CommandLine>
			<CommandLine name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Interesting Command Line Events" condition="begin with">md </CommandLine>
			<CommandLine name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Interesting Command Line Events" condition="begin with">move </CommandLine>
			<CommandLine name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Interesting Command Line Events" condition="begin with">rd </CommandLine>
			<CommandLine name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Interesting Command Line Events" condition="begin with">ren </CommandLine>
			<CommandLine name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Interesting Command Line Events" condition="begin with">set </CommandLine>
			<CommandLine name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Interesting Command Line Events" condition="begin with">setx </CommandLine>
			<CommandLine name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Interesting Command Line Events" condition="contains any">bginfo.bgi /popup /nolicprompt;bginfo.bgi -popup -nolicprompt</CommandLine>
			<CommandLine name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Interesting Command Line Events" condition="image">find.exe</CommandLine>
			<CommandLine name="Attack=T1595,Technique=Hacking,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=FireEye/Fin6 Hacking tools" condition="contains">grabff</CommandLine>
			<CommandLine name="Attack=T1595,Technique=Hacking,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=FireEye/Fin6 Hacking tools" condition="contains">routerscan</CommandLine>
			<CommandLine name="Attack=T1059.006,Technique=Command and Scripting Interpreter: Python,Tactic=Execution,DS=Process: Process Creation,Level=3,Alert=Hacking with python,Risk=70" condition="contains">pythonEngine.Execute</CommandLine>
			<CommandLine name="Attack=T1059.006,Technique=Command and Scripting Interpreter: Python,Tactic=Execution,DS=Process: Process Creation,Level=4,Alert=Hacking with session hijacking,Risk=100" condition="contains">sesshijack</CommandLine>
			<CommandLine name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=File Protocol Handler Execution" condition="contains">file://</CommandLine>
			<Description name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=HTML APP Host" condition="end with">HTML Application host</Description>
			<Description name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Manager Profile Installer" condition="end with">Manager Profile Installer</Description>
			<Description name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Microsoft Application Virtualization Injector" condition="contains">Microsoft Application Virtualization Injector</Description>
			<Description name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=App Compat Database installer" condition="contains">Application Compatibility Database Installer</Description>
			<Image name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=LOLbin" condition="image">popd.exe</Image>
			<Image name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=LOLbin" condition="image">pushd.exe</Image>
			<Image name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=LOLbin" condition="image">subst.exe</Image>
			<Image name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=detect aliases" condition="image">doskey.exe</Image>
			<Image name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=detect cls in batch scripts" condition="image">cls.exe</Image>
			<Image name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=UNC\Device Launches - Image begins with \,Risk=10" condition="begin with">\</Image> 
			<ParentCommandLine name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=IIS Child Processes" condition="begin with">C:\Windows\system32\svchost.exe -k iissvcs</ParentCommandLine>
			<ParentImage name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=UNC\Device Launches - Parent Image begins with \,Risk=10" condition="begin with">\</ParentImage> 
			<ParentImage name="Attack=T1059,DS=Process: Process Creation,Level=0,Desc=Process Spawned from Acrobat" condition="image">acrobat.exe</ParentImage>
			<ParentImage name="Attack=T1059,DS=Process: Process Creation,Level=0,Desc=Process Spawned from Adobe Reader" condition="image">acrord32.exe</ParentImage>
			<ParentImage name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Process Spawned from JAVA" condition="image">java.exe</ParentImage>
			<ParentImage name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Process Spawned from JAVA" condition="image">javaw.exe</ParentImage>
			<!--Detection of Output Redirection-->
			<!-- Disabled for now: Reason: Overrides other detections, waiting on Sysmon multiple rule firing
			<CommandLine name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Output Redirection" condition="contains">2></CommandLine>
			<CommandLine name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Output Redirection" condition="contains">&gt;</CommandLine>
			<CommandLine name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Output Redirection" condition="contains">&lt;</CommandLine>
			-->
			<!--Detect Multiple Commands-->
			<Rule  name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=SVCHost Processes" groupRelation="and">
				<Image condition="image">C:\Windows\system32\svchost.exe</Image>
			</Rule>
			<Image name="Attack=T1222,Technique=File Permissions Modification,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Permission Modifications with icacls or cacls" condition="image">cacls.exe</Image>
			<Image name="Attack=T1222,Technique=File Permissions Modification,Tactic=Defense Evasion,DS=Process: Process Creation,Level=0,Desc=Ownership Permission Modifications with takeown" condition="image">takeown.exe</Image>
			<CommandLine condition="contains" name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Suspicious Cmdline: MsAccess MACRO Exec">/x Macro</CommandLine>
			<Rule  name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=3,Desc=Suspicious pipe via commandline" groupRelation="and">
				<CommandLine condition="contains">\pipe\</CommandLine>
				<CommandLine condition="excludes">&gt;</CommandLine>
			</Rule>
			<CommandLine condition="contains" name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Suspicious Cmdline: RDP Port">/noprofile</CommandLine>
			<CommandLine condition="contains" name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Suspicious Cmdline: Schtasks">/sc ONEVENT</CommandLine>
			<CommandLine name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=3,Alert=Execution run from \\VBOXSVR share" condition="contains">\\VBOXSVR</CommandLine>
			<CommandLine name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=3,Alert=interactive command to slow output" condition="contains">| more</CommandLine>
			<CommandLine name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=3,Alert=interactive command to slow output" condition="contains">|more</CommandLine>
			<CommandLine name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Execution from \\tsclient share" condition="contains">\\tsclient</CommandLine>
			<CommandLine name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Processor ARCH command Line" condition="contains">%PROCESSOR_ARCHITECTURE%</CommandLine>
			<CommandLine name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=SysNative detected" condition="contains">sysnative</CommandLine>
			<Description name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=AutoIT Application Detected" condition="contains">AutoIt</Description>
			<Description name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Windows Filter loader" condition="contains">Microsoft Filter Loader</Description> 
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=3,Alert=interactive command to slow output" condition="is">more.com</Image>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=.Net Framework executables" condition="contains">:\Windows\Microsoft.NET\</Image>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Acrobat Reader Launches" condition="image">acrord32.exe</Image>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=Gpupdate Launched" condition="image">gpupdate.exe</Image>
			<ParentImage name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=.Net Framework executables" condition="contains">:\Windows\Microsoft.NET\</ParentImage>
			<ParentImage name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Creation,Level=0,Desc=System Child Processes" condition="is">System</ParentImage>
			<Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Process: Process Creation,Level=0,Desc=Generic User Execution,Risk=0" groupRelation="and">
				<ParentImage condition="image">explorer.exe</ParentImage>
				<Image name="Allow other rules to fire" condition="excludes any">\regedit.exe;\cmd.exe;terminal;\powershell</Image>
			</Rule>
			<!-- Log other command line events, this sometimes conflicts with rules, add to exclusions as necessary-->
			<!-- <ParentCommandLine name="Information=Uncategorized Events,DS=Process: Process Creation" condition="contains any">/;\;-;unknown;</ParentCommandLine>-->
		</ProcessCreate>
	</RuleGroup>
	<RuleGroup name="RG=Process Create Exclude Group" groupRelation="or">
		<ProcessCreate onmatch="exclude">
			<Rule name="exclude werfault from wmi" groupRelation="and">
				<Image condition="image">C:\Windows\System32\WerFault.exe</Image>
				<ParentImage condition="image">C:\Windows\System32\wbem\WmiPrvSE.exe</ParentImage>
			</Rule>
		</ProcessCreate>
	</RuleGroup>
	<!--SYSMON EVENT ID 2 : FILE CREATION TIME RETROACTIVELY CHANGED IN THE FILESYSTEM [FileCreateTime]-->
	<RuleGroup name="RG=FileCreateTime Include Group" groupRelation="or">
		<FileCreateTime onmatch="include">
			<Image name="Attack=T1070.006,Technique=Timestomp,Tactic=Defense Evasion,DS=File: File Metadata" condition="begin with">C:\Users</Image>
			<Image name="Attack=T1070.006,Technique=Timestomp,Tactic=Defense Evasion,DS=File: File Metadata" condition="begin with">C:\ProgramData</Image>
			<Image name="Attack=T1070.006,Technique=Timestomp,Tactic=Defense Evasion,DS=File: File Metadata" condition="contains">\Temp\</Image>
			<Image name="Attack=T1070.006,Technique=Timestomp,Tactic=Defense Evasion,DS=File: File Metadata" condition="contains">\tmp\</Image>
			<Image name="Attack=T1070.006,Technique=Timestomp,Tactic=Defense Evasion,DS=File: File Metadata" condition="contains">\drivers\</Image>
			<Image name="Attack=T1070.006,Technique=Timestomp,Tactic=Defense Evasion,DS=File: File Metadata" condition="contains">\Download</Image>
		</FileCreateTime>
	</RuleGroup>
	<RuleGroup name="RG=FileCreateTime Exclude Group" groupRelation="or">
		<FileCreateTime onmatch="exclude">
			<Image condition="image">C:\Windows\system32\backgroundTaskHost.exe</Image>
			<Image condition="image">TrustedInstaller.exe</Image>
			<Image condition="image">OneDrive.exe</Image>
			<Image condition="image">vivaldi.exe</Image>
			<Image condition="image">chrome.exe</Image>
			<Image condition="image">C:\WINDOWS\system32\backgroundTaskHost.exe</Image>
			<Image condition="contains">setup</Image>
			<Image condition="end with">AppData\Local\Microsoft\Teams\current\Teams.exe</Image>
			<Image condition="end with">\AppData\Local\Microsoft\Edge SxS\Application\msedge.exe</Image>
		</FileCreateTime>
	</RuleGroup>
	<!--SYSMON EVENT ID 3 : NETWORK CONNECTION INITIATED [NetworkConnect]-->
	<RuleGroup name="RG=NetworkConnect Include Group" groupRelation="or">
		<NetworkConnect onmatch="include">
			<!--MITRE ATT&CK TACTIC: Reconnaissance-->
			<!--MITRE ATT&CK TECHNIQUE: Active Scanning-->
			<DestinationHostname name="Attack=T1595,Technique=Network Service Scanning/Reconnaissance,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Census Network Connection,Risk=40" condition="contains">census</DestinationHostname>
			<DestinationHostname name="Attack=T1595,Technique=Network Service Scanning/Reconnaissance,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=0,Desc=ResearchScan Network Connection,Risk=70" condition="contains">researchscan</DestinationHostname>
			<DestinationHostname name="Attack=T1595,Technique=Network Service Scanning/Reconnaissance,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Scanhub Network Connection,Risk=70" condition="contains">scanhub</DestinationHostname>
			<DestinationHostname name="Attack=T1595,Technique=Network Service Scanning/Reconnaissance,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Shadow Network Connection,Risk=50" condition="contains">shadow</DestinationHostname>
			<DestinationHostname name="Attack=T1595,Technique=Network Service Scanning/Reconnaissance,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Shodan Network Connection,Risk=50" condition="contains">shodan</DestinationHostname>
			<Rule name="Attack=T1595,Technique=Network Service Scanning/Reconnaissance,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Exchange 0day Attackers from September 2022,Risk=100" groupRelation="or">
				<DestinationIp condition="is any">137.184.67.33;206.188.196.77;125.212.220.48;5.180.61.17;47.242.39.92;61.244.94.85;86.48.6.69;86.48.12.64;94.140.8.48;94.140.8.113;103.9.76.208;103.9.76.211;104.244.79.6;112.118.48.186;122.155.174.188;125.212.241.134;185.220.101.182;194.150.167.88;212.119.34.11</DestinationIp>
				<DestinationIp condition="begin with">137.184.67.</DestinationIp>
				<DestinationHostname condition="is any">httpbin.org</DestinationHostname>
			</Rule>
			<Rule name="Attack=T1595,Technique=Active Scanning,Tactic=Reconnaissance,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Advanced IP scanner Detected,Risk=90"  groupRelation="or">
				<DestinationHostname condition="contains any">advanced-ip-scanner.com</DestinationHostname>
			</Rule>
			<Rule name="Attack=T1595,Technique=Active Scanning,Tactic=Reconnaissance,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Kali Linux Distribution Download/Apt URL,Risk=90"  groupRelation="or">
				<DestinationHostname condition="contains any">kali.download</DestinationHostname>
			</Rule>
			<DestinationHostname condition="contains">shodan</DestinationHostname>
			<!--MITRE ATT&CK TECHNIQUE: Gather Victim Host Information-->
			<!--MITRE ATT&CK TECHNIQUE: Gather Victim Identity Information-->
			<!--MITRE ATT&CK TECHNIQUE: Gather Victim Network Information-->
			<!--MITRE ATT&CK TECHNIQUE: Gather Victim Org Information-->
			<!--MITRE ATT&CK TECHNIQUE: Phishing for Information-->
			<!--MITRE ATT&CK TECHNIQUE: Search Closed Sources-->
			<!--MITRE ATT&CK TECHNIQUE: Search Open Technical Databases-->
			<!--MITRE ATT&CK TECHNIQUE: Search Open Websites/Domains-->
			<!--MITRE ATT&CK TECHNIQUE: Search Victim-Owned Websites-->

			<!--MITRE ATT&CK TACTIC: Resource Development-->
			<!--MITRE ATT&CK TECHNIQUE: Acquire Infrastructure-->
			<!--MITRE ATT&CK TECHNIQUE: Compromise Accounts-->
			<!--MITRE ATT&CK TECHNIQUE: Compromise Infrastructure-->
			<!--MITRE ATT&CK TECHNIQUE: Develop Capabilities-->
			<!--MITRE ATT&CK TECHNIQUE: Establish Accounts-->
			<!--MITRE ATT&CK TECHNIQUE: Obtain Capabilities-->
			<!--MITRE ATT&CK TECHNIQUE: Stage Capabilities-->

			<!--MITRE ATT&CK TACTIC: Initial Access-->
			<!--MITRE ATT&CK TECHNIQUE: Drive-by Compromise-->
			<!--MITRE ATT&CK TECHNIQUE: Exploit Public-Facing Application-->
			<!--MITRE ATT&CK TECHNIQUE: External Remote Services-->
			<!--MITRE ATT&CK TECHNIQUE: Hardware Additions-->
			<!--MITRE ATT&CK TECHNIQUE: Phishing-->
			<!--MITRE ATT&CK TECHNIQUE: Replication Through Removable Media-->
			<!--MITRE ATT&CK TECHNIQUE: Supply Chain Compromise-->
			<!--MITRE ATT&CK TECHNIQUE: Trusted Relationship-->
			<!--MITRE ATT&CK TECHNIQUE: Valid Accounts -->
			
			<!--MITRE ATT&CK TACTIC: Execution-->
			<!--MITRE ATT&CK TECHNIQUE: Command and Scripting Interpreter-->
			<Rule name="Attack=T1059,Technique=Visual Basic,Tactic=Execution,DS=Network Traffic: Network Connection Creation,Level=4,Alert=WSCRIPT Network connection,Risk=80" groupRelation="and">
				<Image condition="image">wscript.exe</Image>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Container Administration Command-->
			<!--MITRE ATT&CK TECHNIQUE: Deploy Container-->
			<!--MITRE ATT&CK TECHNIQUE: Exploitation for Client Execution-->
			<!--MITRE ATT&CK TECHNIQUE: Inter-Process Communication-->
			<!--MITRE ATT&CK TECHNIQUE: Native API-->
			<!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
			<Image name="Attack=T1053.005,Technique=Scheduled Task,Tactic=Execution/Persistence/Privilege Escalation,DS=Network Traffic: Network Connection Creation,Level=4,Alert=AT.EXE Task Scheduler Network Connection,Risk=30" condition="image">at.exe</Image>
			<Image name="Attack=T1053.005,Technique=Scheduled Task,Tactic=Execution/Persistence/Privilege Escalation,DS=Network Traffic: Network Connection Creation,Level=4,Alert=SCHTasks.exe Task Scheduler Network Connection,Risk=30" condition="image">schtasks.exe</Image>
			<!--MITRE ATT&CK TECHNIQUE: Shared Modules-->
			<!--MITRE ATT&CK TECHNIQUE: Software Deployment Tools-->
			<!--MITRE ATT&CK TECHNIQUE: System Services-->
			<!--MITRE ATT&CK TECHNIQUE: User Execution-->
			<!--MITRE ATT&CK TECHNIQUE: Windows Management Instrumentation-->

			<!--MITRE ATT&CK TACTIC: Persistence-->
			<!--MITRE ATT&CK TECHNIQUE: Account Manipulation-->
			<!--MITRE ATT&CK TECHNIQUE: BITS Jobs-->
			<!--MITRE ATT&CK TECHNIQUE: Boot or Logon Autostart Execution-->
			<!--MITRE ATT&CK TECHNIQUE: Boot or Logon Initialization Scripts-->
			<!--MITRE ATT&CK TECHNIQUE: Browser Extensions-->
			<!--MITRE ATT&CK TECHNIQUE: Compromise Client Software Binary-->
			<!--MITRE ATT&CK TECHNIQUE: Create Account-->
			<!--MITRE ATT&CK TECHNIQUE: Create or Modify System Process-->
			<!--MITRE ATT&CK TECHNIQUE: Event Triggered Execution-->
			<!--MITRE ATT&CK TECHNIQUE: External Remote Services-->
			<!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
			<!--MITRE ATT&CK TECHNIQUE: Implant Internal Image-->
			<!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
			<!--MITRE ATT&CK TECHNIQUE: Office Application Startup-->
			<!--MITRE ATT&CK TECHNIQUE: Pre-OS Boot-->
			<!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
			<!--MITRE ATT&CK TECHNIQUE: Server Software Component-->
			<!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
			<!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->

			<!--MITRE ATT&CK TACTIC: Privilege Escalation-->
			<!--MITRE ATT&CK TECHNIQUE: Abuse Elevation Control Mechanism-->
			<!--MITRE ATT&CK TECHNIQUE: Access Token Manipulation-->
			<!--MITRE ATT&CK TECHNIQUE: Boot or Logon Autostart Execution-->
			<!--MITRE ATT&CK TECHNIQUE: Boot or Logon Initialization Scripts-->
			<!--MITRE ATT&CK TECHNIQUE: Create or Modify System Process-->
			<!--MITRE ATT&CK TECHNIQUE: Domain Policy Modification-->
			<!--MITRE ATT&CK TECHNIQUE: Escape to Host-->
			<!--MITRE ATT&CK TECHNIQUE: Event Triggered Execution-->
			<!--MITRE ATT&CK TECHNIQUE: Exploitation for Privilege Escalation-->

			<!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
			<!--MITRE ATT&CK TECHNIQUE: Process Injection-->
			<!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
			<!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->

			<!--MITRE ATT&CK TACTIC: Defense Evasion-->
			<!--MITRE ATT&CK TECHNIQUE: Abuse Elevation Control Mechanism-->
			<!--MITRE ATT&CK TECHNIQUE: Access Token Manipulation-->
			<!--MITRE ATT&CK TECHNIQUE: BITS Jobs-->
			<!--MITRE ATT&CK TECHNIQUE: Build Image on Host-->
			<!--MITRE ATT&CK TECHNIQUE: Debugger Evasion-->
			<!--MITRE ATT&CK TECHNIQUE: Deobfuscate/Decode Files or Information-->
			<!--MITRE ATT&CK TECHNIQUE: Deploy Container-->
			<!--MITRE ATT&CK TECHNIQUE: Direct Volume Access-->
			<!--MITRE ATT&CK TECHNIQUE: Domain Policy Modification-->
			<!--MITRE ATT&CK TECHNIQUE: Execution Guardrails-->
			<!--MITRE ATT&CK TECHNIQUE: Exploitation for Defense Evasion-->
			<!--MITRE ATT&CK TECHNIQUE: File and Directory Permissions Modification-->
			<!--MITRE ATT&CK TECHNIQUE: Hide Artifacts-->
			<!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
			<!--MITRE ATT&CK TECHNIQUE: Impair Defenses-->
			<!--MITRE ATT&CK TECHNIQUE: Indicator Removal on Host-->
			<!--MITRE ATT&CK TECHNIQUE: Indirect Command Execution-->
			<!--MITRE ATT&CK TECHNIQUE: Masquerading-->
			<Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Temp file location network connection,Risk=30" groupRelation="and">
				<Image condition="contains">\temp\</Image>
				<DestinationIp condition="excludes any">127.0.0.1</DestinationIp>		
			</Rule>
			<Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Network Connection from wwwroot folder: Possible webshell,Risk=100" groupRelation="and">
				<Image condition="contains">\wwwroot\</Image>
			</Rule>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Network connection in addins" condition="contains">\Windows\addins\</Image>
			<Image name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Network Connection from Windows\repair Folder,Risk=70" condition="begin with">C:\Windows\repair\</Image>
			<Image name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Network Connection from htdocs folder,Risk=70" condition="contains">\htdocs\</Image>
			<Image name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Network Connection from systemprofile Folder,Risk=30" condition="begin with">C:\Windows\system32\config\systemprofile\</Image>
			<Image name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Network connection from Intel logs,Risk=100" condition="begin with">C:\Intel\Logs\</Image>
			<Image name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Network connection from Windows\Addins Folder,Risk=70" condition="begin with">C:\Windows\addins\</Image>
			<Image name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Network connection from Windows\security Folder,Risk=100" condition="begin with">C:\Windows\security\</Image>
			<Image name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Network connection from windows help folder,Risk=70" condition="begin with">C:\Windows\Help\</Image>
			<Image name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Suspicious network connection from Recycle bin,Risk=100" condition="contains">$RECYCLE.BIN</Image>
			<Image name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Network connection in Windows Debug folder,Risk=100" condition="begin with">C:\Windows\Debug\</Image>
			<Image name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Network connection in Windows Font folder,Risk=100" condition="begin with">C:\Windows\Fonts\</Image>
			<Image name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Perflogs unusual network connection,Risk=70" condition="begin with">C:\PerfLogs\</Image>
			<Image name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Unusual network connection from Recycle bin,Risk=100" condition="contains">:\$Recycle.bin\</Image>
			<Image name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Network Connection from Default User folder,Risk=30" condition="contains">:\Users\Default\</Image>
			<Image name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Network Connection from NetworkService User folder,Risk=30" condition="begin with">C:\Users\NetworkService\</Image>
			<Image name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Network connection from Public User folder,Risk=30" condition="begin with">C:\Users\Public\</Image>
			<Image name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Network connection within Media Folder,Risk=30" condition="begin with">C:\Windows\Media\</Image>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Input Method Network Connection" condition="contains">\Windows\IME\</Image>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Programdata Network Connection" condition="begin with">C:\ProgramData</Image>
			<!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
			<!--MITRE ATT&CK TECHNIQUE: Modify Cloud Compute Infrastructure-->
			<!--MITRE ATT&CK TECHNIQUE: Modify Registry-->
			<!--MITRE ATT&CK TECHNIQUE: Modify System Image-->
			<!--MITRE ATT&CK TECHNIQUE: Network Boundary Bridging-->
			<!--MITRE ATT&CK TECHNIQUE: Obfuscated Files or Information-->
			<Rule name="Attack=T1027.004,Tactic=Defense Evasion,Technique=Compile After Delivery,DS=Network Traffic: Network Connection Creation,Level=4,Alert=CSC Network Conections" groupRelation="and">
				<Image condition="image">CSC.exe</Image>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Plist File Modification-->
			<!--MITRE ATT&CK TECHNIQUE: Pre-OS Boot-->
			<!--MITRE ATT&CK TECHNIQUE: Process Injection-->
			<!--MITRE ATT&CK TECHNIQUE: Reflective Code Loading-->
			<!--MITRE ATT&CK TECHNIQUE: Rogue Domain Controller-->
			<!--MITRE ATT&CK TECHNIQUE: Rootkit-->
			<!--MITRE ATT&CK TECHNIQUE: Subvert Trust Controls-->
			<!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution-->
			<Image name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=0,Desc=infDefaultInstall Network Connection" condition="image">infDefaultInstall.exe</Image>
			<Image name="Attack=T1218,Technique=Control Panel,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Control Panel network connection" condition="image">SyncAppvPublishingServer.exe</Image>
			<!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Regsvr32-->
			<!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Installutil-->
			<Image name="Attack=T1218.004,Technique=InstallUtil,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=InstallUtil network connection" condition="image">InstallUtil.exe</Image>
			<!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Msiexec-->
			<Image name="Attack=T1218.007,Technique=MSIExec,Tactic=Defense Evasion,DS=Network Traffic: Network Connection Creation,Level=4,Alert=MSIExec Network connection,Risk=70" condition="image">msiexec.exe</Image>
			<!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Regsvcs/regasm-->
			<Rule name="Attack=T1218,Technique=Signed Binary Proxy Execution,Tactic=Execution,DS=Network Traffic: Network Connection Creation,Level=4,Alert=RegAsm shellcode C2 connection" groupRelation="and">
				<Image condition="contains any">regasm.exe;regsvcs.exe</Image>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Mavinject-->
			<Image name="Attack=T1218.013,Technique=Signed Binary Proxy Execution: Mavinject,Tactic=Execution,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Mavinject detected,Risk=80" condition="image">Mavinject.exe</Image>
			<!--MITRE ATT&CK TECHNIQUE: System Script Proxy Execution-->
			<!--MITRE ATT&CK TECHNIQUE: Template Injection-->
			<!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
			<!--MITRE ATT&CK TECHNIQUE: Trusted Developer Utilities Proxy Execution-->
			<Rule name="Attack=T1127,Tactic=Defense Evasion,Technique=Signed Binary Proxy Execution,DS=Network Traffic: Network Connection Creation,Level=4,Alert=MSBuild Network Conections" groupRelation="and">
				<Image condition="image">msbuild.exe</Image>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Unused/Unsupported Cloud Regions-->
			<!--MITRE ATT&CK TECHNIQUE: Use Alternate Authentication Material-->
			<!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->
			<!--MITRE ATT&CK TECHNIQUE: Virtualization/Sandbox Evasion-->
			<!--MITRE ATT&CK TECHNIQUE: Weaken Encryption-->
			<!--MITRE ATT&CK TECHNIQUE: XSL Script Processing-->

			<!--MITRE ATT&CK TACTIC: Credential Access-->
			<!--MITRE ATT&CK TECHNIQUE: Adversary-in-the-Middle-->
			<!--MITRE ATT&CK TECHNIQUE: Brute Force-->
			<!--MITRE ATT&CK TECHNIQUE: Credentials from Password Stores-->
			<!--MITRE ATT&CK TECHNIQUE: Exploitation for Credential Access-->
			<!--MITRE ATT&CK TECHNIQUE: Forced Authentication-->
			<!--MITRE ATT&CK TECHNIQUE: Forge Web Credentials-->
			<!--MITRE ATT&CK TECHNIQUE: Input Capture-->
			<!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
			<!--MITRE ATT&CK TECHNIQUE: Multi-Factor Authentication Interception-->
			<!--MITRE ATT&CK TECHNIQUE: Multi-Factor Authentication Request Generation-->
			<!--MITRE ATT&CK TECHNIQUE: Network Sniffing-->
			<!--MITRE ATT&CK TECHNIQUE: OS Credential Dumping-->
			<!--MITRE ATT&CK TECHNIQUE: Steal Application Access Token-->
			<!--MITRE ATT&CK TECHNIQUE: Steal or Forge Kerberos Tickets-->
			<!--MITRE ATT&CK TECHNIQUE: Steal Web Session Cookie-->
			<!--MITRE ATT&CK TECHNIQUE: Unsecured Credentials-->

			<!--MITRE ATT&CK TACTIC: Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Account Discovery -->
			<!--MITRE ATT&CK TECHNIQUE: Application Window Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Browser Bookmark Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Cloud Infrastructure Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Cloud Service Dashboard-->
			<!--MITRE ATT&CK TECHNIQUE: Cloud Service Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Cloud Storage Object Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Container and Resource Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Debugger Evasion-->
			<!--MITRE ATT&CK TECHNIQUE: Domain Trust Discovery-->
			<Image name="Attack=T1482,Technique=Domain Trust Discovery,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=0,Desc=DSQuery network connection" condition="image">dsquery.exe</Image>
			<!--MITRE ATT&CK TECHNIQUE: File and Directory Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Group Policy Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Network Service Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Network Share Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Network Sniffing-->
			<!--MITRE ATT&CK TECHNIQUE: Password Policy Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Peripheral Device Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Permission Groups Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Process Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Query Registry-->
			<!--MITRE ATT&CK TECHNIQUE: Remote System Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Software Discovery-->
			<Image name="Attack=T1518,Technique=Software Discovery,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=0,Desc=DriverQuery Network Connection" condition="image">driverquery.exe</Image>
			<!--MITRE ATT&CK TECHNIQUE: System Information Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: System Location Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: System Network Configuration Discovery-->
			<Image name="Attack=T1016,Technique=System Network Configuration Discovery,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=4,Alert=NBTSTAT Query,Risk=30" condition="image">nbtstat.exe</Image>
			<!--MITRE ATT&CK TECHNIQUE: System Network Connections Discovery-->
			<Image name="Attack=T1021,Technique=System Network Configuration Discovery,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=0,Desc=net.exe nework connection,Risk=30" condition="image">net.exe</Image>
			<Image name="Attack=T1021,Technique=System Network Configuration Discovery,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=0,Desc=net.exe nework connection,Risk=30" condition="image">net1.exe</Image>
			<!--MITRE ATT&CK TECHNIQUE: System Owner/User Discovery-->
			<Image name="Attack=T1033,Technique=System Owner/User Discovery,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=2,Alert=QWinsta User enumeration,Risk=30" condition="image">qwinsta.exe</Image>
			<Image name="Attack=T1033,Technique=System Owner/User Discovery,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=3,Alert=RWinsta Forced User Logoff,Risk=30" condition="image">rwinsta.exe</Image>
			<!--MITRE ATT&CK TECHNIQUE: System Service Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: System Time Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Virtualization/Sandbox Evasion-->

			<!--MITRE ATT&CK TACTIC: Lateral Movement-->
			<!--MITRE ATT&CK TECHNIQUE: Exploitation of Remote Services-->
			<!--MITRE ATT&CK TECHNIQUE: Internal Spearphishing-->
			<!--MITRE ATT&CK TECHNIQUE: Lateral Tool Transfer-->
			<!--MITRE ATT&CK TECHNIQUE: Remote Service Session Hijacking-->
			<!--MITRE ATT&CK TECHNIQUE: Remote Services-->
			<Rule name="Attack=T1021.001,Tactic=Lateral Movement,Technique=Remote Desktop Protocol,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Suspicious RDP Connection 3389,Risk=70" groupRelation="and">
				<Initiated>true</Initiated>
				<DestinationPort condition="is">3389</DestinationPort>
				<Image condition="excludes">AutomationManager.ScriptRunner64.exe</Image>
				<Image condition="excludes">C:\Program Files (x86)\VMware\VMware Remote Console\vmrc.exe</Image>
				<Image condition="excludes">C:\Program Files\VMware\VMware Remote Console\vmrc.exe</Image>
				<Image condition="excludes">C:\Program Files\WindowsApps\Microsoft.RemoteDesktop_</Image>
				<Image condition="excludes">CtxLicUsageRecorder.exe</Image>
				<Image condition="excludes">FSAssessment.exe</Image>
				<Image condition="excludes">FSDiscovery.exe</Image>
				<Image condition="excludes">MobaRTE.exe</Image>
				<Image condition="excludes">RDCMan.exe</Image>
				<Image condition="excludes">RSSensor.exe</Image>
				<Image condition="excludes">RTS2App.exe</Image>
				<Image condition="excludes">RTSApp.exe</Image>
				<Image condition="excludes">RemoteDesktopManager64.exe</Image>
				<Image condition="excludes">RemoteDesktopManager.exe</Image>
				<Image condition="excludes">RemoteDesktopManagerFree.exe</Image>
				<Image condition="excludes">Terminals.exe</Image>
				<Image condition="excludes">chrome.exe</Image>
				<Image condition="excludes">mRemote.exe</Image>
				<Image condition="excludes">mRemoteNG.exe</Image>
				<Image condition="excludes">mstsc.exe</Image>
				<Image condition="excludes">spiceworks-finder.exe</Image>
				<Image condition="excludes">svchost.exe</Image>
				<Image condition="excludes">thor64.exe</Image>
				<Image condition="excludes">thor.exe</Image>
			</Rule>
			<Rule name="Attack=T1021.001,Tactic=Lateral Movement,Technique=Remote Desktop Protocol,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Suspicious RDP Connection 3391,Risk=70" groupRelation="and">
				<Initiated>true</Initiated>
				<DestinationPort condition="is">3391</DestinationPort>
				<Image condition="excludes">AutomationManager.ScriptRunner64.exe</Image>
				<Image condition="excludes">C:\Program Files (x86)\VMware\VMware Remote Console\vmrc.exe</Image>
				<Image condition="excludes">C:\Program Files\VMware\VMware Remote Console\vmrc.exe</Image>
				<Image condition="excludes">C:\Program Files\WindowsApps\Microsoft.RemoteDesktop_</Image>
				<Image condition="excludes">CtxLicUsageRecorder.exe</Image>
				<Image condition="excludes">FSAssessment.exe</Image>
				<Image condition="excludes">FSDiscovery.exe</Image>
				<Image condition="excludes">MobaRTE.exe</Image>
				<Image condition="excludes">RDCMan.exe</Image>
				<Image condition="excludes">RSSensor.exe</Image>
				<Image condition="excludes">RTS2App.exe</Image>
				<Image condition="excludes">RTSApp.exe</Image>
				<Image condition="excludes">RemoteDesktopManager64.exe</Image>
				<Image condition="excludes">RemoteDesktopManager.exe</Image>
				<Image condition="excludes">RemoteDesktopManagerFree.exe</Image>
				<Image condition="excludes">Terminals.exe</Image>
				<Image condition="excludes">chrome.exe</Image>
				<Image condition="excludes">mRemote.exe</Image>
				<Image condition="excludes">mRemoteNG.exe</Image>
				<Image condition="excludes">mstsc.exe</Image>
				<Image condition="excludes">spiceworks-finder.exe</Image>
				<Image condition="excludes">svchost.exe</Image>
				<Image condition="excludes">thor64.exe</Image>
				<Image condition="excludes">thor.exe</Image>
			</Rule>
			<Rule name="Attack=T1021.001,Tactic=Lateral Movement,Technique=Remote Desktop Protocol,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Localhost RDP Tunneling Detection,Risk=70" groupRelation="and">
				<Initiated>true</Initiated>
				<DestinationPort condition="is">3389</DestinationPort>
				<DestinationIp condition="is any">127.0.0.1;0:0:0:0:0:0:0:1</DestinationIp>
			</Rule>
			<Rule name="Attack=T1021.001,Tactic=Lateral Movement,Technique=Remote Desktop Protocol,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Link-Local RDP Tunnel Detection,Risk=70" groupRelation="and">
				<Initiated>true</Initiated>
				<DestinationPort condition="is">3389</DestinationPort>
				<DestinationIp condition="begin with">fe80:0</DestinationIp>
			</Rule>
			<Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=SSH Connection with Putty,Risk=80" groupRelation="and">
				<Image condition="contains any">putty.exe;kitty.exe;kitty_portable.exe</Image>
			</Rule>
			<Rule name="Attack=T1028,Technique=Windows Remote Management,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Windows Remote Management connection,Risk=0" groupRelation="and">
				<Image condition="image">wsmprovhost.exe</Image>
			</Rule>
			<Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=PSFTP Connection,Risk=70" groupRelation="and">
				<Image condition="image">psftp.exe</Image>
			</Rule>
			<Image name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Remote Registry via command line,Risk=30" condition="image">reg.exe</Image>
			<Image name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Remote Registry via command line,Risk=80" condition="contains">psshutdown</Image>
			<Image name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Remote password change with PSPasswd,Risk=80" condition="contains">PsPasswd</Image>
			<Image name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Remote querying of services,Risk=80" condition="contains">psservice</Image>
			<Image name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=SSH Connection with ssh.exe,Risk=30" condition="image">ssh.exe</Image>
			<Image name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Sysinternals PSEXE Tools,Risk=100" condition="contains">psexe</Image>
			<Image name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=TSFTP Connection,Risk=70" condition="image">tftp.exe</Image>
			<Image name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Telnet Connection,Risk=30" condition="image">telnet.exe</Image>
			<Image name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=0,Desc=MSTSC Remote Desktop Connection" condition="image">mstsc.exe</Image>
			<Image name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Remote WMIC commands,Risk=30" condition="image">wmic.exe</Image>
			<Image name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=0,Desc=SC.exe Network Connection" condition="image">sc.exe</Image>
			<Image name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Sysinternals PSKILL Tools,Risk=80" condition="contains">pskill</Image>
			<Image name="Attack=T1087,Technique=Account Discovery,Tactic=Discovery,DS=Network Traffic: Network Connection Creation,Level=0,Desc=DSQuery network connection" condition="image">dsquery.exe</Image>
			<Image name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Automated SSH Connection with Putty PLink,Risk=30" condition="image">plink.exe</Image>
			<Image name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=VNC" condition="image">vnc.exe</Image>
			<Image name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=VNC Viewer" condition="image">vncviewer.exe</Image>
			<Image name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=3,Alert=VNC Service" condition="image">vncservice.exe</Image>
			<Image name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation" condition="image">omniinet.exe</Image>
			<Image name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation" condition="image">hpsmhd.exe</Image>
			<!--MITRE ATT&CK TECHNIQUE: Replication Through Removable Media-->
			<!--MITRE ATT&CK TECHNIQUE: Software Deployment Tools-->
			<!--MITRE ATT&CK TECHNIQUE: Taint Shared Content-->
			<!--MITRE ATT&CK TECHNIQUE: Use Alternate Authentication Material-->

			<!--MITRE ATT&CK TACTIC: Collection-->
			<!--MITRE ATT&CK TECHNIQUE: Adversary-in-the-Middle-->
			<!--MITRE ATT&CK TECHNIQUE: Archive Collected Data-->
			<!--MITRE ATT&CK TECHNIQUE: Audio Capture-->
			<!--MITRE ATT&CK TECHNIQUE: Automated Collection-->
			<!--MITRE ATT&CK TECHNIQUE: Browser Session Hijacking-->
			<!--MITRE ATT&CK TECHNIQUE: Clipboard Data-->
			<!--MITRE ATT&CK TECHNIQUE: Data from Cloud Storage Object-->
			<!--MITRE ATT&CK TECHNIQUE: Data from Configuration Repository-->
			<!--MITRE ATT&CK TECHNIQUE: Data from Information Repositories-->
			<!--MITRE ATT&CK TECHNIQUE: Data from Local System-->
			<!--MITRE ATT&CK TECHNIQUE: Data from Network Shared Drive-->
			<!--MITRE ATT&CK TECHNIQUE: Data from Removable Media-->
			<!--MITRE ATT&CK TECHNIQUE: Data Staged-->
			<!--MITRE ATT&CK TECHNIQUE: Email Collection-->
			<!--MITRE ATT&CK TECHNIQUE: Input Capture-->
			<!--MITRE ATT&CK TECHNIQUE: Screen Capture-->
			<!--MITRE ATT&CK TECHNIQUE: Video Capture-->

			<!--MITRE ATT&CK TACTIC: Command and Control-->
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Cobalt Strike Team Server port,Risk=70" groupRelation="and">
				<DestinationPort condition="is">50050</DestinationPort>
				<Initiated>true</Initiated>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Outbound SMTP Email Sending,Risk=10" groupRelation="and">
				<DestinationPort condition="is">25</DestinationPort>
				<Image condition="excludes any">\Bin\EdgeTransport.exe;Bin\MSExchangeFrontendTransport.exe</Image>
				<Initiated>true</Initiated>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Application Layer Protocol-->
			<!--MITRE ATT&CK TECHNIQUE: Communication Through Removable Media-->
			<!--MITRE ATT&CK TECHNIQUE: Data Encoding-->
			<!--MITRE ATT&CK TECHNIQUE: Data Obfuscation-->
			<!--MITRE ATT&CK TECHNIQUE: Dynamic Resolution-->
			<!--MITRE ATT&CK TECHNIQUE: Encrypted Channel-->
			<!--MITRE ATT&CK TECHNIQUE: Fallback Channels-->
			<!--MITRE ATT&CK TECHNIQUE: Ingress Tool Transfer-->
			<Rule name="Attack=T1053.005,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Powershell Network Connection,Risk=30" groupRelation="and">
				<Image condition="image">powershell.exe</Image>
				<DestinationIp condition="excludes any">0:0:0:0:0:0:0:;127.0.0.1</DestinationIp>
			</Rule>
			<Image name="Attack=T1053.005,Technique=Ingress Tool Transfer,Tactic=Command And Control,DS=Network Traffic: Network Connection Creation,Level=3,Alert=MSHTA Network Connection,Risk=100" condition="image">mshta.exe</Image>
			<Image name="Attack=T1053.005,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Network Traffic: Network Connection Creation,Level=0,Desc=CMD Prompt network Connection,Risk=20" condition="image">cmd.exe</Image>
			<Image name="Attack=T1053.005,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Certutil Connecting to network,Risk=20" condition="image">certutil.exe</Image>
			<Image name="Attack=T1053.005,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Bitsadmin Connecting to network,Risk=20" condition="image">certutil.exe</Image>
			<Image name="Attack=T1053.005,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Notepad Network Connection" condition="image">notepad.exe</Image>
			<Image name="Attack=T1053.005,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Network Traffic: Network Connection Creation,Level=0,Desc=RegSVCS Network Connection,Risk=30" condition="image">regsvcs.exe</Image>
			<Image name="Attack=T1053.005,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Network Traffic: Network Connection Creation,Level=0,Desc=RegSVR32 Network Connection,Risk=30" condition="image">regsvr32.exe</Image> 
			<Image name="Attack=T1053.005,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Network Traffic: Network Connection Creation,Level=0,Desc=RunDLL32 Network Connection,Risk=30" condition="image">rundll32.exe</Image>
			<!--MITRE ATT&CK TECHNIQUE: Multi-Stage Channels-->
			<!--MITRE ATT&CK TECHNIQUE: Non-Application Layer Protocol-->
			<!--MITRE ATT&CK TECHNIQUE: Non-Standard Port-->
			<!--MITRE ATT&CK TECHNIQUE: Protocol Tunneling-->
			<!--MITRE ATT&CK TECHNIQUE: Proxy-->
			<!--MITRE ATT&CK TECHNIQUE: Proxy: Multi-hop Proxy-->
			<Image name="Attack=T1090.003,Technique=Multi-hop Proxy,Tactic=Command And Control,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Tor Connection" condition="image">tor.exe</Image>
			<DestinationHostname name="Attack=T1090.003,Technique=Multi-hop Proxy,Tactic=Command And Control,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Tor2Web,Risk=100" condition="contains any">hiddenservice.net;onion.city;onion.direct;onion.direct;onion.link;onion.nu;onion.pet;onion.plus;onion.rip;onion.sh;onion.sh;onion.si;onion.to;onion.top;onion.ws;tor-gateways.de;tor2net.com;tor2web.blutmagie.de;tor2web.fi;tor2web.info;tor2web.io;tor2web.org;onion.to</DestinationHostname>
			<!--MITRE ATT&CK TECHNIQUE: Remote Access Software-->
			<!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
			<!--MITRE ATT&CK TECHNIQUE: Web Service-->

			<!--MITRE ATT&CK TACTIC: Exfiltration-->
			<!--MITRE ATT&CK TECHNIQUE: Automated Exfiltration-->
			<!--MITRE ATT&CK TECHNIQUE: Data Transfer Size Limits-->
			<!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Alternative Protocol-->
			<DestinationHostname name="Attack=T1048,Technique=Exfiltration Over Alternative Protocol,Tactic=Exfiltration,DS=Network Traffic: Network Connection Creation,Level=0,Desc=DNS Over HTTPS" condition="contains any">dns.google;cloudflare-dns.com;mozilla.cloudflare-dns.com;dns.233py.com;dns.aaflalo.me;doh.opendns.com;.quad9.net;dns.cleanbrowsing.org;dns-family.adguard.com;dns.adguard.com;.233py.com;dnscrypt;dnscrypt-cert.oszx.co;dns.oszx.co;doh.dns.sb;doh.defaultroutes.de;doh.tiarap.org;doh.tiar.app;doh.captnemo.in;.aaflalo.me;doh.appliedprivacy.net;doh.dnswarden.com;commons.host;dns.twnic.tw;ibuki.cgnat.net;doh.xfinity.com;dns.nextdns.io;dns.dnsoverhttps.net;doh.crypto.sx;doh.powerdns.org;.blahdns.com;dns.rubyfish.cn;dns.containerpi.com;.seby.io;rdns.faelix.net;doh.li;.armadillodns.net;doh.netweaver.uk;doh.42l.fr;dns.aa.net.uk;adblock.mydns.network;ibksturm.synology.me;jcdns.fun</DestinationHostname>
			<!--MITRE ATT&CK TECHNIQUE: Exfiltration Over C2 Channel-->
			<!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Other Network Medium-->
			<!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Physical Medium-->
			<!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Web Service-->
			<!--MITRE ATT&CK TECHNIQUE: Scheduled Transfer-->
			<!--MITRE ATT&CK TECHNIQUE: Transfer Data to Cloud Account-->
			<DestinationHostname name="Attack=T1048,Technique=Exfiltration Over Alternative Protocol,Tactic=Exfiltration,DS=Network Traffic: Network Connection Creation,Level=0,Desc=privatlab.com Cloud Exfiltration" condition="contains all">privatlab.com</DestinationHostname>
			<DestinationHostname name="Attack=T1048,Technique=Exfiltration Over Alternative Protocol,Tactic=Exfiltration,DS=Network Traffic: Network Connection Creation,Level=3,Alert=Mega.co.nz Cloud Exfiltration" condition="contains any">mega.nz;mega.co.nz</DestinationHostname>
			<DestinationHostname name="Attack=T1048,Technique=Exfiltration Over Alternative Protocol,Tactic=Exfiltration,DS=Network Traffic: Network Connection Creation,Level=3,Alert=PCloud Cloud storage Exfiltration" condition="contains any">.pcloud.com</DestinationHostname>
			<!--MITRE ATT&CK TACTIC: Impact-->
			<!--MITRE ATT&CK TECHNIQUE: Account Access Removal-->
			<!--MITRE ATT&CK TECHNIQUE: Data Destruction-->
			<!--MITRE ATT&CK TECHNIQUE: Data Encrypted for Impact-->
			<!--MITRE ATT&CK TECHNIQUE: Data Manipulation-->
			<!--MITRE ATT&CK TECHNIQUE: Defacement-->
			<!--MITRE ATT&CK TECHNIQUE: Disk Wipe-->
			<!--MITRE ATT&CK TECHNIQUE: Endpoint Denial of Service-->
			<!--MITRE ATT&CK TECHNIQUE: Firmware Corruption-->
			<!--MITRE ATT&CK TECHNIQUE: Inhibit System Recovery-->
			<!--MITRE ATT&CK TECHNIQUE: Network Denial of Service-->
			<!--MITRE ATT&CK TECHNIQUE: Resource Hijacking-->
			<DestinationHostname name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Crypto Currency Miner Detected,Attack=T1496,Technique=Resource Hijacking,Tactic=Impact,Risk=100" condition="contains any">0x1f4b0.com;1q2w3.life;1q2w3.website;31.187.64.216;185.193.38.148;aalbbh84.info;adfreetv.ch;adless.io;adplusplus.fr;adrenali.gq;ajcryptominer.com;ajplugins.com;allfontshere.press;altavista.ovh;amhixwqagiz.ru;analytics.blue;appelamule.com;arizona-miner.tk;aster18cdn.nl;aster18prx.nl;avero.xyz;averoconnector.com;bauersagtnein.myeffect.net;bhzejltg.info;blazepool;blockmasters;blockmasterscoins;bmnr.pw;bmst.pw;bohemianpool;carry.myeffect.net;cashbeet.com;cdn-code.host;cfceu.duckdns.org;cfcnet.gdn;cfcnet.top;cfcs1.duckdns.org;chainblock.science;cieh.mx;coin-hive.com;coin-service.com;coin-services.info;coiner.site;coinpirate.cf;coinrail.io;coinwebmining.com;cpu2cash.link;cryptaloot.pro;cryptmonero;crypto-loot.com;crypto-pool;crypto-webminer.com;cryptoloot.pro;d-ns.ga;dataservices.download;directprimal.com;dwarfpool;encoding.ovh;estream.to;eth-pocket.com;eth-pocket.de;eth-pocket.eu;ethereum-pocket.de;ethereum-pocket.eu;ethtrader.de;eu.sushipool.com;f1tbit.com;flnqmin.org;freecontent.bid;freecontent.date;freecontent.loan;freecontent.racing;freecontent.stream;freecontent.win;gnrdomimplementation.com;graftpool.ovh;greenindex.dynamic-dns.net;gustaver.ddns.net;hashrefinery;hashvault.pro;herphemiste.com;hide.ovh;hk.rs;hlpidkr.ru;hodlers.party;hodling.faith;hostingcloud.win;hrfziiddxa.ru;ihdvilappuxpgiv.ru;imhvlhaelvvbrq.ru;insdrbot.com;irrrymucwxjl.ru;istlandoll.com;ivuovhsn.ru;iwanttoearn.money;ixvenhgwukn.ru;jqassets.download;jqr-cdn.download;jqrcdn.download;jquerrycdn.download;jqwww.download;jqxrrygqnagn.ru;jscoinminer.com;jwduahujge.ru;ksimdw.ru;l33tsite.info;laferia.cr;ledhenone.com;ltstyov.ru;mepirtedic.com;mine.bz;minercircle.com;minercry.pt;minergate;minero.cc;miners.pro;minescripts.info;mininghub.club;miningpoolhubcoins;minr.pw;mixpools.org;mmc.center;mollnia.com;monerise.com;monero.lindon-pool.win;monero;moriaxmr.com;munero.me;mxcdn1.now.sh;mxcdn2.now.sh;myadstats.com;mypool.online;nablabee.com;nanopool.org;nathetsof.com;nicehash;nimiqpool.com;nimpool.io;node.philpool.com;npcdn1.now.sh;nunu-001.now.sh;ogondkskyahxa.ru;ogrid.org;oinkinns.tk;olecintri.com;omine.org;onvid.club;open-hive-server-1.pp.ua;oxwwoeukjispema.ru;pcejuyhjucmkiny.ru;pool.nimiq.watch;pool.nimiqchain.info;pool.porkypool.com;pool.xmr;poolto.be;prohash.net;prohash;proj2018.xyz;pzoifaum.info;ratchetmining.com;realnetwrk.com;reauthenticator.com;rove.cl;ruvuryua.ru;s7ven.com;scaleway.ovh;sentemanactri.com;sickrage.ca/ch;sighash.info;slushpool;soodatmish.com;sparechange.io;statdynamic.com;stati.bid;staticsfs.host;streamplay.to;supportxmr;suprnova.cc;svivqrhrh.ru;sxcdn02.now.sh;sxcdn3.now.sh;sxcdn4.now.sh;sxcdn6.now.sh;synconnector.com;teracycle.net;tercabilis.info;thelifeisbinary.ddns.net;thersprens.com;torrent.pw;ulnawoyyzbljc.ru;unrummaged.com;uoldid.ru;usxmrpool;viaxmr.com;vpzccwpyilvoyg.ru;vzzexalcirfgrf.ru;wbmwss.beetv.net;webmine.cz;webmine.pro;webminepool.tk;webminerpool.com;webwidgetz.duckdns.org;wmemsnhgldd.ru;wmtech.website;wmwmwwfmkvucbln.ru;wrxgandsfcz.ru;xmrm.pw;xmrminingproxy.com;xmrpool;yiimp;yuyyio.com;zavzlen.ru;zergpool;zergpoolcoins;ziykrgc.ru;zlx.com.br;zpool</DestinationHostname>
			<!--MITRE ATT&CK TECHNIQUE: Service Stop-->
			<!--MITRE ATT&CK TECHNIQUE: System Shutdown/Reboot-->
			<!--UEBA Rules-->
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Inbound Windows SVCHost Network Connection" groupRelation="and">
				<Image condition="image">C:\Windows\system32\svchost.exe</Image>
				<DestinationPort condition="is not">3389</DestinationPort>
				<DestinationPort condition="is not">22</DestinationPort>
				<DestinationPort condition="is not">21</DestinationPort>
				<DestinationPort condition="is not">5985</DestinationPort>
				<Initiated>false</Initiated>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Outbound Windows SVCHost Network Connection" groupRelation="and">
				<Image condition="image">C:\Windows\system32\svchost.exe</Image>
				<Initiated>true</Initiated>
				<SourcePort condition="is not">135</SourcePort>
				<SourcePort condition="is not">445</SourcePort>
				<DestinationPort condition="is not">5985</DestinationPort>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Outbound Non-System port 445 SMB connections" groupRelation="and">
				<Image condition="is not">System</Image>
				<Image condition="excludes">svchost.exe</Image>
				<DestinationPort condition="is">445</DestinationPort>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Outbound Non-System port 389 LDAP connections" groupRelation="and">
				<Image condition="is not">System</Image>
				<Image condition="excludes any">svchost.exe;lsass.exe</Image>
				<DestinationPort condition="is">389</DestinationPort>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Inbound LDAP Connections" groupRelation="and">
				<Image condition="image">C:\Windows\System32\lsass.exe</Image>
				<DestinationPort condition="is">389</DestinationPort>
				<DestinationIp condition="excludes any">127.0.0.1;0:0:0:0:0:0:0:1;fe80:0</DestinationIp>
				<SourceHostname condition="excludes any">EXCH</SourceHostname>
				<SourceIp condition="excludes any">127.0.0.1;0:0:0:0:0:0:0:1;fe80:0</SourceIp>
				<Initiated>false</Initiated>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Notepad connecting to the internet" groupRelation="and">
				<Image condition="image">notepad.exe</Image>
				<DestinationIp condition="excludes">127.0.0.1</DestinationIp>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Browsers accessing non-standard ports" groupRelation="and">
				<Image condition="contains any">\iexplore.exe;\chrome.exe;\firefox.exe;\MicrosoftEdge;\msedge.exe;browser_broker.exe;\vivaldi.exe;\brave.exe;\opera.exe</Image>
				<DestinationPort condition="is not">80</DestinationPort>
				<DestinationPort condition="is not">443</DestinationPort>
				<Initiated>true</Initiated>
			</Rule>
			<DestinationHostname name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Connection to Github,Risk=30" condition="contains">github</DestinationHostname> 
			<DestinationHostname name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Connection to Github,Risk=30" condition="contains">githubusercontent.com</DestinationHostname>
			<Rule name="Attack=T1567.002,Technique=Exfiltration Over Web Service: Exfiltration to Cloud Storage,Tactic=Exfiltration,DS=Network Traffic: Network Connection Creation,Level=0,Alert=Dropbox Cloud Exfiltration" groupRelation="and">
				<DestinationHostname condition="end with">dropboxapi.com</DestinationHostname>
				<Image condition="excludes any">\Dropbox\Client\Dropbox.exe;\Dropbox\bin\Dropbox.exe;\Oracle\Java\</Image>
			</Rule>
			<Rule name="Attack=T1567.002,Technique=Exfiltration Over Web Service: Exfiltration to Cloud Storage,Tactic=Exfiltration,DS=Network Traffic: Network Connection Creation,Level=0,Alert=OneDrive Cloud Exfiltration" groupRelation="and">
				<DestinationHostname condition="contains">1drv</DestinationHostname>
				<!--We're looking for alternative Programs accessing Onedrive, If Onedrive is not allowed, uncomment onedrive exe exclusions-->
				<Image condition="excludes any">C:\Program Files\Microsoft OneDrive\OneDrive.exe;\AppData\Local\Microsoft\OneDrive\OneDrive.exe;C:\Program Files (x86)\Google\Chrome\Application\chrome.exe;\Internet Explorer\iexplore.exe;C:\Windows\System32\AppHostRegistrationVerifier.exe;C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe;C:\Program Files (x86)\BraveSoftware\Brave-Browser\Application\brave.exe;C:\Program Files (x86)\Microsoft OneDrive\OneDrive.exe;C:\Program Files\Mozilla Firefox\firefox.exe</Image>
			</Rule>
			<Rule name="Attack=T1567.002,Technique=Exfiltration Over Web Service: Exfiltration to Cloud Storage,Tactic=Exfiltration,DS=Network Traffic: Network Connection Creation,Level=0,Alert=Box.com Cloud Exfiltration" groupRelation="and">
				<DestinationHostname condition="contains all">.box.com;upload</DestinationHostname>
			</Rule>
			<Rule name="Attack=T1567.002,Technique=Exfiltration Over Web Service: Exfiltration to Cloud Storage,Tactic=Exfiltration,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Mega.co.nz Cloud Exfiltration" groupRelation="and">
				<DestinationHostname condition="contains any">mega.nz;mega.co.nz</DestinationHostname>
			</Rule>
			<Rule name="Attack=T1567.002,Technique=Exfiltration Over Web Service: Exfiltration to Cloud Storage,Tactic=Exfiltration,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Privatlab Cloud Exfiltration" groupRelation="and">
				<DestinationHostname condition="contains any">privatlab.com</DestinationHostname>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Social Networking" groupRelation="or">
				<DestinationHostname condition="contains any">tiktok;parler.com;gab.com;mewe.com;4chan;8chan;facebook;fbcdn;twitter;instagram;snapchat</DestinationHostname>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Internet Relay Chat,Risk=70" groupRelation="or">
				<DestinationHostname condition="contains any">efnet;undernet;freenode;ircnet;.rizon;quakenet;oftc.net;dalnet</DestinationHostname>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Internet Chat,Risk=20" groupRelation="and">
				<DestinationHostname condition="contains any">.slack.com;discord.;telegram.;rocketchat.;mattermost.;flock.com</DestinationHostname>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Apache Webserver" groupRelation="and">
				<Image condition="image">apache.exe</Image>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=JAVA Network Connections" groupRelation="and">
				<Image condition="image">java.exe</Image>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Microsoft IIS Webserver" groupRelation="and">
				<Image condition="image">w3wp.exe</Image>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=PHP Webserver" groupRelation="and">
				<Image condition="contains any">\php-cgi.exe;\php.exe</Image>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Setup Network connectivity" groupRelation="and">
				<Image condition="contains">setup</Image>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Tomcat Webserver connectivity" groupRelation="and">
				<Image condition="contains">tomcat</Image>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Uninstaller Network connectivity" groupRelation="and">
				<Image condition="contains">unins</Image>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Unknown Process Connecting to network" groupRelation="and">
				<Image condition="contains">unknown process</Image>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Windows Explorer Network Connection" groupRelation="and">
				<Image condition="image">explorer.exe</Image>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Windows SMTP Server" groupRelation="and">
				<Image condition="image">inetinfo.exe</Image>
			</Rule>
			<!--3rd Party tools-->
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Netcat network connection Detected" condition="contains any">netcat.exe;nc.exe;nc64.exe;ncat.exe</Image>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Procdump Detected" condition="contains any">procdump</Image>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=PSExec Network Connection" condition="contains any">psexe</Image>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=VNC Network Connection" condition="contains any">vnc;vncs;vncv</Image>
			<Rule name="Attack=T1595.002,Technique=Vulnerability Scanning,Tactic=Reconnaissance,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Port Scan Tool Detected,Risk=100" groupRelation="or">
				<Image condition="contains any">rcpping;tcpping;tcping;routerscan;grabff;Port-Scan;netscan;\nmap;ipscan;nacmdline.exe;advanced_port_scanner.exe;rcpping.exe;nmap.exe;zenmap.exe;advanced_ip_scanner.exe</Image>
			</Rule>
			<!--Destination Ports to Monitor-->
			<DestinationPort name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Port: 0" condition="is">0</DestinationPort>
			<DestinationPort name="Attack=T1028,Technique=Windows Remote Management,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Powershell Remoting,Risk=0" condition="is">5985</DestinationPort>
			<DestinationPort name="Attack=T1028,Technique=Windows Remote Management,Tactic=Lateral Movement,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Powershell Remoting,Risk=0" condition="is">5986</DestinationPort>
			<DestinationPort name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=IPSec" condition="is">1293</DestinationPort>
			<DestinationPort name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=L2TP" condition="is">1701</DestinationPort>
			<DestinationPort name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=OpenVPN,Risk=39" condition="is">1194</DestinationPort>
			<DestinationPort name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Remote Assistance Connection,Risk=20" condition="is">3540</DestinationPort>
			<DestinationPort name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Remote Desktop Connection,Risk=20" condition="is">3389</DestinationPort>
			<DestinationPort name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=SSH Port,Risk=30" condition="is">22</DestinationPort>
			<DestinationPort name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Socks Proxy Port 1080" condition="is">1080</DestinationPort>
			<DestinationPort name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Socks Proxy Port 3128" condition="is">3128</DestinationPort>
			<DestinationPort name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Socks Proxy Port 8080" condition="is">8080</DestinationPort>
			<DestinationPort name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=TOR Port" condition="is">1723</DestinationPort>
			<DestinationPort name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Telnet Port,Risk=30" condition="is">23</DestinationPort>
			<DestinationPort name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Tor Port" condition="is">4500</DestinationPort>
			<DestinationPort name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Tor Port,Risk=50" condition="is">9001</DestinationPort>
			<DestinationPort name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Tor Port,Risk=50" condition="is">9030</DestinationPort>
			<DestinationPort name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=VNC Port" condition="is">5900</DestinationPort>
			<DestinationPort name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=VNC,Risk=50" condition="is">5800</DestinationPort>
			<!--Source Ports to Monitor-->
			<SourcePort name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Port: 0" condition="is">0</SourcePort>
			<SourcePort name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=HTTP" condition="is">80</SourcePort>
			<SourcePort name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=HTTPS" condition="is">443</SourcePort>
			<SourcePort name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=LDAPS" condition="is">636</SourcePort>
			<SourcePort name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=VNC" condition="is">5900</SourcePort>
			<SourcePort name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=HTTPS" condition="is">443</SourcePort>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Web Browser HTTP Connections" groupRelation="and">
				<Image condition="contains any">\iexplore.exe;\chrome.exe;\firefox.exe;\MicrosoftEdge;msedge.exe;browser_broker.exe;\vivaldi.exe;\brave.exe;\opera.exe</Image>
				<DestinationPort condition="is">80</DestinationPort>
				<Initiated>true</Initiated>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Non-Browsers Accessing HTTPS" groupRelation="and">
				<Image condition="excludes any">\iexplore.exe;\chrome.exe;\firefox.exe;\MicrosoftEdge;msedge.exe;browser_broker.exe;\vivaldi.exe;\brave.exe</Image>
				<DestinationPortName condition="is">https</DestinationPortName>
				<Initiated>true</Initiated>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Non-Browsers Accessing HTTP" groupRelation="and">
				<Image condition="excludes any">\iexplore.exe;\chrome.exe;\firefox.exe;\MicrosoftEdge;msedge.exe;browser_broker.exe;\vivaldi.exe;\brave.exe</Image>
				<DestinationPortName condition="is">http</DestinationPortName>
				<Initiated>true</Initiated>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=Web Browser HTTPS Connections" groupRelation="and">
				<Image condition="contains any">\iexplore.exe;\chrome.exe;\firefox.exe;\MicrosoftEdge;msedge.exe;browser_broker.exe;\vivaldi.exe;\brave.exe;\opera.exe</Image>
				<DestinationPort condition="is">443</DestinationPort>
				<Initiated>true</Initiated>
			</Rule>
			<!--Suspicious network connections-->
			<DestinationHostname name="Attack=T1311,Technique=Dynamic DNS,Tactic=Adversary Opsec,DS=Network Traffic: Network Connection Creation,Level=4,Alert=Dynamic DNS Connection" condition="contains any">afraid.org;duckdns.org;changeip.com;ddns.net;hopto.org;zapto.org;servehttp.com;sytes.net;whoer.net;bravica.net;ip.webmasterhome.cn;whatsmyip.us;myip.kz;ip-addr.es;curlmyip;anysrc.net;anysrc.net;dlinkddns.com;no-ip.com;no-ip.org;no-ip.biz;no-ip.info;noip.com</DestinationHostname>
		</NetworkConnect>
	</RuleGroup>
	<RuleGroup name="RG=NetworkConnect Exclude Group" groupRelation="or">
		<NetworkConnect onmatch="exclude">
			<Protocol condition="contains">udp</Protocol>
			<Rule name="exclude interprocess communications with localhost" groupRelation="and">
				<Image condition="contains any">System;svchost.exe;oracle.exe;apache.exe;java.exe;php-cgi.exe;w3wp.exe;httpd;ServerManager.exe;unknown process;sql;wscript;cscript;schtasks;at.exe;reg.exe;C:\Windows\System32\find.exe</Image>
				<SourceIp condition="is any">127.0.0.1;0:0:0:0:0:0:0:1</SourceIp>
				<DestinationIp condition="is any">127.0.0.1;0:0:0:0:0:0:0:1</DestinationIp>
			</Rule>
			<!--SECTION: Custom -->
			<Rule name="exclude dest ldap port 88" groupRelation="and">
				<Image condition="image">C:\Windows\System32\lsass.exe</Image>
				<DestinationPort condition="is">88</DestinationPort>
			</Rule>
			<!--Disable Monitoring of Protocols-->
			<DestinationPortName condition="is">epmap</DestinationPortName>
			<DestinationPortName condition="is">llmnr</DestinationPortName>
			<DestinationPortName condition="is">microsoft-ds</DestinationPortName>
			<DestinationPortName condition="is">netbios-dgm</DestinationPortName>
			<DestinationPortName condition="is">ntp</DestinationPortName>
			<DestinationPortName condition="is">ssdp</DestinationPortName>
			<SourcePortName condition="is">epmap</SourcePortName>
			<SourcePortName condition="is">llmnr</SourcePortName>
			<SourcePortName condition="is">microsoft-ds</SourcePortName>
			<SourcePortName condition="is">netbios-dgm</SourcePortName>
			<SourcePortName condition="is">ntp</SourcePortName>
			<SourcePortName condition="is">ssdp</SourcePortName>
			<!--Disable Monitoring on Ports-->
			<DestinationPort name="Service=DNS" condition="is">53</DestinationPort>
			<DestinationPort name="Service=DNS" condition="is">67</DestinationPort>
			<DestinationPort name="Service=Bootp" condition="is">68</DestinationPort>
			<DestinationPort name="Service=SQL Noise" condition="is">1434</DestinationPort>
			<DestinationPort name="Service=Radius" condition="is">1812</DestinationPort>
			<DestinationPort name="Service=Teredo" condition="is">3544</DestinationPort>
			<DestinationPort name="Service=WS-Discovery" condition="is">3702</DestinationPort>
			<DestinationPort name="Service=Google Chrome Safe Search" condition="is">5228</DestinationPort>
			<DestinationPort name="Service=Bonjour/Avahi" condition="is">5353</DestinationPort>
			<DestinationPort name="Service=WSD API" condition="is">5357</DestinationPort>
			<DestinationPort name="Service=Vcenter Secure server for CIM" condition="is">5989</DestinationPort>
			<DestinationPort name="Service=Exchange WMI" condition="is">6007</DestinationPort>
			<DestinationPort name="Service=DFRS/ADFS Replication 1" condition="is">49154</DestinationPort>
			<DestinationPort name="Service=DFRS/ADFS Replication 2" condition="is">49209</DestinationPort>
			<DestinationPort name="Service=DFRS/ADFS Replication 3" condition="is">52176</DestinationPort>
			<DestinationPort name="Service=DFRS/ADFS Replication 4" condition="is">59241</DestinationPort>
			<SourcePort name="Service=DNS" condition="is">53</SourcePort>
			<SourcePort name="Service=Bootp" condition="is">67</SourcePort>
			<SourcePort name="Service=Bootp" condition="is">68</SourcePort>
			<SourcePort name="Service=Radius" condition="is">1812</SourcePort>
			<SourcePort name="Service=WS-Discovery" condition="is">3702</SourcePort>
			<SourcePort name="Service=Exchange WMI" condition="is">6007</SourcePort>
			<SourcePort name="Service=DFRS/ADFS Replication" condition="is">49154</SourcePort>
			<SourcePort name="Service=DFRS/ADFS Replication" condition="is">49209</SourcePort>
			<SourcePort name="Service=DFRS/ADFS Replication" condition="is">50646</SourcePort>
			<SourcePort name="Service=DFRS/ADFS Replication" condition="is">52176</SourcePort>
			<SourcePort name="Service=DFRS/ADFS Replication" condition="is">59241</SourcePort>
			<!--SECTION: Microsoft -->
			<DestinationHostname condition="end with">.bing.com</DestinationHostname>
			<DestinationHostname condition="end with">.cloudapp.net</DestinationHostname>
			<DestinationHostname condition="end with">.lync.com</DestinationHostname>
			<DestinationHostname condition="end with">.microsoft.com</DestinationHostname>
			<DestinationHostname condition="end with">.outlook.com</DestinationHostname>
			<DestinationHostname condition="end with">.search.msn.com</DestinationHostname>
			<DestinationHostname condition="end with">.wns.windows.com</DestinationHostname>
			<DestinationHostname condition="end with">aps.windows.com</DestinationHostname>
			<DestinationHostname condition="end with">arc.msn.com.nsatc.net</DestinationHostname>
			<DestinationHostname condition="end with">arc.msn.com</DestinationHostname>
			<DestinationHostname condition="end with">atson.telemetry.microsoft.com</DestinationHostname>
			<DestinationHostname condition="end with">au.download.windowsupdate.com</DestinationHostname>
			<DestinationHostname condition="end with">b.akamaiedge.net</DestinationHostname>
			<DestinationHostname condition="end with">bingforbusiness.com</DestinationHostname>
			<DestinationHostname condition="end with">client-office365-tas.msedge.net</DestinationHostname>
			<DestinationHostname condition="end with">config.edge.skype.com</DestinationHostname>
			<DestinationHostname condition="end with">csp.digicert.com</DestinationHostname>
			<DestinationHostname condition="end with">ctldl.windowsupdate.com</DestinationHostname>
			<DestinationHostname condition="end with">cy2.licensing.md.mp.microsoft.com.akadns.net</DestinationHostname>
			<DestinationHostname condition="end with">cy2.settings.data.microsoft.com.akadns.net</DestinationHostname>
			<DestinationHostname condition="end with">displaycatalog.mp.microsoft.com</DestinationHostname>
			<DestinationHostname condition="end with">download.windowsupdate.com</DestinationHostname>
			<DestinationHostname condition="end with">e-msedge.net</DestinationHostname>
			<DestinationHostname condition="end with">e3.delivery.dsp.mp.microsoft.com.nsatc.net</DestinationHostname>
			<DestinationHostname condition="end with">emdl.ws.microsoft.com</DestinationHostname>
			<DestinationHostname condition="end with">ettings-win.data.microsoft.com</DestinationHostname>
			<DestinationHostname condition="end with">fe2.update.microsoft.com</DestinationHostname>
			<DestinationHostname condition="end with">fe3.delivery.dsp.mp.microsoft.com.nsatc.net</DestinationHostname>
			<DestinationHostname condition="end with">fe3.delivery.mp.microsoft.com</DestinationHostname>
			<DestinationHostname condition="end with">g.akamaiedge.net</DestinationHostname>
			<DestinationHostname condition="end with">g.live.com</DestinationHostname>
			<DestinationHostname condition="end with">g.msn.com.nsatc.net</DestinationHostname>
			<DestinationHostname condition="end with">geo-prod.do.dsp.mp.microsoft.com</DestinationHostname>
			<DestinationHostname condition="end with">geo-prod.dodsp.mp.microsoft.com.nsatc.net</DestinationHostname>
			<DestinationHostname condition="end with">ile-service.weather.microsoft.com</DestinationHostname>
			<DestinationHostname condition="end with">ip5.afdorigin-prod-am02.afdogw.com</DestinationHostname>
			<DestinationHostname condition="end with">ipv4.login.msa.akadns6.net</DestinationHostname>
			<DestinationHostname condition="end with">licensing.mp.microsoft.com</DestinationHostname>
			<DestinationHostname condition="end with">m3p.wns.notify.windows.com.akadns.net</DestinationHostname>
			<DestinationHostname condition="end with">microsoft.com.akadns.net</DestinationHostname>
			<DestinationHostname condition="end with">microsoft.com.nsatc.net</DestinationHostname>
			<DestinationHostname condition="end with">microsoft.com</DestinationHostname>
			<DestinationHostname condition="end with">modern.watson.data.microsoft.com.akadns.net</DestinationHostname>
			<DestinationHostname condition="end with">msedge.net</DestinationHostname>
			<DestinationHostname condition="end with">msn.com.nsatc.net</DestinationHostname>
			<DestinationHostname condition="end with">msn.com</DestinationHostname>
			<DestinationHostname condition="end with">ocation-inference-westus.cloudapp.net</DestinationHostname>
			<DestinationHostname condition="end with">ocos-office365-s2s.msedge.net</DestinationHostname>
			<DestinationHostname condition="end with">ocsp.digicert.com</DestinationHostname>
			<DestinationHostname condition="end with">odern.watson.data.microsoft.com.akadns.net</DestinationHostname>
			<DestinationHostname condition="end with">oneclient.sfx.ms</DestinationHostname>
			<DestinationHostname condition="end with">pv4.login.msa.akadns6.net</DestinationHostname>
			<DestinationHostname condition="end with">query.prod.cms.rt.microsoft.com</DestinationHostname>
			<DestinationHostname condition="end with">ris.api.iris.microsoft.com.akadns.net</DestinationHostname>
			<DestinationHostname condition="end with">ris.api.iris.microsoft.com</DestinationHostname>
			<DestinationHostname condition="end with">s-msedge.net</DestinationHostname>
			<DestinationHostname condition="end with">settings.data.microsoft.com</DestinationHostname>
			<DestinationHostname condition="end with">sfe.trafficshaping.dsp.mp.microsoft.com</DestinationHostname>
			<DestinationHostname condition="end with">sls.update.microsoft.com</DestinationHostname>
			<DestinationHostname condition="end with">storecatalogrevocation.storequality.microsoft.com</DestinationHostname>
			<DestinationHostname condition="end with">storeedgefd.dsx.mp.microsoft.com</DestinationHostname>
			<DestinationHostname condition="end with">telecommand.telemetry.microsoft.com.akadns.net</DestinationHostname>
			<DestinationHostname condition="end with">tile-service.weather.microsoft.com</DestinationHostname>
			<DestinationHostname condition="end with">tlu.dl.delivery.mp.microsoft.com</DestinationHostname>
			<DestinationHostname condition="end with">tsfe.trafficshaping.dsp.mp.microsoft.com</DestinationHostname>
			<DestinationHostname condition="end with">vip5.afdorigin-prod-am02.afdogw.com</DestinationHostname>
			<DestinationHostname condition="end with">vip5.afdorigin-prod-ch02.afdogw.com</DestinationHostname>
			<DestinationHostname condition="end with">virtualearth.net</DestinationHostname>
			<DestinationHostname condition="end with">windows.net</DestinationHostname>
			<DestinationHostname condition="end with">windowsupdate.com</DestinationHostname>
			<DestinationHostname condition="end with">y2.displaycatalog.md.mp.microsoft.com.akadns.net</DestinationHostname>
			<DestinationHostname condition="end with">y2.licensing.md.mp.microsoft.com.akadns.net</DestinationHostname>
			<DestinationHostname condition="end with">y2.settings.data.microsoft.com.akadns.net</DestinationHostname>
			<Image condition="image">EdgeTransport.exe</Image>
			<Image condition="image">MSExchangeDelivery.exe</Image>
			<Image condition="image">MSExchangeFrontendTransport.exe</Image>
			<Image condition="image">MSExchangeHMWorker.exe</Image>
			<Image condition="image">MSExchangeSubmission.exe</Image>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Connection Creation,Level=0,Desc=UNC Path Network Connections" condition="begin with">\</Image>
			<!--SECTION: Antivirus Exclusions -->
			<Rule name="Antivirus Exclusions" groupRelation="or">
				<Image condition="begin with">C:\Program Files (x86)\Kaspersky Lab</Image> 
				<Image condition="begin with">C:\Program Files\Kaspersky Lab</Image>
				<Image condition="begin with">C:\Program Files (x86)\ESET</Image>
				<Image condition="begin with">C:\Program Files\ESET</Image>
			</Rule>
		</NetworkConnect>
	</RuleGroup>
	<!--SYSMON EVENT ID 4 : RESERVED FOR SYSMON STATUS MESSAGES-->

		<!--DATA: UtcTime, State, Version, SchemaVersion-->
		<!--Cannot be filtered.-->

	<!--SYSMON EVENT ID 5 : PROCESS ENDED [ProcessTerminate]-->
		<!--COMMENT:	Useful data in building infection timelines.-->
		<RuleGroup name="RG=ProcessTerminate Include Group" groupRelation="or">
		<ProcessTerminate onmatch="include">
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=Process Termination Events in Windows Directory" groupRelation="and">
				<Image condition="begin with">C:\Windows\</Image>
				<Image condition="excludes">\System32\;Syswow64;sysmon.exe;sysmon64.exe</Image>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=Process Termination Events in System32" groupRelation="and">
				<Image condition="begin with">C:\Windows\system32\</Image>
				<Image condition="excludes">config\systemprofile\</Image>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=Process Termination of Sysmon" groupRelation="and">
				<Image condition="contains any">C:\Windows\sysmon.exe;C:\Windows\sysmon64.exe</Image>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=Process Termination Events in Root folders" groupRelation="and">
				<Image condition="contains any">A:\;B:\;C:\;D:\;E:\;F:\;G:\;H:\;I:\;J:\;K:\;L:\;M:\;N:\;O:\;P:\;Q:\;R:\;S:\;T:\;U:\;V:\;W:\;X:\;Y:\;Z:\;AA:\;BB:\;CC:\;DD:\;EE:\;FF:\;GG:\;HH:\;II:\;JJ:\;KK:\;LL:\;MM:\;NN:\;OO:\;PP:\;QQ:\;RR:\;SS:\;TT:\;UU:\;VV:\;WW:\;XX:\;YY;ZZ:\</Image>
				<Image condition="excludes">:\PROGRA~</Image>
				<Image condition="excludes">:\Program Files</Image>
				<Image condition="excludes">:\Program Files</Image>
				<Image condition="excludes">:\Program Files</Image>
				<Image condition="excludes">:\ProgramData\</Image>
				<Image condition="excludes">:\Users\</Image>
				<Image condition="excludes">:\Windows\</Image>
				<Image condition="excludes">:\inetpub\</Image>
				<Image condition="excludes">:\$SysReset</Image>
				<Image condition="excludes">:\$WinREAgent</Image>
				<Image condition="excludes">:\inetpub\</Image>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=Process Termination Events of UNC File Paths" groupRelation="and">
				<Image condition="begin with">\</Image>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=Process Termination Events in Users Directory" groupRelation="and">
				<Image condition="begin with">C:\Users\</Image>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=Process Termination Events in ProgramData Directory" groupRelation="and">
				<Image condition="begin with">C:\ProgramData\</Image>
				<Image condition="excludes any">C:\ProgramData\sysmon\sysmon64.exe;C:\ProgramData\sysmon\sysmon.exe</Image>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=Process Termination Events in Program Files Directories" groupRelation="and">
				<Image condition="contains any">C:\Program Files;C:\PROGRA~</Image>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=Process Termination Events in inetpub Directories" groupRelation="and">
				<Image condition="begin with">C:\inetpub\</Image>
			</Rule>
		<!-- Useful data in building infection timelines.-->
			<Image name="Attack=T1036,Tactic=Masquerading,Technique=Defense Evasion,DS=Process: Process Termination,Level=4,Alert=Process Termination in Recyclebin,Risk=100" condition="contains">$RECYCLE.BIN</Image>
			<Image name="Attack=T1562,Technique=Impair Defenses,Tactic=Defense Evasion,DS=Process: Process Termination,Level=0,Desc=Process Terminate: Killing of Log Shippers" condition="contains any">packetbeat.exe;metricbeat.exe;filebeat.exe;winlogbeat.exe;o365beat.exe;graylog-sidecar.exe;graylog-collector-sidecar.exe;splunkd.exe;splunk.exe;syslogng.exe;syslog-ng.exe;nxlog-processor.exe;snarecore.exe;fluentd;td-agent</Image>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=Process Termination in System Profile" condition="begin with">C:\Windows\system32\config\systemprofile\</Image>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=Process Termination in System Profile" condition="begin with">C:\Windows\sysWOW64\config\systemprofile\</Image>
			<Image condition="contains">\Temp\</Image>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Termination,Level=0,Desc=User Process Terminations" condition="contains">C:\Users\</Image>
		</ProcessTerminate>
	</RuleGroup>
	<RuleGroup name="RG=ProcessTerminate Exclude Group" groupRelation="or">
			<ProcessTerminate onmatch="exclude">
			<Image condition="end with">Microsoft\Teams\current\Teams.exe</Image>
			<Image condition="end with">\git.exe</Image>
			<Image condition="end with">Microsoft\EdgeUpdate\MicrosoftEdgeUpdate.exe</Image>
			<Image condition="begin with">C:\ProgramData\Lenovo\ImController\</Image>
		</ProcessTerminate>
	</RuleGroup>
	<!--SYSMON EVENT ID 6 : DRIVER LOADED INTO KERNEL [DriverLoad]-->
	<RuleGroup name="RG=DriverLoad Include Group" groupRelation="or">
		<DriverLoad onmatch="include">
			<Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=Driver: Driver Load,Level=4,Alert=Solarwinds/FireEye sunburst driver hashes,Risk=100" groupRelation="and">
				<Hashes condition="contains any">56ceb6d0011d87b6e4d7023d7ef85676;4f2eb62fa529c0283b28d05ddd311fae;b91ce2fa41029f6955bff20079468448;b91ce2fa41029f6955bff20079468448;846e27a652a5e1bfbd0ddd38a16dc865;2c4a910a1299cdae2a4e55988a2f102e</Hashes><!-- exclude non executable files -->
			</Rule>
			<Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=Driver: Driver Load,Level=4,Alert=Vulnerable Dell Drivers Detected,Risk=100" groupRelation="and">
				<Hashes condition="contains any">0296e2ce999e67c76352613a718e11516fe1b0efc3ffdb8918fc999dd76a73a5;c948ae14761095e4d76b55d9de86412258be7afd;c996d7971c49252c582171d9380360f2;ddbf5ecca5c8086afde1fb4f551e9e6400e94f4428fe7fb5559da5cffa654cc1;10b30bdee43b3a2ec4aa63375577ade650269d25;d2fd132ab7bbc6bbb87a84f026fa0244</Hashes><!-- exclude non executable files -->
			</Rule>
			<ImageLoaded name="Attack=T1003,Tactic=Credential Access,Technique=OS Credential Dumping,DS=Driver: Driver Load,Level=4,Alert=DumpExt.dll driver loaded,Risk=100" condition="contains">DumpExt.dll</ImageLoaded>
			<ImageLoaded name="Attack=T1003,Tactic=Credential Access,Technique=OS Credential Dumping,DS=Driver: Driver Load,Level=4,Alert=Mimikatz driver loaded,Risk=100" condition="contains">mimidrv</ImageLoaded>
			<ImageLoaded name="Attack=T1003,Tactic=Credential Access,Technique=OS Credential Dumping,DS=Driver: Driver Load,Level=4,Alert=PWDump6 driver loaded,Risk=100" condition="contains">lsremora</ImageLoaded>
			<ImageLoaded name="Attack=T1003,Tactic=Credential Access,Technique=OS Credential Dumping,DS=Driver: Driver Load,Level=4,Alert=wceaux.dll driver loaded,Risk=100" condition="contains">wceaux.dll</ImageLoaded>
			<ImageLoaded name="Attack=T1040,Tactic=Discovery,Technique=Network Sniffing,DS=Driver: Driver Load,Level=4,Alert=NPCap packet capture driver loaded,Risk=100" condition="contains">npcap</ImageLoaded>
			<ImageLoaded name="Attack=None,Technique=None,Tactic=None,DS=Driver: Driver Load,Level=0,Desc=Driver Loaded in Temp" condition="contains">\Temp</ImageLoaded>
			<ImageLoaded name="Attack=None,Technique=None,Tactic=None,DS=Driver: Driver Load,Level=0,Desc=Driver Loaded in Users Directories" condition="contains">:\Users</ImageLoaded>
			<Signature name="Attack=T1019,Technique=System Firmware,Tactic=Persistence,DS=Driver: Driver Load,Level=4,Alert=UEFI Rootkit detection,Risk=100" condition="contains">ChongKim Chan</Signature>
			<SignatureStatus condition="contains">?</SignatureStatus>
			<SignatureStatus condition="contains">Revoked</SignatureStatus>
			<SignatureStatus condition="contains">Unavailable</SignatureStatus>
			<SignatureStatus condition="contains">Valid</SignatureStatus>
			<Signed name="Attack=None,Technique=None,Tactic=None,DS=Driver: Driver Load,Level=0,Desc=Unsigned Driver loaded into Kernel" condition="contains">false</Signed>
			<Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Driver: Driver Load,Level=4,Alert=Vulnerable Driver Loaded,Risk=100,Author=Nasreddine Bencherchali,Risk=75" groupRelation="or">
				<!--# List below is from https://github.com/namazso/physmem_drivers and the SHA1 are from VT-->
				<Hashes condition="contains">SHA1=2261198385d62d2117f50f631652eded0ecc71db</Hashes>
				<Hashes condition="contains">SHA1=8db869c0674221a2d3280143cbb0807fac08e0cc</Hashes>
				<Hashes condition="contains">SHA1=27d3ebea7655a72e6e8b95053753a25db944ec0f</Hashes>
				<Hashes condition="contains">SHA1=33cdab3bbc8b3adce4067a1b042778607dce2acd</Hashes>
				<Hashes condition="contains">SHA1=21e6c104fe9731c874fab5c9560c929b2857b918</Hashes>
				<Hashes condition="contains">SHA1=d979353d04bf65cc92ad3412605bc81edbb75ec2</Hashes>
				<Hashes condition="contains">SHA1=2f991435a6f58e25c103a657d24ed892b99690b8</Hashes>
				<Hashes condition="contains">SHA1=f02af84393e9627ba808d4159841854a6601cf80</Hashes>
				<Hashes condition="contains">SHA1=bb962c9a8dda93e94fef504c4159de881e4706fe</Hashes>
				<Hashes condition="contains">SHA1=b97a8d506be2e7eaa4385f70c009b22adbd071ba</Hashes>
				<Hashes condition="contains">SHA1=92f251358b3fe86fd5e7aa9b17330afa0d64a705</Hashes>
				<Hashes condition="contains">SHA1=8b6aa5b2bff44766ef7afbe095966a71bc4183fa</Hashes>
				<Hashes condition="contains">SHA1=af6e1f2cfb230907476e8b2d676129b6d6657124</Hashes>
				<Hashes condition="contains">SHA1=fcde5275ee1913509927ce5f0f85e6681064c9d2</Hashes>
				<Hashes condition="contains">SHA1=00a442a4305c62cefa8105c0b4c4a9a5f4d1e93b</Hashes>
				<Hashes condition="contains">SHA1=6523b3fd87de39eb5db1332e4523ce99556077dc</Hashes>
				<Hashes condition="contains">SHA1=72966ca845759d239d09da0de7eebe3abe86fee3</Hashes>
				<Hashes condition="contains">SHA1=57511ef5ff8162a9d793071b5bf7ebe8371759de</Hashes>
				<Hashes condition="contains">SHA1=2d503a2457a787014a1fdd48a2ece2e6cbe98ea7</Hashes>
				<Hashes condition="contains">SHA1=400f833dcc2ef0a122dd0e0b1ec4ec929340d90e</Hashes>
				<Hashes condition="contains">SHA1=89cd760e8cb19d29ee08c430fb17a5fd4455c741</Hashes>
				<Hashes condition="contains">SHA1=1d0df45ee3fa758f0470e055915004e6eae54c95</Hashes>
				<Hashes condition="contains">SHA1=d5fd9fe10405c4f90235e583526164cd0902ed86</Hashes>
				<Hashes condition="contains">SHA1=c52cef5b9e1d4a78431b7af56a6fdb6aa1bcad65</Hashes>
				<Hashes condition="contains">SHA1=609fa1efcf61e26d64a5ceb13b044175ab2b3a13</Hashes>
				<Hashes condition="contains">SHA1=7d7c03e22049a725ace2a9812c72b53a66c2548b</Hashes>
				<Hashes condition="contains">SHA1=f9519d033d75e1ab6b82b2e156eafe9607edbcfb</Hashes>
				<Hashes condition="contains">SHA1=468e2e5505a3d924b14fedee4ddf240d09393776</Hashes>
				<Hashes condition="contains">SHA1=2e3de9bff43d7712707ef8a0b10f7e4ad8427fd8</Hashes>
				<Hashes condition="contains">SHA1=c9cbfdd0be7b35751a017ec59ff7237ffdc4df1f</Hashes>
				<Hashes condition="contains">SHA1=078ae07dec258db4376d5a2a05b9b508d68c0123</Hashes>
				<Hashes condition="contains">SHA1=623cd2abef6c92255f79cbbd3309cb59176771da</Hashes>
				<Hashes condition="contains">SHA1=1f3a9265963b660392c4053329eb9436deeed339</Hashes>
				<Hashes condition="contains">SHA1=4a235f0b84ff615e2879fa9e0ec0d745fcfdaa5c</Hashes>
				<Hashes condition="contains">SHA1=ace6b9e34e3e2e73fe584f3bbdb4e4ec106e0a7d</Hashes>
				<Hashes condition="contains">SHA1=4268f30b79ce125a81d0d588bef0d4e2ad409bbb</Hashes>
				<Hashes condition="contains">SHA1=c834c4931b074665d56ccab437dfcc326649d612</Hashes>
				<Hashes condition="contains">SHA1=8f5cd4a56e6e15935491aa40adb1ecad61eafe7c</Hashes>
				<Hashes condition="contains">SHA1=51b60eaa228458dee605430aae1bc26f3fc62325</Hashes>
				<Hashes condition="contains">SHA1=3270720a066492b046d7180ca6e60602c764cac7</Hashes>
				<Hashes condition="contains">SHA1=2a6e6bd51c7062ad24c02a4d2c1b5e948908d131</Hashes>
				<Hashes condition="contains">SHA1=19bd488fe54b011f387e8c5d202a70019a204adf</Hashes>
				<Hashes condition="contains">SHA1=a6fe4f30ca7cb94d74bc6d42cdd09a136056952e</Hashes>
				<Hashes condition="contains">SHA1=ea877092d57373cb466b44e7dbcad4ce9a547344</Hashes>
				<Hashes condition="contains">SHA1=205c69f078a563f54f4c0da2d02a25e284370251</Hashes>
				<Hashes condition="contains">SHA1=f9feb60b23ca69072ce42264cd821fe588a186a6</Hashes>
				<Hashes condition="contains">SHA1=b25170e09c9fb7c0599bfba3cf617187f6a733ac</Hashes>
				<Hashes condition="contains">SHA1=160c96b5e5db8c96b821895582b501e3c2d5d6e7</Hashes>
				<Hashes condition="contains">SHA1=a2e0b3162cfa336cd4ab40a2acc95abe7dc53843</Hashes>
				<Hashes condition="contains">SHA1=4e826430a1389032f3fe06e2cc292f643fb0c417</Hashes>
				<Hashes condition="contains">SHA1=7ab4565ba24268f0adadb03a5506d4eb1dc7c181</Hashes>
				<Hashes condition="contains">SHA1=dc7b022f8bd149efbcb2204a48dce75c72633526</Hashes>
				<Hashes condition="contains">SHA1=0307d76750dd98d707c699aee3b626643afb6936</Hashes>
				<Hashes condition="contains">SHA1=5711c88e9e64e45b8fc4b90ab6f2dd6437dc5a8a</Hashes>
				<Hashes condition="contains">SHA1=6714380bc0b8ab09b9a0d2fa66d1b025b646b946</Hashes>
				<Hashes condition="contains">SHA1=8626ab1da6bfbdf61bd327eb944b39fd9df33d1d</Hashes>
				<Hashes condition="contains">SHA1=30a224b22592d952fbe2e6ad97eda4a8f2c734e0</Hashes>
				<Hashes condition="contains">SHA1=c95db1e82619fb16f8eec9a8209b7b0e853a4ebe</Hashes>
				<Hashes condition="contains">SHA1=fe1d909ab38de1389a2a48352fd1c8415fd2eab0</Hashes>
				<Hashes condition="contains">SHA1=b4d1554ec19504215d27de0758e13c35ddd6db3e</Hashes>
				<Hashes condition="contains">SHA1=5dd2c31c4357a8b76db095364952b3d0e3935e1d</Hashes>
				<Hashes condition="contains">SHA1=ecb4d096a9c58643b02f328d2c7742a38e017cf0</Hashes>
				<Hashes condition="contains">SHA1=4a705af959af61bad48ef7579f839cb5ebd654d2</Hashes>
				<Hashes condition="contains">SHA1=d2e6fc9259420f0c9b6b1769be3b1f63eb36dc57</Hashes>
				<Hashes condition="contains">SHA1=c948ae14761095e4d76b55d9de86412258be7afd</Hashes>
				<Hashes condition="contains">SHA1=ddbe809b731a0962e404a045ab9e65a0b64917ad</Hashes>
				<Hashes condition="contains">SHA1=745bad097052134548fe159f158c04be5616afc2</Hashes>
				<Hashes condition="contains">SHA1=8d59fd14a445c8f3f0f7991fa6cd717d466b3754</Hashes>
				<Hashes condition="contains">SHA1=2dfcb799b3c42ecb0472e27c19b24ac7532775ce</Hashes>
				<Hashes condition="contains">SHA1=cc51be79ae56bc97211f6b73cc905c3492da8f9d</Hashes>
				<Hashes condition="contains">SHA1=ac13941f436139b909d105ad55637e1308f49d9a</Hashes>
				<Hashes condition="contains">SHA1=2b0bb408ff0e66bcdf6574f1ca52cbf4015b257b</Hashes>
				<Hashes condition="contains">SHA1=cc0e0440adc058615e31e8a52372abadf658e6b1</Hashes>
				<Hashes condition="contains">SHA1=5520ac25d81550a255dc16a0bb89d4b275f6f809</Hashes>
				<Hashes condition="contains">SHA1=6afc6b04cf73dd461e4a4956365f25c1f1162387</Hashes>
				<Hashes condition="contains">SHA1=4b009e91bae8d27b160dc195f10c095f8a2441e1</Hashes>
				<Hashes condition="contains">SHA1=6003184788cd3d2fc624ca801df291ccc4e225ee</Hashes>
				<Hashes condition="contains">SHA1=0466e90bf0e83b776ca8716e01d35a8a2e5f96d3</Hashes>
				<Hashes condition="contains">SHA1=e6305dddd06490d7f87e3b06d09e9d4c1c643af0</Hashes>
				<Hashes condition="contains">SHA1=89909fa481ff67d7449ee90d24c167b17b0612f1</Hashes>
				<Hashes condition="contains">SHA1=d7e8aef8c8feb87ce722c0b9abf34a7e6bab6eb4</Hashes>
				<Hashes condition="contains">SHA1=5e6ddd2b39a3de0016385cbd7aa50e49451e376d</Hashes>
				<Hashes condition="contains">SHA1=976777d39d73034df6b113dfce1aa6e1d00ffcfd</Hashes>
				<Hashes condition="contains">SHA1=9c6749fc6c1127f8788bff70e0ce9062959637c9</Hashes>
				<Hashes condition="contains">SHA1=53acd4d9e7ba0b1056cf52af0d191f226eddf312</Hashes>
				<Hashes condition="contains">SHA1=3abb9d0a9d600200ae19c706e570465ef0a15643</Hashes>
				<Hashes condition="contains">SHA1=27eab595ec403580236e04101172247c4f5d5426</Hashes>
				<Hashes condition="contains">SHA1=78b9481607ca6f3a80b4515c432ddfe6550b18a8</Hashes>
				<Hashes condition="contains">SHA1=414cd15d6c991d19fb5be02e3b9fb0e6c5ce731c</Hashes>
				<Hashes condition="contains">SHA1=d9c09dd725bc7bc3c19b4db37866015817a516ef</Hashes>
				<Hashes condition="contains">SHA1=9c256edd10823ca76c0443a330e523027b70522d</Hashes>
				<Hashes condition="contains">SHA1=35829e096a15e559fcbabf3441d99e580ca3b26e</Hashes>
				<Hashes condition="contains">SHA1=b8de3a1aeeda9deea43e3f768071125851c85bd0</Hashes>
				<Hashes condition="contains">SHA1=054a50293c7b4eea064c91ef59cf120d8100f237</Hashes>
				<Hashes condition="contains">SHA1=d94f2fb3198e14bfe69b44fb9f00f2551f7248b2</Hashes>
				<Hashes condition="contains">SHA1=01a578a3a39697c4de8e3dab04dba55a4c35163e</Hashes>
				<Hashes condition="contains">SHA1=14bf0eaa90e012169745b3e30c281a327751e316</Hashes>
				<Hashes condition="contains">SHA1=f50c6b84dfb8f2d53ba3bce000a55f0a486c0e79</Hashes>
				<Hashes condition="contains">SHA1=6100eb82a25d64a7a7702e94c2b21333bc15bd08</Hashes>
				<Hashes condition="contains">SHA1=bf87e32a651bdfd9b9244a8cf24fca0e459eb614</Hashes>
				<Hashes condition="contains">SHA1=28b1c0b91eb6afd2d26b239c9f93beb053867a1a</Hashes>
				<Hashes condition="contains">SHA1=879fcc6795cebe67718388228e715c470de87dca</Hashes>
				<Hashes condition="contains">SHA1=1f7501e01d84a2297c85cb39880ec4e40ac3fe8a</Hashes>
				<Hashes condition="contains">SHA1=152b6bb9ffd2ffec00cc46f5c6e29362d0e66e67</Hashes>
				<Hashes condition="contains">SHA1=5f8356ffa8201f338dd2ea979eb47881a6db9f03</Hashes>
				<Hashes condition="contains">SHA1=a7bd05de737f8ea57857f1e0845a25677df01872</Hashes>
				<Hashes condition="contains">SHA1=cce9b82f01ec68f450f5fe4312f40d929c6a506e</Hashes>
				<Hashes condition="contains">SHA1=e35a2b009d54e1a0b231d8a276251f64231b66a3</Hashes>
				<Hashes condition="contains">SHA1=37364cb5f5cefd68e5eca56f95c0ab4aff43afcc</Hashes>
				<Hashes condition="contains">SHA1=d62fa51e520022483bdc5847141658de689c0c29</Hashes>
				<Hashes condition="contains">SHA1=93aa3bb934b74160446df3a47fa085fd7f3a6be9</Hashes>
				<Hashes condition="contains">SHA1=ec4cc6de4c779bb1ca1dd32ee3a03f7e8d633a9b</Hashes>
				<Hashes condition="contains">SHA1=35f1ba60ba0da8512a0b1b15ee8e30fe240d77cd</Hashes>
				<Hashes condition="contains">SHA1=3805e4e08ad342d224973ecdade8b00c40ed31be</Hashes>
				<Hashes condition="contains">SHA1=65d8a7c2e867b22d1c14592b020c548dd0665646</Hashes>
				<Hashes condition="contains">SHA1=c8d87f3cd34c572870e63a696cf771580e6ea81b</Hashes>
				<Hashes condition="contains">SHA1=c4d7fb9db3c3459f7e8c0e3d48c95c7c9c4cff60</Hashes>
				<Hashes condition="contains">SHA1=d34a7c497c603f3f7fcad546dc4097c2da17c430</Hashes>
				<Hashes condition="contains">SHA1=1fd7f881ea4a1dbb5c9aeb9e7ad659a85421745b</Hashes>
				<Hashes condition="contains">SHA1=0b8b83f245d94107cb802a285e6529161d9a834d</Hashes>
				<Hashes condition="contains">SHA1=c969f1f73922fd95db1992a5b552fbc488366a40</Hashes>
				<Hashes condition="contains">SHA1=ac600a2bc06b312d92e649b7b55e3e91e9d63451</Hashes>
				<Hashes condition="contains">SHA1=da9cea92f996f938f699902482ac5313d5e8b28e</Hashes>
				<Hashes condition="contains">SHA1=33285b2e97a0aeb317166cce91f6733cf9c1ad53</Hashes>
				<Hashes condition="contains">SHA1=21edff2937eb5cd6f6b0acb7ee5247681f624260</Hashes>
				<Hashes condition="contains">SHA1=f052dc35b74a1a6246842fbb35eb481577537826</Hashes>
				<Hashes condition="contains">SHA1=f0c463d29a5914b01e4607889094f1b7d95e7aaf</Hashes>
				<Hashes condition="contains">SHA1=0c26ab1299adcd9a385b541ef1653728270aa23e</Hashes>
				<Hashes condition="contains">SHA1=f36a47edfacd85e0c6d4d22133dd386aee4eec15</Hashes>
				<Hashes condition="contains">SHA1=460008b1ffd31792a6deadfa6280fb2a30c8a5d2</Hashes>
				<Hashes condition="contains">SHA1=738b7918d85e5cb4395df9e3f6fc94ddad90e939</Hashes>
				<Hashes condition="contains">SHA1=43419df1f9a07430a18c5f3b3cc74de621be0f8e</Hashes>
				<Hashes condition="contains">SHA1=558aad879b6a47d94a968f39d0a4e3a3aaef1ef1</Hashes>
				<Hashes condition="contains">SHA1=7fb52290883a6b69a96d480f2867643396727e83</Hashes>
				<!--# The list below is from https://github.com/jbaines-r7/dellicious and https://www.rapid7.com/blog/post/2021/12/13/driver-based-attacks-past-and-present/ -->
				<Hashes condition="contains">SHA1=f5696fb352a3fbd14fb1a89ad21a71776027f9ab</Hashes>
				<Hashes condition="contains">SHA1=693a2645c28fc3b248fda95179c36c3ac64f6fc2</Hashes>
				<Hashes condition="contains">SHA1=05c0c49e8bcf11b883d41441ce87a2ee7a3aba1d</Hashes>
				<Hashes condition="contains">SHA1=d25340ae8e92a6d29f599fef426a2bc1b5217299</Hashes>
				<Hashes condition="contains">SHA1=7c1b25518dee1e30b5a6eaa1ea8e4a3780c24d0c</Hashes>
				<Hashes condition="contains">SHA1=fe10018af723986db50701c8532df5ed98b17c39</Hashes>
				<Hashes condition="contains">SHA1=bfe55cacc7c56c9f7bd75bdb4b352c0b745d071b</Hashes>
				<Hashes condition="contains">SHA1=a21c84c6bf2e21d69fa06daaf19b4cc34b589347</Hashes>
				<Hashes condition="contains">SHA1=82ba5513c33e056c3f54152c8555abf555f3e745</Hashes>
				<Hashes condition="contains">SHA1=d098600152e5ee6a8238d414d2a77a34da8afaaa</Hashes>
				<Hashes condition="contains">SHA1=64e4ac8b9ea2f050933b7ec76a55dd04e97773b4</Hashes>
				<Hashes condition="contains">SHA1=bbc1e5fd826961d93b76abd161314cb3592c4436</Hashes>
				<Hashes condition="contains">SHA1=90a76945fd2fa45fab2b7bcfdaf6563595f94891</Hashes>
				<Hashes condition="contains">SHA1=b03b1996a40bfea72e4584b82f6b845c503a9748</Hashes>
				<Hashes condition="contains">SHA1=c771ea59f075170e952c393cfd6fc784b265027c</Hashes>
				<Hashes condition="contains">SHA1=cb44c6f0ee51cb4c5836499bc61dd6c1fbdf8aa1</Hashes>
				<Hashes condition="contains">SHA1=0918277fcdc64a9dc51c04324377b3468fa1269b</Hashes>
				<Hashes condition="contains">SHA1=b09bcc042d60d2f4c0d08284818ed198cededa04</Hashes>
				<!--# The list below is from https://gist.github.com/k4nfr3/af970e7facb09195e56f2112e1c9549c -->
				<Hashes condition="contains">SHA1=8dc2097a90eb7e9d6ee31a7c7a95e7a0b2093b89</Hashes>
				<Hashes condition="contains">SHA1=15df139494d2c40a645fb010908551185c27f3c5</Hashes>
				<Hashes condition="contains">SHA1=012db3a80faf1f7f727b538cbe5d94064e7159de</Hashes>
				<Hashes condition="contains">SHA1=d04e5db5b6c848a29732bfd52029001f23c3da75</Hashes>
				<Hashes condition="contains">SHA1=490109fa6739f114651f4199196c5121d1c6bdf2</Hashes>
				<Hashes condition="contains">SHA1=b4d014b5edd6e19ce0e8395a64faedf49688ecb5</Hashes>
				<Hashes condition="contains">SHA1=a87d6eac2d70a3fbc04e59412326b28001c179de</Hashes>
				<Hashes condition="contains">SHA1=3f223581409492172a1e875f130f3485b90fbe5f</Hashes>
				<Hashes condition="contains">SHA1=5db61d00a001fd493591dc919f69b14713889fc5</Hashes>
				<!--# https://github.com/eclypsium/Screwed-Drivers/blob/master/DRIVERS.md -->
				<Hashes condition="contains">SHA1=9923c8f1e565a05b3c738d283cf5c0ed61a0b90f</Hashes>
				<Hashes condition="contains">SHA1=15d1a6a904c8409fb47a82aefa42f8c3c7d8c370</Hashes>
				<Hashes condition="contains">SHA1=9d07df024ec457168bf0be7e0009619f6ac4f13c</Hashes>
				<Hashes condition="contains">SHA1=9a35ae9a1f95ce4be64adc604c80079173e4a676</Hashes>
				<Hashes condition="contains">SHA1=c6bd965300f07012d1b651a9b8776028c45b149a</Hashes>
				<Hashes condition="contains">SHA1=e83458c4a6383223759cd8024e60c17be4e7c85f</Hashes>
				<Hashes condition="contains">SHA1=cb3de54667548a5c9abf5d8fa47db4097fcee9f1</Hashes>
				<Hashes condition="contains">SHA1=9c24dd75e4074041dbe03bf21f050c77d748b8e9</Hashes>
				<Hashes condition="contains">SHA1=dc55217b6043d819eadebd423ff07704ee103231</Hashes>
				<Hashes condition="contains">SHA1=e92817a8744ebc4e4fa5383cdce2b2977f01ecd4</Hashes>
				<Hashes condition="contains">SHA1=dc0e97adb756c0f30b41840a59b85218cbdd198f</Hashes>
				<Hashes condition="contains">SHA1=26c4a7b392d7e7bd7f0a2a758534e45c0d9a56ab</Hashes>
				<Hashes condition="contains">SHA1=d0d39e1061f30946141b6ecfa0957f8cc3ddeb63</Hashes>
				<Hashes condition="contains">SHA1=c6d349823bbb1f5b44bae91357895dba653c5861</Hashes>
				<Hashes condition="contains">SHA1=f42f28d164205d9f6dab9317c9fecad54c38d5d2</Hashes>
				<Hashes condition="contains">SHA1=bbc0b9fd67c8f4cefa3d76fcb29ff3cef996b825</Hashes>
				<Hashes condition="contains">SHA1=8183a341ba6c3ce1948bf9be49ab5320e0ee324d</Hashes>
				<Hashes condition="contains">SHA1=eb1ecad3d37bb980f908bf1a912415cff32e79e6</Hashes>
				<Hashes condition="contains">SHA1=eb0d45aa6f537f5b2f90f3ad99013606eafcd162</Hashes>
				<Hashes condition="contains">SHA1=6053d258096bccb07cb0057d700fe05233ab1fbb</Hashes>
				<Hashes condition="contains">SHA1=29a190727140f40cea9514a6420f5a195e36386b</Hashes>
				<Hashes condition="contains">SHA1=a4b2c56c12799855162ca3b004b4b2078c6ecf77</Hashes>
				<Hashes condition="contains">SHA1=7667b72471689151e176baeba4e1cd9cd006a09a</Hashes>
				<Hashes condition="contains">SHA1=d7f7594ff084201c0d9fa2f4ef1626635b67bce5</Hashes>
				<Hashes condition="contains">SHA1=99201c9555e5faf6e8d82da793b148311f8aa4b8</Hashes>
				<Hashes condition="contains">SHA1=947db58d6f36a8df9fa2a1057f3a7f653ccbc42e</Hashes>
				<Hashes condition="contains">SHA1=6a3d3b9ab3d201cd6b0316a7f9c3fb4d34d0f403</Hashes>
				<Hashes condition="contains">SHA1=d702d88b12233be9413446c445f22fda4a92a1d9</Hashes>
				<Hashes condition="contains">SHA1=910cb12aa49e9f35ecc4907e8304adf0dcca8cf1</Hashes>
				<Hashes condition="contains">SHA1=643383938d5e0d4fd30d302af3e9293a4798e392</Hashes>
				<Hashes condition="contains">SHA1=c4ed28fdfba7b8a8dfe39e591006f25d39990f07</Hashes>
				<!--# The list below is derived from the ELASTIC yara rules https://github.com/elastic/protections-artifacts/search?q=VulnDriver -->
				<!--# These are the hashes mentioned in the "reference_sample" section that ELASTIC used to create their rules -->
				<Hashes condition="contains">SHA1=b0032b8d8e6f4bd19a31619ce38d8e010f29a816</Hashes>
				<Hashes condition="contains">SHA1=db6245578ec57bd767b27ecf8085095e1c8e5a6e</Hashes>
				<Hashes condition="contains">SHA1=166759fd511613414d3213942fe2575b926a6226</Hashes>
				<Hashes condition="contains">SHA1=02a8b74899591da7b7f49c0450328d39b939d7e4</Hashes>
				<Hashes condition="contains">SHA1=98ceed786f79288becc08c3b82c57e8d4bfa1bca</Hashes>
				<Hashes condition="contains">SHA1=f6b3577ea4b1a5641ae3421151a26268434c3db8</Hashes>
				<Hashes condition="contains">SHA1=4de33d03fee52f396a1c788000ca868d56ac30de</Hashes>
				<Hashes condition="contains">SHA1=c6920171fa6dff2c17eb83befb5fd28e8dddf5f0</Hashes>
				<Hashes condition="contains">SHA1=fbc6d2448739ddec35bb5d6c94b46df4148f648d</Hashes>
				<Hashes condition="contains">SHA1=6b54f8f137778c1391285fee6150dfa58a8120b1</Hashes>
				<Hashes condition="contains">SHA1=943593e880b4d340f2548548e6e673ef6f61eed3</Hashes>
				<Hashes condition="contains">SHA1=5ac4d0e2381fc4a8aebe94a0fb6fe5e7558e4dcd</Hashes>
				<Hashes condition="contains">SHA1=e44297a2b750ec1958bef265e2f1ae6fa4323b28</Hashes>
				<Hashes condition="contains">SHA1=aa2ea973bb248b18973e57339307cfb8d309f687</Hashes>
				<Hashes condition="contains">SHA1=3a5d176c50f97b71d139767ed795d178623f491d</Hashes>
				<Hashes condition="contains">SHA1=25d812a5ece19ea375178ef9d60415841087726e</Hashes>
				<Hashes condition="contains">SHA1=3795e32592ab6d8074b6f7ad33759c6a39b0df07</Hashes>
				<Hashes condition="contains">SHA1=fc121ed6fb37e97a004b6faf217435b772dfc4c0</Hashes>
				<Hashes condition="contains">SHA1=ab2b8602e4baef828b58b995d0889a8e5b8dbd02</Hashes>
				<Hashes condition="contains">SHA1=cf040040628b58f4a811f98c2690913c1e8e4e3c</Hashes>
				<Hashes condition="contains">SHA1=3296844d22c87dd5eba3aa378a8242b41d59db7a</Hashes>
				<Hashes condition="contains">SHA1=bc47e15537fa7c32dfefd23168d7e1741f8477ed</Hashes>
				<Hashes condition="contains">SHA1=cb22723faa5ae2809476e5c5e9b9a597b26cab9b</Hashes>
				<Hashes condition="contains">SHA1=f3c5e723ae009b336cd2719137b8cd194c9ee51d</Hashes>
				<Hashes condition="contains">SHA1=41f2d0f9863bce8920c207b1ef5d3d32b603edef</Hashes>
				<Hashes condition="contains">SHA1=eb93d2f564fea9b3dc350f386b45de2cd9a3e001</Hashes>
				<Hashes condition="contains">SHA1=3cd037fbba8aae82c1b111c9f8755349c98bcb3c</Hashes>
				<Hashes condition="contains">SHA1=9401389fba314d1810f83edce33c37e84a78e112</Hashes>
				<Hashes condition="contains">SHA1=7eb34cc1fcffb4fdb5cb7e97184dd64a65cb9371</Hashes>
				<Hashes condition="contains">SHA1=16d7ecf09fc98798a6170e4cef2745e0bee3f5c7</Hashes>
				<Hashes condition="contains">SHA1=fcd615df88645d1f57ff5702bd6758b77efea6d0</Hashes>
				<Hashes condition="contains">SHA1=f3db629cfe37a73144d5258e64d9dd8b38084cf4</Hashes>
				<Hashes condition="contains">SHA1=a00e444120449e35641d58e62ed64bb9c9f518d2</Hashes>
				<Hashes condition="contains">SHA1=38571f14fc014487194d1eecfa80561ee8644e09</Hashes>
				<Hashes condition="contains">SHA1=4d41248078181c7f61e6e4906aa96bbdea320dc2</Hashes>
				<Hashes condition="contains">SHA1=3599ea2ac1fa78f423423a4cf90106ea0938dde8</Hashes>
				<Hashes condition="contains">SHA1=3d6d53b0f1cc908b898610227b9f1b9352137aba</Hashes>
				<Hashes condition="contains">SHA1=4c18754dca481f107f0923fb8ef5e149d128525d</Hashes>
				<Hashes condition="contains">SHA1=8c377ab4eebc5f4d8dd7bb3f90c0187dfdd3349f</Hashes>
				<Hashes condition="contains">SHA1=cde32654a041fedc7b0fa1083f6005b950760062</Hashes>
				<Hashes condition="contains">SHA1=5fb9421be8a8b08ec395d05e00fd45eb753b593a</Hashes>
				<Hashes condition="contains">SHA1=b480c54391a2a2f917a44f91a5e9e4590648b332</Hashes>
				<Hashes condition="contains">SHA1=4f7a8e26a97980544be634b26899afbefb0a833c</Hashes>
				<!--# The list below is from https://github.com/namazso/physmem_drivers -->
				<Hashes condition="contains">SHA256=05F052C64D192CF69A462A5EC16DDA0D43CA5D0245900C9FCB9201685A2E7748</Hashes>
				<Hashes condition="contains">SHA256=4045AE77859B1DBF13972451972EAAF6F3C97BEA423E9E78F1C2F14330CD47CA</Hashes>
				<Hashes condition="contains">SHA256=6948480954137987A0BE626C24CF594390960242CD75F094CD6AAA5C2E7A54FA</Hashes>
				<Hashes condition="contains">SHA256=8CB62C5D41148DE416014F80BD1FD033FD4D2BD504CB05B90EEB6992A382D58F</Hashes>
				<Hashes condition="contains">SHA256=B1D96233235A62DBB21B8DBE2D1AE333199669F67664B107BFF1AD49B41D9414</Hashes>
				<Hashes condition="contains">SHA256=7196187FB1EF8D108B380D37B2AF8EFDEB3CA1F6EEFD37B5DC114C609147216D</Hashes>
				<Hashes condition="contains">SHA256=7F375639A0DF7FE51E5518CF87C3F513C55BC117DB47D28DA8C615642EB18BFA</Hashes>
				<Hashes condition="contains">SHA256=42579A759F3F95F20A2C51D5AC2047A2662A2675B3FB9F46C1ED7F23393A0F00</Hashes>
				<Hashes condition="contains">SHA256=2DA330A2088409EFC351118445A824F11EDBE51CF3D653B298053785097FE40E</Hashes>
				<Hashes condition="contains">SHA256=436CCAB6F62FA2D29827916E054ADE7ACAE485B3DE1D3E5C6C62D3DEBF1480E7</Hashes>
				<Hashes condition="contains">SHA256=B4D47EA790920A4531E3DF5A4B4B0721B7FEA6B49A35679F0652F1E590422602</Hashes>
				<Hashes condition="contains">SHA256=DDE6F28B3F7F2ABBEE59D4864435108791631E9CB4CDFB1F178E5AA9859956D8</Hashes>
				<Hashes condition="contains">SHA256=B48A309EE0960DA3CAAAAF1E794E8C409993AEB3A2B64809F36B97AAC8A1E62A</Hashes>
				<Hashes condition="contains">SHA256=025E7BE9FCEFD6A83F4471BBA0C11F1C11BD5047047D26626DA24EE9A419CDC4</Hashes>
				<Hashes condition="contains">SHA256=2AA1B08F47FBB1E2BD2E4A492F5D616968E703E1359A921F62B38B8E4662F0C4</Hashes>
				<Hashes condition="contains">SHA256=ECE0A900EA089E730741499614C0917432246CEB5E11599EE3A1BB679E24FD2C</Hashes>
				<Hashes condition="contains">SHA256=F40435488389B4FB3B945CA21A8325A51E1B5F80F045AB019748D0EC66056A8B</Hashes>
				<Hashes condition="contains">SHA256=2A652DE6B680D5AD92376AD323021850DAB2C653ABF06EDF26120F7714B8E08A</Hashes>
				<Hashes condition="contains">SHA256=950A4C0C772021CEE26011A92194F0E58D61588F77F2873AA0599DFF52A160C9</Hashes>
				<Hashes condition="contains">SHA256=0AAFA9F47ACF69D46C9542985994FF5321F00842A28DF2396D4A3076776A83CB</Hashes>
				<Hashes condition="contains">SHA256=47F08F7D30D824A8F4BB8A98916401A37C0FD8502DB308ABA91FE3112B892DCC</Hashes>
				<Hashes condition="contains">SHA256=B9A4E40A5D80FEDD1037EAED958F9F9EFED41EB01ADA73D51B5DCD86E27E0CBF</Hashes>
				<Hashes condition="contains">SHA256=5C04C274A708C9A7D993E33BE3EA9E6119DC29527A767410DBAF93996F87369A</Hashes>
				<Hashes condition="contains">SHA256=0040153302B88BEE27EB4F1ECA6855039E1A057370F5E8C615724FA5215BADA3</Hashes>
				<Hashes condition="contains">SHA256=3326E2D32BBABD69FEB6024809AFC56C7E39241EBE70A53728C77E80995422A5</Hashes>
				<Hashes condition="contains">SHA256=36B9E31240AB0341873C7092B63E2E0F2CAB2962EBF9B25271C3A1216B7669EB</Hashes>
				<Hashes condition="contains">SHA256=29E0062A017A93B2F2F5207A608A96DF4D554C5DE976BD0276C2590A03BD3E94</Hashes>
				<Hashes condition="contains">SHA256=45ABDBCD4C0916B7D9FAAF1CD08543A3A5178871074628E0126A6EDA890D26E0</Hashes>
				<Hashes condition="contains">SHA256=50DB5480D0392A7DD6AB5DF98389DC24D1ED1E9C98C9C35964B19DABCD6DC67F</Hashes>
				<Hashes condition="contains">SHA256=607DC4C75AC7AEF82AE0616A453866B3B358C6CF5C8F9D29E4D37F844306B97C</Hashes>
				<Hashes condition="contains">SHA256=61D6E40601FA368800980801A662A5B3B36E3C23296E8AE1C85726A56EF18CC8</Hashes>
				<Hashes condition="contains">SHA256=74A846C61ADC53692D3040AFF4C1916F32987AD72B07FE226E9E7DBEFF1036C4</Hashes>
				<Hashes condition="contains">SHA256=76FB4DEAEE57EF30E56C382C92ABFFE2CF616D08DBECB3368C8EE6B02E59F303</Hashes>
				<Hashes condition="contains">SHA256=81939E5C12BD627FF268E9887D6FB57E95E6049F28921F3437898757E7F21469</Hashes>
				<Hashes condition="contains">SHA256=9790A7B9D624B2B18768BB655DDA4A05A9929633CEF0B1521E79E40D7DE0A05B</Hashes>
				<Hashes condition="contains">SHA256=9A1D66036B0868BBB1B2823209FEDEA61A301D5DD245F8E7D390BD31E52D663E</Hashes>
				<Hashes condition="contains">SHA256=AA9AB1195DC866270E984F1BED5E1358D6EF24C515DFDB6C2A92D1E1B94BF608</Hashes>
				<Hashes condition="contains">SHA256=AF095DE15A16255CA1B2C27DAD365DFF9AC32D2A75E8E288F5A1307680781685</Hashes>
				<Hashes condition="contains">SHA256=D5586DC1E61796A9AE5E5D1CED397874753056C3DF2EB963A8916287E1929A71</Hashes>
				<Hashes condition="contains">SHA256=D8459F7D707C635E2C04D6D6D47B63F73BA3F6629702C7A6E0DF0462F6478AE2</Hashes>
				<Hashes condition="contains">SHA256=E81230217988F3E7EC6F89A06D231EC66039BDBA340FD8EBB2BBB586506E3293</Hashes>
				<Hashes condition="contains">SHA256=F88EBB633406A086D9CCA6BC8B66A4EA940C5476529F9033A9E0463512A23A57</Hashes>
				<Hashes condition="contains">SHA256=1C8DFA14888BB58848B4792FB1D8A921976A9463BE8334CFF45CC96F1276049A</Hashes>
				<Hashes condition="contains">SHA256=22418016E980E0A4A2D01CA210A17059916A4208352C1018B0079CCB19AAF86A</Hashes>
				<Hashes condition="contains">SHA256=405472A8F9400A54BB29D03B436CCD58CFD6442FE686F6D2ED4F63F002854659</Hashes>
				<Hashes condition="contains">SHA256=49F75746EEBE14E5DB11706B3E58ACCC62D4034D2F1C05C681ECEF5D1AD933BA</Hashes>
				<Hashes condition="contains">SHA256=4A3D4DB86F580B1680D6454BAEE1C1A139E2DDE7D55E972BA7C92EC3F555DCE2</Hashes>
				<Hashes condition="contains">SHA256=4AB41816ABBF14D59E75B7FAD49E2CB1C1FEB27A3CB27402297A2A4793FF9DA7</Hashes>
				<Hashes condition="contains">SHA256=54841D9F89E195196E65AA881834804FE3678F1CF6B328CAB8703EDD15E3EC57</Hashes>
				<Hashes condition="contains">SHA256=5EE292B605CD3751A24E5949AAE615D472A3C72688632C3040DC311055B75A92</Hashes>
				<Hashes condition="contains">SHA256=76B86543CE05540048F954FED37BDDA66360C4A3DDB8328213D5AEF7A960C184</Hashes>
				<Hashes condition="contains">SHA256=7F190F6E5AB0EDAFD63391506C2360230AF4C2D56C45FC8996A168A1FC12D457</Hashes>
				<Hashes condition="contains">SHA256=845F1E228DE249FC1DDF8DC28C39D03E8AD328A6277B6502D3932E83B879A65A</Hashes>
				<Hashes condition="contains">SHA256=84BF1D0BCDF175CFE8AEA2973E0373015793D43907410AE97E2071B2C4B8E2D4</Hashes>
				<Hashes condition="contains">SHA256=8EF0AD86500094E8FA3D9E7D53163AA6FEEF67C09575C169873C494ED66F057F</Hashes>
				<Hashes condition="contains">SHA256=A56C2A2425EB3A4260CC7FC5C8D7BED7A3B4CD2AF256185F24471C668853AEE8</Hashes>
				<Hashes condition="contains">SHA256=AC3F613D457FC4D44FA27B2E0B1BAA62C09415705EFB5A40A4756DA39B3AC165</Hashes>
				<Hashes condition="contains">SHA256=B1334A71CC73B3D0C54F62D8011BEC330DFC355A239BF94A121F6E4C86A30A2E</Hashes>
				<Hashes condition="contains">SHA256=B47BE212352D407D0EF7458A7161C66B47C2AEC8391DD101DF11E65728337A6A</Hashes>
				<Hashes condition="contains">SHA256=B9B3878DDC5DFB237D38F8D25067267870AFD67D12A330397A8853209C4D889C</Hashes>
				<Hashes condition="contains">SHA256=DB90E554AD249C2BD888282ECF7D8DA4D1538DD364129A3327B54F8242DD5653</Hashes>
				<Hashes condition="contains">SHA256=E61A54F6D3869B43C4ECEAC3016DF73DF67CCE03878C5A6167166601C5D3F028</Hashes>
				<Hashes condition="contains">SHA256=3871E16758A1778907667F78589359734F7F62F9DC953EC558946DCDBE6951E3</Hashes>
				<Hashes condition="contains">SHA256=DED2927F9A4E64EEFD09D0CABA78E94F309E3A6292841AE81D5528CAB109F95D</Hashes>
				<Hashes condition="contains">SHA256=0296E2CE999E67C76352613A718E11516FE1B0EFC3FFDB8918FC999DD76A73A5</Hashes>
				<Hashes condition="contains">SHA256=80CBBA9F404DF3E642F22C476664D63D7C229D45D34F5CD0E19C65EB41BECEC3</Hashes>
				<Hashes condition="contains">SHA256=BB50818A07B0EB1BD317467139B7EB4BAD6CD89053FECDABFEAE111689825955</Hashes>
				<Hashes condition="contains">SHA256=FF6729518A380BF57F1BC6F1EC0AA7F3012E1618B8D9B0F31A61D299EE2B4339</Hashes>
				<Hashes condition="contains">SHA256=3A5EC83FE670E5E23AEF3AFA0A7241053F5B6BE5E6CA01766D6B5F9177183C25</Hashes>
				<Hashes condition="contains">SHA256=61A1BDDDD3C512E681818DEBB5BEE94DB701768FC25E674FCAD46592A3259BD0</Hashes>
				<Hashes condition="contains">SHA256=07B6D69BAFCFD767F1B63A490A8843C3BB1F8E1BBEA56176109B5743C8F7D357</Hashes>
				<Hashes condition="contains">SHA256=21CCDD306B5183C00ECFD0475B3152E7D94B921E858E59B68A03E925D1715F21</Hashes>
				<Hashes condition="contains">SHA256=2D83CCB1AD9839C9F5B3F10B1F856177DF1594C66CBBC7661677D4B462EBF44D</Hashes>
				<Hashes condition="contains">SHA256=F581DECC2888EF27EE1EA85EA23BBB5FB2FE6A554266FF5A1476ACD1D29D53AF</Hashes>
				<Hashes condition="contains">SHA256=F8965FDCE668692C3785AFA3559159F9A18287BC0D53ABB21902895A8ECF221B</Hashes>
				<Hashes condition="contains">SHA256=3D23BDBAF9905259D858DF5BF991EB23D2DC9F4ECDA7F9F77839691ACEF1B8C4</Hashes>
				<Hashes condition="contains">SHA256=DD4A1253D47DE14EF83F1BC8B40816A86CCF90D1E624C5ADF9203AE9D51D4097</Hashes>
				<Hashes condition="contains">SHA256=509628B6D16D2428031311D7BD2ADD8D5F5160E9ECC0CD909F1E82BBBB3234D6</Hashes>
				<Hashes condition="contains">SHA256=525D9B51A80CA0CD4C5889A96F857E73F3A80DA1FFBAE59851E0F51BDFB0B6CD</Hashes>
				<Hashes condition="contains">SHA256=6DE84CAA2CA18673E01B91AF58220C60AECD5CCCF269725EC3C7F226B2167492</Hashes>
				<Hashes condition="contains">SHA256=09BEDBF7A41E0F8DABE4F41D331DB58373CE15B2E9204540873A1884F38BDDE1</Hashes>
				<Hashes condition="contains">SHA256=101402D4F5D1AE413DED499C78A5FCBBC7E3BAE9B000D64C1DD64E3C48C37558</Hashes>
				<Hashes condition="contains">SHA256=131D5490CEB9A5B2324D8E927FEA5BECFC633015661DE2F4C2F2375A3A3B64C6</Hashes>
				<Hashes condition="contains">SHA256=1DDFE4756F5DB9FB319D6C6DA9C41C588A729D9E7817190B027B38E9C076D219</Hashes>
				<Hashes condition="contains">SHA256=1E8B0C1966E566A523D652E00F7727D8B0663F1DFDCE3B9A09B9ADFAEF48D8EE</Hashes>
				<Hashes condition="contains">SHA256=2BBE65CBEC3BB069E92233924F7EE1F95FFA16173FCEB932C34F68D862781250</Hashes>
				<Hashes condition="contains">SHA256=30706F110725199E338E9CC1C940D9A644D19A14F0EB8847712CBA4CACDA67AB</Hashes>
				<Hashes condition="contains">SHA256=3124B0411B8077605DB2A9B7909D8240E0D554496600E2706E531C93C931E1B5</Hashes>
				<Hashes condition="contains">SHA256=38FA0C663C8689048726666F1C5E019FEAA9DA8278F1DF6FF62DA33961891D2A</Hashes>
				<Hashes condition="contains">SHA256=39CFDE7D401EFCE4F550E0A9461F5FC4D71FA07235E1336E4F0B4882BD76550E</Hashes>
				<Hashes condition="contains">SHA256=3D9E83B189FCF5C3541C62D1F54A0DA0A4E5B62C3243D2989AFC46644056C8E3</Hashes>
				<Hashes condition="contains">SHA256=3F2FDA9A7A9C57B7138687BBCE49A2E156D6095DDDABB3454EA09737E02C3FA5</Hashes>
				<Hashes condition="contains">SHA256=47F0CDAA2359A63AD1389EF4A635F1F6EEE1F63BDF6EF177F114BDCDADC2E005</Hashes>
				<Hashes condition="contains">SHA256=50D5EAA168C077CE5B7F15B3F2C43BD2B86B07B1E926C1B332F8CB13BD2E0793</Hashes>
				<Hashes condition="contains">SHA256=56A3C9AC137D862A85B4004F043D46542A1B61C6ACB438098A9640469E2D80E7</Hashes>
				<Hashes condition="contains">SHA256=591BD5E92DFA0117B3DAA29750E73E2DB25BAA717C31217539D30FFB1F7F3A52</Hashes>
				<Hashes condition="contains">SHA256=5D530E111400785D183057113D70623E17AF32931668AB7C7FC826F0FD4F91A3</Hashes>
				<Hashes condition="contains">SHA256=6F1FF29E2E710F6D064DC74E8E011331D807C32CC2A622CBE507FD4B4D43F8F4</Hashes>
				<Hashes condition="contains">SHA256=79E2D37632C417138970B4FEBA91B7E10C2EA251C5EFE3D1FC6FA0190F176B57</Hashes>
				<Hashes condition="contains">SHA256=85866E8C25D82C1EC91D7A8076C7D073CCCF421CF57D9C83D80D63943A4EDD94</Hashes>
				<Hashes condition="contains">SHA256=89B0017BC30CC026E32B758C66A1AF88BD54C6A78E11EC2908FF854E00AC46BE</Hashes>
				<Hashes condition="contains">SHA256=9254F012009D55F555418FF85F7D93B184AB7CB0E37AECDFDAB62CFE94DEA96B</Hashes>
				<Hashes condition="contains">SHA256=984A77E5424C6D099051441005F2938AE92B31B5AD8F6521C6B001932862ADD7</Hashes>
				<Hashes condition="contains">SHA256=98B734DDA78C16EBCAA4AFEB31007926542B63B2F163B2F733FA0D00DBB344D8</Hashes>
				<Hashes condition="contains">SHA256=99F4994A0E5BD1BF6E3F637D3225C69FF4CD620557E23637533E7F18D7D6CBA1</Hashes>
				<Hashes condition="contains">SHA256=9C10E2EC4F9EF591415F9A784B93DC9C9CDAFA7C69602C0DC860C5B62222E449</Hashes>
				<Hashes condition="contains">SHA256=A961F5939088238D76757669A9A81905E33F247C9C635B908DAAC146AE063499</Hashes>
				<Hashes condition="contains">SHA256=A9706E320179993DADE519A83061477ACE195DAA1B788662825484813001F526</Hashes>
				<Hashes condition="contains">SHA256=B7A20B5F15E1871B392782C46EBCC897929443D82073EE4DCB3874B6A5976B5D</Hashes>
				<Hashes condition="contains">SHA256=CC586254E9E89E88334ADEE44E332166119307E79C2F18F6C2AB90CE8BA7FC9B</Hashes>
				<Hashes condition="contains">SHA256=CD4A249C3EF65AF285D0F8F30A8A96E83688486AAB515836318A2559757A89BB</Hashes>
				<Hashes condition="contains">SHA256=CF4B5FA853CE809F1924DF3A3AE3C4E191878C4EA5248D8785DC7E51807A512B</Hashes>
				<Hashes condition="contains">SHA256=D0BD1AE72AEB5F3EABF1531A635F990E5EAAE7FDD560342F915F723766C80889</Hashes>
				<Hashes condition="contains">SHA256=D8B58F6A89A7618558E37AFC360CD772B6731E3BA367F8D58734ECEE2244A530</Hashes>
				<Hashes condition="contains">SHA256=D92EAB70BCECE4432258C9C9A914483A2267F6AB5CE2630048D3A99E8CB1B482</Hashes>
				<Hashes condition="contains">SHA256=E005E8D183E853A27AD3BB56F25489F369C11B0D47E3D4095AAD9291B3343BF1</Hashes>
				<Hashes condition="contains">SHA256=E68D453D333854787F8470C8BAEF3E0D082F26DF5AA19C0493898BCF3401E39A</Hashes>
				<Hashes condition="contains">SHA256=E83908EBA2501A00EF9E74E7D1C8B4FF1279F1CD6051707FD51824F87E4378FA</Hashes>
				<Hashes condition="contains">SHA256=EF86C4E5EE1DBC4F81CD864E8CD2F4A2A85EE4475B9A9AB698A4AE1CC71FBEB0</Hashes>
				<Hashes condition="contains">SHA256=F088B2BA27DACD5C28F8EE428F1350DCA4BC7C6606309C287C801B2E1DA1A53D</Hashes>
				<Hashes condition="contains">SHA256=FD8669794C67B396C12FC5F08E9C004FDF851A82FAF302846878173E4FBECB03</Hashes>
				<Hashes condition="contains">SHA256=91314768DA140999E682D2A290D48B78BB25A35525EA12C1B1F9634D14602B2C</Hashes>
				<Hashes condition="contains">SHA256=F0605DDA1DEF240DC7E14EFA73927D6C6D89988C01EA8647B671667B2B167008</Hashes>
				<Hashes condition="contains">SHA256=6CB51AE871FBD5D07C5AAD6FF8EEA43D34063089528603CA9CEB8B4F52F68DDC</Hashes>
				<Hashes condition="contains">SHA256=DB2A9247177E8CDD50FE9433D066B86FFD2A84301AA6B2EB60F361CFFF077004</Hashes>
				<Hashes condition="contains">SHA256=7EC93F34EB323823EB199FBF8D06219086D517D0E8F4B9E348D7AFD41EC9FD5D</Hashes>
				<Hashes condition="contains">SHA256=7049F3C939EFE76A5556C2A2C04386DB51DAF61D56B679F4868BB0983C996EBB</Hashes>
				<Hashes condition="contains">SHA256=7877C1B0E7429453B750218CA491C2825DAE684AD9616642EFF7B41715C70ACA</Hashes>
				<Hashes condition="contains">SHA256=159E7C5A12157AF92E0D14A0D3EA116F91C09E21A9831486E6DC592C93C10980</Hashes>
				<Hashes condition="contains">SHA256=3243AAB18E273A9B9C4280A57AECEF278E10BFFF19ABB260D7A7820E41739099</Hashes>
				<Hashes condition="contains">SHA256=7CFA5E10DFF8A99A5D544B011F676BC383991274C693E21E3AF40CF6982ADB8C</Hashes>
				<Hashes condition="contains">SHA256=C9B49B52B493B53CD49C12C3FA9553E57C5394555B64E32D1208F5B96A5B8C6E</Hashes>
				<Hashes condition="contains">SHA256=3EC5AD51E6879464DFBCCB9F4ED76C6325056A42548D5994BA869DA9C4C039A8</Hashes>
				<Hashes condition="contains">SHA256=47EAEBC920CCF99E09FC9924FEB6B19B8A28589F52783327067C9B09754B5E84</Hashes>
				<!--# The list below is from https://github.com/jbaines-r7/dellicious and https://www.rapid7.com/blog/post/2021/12/13/driver-based-attacks-past-and-present/ -->
				<Hashes condition="contains">SHA256=1aaf4c1e3cb6774857e2eef27c17e68dc1ae577112e4769665f516c2e8c4e27b</Hashes>
				<Hashes condition="contains">SHA256=e6056443537d4d2314dabca1b9168f1eaaf17a14eb41f6f5741b6b82b3119790</Hashes>
				<Hashes condition="contains">SHA256=76660e91f1ff3cb89630df5af4fe09de6098d09baa66b1a130c89c3c5edd5b22</Hashes>
				<Hashes condition="contains">SHA256=6c7120e40fc850e4715058b233f5ad4527d1084a909114fd6a36b7b7573c4a44</Hashes>
				<Hashes condition="contains">SHA256=2e6b339597a89e875f175023ed952aaac64e9d20d457bbc07acf1586e7fe2df8</Hashes>
				<Hashes condition="contains">SHA256=71fe5af0f1564dc187eea8d59c0fbc897712afa07d18316d2080330ba17cf009</Hashes>
				<Hashes condition="contains">SHA256=39937d239220c1b779d7d55613de2c0a48bd6e12e0214da4c65992b96cf591df</Hashes>
				<Hashes condition="contains">SHA256=7ed26a593524a2a92ffcfb075a42bb4fa4775ffbf83af98525244a4710886ead</Hashes>
				<Hashes condition="contains">SHA256=aa717e9ab4d614497df19f602d289a6eddcdba8027c71bcc807780a219347d16</Hashes>
				<Hashes condition="contains">SHA256=ff5f6048a3d6f6738b60e911e3876fcbdc9a02ec9862f909345c8a50fd4cc0a7</Hashes>
				<Hashes condition="contains">SHA256=11bd2c9f9e2397c9a16e0990e4ed2cf0679498fe0fd418a3dfdac60b5c160ee5</Hashes>
				<Hashes condition="contains">SHA256=58a74dceb2022cd8a358b92acd1b48a5e01c524c3b0195d7033e4bd55eff4495</Hashes>
				<Hashes condition="contains">SHA256=01aa278b07b58dc46c84bd0b1b5c8e9ee4e62ea0bf7a695862444af32e87f1fd</Hashes>
				<Hashes condition="contains">SHA256=22be050955347661685a4343c51f11c7811674e030386d2264cd12ecbf544b7c</Hashes>
				<Hashes condition="contains">SHA256=31f4cfb4c71da44120752721103a16512444c13c2ac2d857a7e6f13cb679b427</Hashes>
				<!--# The list below is from https://gist.github.com/k4nfr3/af970e7facb09195e56f2112e1c9549c -->
				<Hashes condition="contains">SHA256=952199C28332BC90CFD74530A77EE237967ED32B3C71322559C59F7A42187DC4</Hashes>
				<Hashes condition="contains">SHA256=9529EFB1837B1005E5E8F477773752078E0A46500C748BC30C9B5084D04082E6</Hashes>
				<Hashes condition="contains">SHA256=A7B000ABBCC344444A9B00CFADE7AA22AB92CE0CADEC196C30EB1851AE4FA062</Hashes>
				<Hashes condition="contains">SHA256=4429f32db1cc70567919d7d47b844a91cf1329a6cd116f582305f3b7b60cd60b</Hashes>
				<Hashes condition="contains">SHA256=01e024cb14b34b6d525c642a710bfa14497ea20fd287c39ba404b10a8b143ece</Hashes>
				<Hashes condition="contains">SHA256=9fc29480407e5179aa8ea41682409b4ea33f1a42026277613d6484e5419de374</Hashes>
				<Hashes condition="contains">SHA256=06bda5a1594f7121acd2efe38ccb617fbc078bb9a70b665a5f5efd70e3013f50</Hashes>
				<Hashes condition="contains">SHA256=cbb8239a765bf5b2c1b6a5c8832d2cab8fef5deacadfb65d8ed43ef56d291ab6</Hashes>
				<Hashes condition="contains">SHA256=d205286bffdf09bc033c09e95c519c1c267b40c2ee8bab703c6a2d86741ccd3e</Hashes>
				<!--# https://github.com/eclypsium/Screwed-Drivers/blob/master/DRIVERS.md -->
				<Hashes condition="contains">SHA256=a7c2e7910942dd5e43e2f4eb159bcd2b4e71366e34a68109548b9fb12ac0f7cc</Hashes>
				<Hashes condition="contains">SHA256=2003b478b9fd1b3d76ec5bf4172c2e8915babbbee7ad1783794acbf8d4c2519d</Hashes>
				<Hashes condition="contains">SHA256=f929bead59e9424ab90427b379dcdd63fbfe0c4fb5e1792e3a1685541cd5ec65</Hashes>
				<Hashes condition="contains">SHA256=59626cac380d8fe0b80a6d4c4406d62ba0683a2f0f68d50ad506ca1b1cf25347</Hashes>
				<Hashes condition="contains">SHA256=552f70374715e70c4ade591d65177be2539ec60f751223680dfaccb9e0be0ed9</Hashes>
				<Hashes condition="contains">SHA256=86a8e0aa29a5b52c84921188cc1f0eca9a7904dcfe09544602933d8377720219</Hashes>
				<Hashes condition="contains">SHA256=1d0397c263d51e9fc95bcc8baf98d1a853e1c0401cd0e27c7bf5da3fba1c93a8</Hashes>
				<Hashes condition="contains">SHA256=60c6f4f34c7319cb3f9ca682e59d92711a05a2688badbae4891b1303cd384813</Hashes>
				<Hashes condition="contains">SHA256=55fee54c0d0d873724864dc0b2a10b38b7f40300ee9cae4d9baaf8a202c4049a</Hashes>
				<Hashes condition="contains">SHA256=42f0b036687cbd7717c9efed6991c00d4e3e7b032dc965a2556c02177dfdad0f</Hashes>
				<Hashes condition="contains">SHA256=bb1135b51acca8348d285dc5461d10e8f57260e7d0c8cc4a092734d53fc40cbc</Hashes>
				<Hashes condition="contains">SHA256=b179e1ab6dc0b1aee783adbcad4ad6bb75a8a64cb798f30c0dd2ee8aaf43e6de</Hashes>
				<Hashes condition="contains">SHA256=314384b40626800b1cde6fbc51ebc7d13e91398be2688c2a58354aa08d00b073</Hashes>
				<Hashes condition="contains">SHA256=65db1b259e305a52042e07e111f4fa4af16542c8bacd33655f753ef642228890</Hashes>
				<Hashes condition="contains">SHA256=19a212e6fc324f4cb9ee5eba60f5c1fc0191799a4432265cbeaa3307c76a7fc0</Hashes>
				<Hashes condition="contains">SHA256=a7c8f4faf3cbb088cac7753d81f8ec4c38ccb97cd9da817741f49272e8d01200</Hashes>
				<Hashes condition="contains">SHA256=677c0b1add3990fad51f492553d3533115c50a242a919437ccb145943011d2bf</Hashes>
				<Hashes condition="contains">SHA256=fc22977ff721b3d718b71c42440ee2d8a144f3fbc7755e4331ddd5bcc65158d2</Hashes>
				<Hashes condition="contains">SHA256=ad40e6d0f77c0e579fb87c5106bf6de3d1a9f30ee2fbf8c9c011f377fa05f173</Hashes>
				<Hashes condition="contains">SHA256=18e1707b319c279c7e0204074088cc39286007a1cf6cb6e269d5067d8d0628c6</Hashes>
				<Hashes condition="contains">SHA256=c9cf1d627078f63a36bbde364cd0d5f2be1714124d186c06db5bcdf549a109f8</Hashes>
				<Hashes condition="contains">SHA256=afdd66562dea51001c3a9de300f91fc3eb965d6848dfce92ccb9b75853e02508</Hashes>
				<Hashes condition="contains">SHA256=a899b659b08fbae30b182443be8ffb6a6471c1d0497b52293061754886a937a3</Hashes>
				<Hashes condition="contains">SHA256=1963d5a0e512b72353953aadbe694f73a9a576f0241a988378fa40bf574eda52</Hashes>
				<Hashes condition="contains">SHA256=7133a461aeb03b4d69d43f3d26cd1a9e3ee01694e97a0645a3d8aa1a44c39129</Hashes>
				<Hashes condition="contains">SHA256=32e1a8513eee746d17eb5402fb9d8ff9507fb6e1238e7ff06f7a5c50ff3df993</Hashes>
				<Hashes condition="contains">SHA256=082c39fe2e3217004206535e271ebd45c11eb072efde4cc9885b25ba5c39f91d</Hashes>
				<Hashes condition="contains">SHA256=65329dad28e92f4bcc64de15c552b6ef424494028b18875b7dba840053bc0cdd</Hashes>
				<Hashes condition="contains">SHA256=f8430bdc6fd01f42217d66d87a3ef6f66cb2700ebb39c4f25c8b851858cc4b35</Hashes>
				<Hashes condition="contains">SHA256=9f1229cd8dd9092c27a01f5d56e3c0d59c2bb9f0139abf042e56f343637fda33</Hashes>
				<Hashes condition="contains">SHA256=b03f26009de2e8eabfcf6152f49b02a55c5e5d0f73e01d48f5a745f93ce93a29</Hashes>
				<!--# The list below is derived from the ELASTIC yara rules https://github.com/elastic/protections-artifacts/search?q=VulnDriver -->
				<!--# These are the hashes mentioned in the "reference_sample" section that ELASTIC used to create their rules -->
				<Hashes condition="contains">SHA256=3943a796cc7c5352aa57ccf544295bfd6fb69aae147bc8235a00202dc6ed6838</Hashes>
				<Hashes condition="contains">SHA256=3c5bf92c26398695f9ced7ce647a7e9f6ddcc89eea66b45aa3607196a187431b</Hashes>
				<Hashes condition="contains">SHA256=478917514be37b32d5ccf76e4009f6f952f39f5553953544f1b0688befd95e82</Hashes>
				<Hashes condition="contains">SHA256=4ed2d2c1b00e87b926fb58b4ea43d2db35e5912975f4400aa7bd9f8c239d08b7</Hashes>
				<Hashes condition="contains">SHA256=b205835b818d8a50903cf76936fcf8160060762725bd74a523320cfbd091c038</Hashes>
				<Hashes condition="contains">SHA256=ab8f2217e59319b88080e052782e559a706fa4fb7b8b708f709ff3617124da89</Hashes>
				<Hashes condition="contains">SHA256=73327429c505d8c5fd690a8ec019ed4fd5a726b607cabe71509111c7bfe9fc7e</Hashes>
				<Hashes condition="contains">SHA256=87e38e7aeaaaa96efe1a74f59fca8371de93544b7af22862eb0e574cec49c7c3</Hashes>
				<Hashes condition="contains">SHA256=2270a8144dabaf159c2888519b11b61e5e13acdaa997820c09798137bded3dd6</Hashes>
				<Hashes condition="contains">SHA256=43ba8d96d5e8e54cab59d82d495eeca730eeb16e4743ed134cdd495c51a4fc89</Hashes>
				<Hashes condition="contains">SHA256=e1980c6592e6d2d92c1a65acad8f1071b6a404097bb6fcce494f3c8ac31385cf</Hashes>
				<Hashes condition="contains">SHA256=1dadd707c55413a16320dc70d2ca7784b94c6658331a753b3424ae696c5d93ea</Hashes>
				<Hashes condition="contains">SHA256=d84e3e250a86227c64a96f6d5ac2b447674ba93d399160850acb2339da43eae5</Hashes>
				<Hashes condition="contains">SHA256=5ae23f1fcf3fb735fcf1fa27f27e610d9945d668a149c7b7b0c84ffd6409d99a</Hashes>
				<Hashes condition="contains">SHA256=0f726d8ce21c0c9e01ebe6b55913c519ad6086bcaec1a89f8308f3effacd435f</Hashes>
				<Hashes condition="contains">SHA256=95d50c69cdbf10c9c9d61e64fe864ac91e6f6caa637d128eb20e1d3510e776d3</Hashes>
				<Hashes condition="contains">SHA256=0e14a4401011a9f4e444028ac5b1595da34bbbf9af04a00670f15ff839734003</Hashes>
				<Hashes condition="contains">SHA256=26c86227d3f387897c1efd77dc711eef748eb90be84149cb306e3d4c45cc71c7</Hashes>
				<Hashes condition="contains">SHA256=42d926cfb3794f9b1e3cb397498696cb687f505e15feb9df11b419c49c9af498</Hashes>
				<Hashes condition="contains">SHA256=1684e24dae20ab83ab5462aa1ff6473110ec53f52a32cfb8c1fe95a2642c6d22</Hashes>
				<Hashes condition="contains">SHA256=9b6a84f7c40ea51c38cc4d2e93efb3375e9d98d4894a85941190d94fbe73a4e4</Hashes>
				<Hashes condition="contains">SHA256=440883cd9d6a76db5e53517d0ec7fe13d5a50d2f6a7f91ecfc863bc3490e4f5c</Hashes>
				<Hashes condition="contains">SHA256=e05eeb2b8c18ad2cb2d1038c043d770a0d51b96b748bc34be3e7fc6f3790ce53</Hashes>
				<Hashes condition="contains">SHA256=3a364a7a3f6c0f2f925a060e84fb18b16c118125165b5ea6c94363221dc1b6de</Hashes>
				<Hashes condition="contains">SHA256=fda506e2aa85dc41a4cbc23d3ecc71ab34e06f1def736e58862dc449acbc2330</Hashes>
				<Hashes condition="contains">SHA256=3ac5e01689a3d745e60925bc7faca8d4306ae693e803b5e19c94906dc30add46</Hashes>
				<Hashes condition="contains">SHA256=175eed7a4c6de9c3156c7ae16ae85c554959ec350f1c8aaa6dfe8c7e99de3347</Hashes>
				<Hashes condition="contains">SHA256=8596ea3952d84eeef8f5dc5b0b83014feb101ec295b2d80910f21508a95aa026</Hashes>
				<Hashes condition="contains">SHA256=52a90fd1546c068b92add52c29fbb8a87d472a57e609146bbcb34862f9dcec15</Hashes>
				<Hashes condition="contains">SHA256=543991ca8d1c65113dff039b85ae3f9a87f503daec30f46929fd454bc57e5a91</Hashes>
				<Hashes condition="contains">SHA256=e75714f8e0ff45605f6fc7689a1a89c7dcd34aab66c6131c63fefaca584539cf</Hashes>
				<Hashes condition="contains">SHA256=1aaa9aef39cb3c0a854ecb4ca7d3b213458f302025e0ec5bfbdef973cca9111c</Hashes>
				<Hashes condition="contains">SHA256=cc687fe3741bbde1dd142eac0ef59fd1d4457daee43cdde23bb162ef28d04e64</Hashes>
				<Hashes condition="contains">SHA256=3ed15a390d8dfbd8a8fb99e8367e19bfd1cced0e629dfe43ccdb46c863394b59</Hashes>
				<Hashes condition="contains">SHA256=8c95d28270a4a314299cf50f05dcbe63033b2a555195d2ad2f678e09e00393e6</Hashes>
				<Hashes condition="contains">SHA256=eea53103e7a5a55dc1df79797395a2a3e96123ebd71cdd2db4b1be80e7b3f02b</Hashes>
				<Hashes condition="contains">SHA256=37c637a74bf20d7630281581a8fae124200920df11ad7cd68c14c26cc12c5ec9</Hashes>
				<Hashes condition="contains">SHA256=32cccc4f249499061c0afa18f534c825d01034a1f6815f5506bf4c4ff55d1351</Hashes>
				<Hashes condition="contains">SHA256=c5050a2017490fff7aa53c73755982b339ddb0fd7cef2cde32c81bc9834331c5</Hashes>
				<Hashes condition="contains">SHA256=ff803017d1acafde6149fe7d463aee23b1c4f6f3b97c698c05f3ca6f07e4df6c</Hashes>
				<Hashes condition="contains">SHA256=000547560fea0dd4b477eb28bf781ea67bf83c748945ce8923f90fdd14eb7a4b</Hashes>
				<Hashes condition="contains">SHA256=0af5ccb3d33a9ba92071c9637be6254030d61998733a5eb3583e865e17844e05</Hashes>
				<Hashes condition="contains">SHA256=a13054f349b7baa8c8a3fcbd31789807a493cc52224bbff5e412eb2bd52a6433</Hashes>
			</Rule>
		</DriverLoad>
	</RuleGroup>
	<RuleGroup name="RG=DriverLoad Exclude Group" groupRelation="or">
		<DriverLoad onmatch="exclude">
		<!--COMMENT:	Because drivers with bugs can be used to escalate to kernel permissions, be extremely selective
				about what you exclude from monitoring. Low event volume, little incentive to exclude.-->
		</DriverLoad>
	</RuleGroup>
	<!--SYSMON EVENT ID 7 : DLL (IMAGE) LOADED BY PROCESS [ImageLoad]-->
		<!--COMMENT:	Can cause high system load, disabled by default.-->
		<!--DATA: RuleName, UtcTime, ProcessGuid, ProcessId, Image, ImageLoaded, Hashes, Signed, Signature, SignatureStatus-->
	<RuleGroup name="RG=Image Load Includes" groupRelation="or">
		<ImageLoad onmatch="include">
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Module: Module Load,Level=4,Alert=MSDT Loading diagnostic library: Dogwalk/follina,Risk=100,CVE=CVE-2022-30190" groupRelation="and">
				<Image condition="image">msdt.exe</Image>
				<ImageLoaded condition="contains">sdiageng.dll</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=VBE7 Macro Image Loads with wshom,Risk=70" groupRelation="and">
				<Image condition="contains any">WINWORD.exe;EXCEL.EXE</Image>
				<ImageLoaded condition="contains all">VBE7.DLL;VBE7INTL.DLL;VBEUI.DLL;wshom.ocx</ImageLoaded>
				<ImageLoaded condition="excludes all">wbemdisp.dll;wbemcomn.dll;wbemprox.dll;wmiutils.dll;wbemsvc.dll</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Suspicious Process Loading ntkrnlmp.exe,Risk=50" groupRelation="and">
				<ImageLoaded condition="image">ntkrnlmp.exe</ImageLoaded>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,CVE=CVE-2021-1675,DS=Module: Module Load,Level=0,Desc=Printer Expoit,Risk=100" groupRelation="and">
				<ImageLoaded condition="contains any">\spool\drivers\x64\3\;\spool\drivers\W32X86\3\;\spool\drivers\IA64\3\</ImageLoaded>
				<Image condition="contains any">spoolsv.exe;printisolationhost.exe</Image>
				<SignatureStatus condition="excludes">Valid</SignatureStatus>
				<Company condition="excludes any">Brother Industries;Canon;Sharp;Microsoft Corporation;DYMO;Euro Plus d.o.o;HP Inc;Hewlett-Packard</Company>
			</Rule>
			<Rule name="Attack=T1218,Technique=System Binary Proxy Execution,Tactic=Defense Evasion,DS=Module: Module Load,Level=0,Desc=DLL Image Load by System in Suspicious Locations" groupRelation="and">
				<Image condition="begin with">C:\Windows\</Image>
				<ImageLoaded condition="contains any">\Users\Public\;\Desktop\;\Downloads\;\AppData\Local\Temp\;\PerfLogs\;$Recycle;\Fonts\</ImageLoaded>
				<ImageLoaded condition="excludes any">\Program Files</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Equation editor loading itself,Risk=50" groupRelation="and">
				<Image condition="image">EQNEDT32.EXE</Image>
				<ImageLoaded condition="contains">EQNEDT32.EXE</ImageLoaded>
			</Rule>
			<Rule name="Attack=T1033,Technique=System Owner/User Discovery,Tactic=Discovery,DS=Module: Module Load,Level=2,Alert=Windows Active Directory Services DLL Loading in Susicious Directories,Risk=100" groupRelation="and">
				<ImageLoaded condition="contains any">ACTIVEDS.DLL;Adsldpc.dll;Wldap32.dll;adsldp.dll</ImageLoaded>
				<Image condition="contains any">C:\Users;\Temp\;\ProgramData\</Image>
			</Rule>
			<Rule name="Attack=T1033,Technique=System Owner/User Discovery,Tactic=Discovery,DS=Module: Module Load,Level=2,Alert=Windows Active Directory Services DLL Loading by Suspicious Process,Risk=100" groupRelation="and">
				<ImageLoaded condition="contains any">ACTIVEDS.DLL;Adsldpc.dll;Wldap32.dll;adsldp.dll</ImageLoaded>
				<Image condition="contains any">\wscript.exe;\cscript.exe;\powershell.exe;\powershell_ise.exe;\rundll32.exe;\msbuild.exe;\csc.exe</Image>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=VBE6 Macro Image Loads with wshom,Risk=40" groupRelation="and">
				<Image condition="contains any">WINWORD.exe;EXCEL.EXE</Image>
				<ImageLoaded condition="contains all">VBEUI.DLL;VBE6.DLL;VBE6INTL.DLL;wshom.ocx</ImageLoaded>
				<ImageLoaded condition="excludes all">wbemdisp.dll;wbemcomn.dll;wbemprox.dll;wmiutils.dll;wbemsvc.dll;fastprox.dll</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=VBE7 Macro Image Loads with wmi,Risk=30" groupRelation="and">
				<Image condition="contains any">WINWORD.exe;EXCEL.EXE</Image>
				<ImageLoaded condition="contains all">VBE7.DLL;VBE7INTL.DLL;VBEUI.DLL;wbemdisp.dll;wbemcomn.dll;wbemprox.dll;wmiutils.dll;wbemsvc.dll</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=VBE6 Macro Image Loads with wmi,Risk=50" groupRelation="and">
				<Image condition="contains any">WINWORD.exe;EXCEL.EXE</Image>
				<ImageLoaded condition="contains all">VBEUI.DLL;VBE6.DLL;VBE6INTL.DLL;wbemdisp.dll;wbemcomn.dll;wbemprox.dll;wmiutils.dll;wbemsvc.dll</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Office taskschd.dll Load" groupRelation="and">
				<Image condition="contains any">WINWORD.exe;EXCEL.EXE</Image>
				<ImageLoaded condition="end with">taskschd.dll</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=WScript taskschd.dll Load" groupRelation="and">
				<Image condition="contains any">wscript.exe;cscript.exe</Image>
				<ImageLoaded condition="end with">taskschd.dll</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=WMI taskschd.dll Load" groupRelation="and">
				<Image condition="image">wmiprvse.exe</Image>
				<ImageLoaded condition="end with">taskschd.dll</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Powershell Loading MSI.dll" groupRelation="and">
				<Image condition="image">powershell.exe</Image>
				<ImageLoaded condition="end with">msi.dll</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Powershell Loading AMSI.dll" groupRelation="and">
				<Image condition="contains">powershell</Image>
				<ImageLoaded condition="end with">amsi.dll</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Powershell Not Loading AMSI.dll" groupRelation="and">
				<Image condition="excludes">powershell</Image>
				<ImageLoaded condition="end with">amsi.dll</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=1,Desc=Monitor logoncli.dll dll loads for injection - potential qbot activity" groupRelation="and">
				<ImageLoaded condition="end with">logoncli.dll</ImageLoaded>
				<Image condition="is not">C:\Windows\System32\wbem\WmiPrvSE.exe</Image>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Office clr.dll Load" groupRelation="and">
				<Image condition="contains any">WINWORD.exe;EXCEL.EXE</Image>
				<ImageLoaded condition="end with">clr.dll</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Suspicious clr windows management dll Load" groupRelation="and">
				<ImageLoaded condition="contains all">clr.dll;System.Management.ni.dll;Microsoft.Build.Utilities</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Wscript Internet Access library Loads" groupRelation="and">
				<Image condition="contains any">wscript.exe;cscript.exe</Image>
				<ImageLoaded condition="contains all">msxml;wshom.ocx</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Wscript Internet Access library Loads 2" groupRelation="and">
				<Image condition="contains any">wscript.exe;cscript.exe</Image>
				<ImageLoaded condition="contains all">winhttp.dll;mswsock.dll;IPHLPAPI.DLL</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Interesting Installutil DLL Loads" groupRelation="and">
				<Image condition="contains any">installutil.exe</Image>
				<ImageLoaded condition="contains all">CustomMarshalers.dll;CustomMarshalers.ni.dll;System.Management.ni.dll;WMINet_Utils.dll;mswsock.dll</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Automation NI DLL Loaded" groupRelation="and">
				<ImageLoaded condition="end with">System.Management.Automation.ni.dll</ImageLoaded>
				<ImageLoaded condition="begin with">C:\Windows\Microsoft.NET\assembly\GAC_MSIL\</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Automation DLL Loaded" groupRelation="and">
				<ImageLoaded condition="end with">System.Management.Automation.dll</ImageLoaded>
				<ImageLoaded condition="begin with">C:\Windows\Microsoft.NET\assembly\GAC_MSIL\</ImageLoaded>
				<ImageLoaded condition="excludes any">Lenovo.Vantage.AddinHost;\Microsoft.Sara.exe;C:\Program Files\CONEXANT</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Credential Manager DLL Loaded" groupRelation="and">
				<ImageLoaded condition="is">C:\Windows\System32\vaultcli.dll</ImageLoaded>
				<Image condition="excludes any">\svchost.exe;\GameBar.exe;C:\Program Files\WindowsApps;\Microsoft\Teams\current\Teams.exe</Image>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=UNC Path Image Loaded" groupRelation="and">
				<ImageLoaded condition="begin with">\\</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=WLL Office Application Startup" groupRelation="and">
				<ImageLoaded condition="contains">\Microsoft\Word\Startup\</ImageLoaded>
				<ImageLoaded condition="end with">.wll</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=XLL Office Application Startup" groupRelation="and">
				<ImageLoaded condition="contains">\Microsoft\Excel\Startup\</ImageLoaded>
				<ImageLoaded condition="end with">.xll</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Office Application Startup Generic" groupRelation="and">
				<ImageLoaded condition="contains">\Microsoft\Addins\</ImageLoaded>
				<ImageLoaded condition="contains any">.xla</ImageLoaded>
			</Rule>
			<Rule name="Attack=T1090.003,Technique=Proxy: Multi-hop Proxy,Tactic=Defense Evasion,DS=Module: Module Load,Level=4,Alert=Ransomware detected tor library,Risk=100" groupRelation="and">
				<ImageLoaded condition="contains">tor-lib.dll</ImageLoaded>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Module: Module Load,Level=0,Desc=Cred Dumping,Risk=90" groupRelation="and">
				<ImageLoaded condition="is any">C:\Windows\System32\WinSCard.dll;C:\Windows\System32\cryptdll.dll;C:\Windows\System32\hid.dll;C:\Windows\System32\samlib.dll;C:\Windows\System32\vaultcli.dll</ImageLoaded>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Module: Module Load,Level=0,Desc=Mimikatz Cred Dumping,Risk=100" groupRelation="and">
				<Image condition="image">rundll32.exe</Image>
				<ImageLoaded condition="contains all">vaultcli.dll;wlanapi.dll</ImageLoaded>
				<ImageLoaded condition="excludes">combase.dll</ImageLoaded>
				<ImageLoaded condition="excludes">cryptdll.dll</ImageLoaded>
				<ImageLoaded condition="excludes">imm32.dll</ImageLoaded>
				<ImageLoaded condition="excludes">logoncli.dll</ImageLoaded>
				<ImageLoaded condition="excludes">netapi32.dll</ImageLoaded>
				<ImageLoaded condition="excludes">ntasn1.dll</ImageLoaded>
				<ImageLoaded condition="excludes">ntdsapi.dll</ImageLoaded>
				<ImageLoaded condition="excludes">samlib.dll</ImageLoaded>
				<ImageLoaded condition="excludes">shcore.dll</ImageLoaded>
				<ImageLoaded condition="excludes">srvcli.dll</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Potential C3 Framework,Risk=100" groupRelation="and">
				<ImageLoaded condition="contains all">odbc32.dll;winhttp.dll;netapi32.dll;SHLWAPI.dll</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Explorer Loading Powershell in memory,Risk=100" groupRelation="and">
				<Image condition="image">C:\Windows\Explorer.EXE</Image>
				<ImageLoaded condition="is">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Programdata Image Loading exe Image from Programdata" groupRelation="and">
				<Image condition="begin with">C:\ProgramData\</Image>
				<ImageLoaded condition="begin with">C:\ProgramData\</ImageLoaded>
				<ImageLoaded condition="end with">.exe</ImageLoaded>
				<Company condition="excludes">Adobe</Company>
				<Image condition="excludes">C:\ProgramData\Lenovo\</Image>
				<ImageLoaded condition="excludes">C:\ProgramData\Microsoft\Windows Defender\</ImageLoaded>
				<ImageLoaded condition="excludes">C:\ProgramData\sysmon\sysmon64.exe</ImageLoaded>
			</Rule>
			<Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Module: Module Load,Level=3,Alert=Suspicious Image loaded within Default or Public Directory,Risk=40" groupRelation="and">
				<ImageLoaded condition="contains any">C:\Users\Default\;C:\Users\Public\</ImageLoaded>
				<ImageLoaded condition="end with">.exe</ImageLoaded>
			</Rule>
			<Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=Module: Module Load,Level=3,Alert=Suspicious Image loaded within Default or Public Directory,Risk=40" groupRelation="and">
				<ImageLoaded condition="contains any">C:\Users\Default\;C:\Users\Public\</ImageLoaded>
				<ImageLoaded condition="end with">.dll</ImageLoaded>
			</Rule>
			<Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=Module: Module Load,Level=4,Alert=Solarwinds/FireEye sunburst image hashes,Risk=100" groupRelation="and">
				<Hashes condition="contains any">56ceb6d0011d87b6e4d7023d7ef85676;4f2eb62fa529c0283b28d05ddd311fae;b91ce2fa41029f6955bff20079468448;b91ce2fa41029f6955bff20079468448;846e27a652a5e1bfbd0ddd38a16dc865;2c4a910a1299cdae2a4e55988a2f102e</Hashes><!-- exclude non executable files -->
			</Rule>
			<Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=Module: Module Load,Level=4,Alert=Sept 2022 Exchange 0day DLL detection,Risk=100" groupRelation="or">
				<Hashes condition="contains">SHA256=074eb0e75bb2d8f59f1fd571a8c5b76f9c899834893da6f7591b68531f2b5d82</Hashes><!--Exchange Zero Day Dropped DLL-->
				<Hashes condition="contains">SHA256=45c8233236a69a081ee390d4faa253177180b2bd45d8ed08369e07429ffbe0a9</Hashes><!--Exchange Zero Day Dropped DLL-->
				<Hashes condition="contains">SHA256=9ceca98c2b24ee30d64184d9d2470f6f2509ed914dafb87604123057a14c57c0</Hashes><!--Exchange Zero Day Dropped DLL-->
				<Hashes condition="contains">SHA256=29b75f0db3006440651c6342dc3c0672210cfb339141c75e12f6c84d990931c3</Hashes><!--Exchange Zero Day Dropped DLL-->
				<Hashes condition="contains">SHA256=c8c907a67955bcdf07dd11d35f2a23498fb5ffe5c6b5d7f36870cf07da47bff2</Hashes><!--Exchange Zero Day Dropped DLL-->
				<Hashes condition="contains">SHA256=76a2f2644cb372f540e179ca2baa110b71de3370bb560aca65dcddbd7da3701e</Hashes><!--Exchange Zero Day Dropped DLL-->
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=SVCHost loading Unsigned DLL" groupRelation="and">
				<Image condition="image">C:\Windows\System32\svchost.exe</Image>
				<Signed condition="is">false</Signed>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Revoked Signature Libraries Loaded" groupRelation="and">
				<SignatureStatus condition="is">Revoked</SignatureStatus>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=Expired Signature Libraries Loaded" groupRelation="and">
				<SignatureStatus condition="is">Expired</SignatureStatus>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=4,Alert=HTA Exec with IE JS Engine AMSI Bypass" groupRelation="and">
				<ImageLoaded condition="end with">jscript9.dll</ImageLoaded>
				<Image condition="image">mshta.exe</Image>
			</Rule>
			<ImageLoaded condition="end with">scrobj.dll</ImageLoaded>
			<ImageLoaded condition="end with">crypt0.dll</ImageLoaded>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Module: Module Load,Level=0,Desc=Wireless Credential Dumping" groupRelation="and">
				<ImageLoaded condition="end with">C:\Windows\System32\wlanapi.dll</ImageLoaded>
				<Image condition="excludes">C:\Program Files\NVIDIA Corporation\NVIDIA GeForce Experience\NVIDIA Share.exe</Image>
				<Image condition="excludes">C:\Program Files\NVIDIA Corporation\NVIDIA GeForce Experience\NVIDIA Share.exe</Image>
				<Image condition="excludes">C:\Program Files\WindowsApps\MicrosoftWindows.Client.WebExperience</Image>
				<Image condition="excludes">C:\Windows\ImmersiveControlPanel\SystemSettings.exe</Image>
				<Image condition="excludes">C:\Windows\ImmersiveControlPanel\SystemSettings.exe</Image>
				<Image condition="excludes">C:\Windows\System32\AppHostRegistrationVerifier.exe</Image>
				<Image condition="excludes">C:\Windows\System32\CompatTelRunner.exe</Image>
				<Image condition="excludes">C:\Windows\System32\DeviceCensus.exe</Image>
				<Image condition="excludes">C:\Windows\System32\DriverStore\FileRepository\</Image>
				<Image condition="excludes">C:\Windows\System32\LogonUI.exe</Image>
				<Image condition="excludes">C:\Windows\System32\MoNotificationUx.exe</Image>
				<Image condition="excludes">C:\Windows\System32\SystemSettingsBroker.exe</Image>
				<Image condition="excludes">C:\Windows\System32\dxgiadaptercache.exe</Image>
				<Image condition="excludes">C:\Windows\System32\netsh.exe</Image>
				<Image condition="excludes">C:\Windows\System32\wlanext.exe</Image>
				<Image condition="excludes">C:\Windows\UUS\amd64\MoUsoCoreWorker.exe</Image>
				<Image condition="excludes">C:\Windows\WinSxS\amd64_microsoft-windows-servicingstack_</Image>
				<Image condition="excludes">C:\Windows\explorer.exe</Image>
			</Rule>
			<Rule name="Attack=T1059.006,Technique=Command and Scripting Interpreter: Python,Tactic=Execution,DS=Module: Module Load,Level=2,Desc=Python DLL Loaded,Risk=30" groupRelation="and">
				<ImageLoaded condition="contains any">python</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=1,Desc=Unsigned Global Assembly Cache Load" groupRelation="and">
				<ImageLoaded condition="begin with">C:\Windows\Microsoft.NET\assembly\GAC_MSIL</ImageLoaded>
				<Signed condition="is">false</Signed>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=1,Desc=Signed Global Assembly Cache Load" groupRelation="and">
				<ImageLoaded condition="begin with">C:\Windows\Microsoft.NET\assembly\GAC_MSIL</ImageLoaded>
				<Signed condition="is">true</Signed>
			</Rule>
		</ImageLoad>
	</RuleGroup>
	<RuleGroup name="RG=Image Load Excludes" groupRelation="or">
		<ImageLoad onmatch="exclude">
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=XLL Office Application Startup removal" groupRelation="and">
				<Image condition="contains">\Microsoft Office\</Image>
				<ImageLoaded condition="end with">\mscorlib.ni.dll</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=XLL Office Application Startup removal" groupRelation="and">
				<Image condition="contains">\Microsoft Office\</Image>
				<ImageLoaded condition="end with">\sppc.dll</ImageLoaded>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Module: Module Load,Level=0,Desc=SVCHost Signed DLL" groupRelation="and">
				<Image condition="image">C:\Windows\System32\svchost.exe</Image>
				<Signed condition="is">true</Signed>
			</Rule>
			<!--Universal Exclusions: Be Careful-->
			<Rule name="Antivirus Exclusions" groupRelation="or"> 
				<Image condition="begin with">C:\Program Files (x86)\Kaspersky Lab</Image> 
				<Image condition="begin with">C:\Program Files\Kaspersky Lab</Image>
				<Image condition="begin with">C:\Program Files (x86)\ESET</Image>
				<Image condition="begin with">C:\Program Files\ESET</Image>
				<Image condition="begin with">C:\ProgramData\Microsoft\Windows Defender\</Image>
			</Rule>
			<Company condition="contains">Fortinet</Company>
			<Company condition="contains">Lenovo</Company>
			<Company condition="contains">Sophos</Company>
			<Image condition="end with">mscorsvw.exe</Image>
			<Image condition="image">C:\Program Files (x86)\Microsoft Office\root\Office15\officebackgroundtaskhandler.exe</Image>
			<Image condition="image">C:\Program Files (x86)\Microsoft Office\root\Office16\officebackgroundtaskhandler.exe</Image>
			<Image condition="image">C:\Program Files\Microsoft Office\root\Office15\officebackgroundtaskhandler.exe</Image>
			<Image condition="image">C:\Program Files\Microsoft Office\root\Office16\officebackgroundtaskhandler.exe</Image>
			<Image condition="image">C:\Windows\SysWOW64\SearchProtocolHost.exe</Image>
			<Image condition="image">C:\Windows\System32\InstallAgentUserBroker.exe</Image>
			<Image condition="image">C:\Windows\System32\RuntimeBroker.exe</Image>
			<Image condition="image">C:\Windows\System32\SearchIndexer.exe</Image>
			<Image condition="image">C:\Windows\System32\SettingSyncHost.exe</Image>
			<Image condition="image">C:\Windows\System32\backgroundTaskHost.exe</Image>
			<Image condition="image">C:\Windows\System32\sppsvc.exe</Image>
			<Image condition="image">C:\Windows\System32\taskhost.exe</Image>
			<Image condition="image">C:\Windows\System32\taskhostw.exe</Image>
			<Image condition="image">C:\Windows\SystemApps\Microsoft.AAD.BrokerPlugin_cw5n1h2txyewy\Microsoft.AAD.BrokerPlugin.exe</Image>
			<Image condition="image">C:\Windows\SystemApps\Microsoft.Windows.Cortana_cw5n1h2txyewy\SearchUI.exe</Image>
			<Image condition="image">HxTsr.exe</Image>
			<Image condition="image">SearchUI.exe</Image>
			<ImageLoaded condition="contains">C:\Program Files (x86)\Common Files\BIExcelFunctions1.1\32bit\Sage.</ImageLoaded>
			<ImageLoaded condition="contains">C:\Windows\Microsoft.NET\assembly\GAC_MSIL\Pfx.</ImageLoaded>
			<ImageLoaded condition="is">C:\Program Files (x86)\Adobe\Acrobat 10.0\Acrobat\Adist64.dll</ImageLoaded>
			<ImageLoaded condition="is">C:\Program Files (x86)\Microsoft Office\Office15\Library\Analysis\ANALYS32.XLL</ImageLoaded>
			<ImageLoaded condition="is">C:\Program Files (x86)\Microsoft Office\Office16\Library\Analysis\ANALYS32.XLL</ImageLoaded>
			<ImageLoaded condition="is">C:\Program Files\Microsoft Office\Office15\Library\Analysis\ANALYS32.XLL</ImageLoaded>
			<ImageLoaded condition="is">C:\Program Files\Microsoft Office\Office16\Library\Analysis\ANALYS32.XLL</ImageLoaded>
			<ImageLoaded condition="is">C:\Windows\SysWOW64\sppc.dll</ImageLoaded>
			<ImageLoaded condition="end with">Microsoft.Office.Interop.VisOcx.dll</ImageLoaded>
			<ImageLoaded condition="end with">Microsoft.Office.Interop.Word.dll</ImageLoaded>
			<ImageLoaded condition="end with">Microsoft.Vbe.Interop.dll</ImageLoaded>
			<ImageLoaded condition="end with">OFFICE.DLL</ImageLoaded>
		</ImageLoad>
	</RuleGroup>
	<!--SYSMON EVENT ID 8 : REMOTE THREAD CREATED [CreateRemoteThread]-->
	<RuleGroup name="RG=CreateRemoteThread Include Group" groupRelation="or">
		<CreateRemoteThread onmatch="include">
			<!--Custom Rules-->
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Modification,Level=4,Alert=Credential Dumping from lsass,Risk=100" groupRelation="and">
				<StartAddress condition="is">0x001A0000</StartAddress>
				<TargetImage condition="image">c:\windows\system32\lsass.exe</TargetImage>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privledge Escalation,DS=Process: Process Modification,Level=4,Alert=CreateRemoteThread with msiexec,Risk=100" groupRelation="and">
				<SourceImage condition="contains any">msiexec.exe</SourceImage>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion,DS=Process: Process Modification,Level=0,Desc=Remote Thread Injection Targetting Web Browser,Risk=70" groupRelation="and">
				<TargetImage condition="contains any">chrome.exe;firefox.exe;edge.exe;msedge.exe;browser_broker.exe;iexplore.exe;opera.exe</TargetImage>
			</Rule>
			<Rule name="Attack=T1003,Tactic=Credential Access,Technique=OS Credential Dumping,DS=Process: Process Modification,Level=0,Desc=LSASS Credential dumping,Risk=70" groupRelation="and">
				<StartAddress condition="is">0x001A0000</StartAddress>
				<TargetImage condition="image">c:\windows\system32\lsass.exe</TargetImage>
			</Rule>
			<Rule name="Attack=T1003,Tactic=Credential Access,Technique=OS Credential Dumping,DS=Process: Process Modification,Level=0,Desc=Rundll32 LSASS Credential dumping,Risk=70" groupRelation="and">
				<TargetImage condition="image">c:\windows\system32\lsass.exe</TargetImage>
				<SourceImage condition="image">c:\windows\system32\rundll32.exe</SourceImage>
			</Rule>
			<Rule name="Attack=T1546.012,Technique=Event Triggered Execution: Image File Execution Options Injection,Tactic=Persistence,DS=Process: Process Modification,Level=4,Alert=Remote Thread Process debugging detected,Risk=30" groupRelation="and">
				<StartFunction condition="contains">DbgUiRemoteBreakin</StartFunction>
				<TargetImage condition="excludes">nacl64.exe</TargetImage>
			</Rule>
			<Rule name="Attack=T1546.012,Technique=Event Triggered Execution: Image File Execution Options Injection,Tactic=Persistence,DS=Process: Process Modification,Level=0,Desc=Remote Query Debug info,Risk=30" groupRelation="and">
				<StartFunction condition="contains">QueryProcessDebugInformationRemote</StartFunction>
				<TargetImage condition="excludes">nacl64.exe</TargetImage>
			</Rule>
			<Rule name="Attack=T1546.012,Technique=Event Triggered Execution: Image File Execution Options Injection,Tactic=Persistence,Tactic=Defense Evasion,DS=Process: Process Modification,Level=0,Desc=Query Debug info 2,Risk=30" groupRelation="and">
				<StartFunction condition="contains">isdebuggerpresent</StartFunction>
				<TargetImage condition="excludes">nacl64.exe</TargetImage>
			</Rule>
			<Rule name="Attack=T1546.012,Technique=Process Debugging Detected,Tactic=Defense Evasion,DS=Process: Process Modification,Level=3,Alert=Process Debug of active Process,Risk=30" groupRelation="and">
				<StartFunction condition="contains">DebugActiveProcess</StartFunction>
				<TargetImage condition="excludes">nacl64.exe</TargetImage>
			</Rule>
			<Rule name="Attack=T1055.001,Technique=Process Injection: Dynamic-link Library Injection,Tactic=Defense Evasion,DS=Process: Process Modification,Level=3,Alert=LoadLibrary DLL Injection,Risk=70" groupRelation="and">
				<StartFunction condition="contains">LoadLibrary</StartFunction>
				<SourceImage condition="excludes">C:\Program Files\Bitdefender\Endpoint Security\EPSecurityService.exe</SourceImage>
				<SourceImage condition="excludes">C:\Program Files\NVIDIA Corporation\Display.NvContainer\NVDisplay.Container.exe</SourceImage>
				<SourceImage condition="excludes">C:\Windows\ImmersiveControlPanel\SystemSettings.exe</SourceImage>
				<SourceImage condition="excludes">C:\Windows\System32\DriverStore\FileRepository\</SourceImage>
				<SourceImage condition="excludes">C:\Windows\System32\igfxEM.exe</SourceImage>
				<SourceImage condition="excludes">C:\Windows\System32\igfxHK.exe</SourceImage>
				<SourceImage condition="excludes">Enterprise\Common7\IDE\devenv.exe</SourceImage>
				<TargetImage condition="excludes">C:\Program Files (x86)\ASUS\ROG Live Service\FileOperator.exe</TargetImage>
				<SourceImage condition="excludes all">C:\ProgramData\Microsoft\Windows Defender\Platform\;\MsMpEng.exe</SourceImage>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion,DS=Process: Process Modification,Level=0,Desc=CreateFileMapping,Risk=70" groupRelation="and">
				<StartFunction condition="contains any">CreateFileMapping;MapViewOfFile</StartFunction>
			</Rule>			
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion,DS=Process: Process Modification,Level=0,Desc=LdrLoadDll DLL Injection,Risk=70" groupRelation="and">
				<StartFunction condition="contains any">LdrLoadDll</StartFunction>
			</Rule>
			<Rule name="Attack=T1106,Technique=Native API,Tactic=Execution,DS=Process: Process Modification,Level=0,Desc=Crypt API Usage" groupRelation="and">
				<StartFunction condition="contains any">CryptAcquireContextA;CryptDecodeObjectEx;CryptImportPublicKeyInfo;CryptEncrypt;CryptGenKey;CryptDecrypt;CryptStringToBinary;CryptBinaryToString;CryptImportKey</StartFunction>
			</Rule>
			<Rule name="Attack=T1115,Technique=Clipboard Data,Tactic=Collection,DS=Process: Process Modification,Level=0,Desc=Clipboard Usage Detected" groupRelation="and">
				<SourceImage condition="image">c:\windows\system32\csrss.exe</SourceImage>
				<StartFunction condition="contains">CrtlRoutine</StartFunction>
			</Rule>
			<StartAddress name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion,DS=Process: Process Modification,Level=4,Alert=Cobalt Strike Detected 1,Risk=100" condition="end with">0B80</StartAddress>
			<StartAddress name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion,DS=Process: Process Modification,Level=4,Alert=Cobalt Strike Detected 2,Risk=100" condition="end with">0C7C</StartAddress>
			<StartAddress name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion,DS=Process: Process Modification,Level=4,Alert=Cobalt Strike Detected 3,Risk=100" condition="end with">0C88</StartAddress>
			<TargetImage name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion,DS=Process: Process Modification,Level=0,Desc=Remote Desktop injection,Risk=30" condition="image">c:\windows\system32\mstsc.exe</TargetImage>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Modification,Alert=Potentially Detect EtwEventWrite Tampering with remote threads" groupRelation="and">
				<StartModule condition="is">C:\WINDOWS\SYSTEM32\ntdll.dll</StartModule>
				<StartFunction condition="contains">EtwEventWrite</StartFunction>
			</Rule>
		</CreateRemoteThread>
	</RuleGroup>
	<RuleGroup name="RG=CreateRemoteThread Exclude Group" groupRelation="or">
		<CreateRemoteThread onmatch="exclude">
			<!--COMMENT: Exclude mostly-safe sources and log anything else.-->
			<SourceImage condition="image">C:\Windows\SysWOW64\wbem\WmiPrvSE.exe</SourceImage>
			<SourceImage condition="image">C:\Windows\system32\audiodg.exe</SourceImage>
			<SourceImage condition="image">C:\Windows\system32\services.exe</SourceImage>
			<SourceImage condition="image">C:\Windows\system32\svchost.exe</SourceImage>
			<SourceImage condition="image">C:\Windows\system32\wbem\WmiPrvSE.exe</SourceImage>
			<SourceImage condition="image">C:\Windows\system32\wininit.exe</SourceImage>
			<SourceImage condition="image">C:\Windows\system32\winlogon.exe</SourceImage>
		</CreateRemoteThread>
	</RuleGroup>
	<!--SYSMON EVENT ID 9 : RAW DISK ACCESS [RawAccessRead]-->
	<RuleGroup name="RG=RawAccessRead Include Group" groupRelation="or">
		<RawAccessRead onmatch="include">
		</RawAccessRead>
	</RuleGroup>
	<!--SYSMON EVENT ID 10 : INTER-PROCESS ACCESS [ProcessAccess]-->
	<RuleGroup name="RG=ProcessAccess Include Group" groupRelation="or">
		<ProcessAccess onmatch="include">
			<!--Custom Rules-->
			<Rule name="Attack=T1059.005,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Access,Level=0,Desc=CSShellExecute_ExecuteAssoc,Risk=30" groupRelation="and">
				<CallTrace condition="contains">C:\Windows\System32\SHELL32.dll+9b5bd</CallTrace>
				<TargetImage condition="excludes">\LocalBridge.exe</TargetImage>
			</Rule>
			<Rule name="Attack=T1059.005,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Access,Level=0,Desc=WSHellExec,Risk=50" groupRelation="and">
				<CallTrace condition="contains any">C:\Windows\System32\wshom.ocx+c8a0;C:\Windows\System32\wshom.ocx+c39d</CallTrace>
			</Rule>
			<Rule name="Attack=T1047.005,Technique=Windows Management Instrumentation,Tactic=Execution,DS=Process: Process Access,Level=0,Desc=CWbemProviderGlueExecMethodAsync,Risk=50" groupRelation="and">
				<CallTrace condition="contains">C:\Windows\SYSTEM32\framedynos.dll+2cb3e</CallTrace>
				<TargetImage condition="excludes any">C:\Windows\system32\SgrmBroker.exe;C:\Windows\system32\SecurityHealthService.exe;C:\ProgramData\Microsoft\Windows Defender\platform\;C:\Windows\system32\services.exe;C:\Windows\system32\wininit.exe;C:\Windows\system32\sppsvc.exe;C:\Windows\System32\smss.exe;C:\Windows\system32\csrss.exe;C:\Windows\System32\svchost.exe</TargetImage>
			</Rule>
			<Rule name="Attack=T1047.005,Technique=Windows Management Instrumentation,Tactic=Execution,DS=Process: Process Access,Level=0,Desc=ProviderExecMethod 1,Risk=60" groupRelation="and">
				<CallTrace condition="contains">C:\Windows\SYSTEM32\framedynos.dll+2b496</CallTrace>
			</Rule>
			<Rule name="Attack=T1003.001,Technique=Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=0,Desc=MiniDumpWriteDump,Risk=50" groupRelation="and">
				<CallTrace condition="contains">C:\Windows\SYSTEM32\dbgcore.DLL+6cfb</CallTrace>
			</Rule>
			<Rule name="Attack=T1003.001,Technique=Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=0,Desc=PssCaptureSnapShot,Risk=50" groupRelation="and">
				<CallTrace condition="contains">C:\Windows\System32\KernelBase.dll+de67e</CallTrace>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=0,Desc=Dotnet Debugging detected,Risk=30" groupRelation="and">
				<CallTrace condition="contains">ntdll.dll+a0044</CallTrace>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=0,Alert=DInvoke detected,Risk=100" groupRelation="and">
				<CallTrace condition="contains any">clr.dll+6c23;clr.dll+6b38</CallTrace>
			</Rule>
			<Rule name="Attack=T1055,Tactic=Defense Evasion,Technique=Process Injection,DS=Process: Process Access,Level=0,Desc=Suspicious In-Memory Module Execution 1,Risk=30" groupRelation="and">
				<CallTrace condition="contains all">C:\Windows\\SYSTEM32\ntdll.dll+;|C:\Windows\System32\KERNELBASE.dll+;|UNKNOWN(</CallTrace>
				<CallTrace condition="end with">)</CallTrace>
			</Rule>
			<Rule name="Attack=T1055,Tactic=Defense Evasion,Technique=Process Injection,DS=Process: Process Access,Level=0,Desc=Suspicious In-Memory Module Execution 2,Risk=30" groupRelation="and">
				<CallTrace condition="contains all">"UNKNOWN(;)|UNKNOWN(</CallTrace>
				<CallTrace condition="end with">)</CallTrace>
			</Rule>
			<Rule name="Attack=T1055,Tactic=Defense Evasion,Technique=Process Injection,DS=Process: Process Access,Level=0,Desc=Suspicious In-Memory Module Execution 3,Risk=30" groupRelation="and">
				<CallTrace condition="contains all">"UNKNOWN</CallTrace>
				<GrantedAccess condition="contains any">0x1F0FFF;0x1F1FFF;0x143A;0x1410;0x1010;0x1F2FFF;0x1F3FFF;0x1FFFFF</GrantedAccess>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion,DS=Process: Process Access,Level=0,Desc=Office Macro Injection Detected,Risk=100" groupRelation="and">
				<SourceImage condition="contains all">C:\Program Files;\Microsoft Office\Root\Office</SourceImage>
				<CallTrace condition="contains">\Microsoft Shared\VBA</CallTrace>
				<TargetImage condition="excludes">C:\Program Files (x86)\Intuit\</TargetImage>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=0,Desc=LSASS Credential Access,Risk=70" groupRelation="and">
				<TargetImage condition="image">C:\Windows\system32\lsass.exe</TargetImage>
				<GrantedAccess>0x1FFFFF</GrantedAccess>
				<CallTrace condition="contains">UNKNOWN</CallTrace>
				<CallTrace condition="excludes">WmiPerfClass.dll</CallTrace>
				<SourceImage condition="excludes any">C:\Windows\sysWOW64\wbem\wmiprvse.exe;C:\Windows\system32\wbem\wmiprvse.exe;C:\Program Files\VMware\VMware Tools\vmtoolsd.exe;C:\Program Files (x86)\VMware\VMware Tools\vmtoolsd.exe;WmiPerfClass.dll;C:\Program Files (x86)\Adobe\Adobe Sync\CoreSync\customhook\CoreSyncCustomHook.exe;C:\Program Files\Adobe\Adobe Sync\CoreSync\customhook\CoreSyncCustomHook.exe;C:\Program Files (x86)\Common Files\Adobe</SourceImage>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=0,Desc=Mimikatz through Windows Remote Management,Risk=100" groupRelation="and">
				<TargetImage condition="image">C:\Windows\system32\lsass.exe</TargetImage>
				<SourceImage condition="image">C:\Windows\system32\wsmprovhost.exe</SourceImage>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=0,Desc=LSASS process access by LaZagne,Risk=100" groupRelation="and">
				<TargetImage condition="image">C:\Windows\system32\lsass.exe</TargetImage>
				<GrantedAccess>0x1FFFFF</GrantedAccess>
				<CallTrace condition="contains all">python27.dll;_ctypes.pyd;KERNELBASE.dll;ntdll.dll</CallTrace>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=0,Desc=LSASS process access by Mimikatz,Risk=100" groupRelation="and">
				<TargetImage condition="image">C:\Windows\system32\lsass.exe</TargetImage>
				<CallTrace condition="begin with">C:\Windows\SYSTEM32\ntdll.dll+4595c|C:\Windows\system32\KERNELBASE.dll+8185</CallTrace>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=0,Desc=LSASS Cobalt Strike Monitor,Risk=70" groupRelation="and">
				<TargetImage condition="image">C:\Windows\system32\lsass.exe</TargetImage>
				<CallTrace condition="begin with">C:\WINDOWS\SYSTEM32\ntdll.dll+</CallTrace>
				<CallTrace condition="end with">)</CallTrace>
				<CallTrace condition="contains all">|C:\WINDOWS\System32\KERNELBASE.dll+;|UNKNOWN(</CallTrace>
				<CallTrace condition="excludes any">wow64.dll;)|C;Exchange.Diagnostics;Microsoft.Exchange</CallTrace>
				<SourceImage condition="excludes any">C:\Program Files\Bitdefender\Endpoint Security\EPSecurityService.exe;c:\windows\system32\inetsrv\w3wp.exe;MSExchangeHMHost.exe;C:\Windows\sysWOW64\wbem\wmiprvse.exe</SourceImage>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=4,Alert=Rubeus Mimikatz Like Detection,Risk=70" groupRelation="and">
				<TargetImage condition="image">C:\Windows\system32\winlogon.exe</TargetImage>
				<GrantedAccess>0x1F3FFF</GrantedAccess>
				<CallTrace condition="contains any">C:\Windows\Microsoft.NET;UNKNOWN</CallTrace>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=0,Desc=Suspicious Process Accessing Sysmon,Risk=50" groupRelation="and">
				<SourceImage condition="end with">.exe</SourceImage>
				<TargetImage condition="contains any">C:\Windows\sysmon64.exe;C:\Windows\sysmon64.exe</TargetImage>
				<GrantedAccess>0x1C00</GrantedAccess>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=0,Desc=LSASS Access,Risk=20" groupRelation="and">
				<TargetImage condition="image">C:\Windows\system32\lsass.exe</TargetImage>
				<GrantedAccess>0x1F1FFF</GrantedAccess>
				<CallTrace condition="contains">UNKNOWN</CallTrace>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=0,Desc=LSASS Access 2,Risk=20" groupRelation="and">
				<TargetImage condition="image">C:\Windows\system32\lsass.exe</TargetImage>
				<GrantedAccess>0x1010</GrantedAccess>
				<CallTrace condition="contains">UNKNOWN</CallTrace>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=0,Desc=LSASS Access 3,Risk=20" groupRelation="and">
				<TargetImage condition="image">C:\Windows\system32\lsass.exe</TargetImage>
				<GrantedAccess>0x143A</GrantedAccess>
				<CallTrace condition="contains">UNKNOWN</CallTrace>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=4,Alert=LSASS Memory Dump,Risk=100" groupRelation="and">
				<TargetImage condition="image">C:\Windows\system32\lsass.exe</TargetImage>
				<GrantedAccess>0x1fffff</GrantedAccess>
				<CallTrace condition="contains any">dbghelp.dll;dbgcore.dll</CallTrace>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=0,Desc=Process access with dbghelp,Risk=30" groupRelation="and">
				<CallTrace condition="contains any">dbghelp.dll;dbgcore.dll</CallTrace>
				<TargetImage condition="excludes">C:\Windows\system32\lsass.exe</TargetImage>
				<SourceImage condition="excludes">C:\wfx32\</SourceImage>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=0,Desc=Powershell accessing another process memory" groupRelation="and">
				<SourceImage condition="image">powershell.exe</SourceImage>
				<TargetImage condition="excludes any">C:\Programdata\sysmon\sysmon64.exe;C:\Programdata\sysmon\sysmon.exe;C:\Windows\sysmon.exe;C:\Windows\sysmon64.exe;\dismhost.exe</TargetImage>
				<CallTrace condition="excludes all">C:\WINDOWS\SYSTEM32\ntdll.dll+;|C:\WINDOWS\System32\KERNELBASE.dll+;|C:\ProgramData\Microsoft\Windows Defender\Platform\;\MPCLIENT.DLL;\MpOav.dll+;|C:\WINDOWS\SYSTEM32\amsi.dll</CallTrace>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=0,Desc=Potential Keylogger detected,Risk=100" groupRelation="and">
				<CallTrace condition="contains">getasynckeystate</CallTrace>
			</Rule>
			<Rule name="Attack=T1548.002,Technique=Abuse Elevation Control Mechanism: Bypass User Account Control,Tactic=Defense Evasion/Privilege Escalation,DS=Process: Process Access,Level=0,Desc=CMSTP UAC Bypass" groupRelation="and">
				<CallTrace condition="contains">cmlua.dll</CallTrace>
			</Rule>
			<Rule name="Attack=T1086,Technique=PowerShell,Tactic=Execution,DS=Process: Process Access,Level=3,Alert=Powershell without Powershell,Risk=30" groupRelation="and">
				<CallTrace condition="contains">System.Management.Automation</CallTrace>
				<CallTrace condition="excludes">C:\ProgramData\Microsoft\Windows Defender\platform\</CallTrace>
				<CallTrace condition="excludes">ctiuser.dll</CallTrace>
				<SourceImage condition="is not">C:\Program Files\Citrix\ConfigSync\ConfigSyncRun.exe</SourceImage>
				<SourceImage condition="is not">C:\Program Files\Microsoft\Exchange Server\V14\bin\ExSetupUI.exe</SourceImage>
				<SourceImage condition="is not">C:\Program Files\Microsoft\Exchange Server\V15\bin\ExSetupUI.exe</SourceImage>
				<SourceImage condition="is not">C:\Program Files\Microsoft\Exchange Server\V16\bin\ExSetupUI.exe</SourceImage>
				<SourceImage condition="is not">C:\Windows\SysWOW64\sdiagnhost.exe</SourceImage>
				<SourceImage condition="is not">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</SourceImage>
				<SourceImage condition="is not">C:\Windows\Temp\ExchangeSetup\ExSetupUI.exe</SourceImage>
				<SourceImage condition="is not">C:\system32\WindowsPowerShell\v1.0\PowerShell_ISE.exe</SourceImage>
				<TargetImage condition="is not">C:\Program Files\Microsoft Azure Active Directory Connect\AzureADConnect.exe</TargetImage>
				<TargetImage condition="is not">C:\Windows\system32\HOSTNAME.EXE</TargetImage>
				<TargetImage condition="is not">C:\Windows\system32\ROUTE.exe</TargetImage>
				<TargetImage condition="is not">C:\Windows\system32\query.exe</TargetImage>
				<TargetImage condition="is not">MsMpEng.exe</TargetImage>
			</Rule>
			<Rule name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=3,Alert=Kaodic credential access detected,Risk=100" groupRelation="and">
				<TargetImage condition="image">C:\Windows\system32\lsass.exe</TargetImage>
				<CallTrace condition="contains">comsvcs.dll</CallTrace>
			</Rule>
			<Rule name="Attack=T1059,Technique=Scripting,Tactic=Execution,DS=Process: Process Access,Level=3,Alert=Office Macro Execution VBE7,Risk=80" groupRelation="and">
				<CallTrace condition="contains any">VBE7.dll;VBEUI.DLL;VBE7INTL.DLL</CallTrace>
			</Rule>
			<Rule name="Attack=T1059,Technique=Scripting,Tactic=Execution,DS=Process: Process Access,Level=3,Alert=Office Macro Execution VBE6,Risk=80" groupRelation="and">
				<CallTrace condition="contains any">VBE6.dll;VBEUI.DLL;VBE6INTL.DLL</CallTrace>
			</Rule>
			<Rule name="Attack=T1059,Technique=Scripting,Tactic=Execution,DS=Process: Process Access,Level=3,Alert=verclsid Office Execution,Risk=80" groupRelation="and">
				<SourceImage condition="contains">Office</SourceImage>
				<TargetImage condition="contains">verclsid.exe</TargetImage>
				<CallTrace condition="contains any">VBE7.dll;VBEUI.DLL;VBE7INTL.DLL</CallTrace>
				<CallTrace condition="contains any">|UNKNOWN(</CallTrace>
				<GrantedAccess condition="contains">0x1FFFFF</GrantedAccess>
			</Rule>
			<Rule name="Attack=T1059.005,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Access,Level=0,Desc=CreateProcessW,Risk=70" groupRelation="and">
				<SourceImage condition="contains">C:\Program Files\Microsoft Office\Root\Office</SourceImage>
				<CallTrace condition="contains">C:\Windows\System32\KERNELBASE.dll+76516</CallTrace>
			</Rule>
			<Rule name="Attack=T1059.005,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=Process: Process Access,Level=0,Desc=CSShellExecute_DoExecute,Risk=30" groupRelation="and">
				<CallTrace condition="contains" >C:\Windows\System32\SHELL32.dll+ae3b9</CallTrace>
				<TargetImage condition="excludes">C:\WINDOWS\system32\sihost.exe</TargetImage>
				<TargetImage condition="excludes">C:\Program Files\WindowsApps\Microsoft.MicrosoftOfficeHub</TargetImage>
			</Rule>
			<CallTrace name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=4,Alert=CobaltStrike BOF using OpenProcess/NtOpenProcess" condition="begin with">UNKNOWN</CallTrace>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=4,Alert=Typical ProcessAccess Pattern of CobaltStrike BOF" groupRelation="and">
				<CallTrace condition="contains">|UNKNOWN(</CallTrace>
				<CallTrace condition="begin with">C:\WINDOWS\SYSTEM32\ntdll.dll+</CallTrace>
				<CallTrace condition="contains">|C:\WINDOWS\System32\KERNELBASE.dll+</CallTrace>
				<CallTrace condition="end with">)</CallTrace>
				<GrantedAccess condition="contains any">0x1028;0x1fffff</GrantedAccess>
				<SourceImage condition="excludes any">C:\Program Files\SmartGit\bin\;C:\Program Files (x86)\ASUS\Update\;C:\Program Files (x86)\Razer\Synapse3\Service\Razer Synapse Service.exe;C:\Program Files (x86)\Citrix\ICA Client\Receiver\UpdaterService.exe;C:\WINDOWS\SysWOW64\config\systemprofile\Citrix\UpdaterBinaries\;C:\Program Files\Mozilla Firefox\firefox.exe;C:\Program Files\SmartGit\git;\Intel\Driver and Support Assistant\DSAService.exe</SourceImage>
				<SourceImage condition="excludes all">C:\Windows\Microsoft.NET\Framework\;\NGenTask.exe</SourceImage>
				<TargetImage condition="excludes any">\Intel\Driver and Support Assistant\</TargetImage>
				<TargetImage condition="excludes all">C:\Windows\Microsoft.NET\Framework\;\ngen.exe</TargetImage>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=3,Alert=Potential MalDoc Behavior" groupRelation="and">
				<SourceImage condition="contains any">winword.exe;excel.exe;powerpnt.exe</SourceImage>
				<CallTrace condition="contains all">:\Windows\Microsoft.NET\Framework64\v2.;UNKNOWN</CallTrace>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=4,Alert=Potential Metasploit Process Migration" groupRelation="and">
				<CallTrace condition="contains">UNKNOWN</CallTrace>
				<GrantedAccess condition="contains">0x147a</GrantedAccess>
			</Rule>
			<Rule name="Attack=T1562.002,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Process: Process Access,Level=4,Alert=SysmonEnte Detection,DS=Process: Process Access,Level=4,Risk=100" groupRelation="and">
				<TargetImage condition="contains any">C:\Windows\Sysmon64.exe;C:\Windows\Sysmon.exe</TargetImage>
				<SourceImage condition="is not">C:\WINDOWS\system32\wbem\wmiprvse.exe</SourceImage>
				<SourceImage condition="is not">C:\Program Files (x86)\ASUS\Update\AsusUpdate.exe</SourceImage>
				<SourceImage condition="is not">C:\Program Files\Intel\SUR\QUEENCREEK\x64\esrv_svc.exe</SourceImage>
				<SourceImage condition="excludes any">C:\ProgramData\Microsoft\Windows Defender\Platform\;\MsMpEng.exe;C:\Program Files (x86)\Microsoft\EdgeUpdate\MicrosoftEdgeUpdate.exe;C:\Program Files (x86)\Google\Update\GoogleUpdate.exe</SourceImage>
				<GrantedAccess condition="contains">0x1400</GrantedAccess>
			</Rule>
			<!-- PROCESS_SUSPEND_RESUME + PROCESS_VM_WRITE: possible memory injection -->
			<GrantedAccess name="Attack=T1093,Technique=Process Hollowing,Tactic=Defense Evasion,DS=Process: Process Access,Level=4,Alert=Process Hollowing Detected,Risk=100">0x0800</GrantedAccess>
			<!-- PROCESS_SUSPEND_RESUME -->
			<GrantedAccess name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=4,Alert=Credential Dumping from Memory indicator">0x0810</GrantedAccess>
			<!-- PROCESS_SUSPEND_RESUME + PROCESS_VM_READ: possible memory dump to extract sensitive information -->
			<GrantedAccess name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Process: Process Access,Level=0,Desc=Possible Memory Dump,Risk=70">0x0820</GrantedAccess>
			<!-- PROCESS_SUSPEND_RESUME -->
			<GrantedAccess name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=4,Alert=Credential Dumping from Memory indicator,Risk=70">0x810</GrantedAccess>
			<!-- PROCESS_SUSPEND_RESUME + PROCESS_VM_READ: possible memory dump to extract sensitive information -->
			<GrantedAccess name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Process: Process Modification,Risk=70">0x820</GrantedAccess>
			<SourceImage name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=0,Desc=CScript accessing another process memory,Risk=30" condition="end with">cscript.exe</SourceImage>
			<SourceImage name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=0,Desc=WScript accessing another process memory,Risk=30" condition="end with">wscript.exe</SourceImage>
			<SourceImage condition="end with">jjs.exe</SourceImage>
			<CallTrace name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=4,Alert=Credential Dumping from Memory indicator,Risk=100" condition="contains">dump</CallTrace>
			<CallTrace name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Process: Process Access,Level=4,Alert=Credential Dumping from Memory indicator,Risk=100" condition="contains">mimikatz</CallTrace>
			<CallTrace name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=0,Desc=ProcessAccess with CorperfmontExt.dll,Risk=70" condition="contains">CorperfmontExt.dll</CallTrace>
		</ProcessAccess>
	</RuleGroup>
	<RuleGroup name="RG=ProcessAccess Exclude Group" groupRelation="or">
		<ProcessAccess onmatch="exclude">
			<Rule name="wmi accessing lsass" groupRelation="and">
				<SourceImage condition="image">wmiprvse.exe</SourceImage>
				<TargetImage condition="image">lsass.exe</TargetImage>
			</Rule>
			<Rule name="lsass accessing winlogon" groupRelation="and">
				<SourceImage condition="image">lsass.exe</SourceImage>
				<TargetImage condition="image">winlogon.exe</TargetImage>
			</Rule>
			<!-- These binaries appear to access lsass legitimately -->
			<Rule name="legitimate lsass access" groupRelation="and">
				<TargetImage condition="image">lsass.exe</TargetImage>
				<SourceImage condition="excludes any">C:\Windows\system32\w32tm.exe;C:\Windows\System32\ping.exe;C:\Windows\System32\net.exe;C:\Windows\System32\net1.exe;C:\Windows\SYSTEM32\HOSTNAME.EXE;C:\Programdata\sysmon\sysmon.exe;C:\Programdata\sysmon\sysmon64.exe;C:\Program Files\Windows Defender\MsMpEng.exe;C:\Program Files (x86)\BeAnywhere Support Express\;C:\Program Files (x86)\CheckPoint\;C:\Program Files (x86)\Common Files\Intuit\QuickBooks\;C:\Program Files (x86)\Fortinet\;C:\Program Files (x86)\Trend Micro\;C:\Program Files\Adobe\Adobe Creative Cloud Experience\;C:\Program Files\CheckPoint\;C:\Program Files\Fortinet\;C:\Program Files\Realtek;C:\Program Files\Trend Micro\;C:\ProgramData\Microsoft\Windows Defender\platform\;C:\Program Files (x86)\Lenovo\;snmpd.exe;taskmgr;:\Windows\System32\smss.exe;:\Windows\system32\wininit.exe;\Bin\FMS.exe; <!-- Exchange Process -->\EMET_GUI.exe;\EMET_Service.exe;\Google\Update\GoogleUpdate.exe;\RAAGTAPP.EXE;\controls\cef\ConnectWise.exe;C:\Program Files (x86)\Sophos\Sophos Anti-Virus\SavService.exe;C:\Program Files\Hewlett-Packard\AMS\service\hpqams.exe;C:\Program Files\Intel\SUR\WILLAMETTE\ESRV\esrv_svc.exe;C:\Program Files\VMware\VMware Tools\vmtoolsd.exe;C:\Program Files\Windows Defender\MsMpEng.exe;C:\WINDOWS\system32\WerFault.exe;C:\WINDOWS\system32\taskkill.exe;C:\Windows\SysWOW64\WerFault.exe;C:\Windows\System32\snmp.exe;C:\Windows\system32\msiexec.exe;C:\Windows\system32\spoolsv.exe;C:\Windows\system32\svchost.exe</SourceImage>
			</Rule>
			<!-- These binaries get or access processes running .NET -->
			<SourceImage condition="end with">:\Windows\system32\sppsvc.exe</SourceImage>
			<SourceImage condition="end with">:\Windows\system32\sdiagnhost.exe</SourceImage>
			<!-- In testing a common false-positive is memory space that DLLS would be expected to mapped to. -->
			<CallTrace condition="contains">UNKNOWN(00007F</CallTrace>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Process: Process Access,Level=0,Desc=Direct System Call Events" groupRelation="and">
				<CallTrace condition="not begin with">C:\Windows\SYSTEM32\ntdll.dll</CallTrace>  
				<CallTrace condition="not begin with">C:\Windows\SYSTEM32\win32u.dll</CallTrace>
				<CallTrace condition="not begin with">C:\Windows\SYSTEM32\wow64win.dll</CallTrace>
			</Rule>
			<Rule name="Antivirus Exclusions" groupRelation="or"> 
				<SourceImage condition="begin with">C:\Program Files (x86)\Kaspersky Lab</SourceImage> 
				<SourceImage condition="begin with">C:\Program Files\Kaspersky Lab</SourceImage>
				<SourceImage condition="begin with">C:\Program Files (x86)\ESET</SourceImage>
				<SourceImage condition="begin with">C:\Program Files\ESET</SourceImage>
				<SourceImage condition="begin with">C:\ProgramData\Microsoft\Windows Defender\</SourceImage>
			</Rule>
		</ProcessAccess>
	</RuleGroup>
	<!--SYSMON EVENT ID 11 : FILE CREATED [FileCreate]-->
		<!--DATA: RuleName, UtcTime, ProcessGuid, ProcessId, Image, TargetFilename, CreationUtcTime-->
	<RuleGroup name="RG=FileCreate Include Group" groupRelation="or">
		<FileCreate onmatch="include">
			<!--MITRE ATT&CK TACTIC: Reconnaissance-->
			<!--MITRE ATT&CK TECHNIQUE: Active Scanning-->
			<TargetFilename name="Attack=T1595,Technique=Active Scanning,Tactic=Reconnaissance,DS=File: File Creation,Level=4,Alert=Nessus Temp Files Created,Risk=100" condition="contains">\TEMP\nessus_</TargetFilename>
			<!--MITRE ATT&CK TECHNIQUE: Gather Victim Host Information-->
			<!--MITRE ATT&CK TECHNIQUE: Gather Victim Identity Information-->
			<!--MITRE ATT&CK TECHNIQUE: Gather Victim Network Information-->
			<!--MITRE ATT&CK TECHNIQUE: Gather Victim Org Information-->
			<!--MITRE ATT&CK TECHNIQUE: Phishing for Information-->
			<!--MITRE ATT&CK TECHNIQUE: Search Closed Sources-->
			<!--MITRE ATT&CK TECHNIQUE: Search Open Technical Databases-->
			<!--MITRE ATT&CK TECHNIQUE: Search Open Websites/Domains-->
			<!--MITRE ATT&CK TECHNIQUE: Search Victim-Owned Websites-->

			<!--MITRE ATT&CK TACTIC: Resource Development-->
			<!--MITRE ATT&CK TECHNIQUE: Acquire Infrastructure-->
			<!--MITRE ATT&CK TECHNIQUE: Compromise Accounts-->
			<!--MITRE ATT&CK TECHNIQUE: Compromise Infrastructure-->
			<!--MITRE ATT&CK TECHNIQUE: Develop Capabilities-->
			<!--MITRE ATT&CK TECHNIQUE: Establish Accounts-->
			<!--MITRE ATT&CK TECHNIQUE: Obtain Capabilities-->
			<!--MITRE ATT&CK TECHNIQUE: Stage Capabilities-->

			<!--MITRE ATT&CK TACTIC: Initial Access-->
			<!--MITRE ATT&CK TECHNIQUE: Drive-by Compromise-->
			<!--MITRE ATT&CK TECHNIQUE: Exploit Public-Facing Application-->
			<!--MITRE ATT&CK TECHNIQUE: External Remote Services-->
			<!--MITRE ATT&CK TECHNIQUE: Hardware Additions-->
			<!--MITRE ATT&CK TECHNIQUE: Phishing-->
			<!--MITRE ATT&CK TECHNIQUE: Replication Through Removable Media-->
			<!--MITRE ATT&CK TECHNIQUE: Supply Chain Compromise-->
			<Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=File: File Creation,Level=4,Alert=Solarwinds sunburst suspicious file writes,Risk=100" groupRelation="and">
				<Image condition="contains any">solarwinds.businesslayerhost</Image>
				<TargetFilename condition="contains any">.exe;.dll;.ps1;.mz;.jpg;.png</TargetFilename>
			</Rule>
			<Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=File: File Creation,Level=4,Alert=Solarwinds sunburst malware dll,Risk=100" groupRelation="and">
				<TargetFilename condition="is">C:\WINDOWS\SysWOW64\netsetupsvc.dll</TargetFilename>
			</Rule>
			<Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=File: File Creation,Level=4,Alert=Dark Halo Software location,Risk=100" groupRelation="and">
				<TargetFilename condition="begin with">C:\Windows\SoftwareDistribution</TargetFilename>
				<TargetFilename condition="is not">C:\Windows\SoftwareDistribution\Download\Install\AM_Delta.exe</TargetFilename>
				<TargetFilename condition="end with">.exe</TargetFilename>
			</Rule>
			<Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=File: File Creation,Level=0,Desc=MSBuild Source Files created" groupRelation="or">
				<TargetFilename condition="end with">proj</TargetFilename>
				<TargetFilename condition="end with">.targets</TargetFilename>
				<TargetFilename condition="end with">.build</TargetFilename>
				<TargetFilename condition="end with">.props</TargetFilename>
				<TargetFilename condition="end with">.tasks</TargetFilename>
				<TargetFilename condition="end with">.sln</TargetFilename>
				<TargetFilename condition="end with">.cs</TargetFilename>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Trusted Relationship-->
			<!--MITRE ATT&CK TECHNIQUE: Valid Accounts -->
			
			<!--MITRE ATT&CK TACTIC: Execution-->
			<!--MITRE ATT&CK TECHNIQUE: Command and Scripting Interpreter-->
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Batch File scripting: Batch scripts" condition="end with">.bat</TargetFilename>
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Batch scripting: Legacy btm Extension" condition="end with">.btm</TargetFilename>
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Batch scripting: Legacy cmd Extension" condition="end with">.cmd</TargetFilename>
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Batch scripting: Legacy com Extension" condition="end with">.com</TargetFilename>
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=CMDLine File Created" condition="end with">.cmdline</TargetFilename>
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Batch File Created" condition="end with">.bas</TargetFilename>
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=BIN file created" condition="end with">.bin</TargetFilename>
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=WMI Shell artifacts" condition="begin with">C:\Windows\SysWOW64\Wbem</TargetFilename>
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=WMI Shell artifacts" condition="begin with">C:\Windows\System32\Wbem</TargetFilename>
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=WS Scripting" condition="end with">.ws</TargetFilename>
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=WSC Scripting" condition="end with">.wsc</TargetFilename>
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=WSF Scripting" condition="end with">.wsf</TargetFilename>
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=WSH Scripting" condition="end with">.wsh</TargetFilename>
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=PIF Scripting" condition="end with">.pif</TargetFilename>
			<!--MITRE ATT&CK TECHNIQUE: Command and Scripting Interpreter: MSHTA-->
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=MSHTA Scripting" condition="end with">.hta</TargetFilename>
			<!--MITRE ATT&CK TECHNIQUE: Command and Scripting Interpreter: Python-->
			<TargetFilename name="Attack=T1059.006,Technique=Command and Scripting Interpreter: Python,Tactic=Execution,DS=File: File Creation,Level=0,Desc=IronPython,Risk=90" condition="contains">IronPython</TargetFilename>
			<TargetFilename name="Attack=T1059.006,Technique=Command and Scripting Interpreter: Python,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Python" condition="end with">.py</TargetFilename>
			<TargetFilename name="Attack=T1059.006,Technique=Command and Scripting Interpreter: Python,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Python" condition="end with">.pyc</TargetFilename>
			<TargetFilename name="Attack=T1059.006,Technique=Command and Scripting Interpreter: Python,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Python" condition="end with">.pyd</TargetFilename>
			<!--MITRE ATT&CK TECHNIQUE: Command and Scripting Interpreter: Powershell-->
			<Rule name="Attack=T1059.001,Technique=Command and Scripting Interpreter: PowerShell,Tactic=Execution,DS=File: File Creation,Level=2,Desc=Powershell file types,Risk=100" groupRelation="or">
				<TargetFilename condition="end with">.cdxml</TargetFilename>
				<TargetFilename condition="end with">.ps1</TargetFilename>
				<TargetFilename condition="end with">.ps1xml</TargetFilename>
				<TargetFilename condition="end with">.psc1</TargetFilename>
				<TargetFilename condition="end with">.psd1</TargetFilename>
				<TargetFilename condition="end with">.psm1</TargetFilename>
				<TargetFilename condition="end with">.pssc</TargetFilename>
			</Rule>
			<Rule name="Attack=T1059.001,Technique=Command and Scripting Interpreter: PowerShell,Tactic=Execution,DS=File: File Creation,Level=2,Desc=Powershell Creating Files,Risk=10" groupRelation="and">
				<Image condition="contains any">powershell.exe;powershell_ise.exe</Image>
				<TargetFilename condition="excludes">\Recent\CustomDestinations\</TargetFilename>
			</Rule>
			<TargetFilename name="Attack=T1059.001,Technique=Command and Scripting Interpreter: PowerShell,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Powershell directory modifications" condition="begin with">C:\Windows\SysWOW64\WindowsPowerShell</TargetFilename>
			<TargetFilename name="Attack=T1059.001,Technique=Command and Scripting Interpreter: PowerShell,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Powershell directory modifications" condition="begin with">C:\Windows\System32\WindowsPowerShell</TargetFilename>
			<TargetFilename name="Attack=T1059.001,Technique=Command and Scripting Interpreter: PowerShell,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Persistence: PowerShell default profile" condition="begin with">c:\Windows\System32\WindowsPowerShell\v1.0\profile</TargetFilename>
			<TargetFilename name="Attack=T1059.001,Technique=Command and Scripting Interpreter: PowerShell,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Persistence: PowerShell default profile" condition="begin with">c:\Windows\Syswow64\WindowsPowerShell\v1.0\profile</TargetFilename>
			<TargetFilename name="Attack=T1059.001,Technique=Command and Scripting Interpreter: PowerShell,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Execution: Susp ManagedCode Host Process" condition="end with">\UsageLogs\powershell.exe.log</TargetFilename>
			<TargetFilename name="Attack=T1059.001,Technique=Command and Scripting Interpreter: PowerShell,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Powershell Console History" condition="end with">PSReadLine\ConsoleHost_history.txt</TargetFilename>
			<!--MITRE ATT&CK TECHNIQUE: Command and Scripting Interpreter: Javascript-->
			<TargetFilename name="Attack=T1059.007,Technique=Command and Scripting Interpreter: JavaScript,Tactic=Execution,DS=File: File Creation,Level=0,Desc=vbs script created" condition="end with">.vbs</TargetFilename>
			<TargetFilename name="Attack=T1059.007,Technique=Command and Scripting Interpreter: JavaScript,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Java JRE Timestamp usage for DFIR" condition="contains">.oracle_jre_usage\</TargetFilename>
			<TargetFilename name="Attack=T1059.007,Technique=Command and Scripting Interpreter: JavaScript,Tactic=Execution,DS=File: File Creation,Level=0,Desc=JavaScript" condition="end with">.js</TargetFilename>
			<TargetFilename name="Attack=T1059.007,Technique=Command and Scripting Interpreter: JavaScript,Tactic=Execution,DS=File: File Creation,Level=0,Desc=JavaScript" condition="end with">.jse</TargetFilename>
			<TargetFilename name="Attack=T1059.005,Technique=Command and Scripting Interpreter: VisualBasic,Tactic=Execution,DS=File: File Creation,Level=0,Desc=VisualBasicScripting" condition="end with">.vb</TargetFilename>
			<TargetFilename name="Attack=T1059.005,Technique=Command and Scripting Interpreter: VisualBasic,Tactic=Execution,DS=File: File Creation,Level=0,Desc=VisualBasicScripting" condition="end with">.vbe</TargetFilename>
			<TargetFilename name="Attack=T1059.005,Technique=Command and Scripting Interpreter: VisualBasic,Tactic=Execution,DS=File: File Creation,Level=0,Desc=VisualBasicScripting" condition="end with">.vbsript</TargetFilename>
			<!--MITRE ATT&CK TECHNIQUE: Container Administration Command-->
			<!--MITRE ATT&CK TECHNIQUE: Deploy Container-->
			<!--MITRE ATT&CK TECHNIQUE: Exploitation for Client Execution-->
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=File: File Creation,Level=0,Desc=CVE-2019-1315,Risk=70" groupRelation="and">
				<TargetFilename condition="end with">Report.wer.tmp</TargetFilename>
				<TargetFilename condition="excludes">\WER\</TargetFilename>
				<Image condition="image">C:\Windows\system32\wermgr.exe</Image>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Office App Creating Exe File,Risk=70" groupRelation="and">
				<Image condition="contains any">winword.exe;excel.exe;powerpnt.exe;outlook.exe;msaccess.exe;mspub.exe;visio.exe;notepad.exe;wordpad.exe;eqnedt32.exe;wordview.exe</Image>
				<TargetFilename condition="end with">.exe</TargetFilename>
				<TargetFilename condition="begin with">C:\Users</TargetFilename>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Office App Creating DLL File,Risk=70" groupRelation="and">
				<Image condition="contains any">winword.exe;excel.exe;powerpnt.exe;outlook.exe;msaccess.exe;mspub.exe;visio.exe;notepad.exe;wordpad.exe;eqnedt32.exe;wordview.exe</Image>
				<TargetFilename condition="end with">.dll</TargetFilename>
				<TargetFilename condition="begin with">C:\Users</TargetFilename>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Inter-Process Communication-->
			<!--MITRE ATT&CK TECHNIQUE: Native API-->
			<!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
			<!--MITRE ATT&CK TECHNIQUE: Shared Modules-->
			<!--MITRE ATT&CK TECHNIQUE: Software Deployment Tools-->
			<!--MITRE ATT&CK TECHNIQUE: System Services-->
			<!--MITRE ATT&CK TECHNIQUE: User Execution-->
			<!--MITRE ATT&CK TECHNIQUE: User Execution: Malicious File-->
			<Rule name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=Generic Ransomware Detection" groupRelation="and">
				<TargetFilename condition="contains any">!!!-WARNING-!!!.html;!!!-WARNING-!!!.txt;!!! HOW TO DECRYPT FILES !!!;!!!README!!!;!!!READ_TO_UNLOCK!!!.TXT;!!!_READ_ME_;!Recovery_;!Where_are_my_files!.html;!_HOW_TO_RESTORE_;!_RECOVERY_HELP_!.txt;!recover!;# DECRYPT MY FILES #.html;# DECRYPT MY FILES #.txt;# DECRYPT MY FILES #.vbs;# SATAN CRYPTOR #;+recover+;.8lock8;.31392E30362E32303136_;.ABCDEF;.CIop;.CR1;.CRAB;.CRYPTOSHIELD;.Cl0p;.Contact_Here_To_Recover_Your_Files.txt;.CryptoTorLocker2015!;.HERMES;.HakunaMatata;.How_To_Decrypt.txt;.How_To_Get_Back.txt;.KEYZ.KEYH0LES;.L0CKED;.LOL!;.MATRIX;.OMG!;.R.i.P;.RMCM1;.RSplited;.SUPERCRYPT;.SecureCrypted;.TheTrumpLocker;.VBRANSOM;.VforVendetta;.Where_my_files.txt;.XBTL;._AiraCropEncrypted!;.airacropencrypted!;.areyoulovemyrans;.berkshire;.bitpy;.bitx;.blocatto;.bomber;.braincrypt;.breakingbad;.breeding123;.cerber;.cifgksaffsfyghd;.country82000;.crypt;.crypted;.crypton;.cryptotorlocker;.decrypt2017;.deria;.dglnl;.disposed2017;.doomed;.encrypted.locked;.encrypted;.encryptedyourfiles;.enjey;.evillock;.filegofprencrp;.fileiscryptedhard;.firecrypt;.fuckyourdata;.gangbang;.gefickt;.googl;.happydayzz;.hceem;.helpdecrypt;.helpmeencedfiles;.hnumkhotep;.hydracrypt_ID;.iaufkakfhsaraf;.info.txt;.jimm;.kharma;.killedXXX;.lambda_l0cked;.letmetrydecfiles;.locked;.locker16;.loveransisgood;.lovewindows;.magic_software_syndicate;.mention9823;.moments2900;.myrandsext2017;.newlock;.no_more_ransom;.nochance;.noproblemwedecfiles;.notfoundrans;.ohwqg;.one-we_can-help_you;.oops;.osiris;.otherinformation;.paytounlock;.powerfulldecrypt;.powned;.pr0lock;.prolock;.prosperous666;.pwnd;.ransom;.readme2unlock;.righ;.roger;.ryk;.satan;.savethequeen;.sigaint.org;.skjdthghh;.skynet;.snatch;.stubbin;.supported2017;.suppose666;.theworldisyours;.txd0t;.warn_wallet;.weapologize;.weareyourfriends;.weencedufiles;.wowreadfordecryp;.wowwhereismyfiles;.wvtr0;.yourransom;.zzzzz ;.{CRYPTENDBLACKDC};-DECRYPT.txt;000-IF-YOU-WANT-DEC-FILES;000-No-PROBLEM-WE-DEC-FILES;000-PLEASE-READ-WE-HELP;001-READ-FOR-DECRYPT-FILES;1025-7152.exe;:\windows\update_collector.exe;=READ=THIS=PLEASE=;@cock.li;@countermail.com;@firemail.cc;@india.com;@mail.ru;@ukr.net;ASSISTANCE_IN_RECOVERY;ATTENTION!!!.txt;ATTENTION.url;Aescrypt.exe;AllFilesAreLocked;BTC_DECRYPT_FILES;BUYUNLOCKCODE.txt;BUYUNLOCKCODE;BitCryptorFileList.txt;C:\ProgramData\dtb.dat;C:\Programdata\WinMgr;C:\Programdata\clean.bat;C:\Programdata\run.bat;C:\Windows\svchost.exe;CEBER3;CHECK-IT-HELP-FILES;COME_RIPRISTINARE_I_FILE.;COMO_ABRIR_ARQUIVOS.txt;COMO_RESTAURAR_ARCHIVOS;Coin.Locker.txt;Comment débloquer mes fichiers.txt;Como descriptografar seus arquivos.txt;Corona-virus-Map;Corona.bat;Corona.sfx;CryptoRansomware;Crytp0l0cker;Cyber SpLiTTer Vbs.exe;Cyborg_DECRYPT;DALE_FILES.TXT;DECRYPT-FILES;DECRYPTION INSTRUCTIONS.;DECRYPTION_HOWTO.Notepad;DECRYPT_INFORMATION;DECRYPT_INSTRUCTION.HTML;DECRYPT_INSTRUCTION.URL;DECRYPT_INSTRUCTIONS.html;DECRYPT_INSTRUCTIONS;DECRYPT_ReadMe1.TXT;DECRYPT_Readme.TXT.ReadMe;DECRYPT_YOUR_FILES;DESIFROVANI_POKYNY.html;Decrypt All Files;DecryptAllFiles;DecryptFile;Decrypt_readme.txt;DesktopOsiris;ENTSCHLUSSELN_HINWEISE.html;EdgeLocker;FILESAREGONE.txt;FILES_BACK.txt;File Decrypt Help.html;GJENOPPRETTING_AV_FILER;GetYouFiles.txt;HAPPEN-ENCED-FILES;HELLOTHERE.TXT;HELP-ME-ENCED-FILES;HELPDECRYPT_YOUR_FILES.HTML;HELP_DECRYPT.HTML;HELP_DECRYPT.PNG;HELP_DECRYPT.URL;HELP_DECRYPT.lnk;HELP_ME_PLEASE.txt;HELP_RESTORE_FILES_;HELP_TO_SAVE_FILES.bmp;HELP_TO_SAVE_FILES;HELP_YOURFILES.HTML;HELP_YOUR_FILES.PNG;HELP_YOUR_FILES.html;HELP_YOUR_FILES;HOW-TO-DECRYPT-FILES.HTML;HOW-TO-RESTORE-FILES;HOW TO BACK YOUR FILES;HOW TO DECRYPT FILES.HTML;HOW TO DECRYPT FILES.txt;HOW TO RECOVER;HOWTO_RECOVER_FILES_;HOWTO_RESTORE_FILES;HOWTO_RESTORE_FILES_;HOW_DECRYPT.HTML;HOW_DECRYPT.TXT;HOW_DECRYPT.URL;HOW_OPEN_FILES;HOW_TO_DECRYPT.HTML;HOW_TO_DECRYPT_;HOW_TO_PAY_THE_RANSOM;HOW_TO_RESTORE_FILES.html;HOW_TO_RESTORE_FILES;HOW_TO_RESTORE_YOUR_DATA;HOW_TO_UNLOCK_FILES_README_;HWID Lock.exe;Hacked_Read_me_to_decrypt_files.html;Help Decrypt.html;How decrypt files.hta;How to decrypt LeChiffre files.html;How to decrypt your data.txt;HowDecrypt.gif;HowDecrypt.txt;How_to_decrypt_your_files.jpg;How_to_restore_files.hta;HowtoRestore_File;HowtoRestore_Files;Howto_RESTORE_FILES.html;Howto_Restore_FILES.TXT;IAMREADYTOPAY.TXT;IF-YOU-WANT-DEC-FILES;IF_WANT_FILES_BACK_PLS_READ.html;IHAVEYOURSECRET.KEY;IMPORTANT READ ME.txt;IMPORTANT.README;INSTALL_TOR.URL;INSTRUCCIONES;INSTRUCCIONES_DESCIFRADO.html;INSTRUCTION RESTORE FILE;INSTRUCTIONS_DE_DECRYPTAGE.html;INSTUCCIONES_DESCRIFRADO;ISTRUZIONI_DECRITTAZIONE.html;Important!.txt;Instructionaga.txt;KryptoLocker_README.txt;LEER_INMEDIATAMENTE;LET-ME-TRY-DEC-FILES;Locked-by-Mafia;MENSAGEM.txt;MERRY_I_LOVE_YOU_BRUCE.hta;No-PROBLEM-WE-DEC-FILES;OKSOWATHAPPENDTOYOURFILES.TXT;ONTSLEUTELINGS_INSTRUCTIES.html;OSIRIS-;PAYLOADBIN;PINGY@INDIA.COM;PLEASE-READ-WE-HELP.;PLEASE-READIT-IF_YOU-WANT.html;PLEASE-READIT-IF_YOU-WANT;PLEASE-README-AFFECTED-FILES;PLS-DEC-MY-FILES;PURELOCKER;Payment_Instructions.jpg;Please Read Me!!!;READ-FOR-DECCCC-FILESSS;READ-FOR-DECRYPT-FILES;READ-READ-READ;READ IF YOU WANT YOUR FILES BACK.html;READ ME FOR DECRYPT.txt;README HOW TO DECRYPT YOUR FILES.HTML;README!!!;README_DECRYPT_HYDRA_ID_;README_DECRYPT_HYRDA_ID_;README_DECRYPT_UMBRE_ID_;README_DONT_DELETE;README_HOW_TO_UNLOCK.HTML;README_HOW_TO_UNLOCK.TXT;README_RECOVER_FILES_;README_TO_RECURE_YOUR_FILES;READTHISNOW!!!.txt;READ_IT.txt;READ_ME_!.txt;READ_ME_TO_DECRYPT_YOU_INFORMA;READ_THIS_TO_DECRYPT.html;RECOVER-FILES;RECOVERY_FILE.;RECOVERY_FILES.TXT;RECOVER_MY_FILE;RESTORE_CORUPTED_FILES;RESTORE_FILES_;RETURN FILES.txt;RETURN YOUR FILES;RETURNFILES_.txt;RETURN_FILES.txt;RETURN_FILES_.txt;Rans0m_N0te_Read_ME;Read Me (How Decrypt) !!!!.txt;ReadDecryptFilesHere;Read_this_file.txt;Receipt.exe;RecoveryManual.html;Recovery_File_;Recovery_file_;Rooster865qq;SECRET.KEY;SECRETIDHERE.KEY;SHTODELATVAM.txt;SIFRE_COZME_TALIMATI.html;SORRY-FOR-FILES;Survey Locker.exe;TRY-READ-ME-TO-DEC;Temp\satan\satan;ThxForYurTyme;UNLOCK_FILES_INSTRUCTIONS.html;UNLOCK_FILES_INSTRUCTIONS.txt;UnblockFiles.vbs;VIP72.exe;Vape Launcher.exe;WANT_FILES_BACK;WE-MUST-DEC-FILES;WHERE-YOUR-FILES;WORMKILLER@INDIA.COM.XTBL;What happen to my files.txt;Whereisyourfiles;WindowsApplication1.exe;YOUGOTHACKED.TXT;YOUR_FILES.txt;YOUR_FILES.url;YOUR_FILES_ARE_DEAD;YOUR_FILES_ARE_ENCRYPTED.HTML;YOUR_FILES_ARE_ENCRYPTED.TXT;YOUR_FILES_ARE_LOCKED.txt;Your files are locked !!!!.txt;Your files are locked !!!.txt;Your files are locked !!.txt;Your files are locked !.txt;Your files encrypted by our friends !!! txt;Your files encrypted by our friends !!!.txt;[KASISKI];_Adatok_visszaallitasahoz_utasitasok;_DECRYPT_ASSISTANCE_;_DECRYPT_INFO_;_DECRYPT_INFO_szesnl;_DEC_FILES.;_FILES_WERE_ENCRYPTED_@.TXT;_HELP_HELP_HELP_;_HELP_Recover_Files_;_HELP_instructions.bmp;_HELP_instructions.txt;_HOWDO_text.bmp;_HOWDO_text.html;_HOW_TO_Decrypt;_H_e_l_p_RECOVER_INSTRUCTIONS+;_H_e_l_p_RECOVER_INSTRUCTIONS;_Locky_recover;_Locky_recover_instructions.bmp;_Locky_recover_instructions.txt;_README.hta;_README.jpg;_READ_ME!;_RECOVER_INSTRUCTIONS;_ReCoVeRy_+;_USE_TO_FIX_;_WHAT_is.html;_help_instruct;_how_recover.txt;_how_recover;_how_recover_;_recover_;_secret_code.txt;_steaveiwalker@india.com_;aeroware;confirmation.key;contains(to_string($message.file_created), "howrecover+;crjoker.html;cryptinfo.txt;cryptolocker.;cryptopp;de_crypt_readme.;de_crypt_readme.bmp;de_crypt_readme.html;de_crypt_readme.txt;decipher_ne;decrypt-instruct;decrypt explanations.;decrypt my file;decrypt your file;decrypt_Globe;decrypt_instruct;decrypted_files.dat;decryptional;decryptmyfiles;decypt_your_files.html;default32643264.bmp;default432643264.jpg;email-salazar_slytherin10;enc_files.txt;encryptor_raas_readme_liesmich;enigma.hta;enigma_encr.txt;exit.hhr.obleep;fattura_;file0locked;files_are_encrypted.;-filesencrypted;firemail.cc;firstransomware.exe;gmx.de;hacks.at.sigaint.org;help-file-decrypt.enc;help_decrypt;help_file_;help_instructions.;help_my_files;help_recover;help_recover_instructions;help_restore;help_restore_files;help_your_file;helpmeencedfiles;how to decrypt aes files.lnk;how to decrypt;how to get data.txt;how_decrypt.gif;how_recover;how_to_decrypt;how_to_recover;howrecover+ recoveryfile_;howrecover+;howto_recover_file;howto_restore;howtodecrypt;howtodecryptaesfiles.txt;inbox.ru;info@kraken.cc_worldcza@email.cz;install_tor;iran.ir;last_chance.txt;maestro@pizzacrypts.info;maxcrypt.bmp;only-we_can-help_you;openforyou@india.com;opensourcemail.org;padcrypt;paycrypt.bmp;popcorn_time.exe;powerfulldecrypt;protonmail.ch;qbmail.biz;randomname;readme_decrypt;readme_for_decrypt;readme_liesmich_encryptor_raas;recover_file;recover_file_;recover_instruction;recoverfile;recoverfile_;recovery+;recovery_file.txt;recovery_key.txt;recoveryfile;recover}-;restore_files.txt;restorefiles;restorefiles_;ryukreadme.html;tuta.io;tutanota.com;tutanota.de;unCrypte;vault.hta;vault.key;vault.txt;want your files back.;warning-!!;wie_zum_Wiederherstellen_von_Dateien.txt;wowreadfordecryp;wowwhereismyfiles;zXz.html;zycrypt.;zzzzzzzzzzzzzzzzzyyy</TargetFilename>
				<TargetFilename condition="excludes all">C:\Users\;\Google\Chrome Beta\User Data\;\IndexedDB\</TargetFilename>
				<TargetFilename condition="excludes any">C:\Program Files\WindowsApps\Microsoft.YourPhone_;C:\Program Files\dotnet\shared\Microsoft.NETCore.App\;\Microsoft.NET\assembly\GAC_MSIL</TargetFilename>
			</Rule>
			<TargetFilename name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=Common Files of CrackMapExec,Risk=100" condition="contains">crackmapexec</TargetFilename>
			<TargetFilename name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=Common Files of CrackMapExec,Risk=100" condition="end with">\Crypto.Cipher._AES.pyd</TargetFilename>
			<TargetFilename name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=Common Files of CrackMapExec,Risk=100" condition="end with">\Crypto.Cipher._DES.pyd</TargetFilename>
			<TargetFilename name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=Common Files of CrackMapExec,Risk=100" condition="end with">\Crypto.Hash._SHA256.pyd</TargetFilename>
			<TargetFilename name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=Common Files of CrackMapExec,Risk=100" condition="end with">\Crypto.Random.OSRNG.winrandom.pyd</TargetFilename>
			<TargetFilename name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=Common Files of CrackMapExec,Risk=100" condition="end with">\Crypto.Util.strxor.pyd</TargetFilename>
			<TargetFilename name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=Common Files of CrackMapExec,Risk=100" condition="end with">\crackmapexec.exe.manifest</TargetFilename>
			<TargetFilename name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=Common Files of CrackMapExec,Risk=100" condition="end with">\greenlet.pyd</TargetFilename>
			<TargetFilename name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=KeeFarce.exe default injected DLL name,Risk=100" condition="end with">BootStrapDLL.dll</TargetFilename>
			<TargetFilename name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=MegaCortex Ransomware,Risk=100" condition="begin with">C:\windows\temp\wininit.exe</TargetFilename>
			<TargetFilename name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=Mimikatz Files" condition="contains any">lazycat;powerkatz;mimikatz;mimidrv;mimilove;mimilib;mimikittenz;mimiauth;invoke-mimi</TargetFilename>
			<TargetFilename name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=RDP Wrapper,Risk=100" condition="end with">rdpwrap.dll</TargetFilename>
			<TargetFilename name="Attack=T1204.002,Technique=Malicious File,Tactic=Execution,DS=File: File Creation,Level=4,Alert=winspool.drv dropped" condition="end with">winspool.drv</TargetFilename>
			<!--MITRE ATT&CK TECHNIQUE: Windows Management Instrumentation-->
			<TargetFilename name="Attack=T1047,Technique=Windows Management Instrumentation,Tactic=Execution,DS=File: File Creation" condition="begin with">C:\Windows\System32\Wbem</TargetFilename>
			<TargetFilename name="Attack=T1047,Technique=Windows Management Instrumentation,Tactic=Execution,DS=File: File Creation" condition="begin with">C:\Windows\SysWOW64\Wbem</TargetFilename>
			<Image name="Attack=T1047,Technique=Windows Management Instrumentation,Tactic=Execution,DS=File: File Creation" condition="begin with">C:\WINDOWS\system32\wbem\scrcons.exe</Image>
			<!--MITRE ATT&CK TACTIC: Persistence-->
			<!--MITRE ATT&CK TECHNIQUE: Account Manipulation-->
			<!--MITRE ATT&CK TECHNIQUE: BITS Jobs-->
			<!--MITRE ATT&CK TECHNIQUE: Boot or Logon Autostart Execution-->
			<TargetFilename name="Attack=T1547.001,Technique=Registry Startup Folder,Tactic=Persistence,DS=File: File Creation,Level=3,Alert=Autorun Folder Entries" condition="contains">\Programs\Startup\</TargetFilename>
			<TargetFilename name="Attack=T1547.001,Technique=Registry Startup Folder,Tactic=Persistence,DS=File: File Creation,Level=3,Alert=Autorun Folder Entries" condition="contains">\Startup\</TargetFilename>
			<!--MITRE ATT&CK TECHNIQUE: Boot or Logon Initialization Scripts-->
			<!--MITRE ATT&CK TECHNIQUE: Browser Extensions-->
			<!--MITRE ATT&CK TECHNIQUE: Compromise Client Software Binary-->
			<!--MITRE ATT&CK TECHNIQUE: Create Account-->
			<!--MITRE ATT&CK TECHNIQUE: Create or Modify System Process-->
			<!--MITRE ATT&CK TECHNIQUE: Event Triggered Execution-->
			<!--MITRE ATT&CK TECHNIQUE: External Remote Services-->
			<!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
			<!--MITRE ATT&CK TECHNIQUE: Implant Internal Image-->
			<!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
			<!--MITRE ATT&CK TECHNIQUE: Office Application Startup-->
			<TargetFilename name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=File: File Creation,Level=0,Desc=Office Application Startup modification" condition="contains">\Word\STARTUP\</TargetFilename>
			<TargetFilename name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=File: File Creation,Level=0,Desc=Office Application Startup modification" condition="contains">\Microsoft\Templates\</TargetFilename>
			<TargetFilename name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=File: File Creation,Level=0,Desc=Office Application Startup modification" condition="contains">\Excel\XLSTART\</TargetFilename>
			<TargetFilename name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=File: File Creation" condition="end with">.dotm</TargetFilename>
			<TargetFilename name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=File: File Creation" condition="end with">.XLSB</TargetFilename>
			<!--MITRE ATT&CK TECHNIQUE: Pre-OS Boot-->
			<!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Scheduled Task Modified" condition="begin with">C:\Windows\Tasks\</TargetFilename>
			<!--MITRE ATT&CK TECHNIQUE: Server Software Component-->
			<Rule name="Attack=T1505.003,Technique=Server Software Component: Web Shell,Tactic=Persistence,DS=File: File Creation,Level=3,Alert=Exchange 0day from September 2022 overwriting legit file,Risk=80" groupRelation="and">
				<TargetFilename condition="end with">RedirSuiteServiceProxy.aspx</TargetFilename>
			</Rule>
			<Rule name="Attack=T1505.003,Technique=Server Software Component: Web Shell,Tactic=Persistence,DS=File: File Creation,Level=3,Alert=Web Shells Dropped 1,Risk=80" groupRelation="and">
				<Image condition="image">w3wp.exe</Image>
				<TargetFilename condition="end with">.aspx</TargetFilename>
			</Rule>
			<Rule name="Attack=T1505.003,Technique=Server Software Component: Web Shell,Tactic=Persistence,DS=File: File Creation,Level=3,Alert=Web Shells Dropped 2,Risk=80" groupRelation="and">
				<Image condition="image">w3wp.exe</Image>
				<TargetFilename condition="end with">.asp</TargetFilename>
			</Rule>
			<Rule name="Attack=T1505.003,Technique=Server Software Component: Web Shell,Tactic=Persistence,DS=File: File Creation,Level=3,Alert=Web Shells Dropped 3,Risk=80" groupRelation="and">
				<Image condition="image">w3wp.exe</Image>
				<TargetFilename condition="end with">.ashx</TargetFilename>
			</Rule>
			<Rule name="Attack=T1505.003,Technique=Server Software Component: Web Shell,Tactic=Persistence,DS=File: File Creation,Level=0,Alert=Web Shells Dropped 4,Risk=80" groupRelation="and">
				<Image condition="image">w3wp.exe</Image>
				<TargetFilename condition="end with">.php</TargetFilename>
			</Rule>
			<Rule name="Attack=T1505.003,Technique=Server Software Component: Web Shell,Tactic=Persistence,DS=File: File Creation,Level=0,Alert=Web Shells Dropped 5,Risk=80" groupRelation="and">
				<Image condition="image">w3wp.exe</Image>
				<TargetFilename condition="end with">.aaa</TargetFilename>
			</Rule>
			<Rule name="Attack=T1505.003,Technique=Server Software Component: Web Shell,Tactic=Persistence,DS=File: File Creation,Level=3,Alert=Web Shells Dropped 6,Risk=100" groupRelation="and">
				<TargetFilename condition="contains any">\wwwroot\aspnet_client\;\FrontEnd\HttpProxy\owa\auth</TargetFilename>
				<TargetFilename condition="contains any">.aspx;.php;.ashx</TargetFilename>
			</Rule>
			<Rule name="Attack=T1190,Technique=Server Software Component: Web Shell,Tactic=Persistence,DS=File: File Creation,Level=3,Alert=IIS Dropping Ps1 file,Risk=100" groupRelation="and">
				<Image condition="image">w3wp.exe</Image>
				<TargetFilename condition="end with">.ps1</TargetFilename>
			</Rule>
			<Rule name="Attack=T1505.003,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=File: File Creation,Level=3,Alert=IIS Dropping Bat file,Risk=100" groupRelation="and">
				<Image condition="image">w3wp.exe</Image>
				<TargetFilename condition="end with">.bat</TargetFilename>
			</Rule>
			<Rule name="Attack=T1505.003,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=File: File Creation,Level=3,Alert=IIS Dropping DLL file,Risk=100" groupRelation="and">
				<Image condition="image">w3wp.exe</Image>
				<TargetFilename condition="end with">.dll</TargetFilename>
			</Rule>
			<Rule name="Attack=T1505.003,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=File: File Creation,Level=3,Alert=IIS Dropping VBS file,Risk=100" groupRelation="and">
				<Image condition="image">w3wp.exe</Image>
				<TargetFilename condition="end with">.vbs</TargetFilename>
			</Rule>
			<Rule name="Attack=T1505.003,Technique=Exploit Public-Facing Application,Tactic=Initial Access,DS=File: File Creation,Level=3,Alert=IIS Dropping HTA file,Risk=100" groupRelation="and">
				<Image condition="image">w3wp.exe</Image>
				<TargetFilename condition="end with">.hta</TargetFilename>
			</Rule>
			<Rule name="Attack=T1505.003,Technique=Server Software Component: Web Shell,Tactic=Persistence,DS=File: File Creation,Level=0,Desc=Files dropped in wwwroot directory,Risk=40" groupRelation="and">
				<TargetFilename condition="contains any">\wwwroot\</TargetFilename>
				<TargetFilename condition="excludes any">\wwwroot\aspnet_client\;jpg</TargetFilename>
			</Rule>
			<Rule name="Attack=T1505.003,Technique=Server Software Component: Web Shell,Tactic=Persistence,DS=File: File Creation,Level=0,Desc=ASP Files dropped outside wwwroot directory" groupRelation="and">
				<TargetFilename condition="end with">.asp</TargetFilename>
				<TargetFilename condition="excludes any">\wwwroot\</TargetFilename>
			</Rule>
			<Rule name="Attack=T1505.003,Technique=Server Software Component: Web Shell,Tactic=Persistence,DS=File: File Creation,Level=0,Desc=ASPX Files dropped outside wwwroot directory" groupRelation="and">
				<TargetFilename condition="end with">.aspx</TargetFilename>
				<TargetFilename condition="excludes any">\wwwroot\</TargetFilename>
			</Rule>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Files dropped in Exchange ECP directory,Risk=80" condition="contains">\ecp\auth\</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Files dropped in Exchange OAB directory,Risk=80" condition="contains">\oab\auth\</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Files dropped in Exchange OWA directory,Risk=80" condition="contains">ClientAccess\Owa\</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Files dropped in Exchange OWA directory,Risk=80" condition="contains">\owa\auth\</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Files dropped in Exchange RPC directory,Risk=80" condition="contains">httpproxy\rpc\</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Files dropped in Exchange ecp directory,Risk=80" condition="contains">ClientAccess\ecp\</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Files dropped in wwwroot htdocs directory" condition="contains">\htdocs\</TargetFilename>
			<!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
			<!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->

			<!--MITRE ATT&CK TACTIC: Privilege Escalation-->
			<!--MITRE ATT&CK TECHNIQUE: Abuse Elevation Control Mechanism-->
			<!--MITRE ATT&CK TECHNIQUE: Access Token Manipulation-->
			<!--MITRE ATT&CK TECHNIQUE: Boot or Logon Autostart Execution-->
			<!--MITRE ATT&CK TECHNIQUE: Boot or Logon Initialization Scripts-->
			<!--MITRE ATT&CK TECHNIQUE: Create or Modify System Process-->
			<!--MITRE ATT&CK TECHNIQUE: Domain Policy Modification-->
			<!--MITRE ATT&CK TECHNIQUE: Escape to Host-->
			<!--MITRE ATT&CK TECHNIQUE: Event Triggered Execution-->
			<!--MITRE ATT&CK TECHNIQUE: Exploitation for Privilege Escalation-->
			<Rule name="Attack=T1068,Technique=Exploitation for Privilege Escalation,Tactic=Privilege Escalation,DS=File: File Creation,Level=0,Desc=Printer Exploitation Detected,Risk=20" groupRelation="and">
				<TargetFilename condition="end with">.SPL</TargetFilename>
				<Image condition="excludes any">spoolsv.exe;printfilterpipelinesvc.exe;printisolationhost.exe;splwow64.exe;msiexec.exe;poqexec.exe</Image>
			</Rule>
			<Rule name="Attack=T1068,Technique=Exploitation for Privilege Escalation,Tactic=Privilege Escalation,DS=File: File Creation,Level=0,Desc=Printer Spooler Created exe file,Risk=40" groupRelation="and">
				<Image condition="image">spoolsv.exe</Image>
				<TargetFilename condition="end with">.exe</TargetFilename>
				<TargetFilename condition="excludes">C\:\Windows\System32\spool\;C\:\Windows\Temp\;C\:\Users\</TargetFilename>
			</Rule>
			<Rule name="Attack=T1068,Technique=Exploitation for Privilege Escalation,Tactic=Privilege Escalation,DS=File: File Creation,Level=0,Desc=InstallerFileTakeOver,Risk=80,CVE=CVE-2021-41379" groupRelation="and">
				<Image condition="image">msiexec.exe</Image>
				<TargetFilename condition="contains">\Microsoft\Edge\Application</TargetFilename>
				<TargetFilename condition="end with">elevation_service.exe</TargetFilename>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
			<!--MITRE ATT&CK TECHNIQUE: Process Injection-->
			<!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
			<!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->

			<!--MITRE ATT&CK TACTIC: Defense Evasion-->
			<!--MITRE ATT&CK TECHNIQUE: Abuse Elevation Control Mechanism-->
			<!--MITRE ATT&CK TECHNIQUE: Access Token Manipulation-->
			<!--MITRE ATT&CK TECHNIQUE: BITS Jobs-->
			<!--MITRE ATT&CK TECHNIQUE: Build Image on Host-->
			<!--MITRE ATT&CK TECHNIQUE: Debugger Evasion-->
			<!--MITRE ATT&CK TECHNIQUE: Deobfuscate/Decode Files or Information-->
			<!--MITRE ATT&CK TECHNIQUE: Deploy Container-->
			<!--MITRE ATT&CK TECHNIQUE: Direct Volume Access-->
			<!--MITRE ATT&CK TECHNIQUE: Domain Policy Modification-->
			<!--MITRE ATT&CK TECHNIQUE: Execution Guardrails-->
			<!--MITRE ATT&CK TECHNIQUE: Exploitation for Defense Evasion-->
			<!--MITRE ATT&CK TECHNIQUE: File and Directory Permissions Modification-->
			<!--MITRE ATT&CK TECHNIQUE: Hide Artifacts-->
			<!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
			<!--MITRE ATT&CK TECHNIQUE: Impair Defenses-->
			<!--MITRE ATT&CK TECHNIQUE: Indicator Removal on Host-->
			<!--MITRE ATT&CK TECHNIQUE: Indirect Command Execution-->
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=WSL Locations" condition="contains">\LocalState\rootfs\</TargetFilename>

			<!--MITRE ATT&CK TECHNIQUE: Masquerading-->
			<Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,Risk=20,DS=File: File Creation,Level=0,Desc=Monitor Common Masquarading Locations" groupRelation="or">
				<TargetFilename condition="begin with">C:\PerfLogs\</TargetFilename> 
				<TargetFilename condition="begin with">C:\Temp\</TargetFilename> 
				<TargetFilename condition="begin with">C:\Users\Default\</TargetFilename> 
				<TargetFilename condition="begin with">C:\Users\Public\</TargetFilename> 
				<TargetFilename condition="begin with">C:\Windows\Temp\</TargetFilename> 
				<TargetFilename condition="contains">\AppData\Temp\</TargetFilename>
			</Rule>
			<TargetFilename condition="contains" name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Recycle bin files created">$Recycle.Bin</TargetFilename>
			<Image condition="contains" name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Files Created from">$Recycle.Bin</Image>
			<Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,Risk=20,DS=File: File Creation,Level=0,Desc=Files Created within System Profile" groupRelation="and">
				<TargetFilename condition="begin with">C:\Windows\</TargetFilename>
				<TargetFilename condition="contains">\config\systemprofile\</TargetFilename>
			</Rule>
			<Rule name="Attack=T1036,Technique=Masquerading,Tactic=Defense Evasion,Risk=20,DS=File: File Creation,Level=0,Desc=Files Created from System Profile executable" groupRelation="and">
				<Image condition="begin with">C:\Windows\</Image>
				<Image condition="contains">\config\systemprofile\</Image>
			</Rule>
			<Rule name="Attack=T1036.007,Technique=Masquerading: Double File Extension,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Alert=Block double extensions" groupRelation="or">
				<TargetFilename condition="end with">      .exe</TargetFilename>
				<TargetFilename condition="end with">.7z.exe</TargetFilename>
				<TargetFilename condition="end with">.doc.exe</TargetFilename>
				<TargetFilename condition="end with">.doc.exe</TargetFilename>
				<TargetFilename condition="end with">.docx.exe</TargetFilename>
				<TargetFilename condition="end with">.ico.exe</TargetFilename>
				<TargetFilename condition="end with">.iso.exe</TargetFilename>
				<TargetFilename condition="end with">.lnk.exe</TargetFilename>
				<TargetFilename condition="end with">.pdf.exe</TargetFilename>
				<TargetFilename condition="end with">.ppt.exe</TargetFilename>
				<TargetFilename condition="end with">.pptx.exe</TargetFilename>
				<TargetFilename condition="end with">.rar.exe</TargetFilename>
				<TargetFilename condition="end with">.rtf.exe</TargetFilename>
				<TargetFilename condition="end with">.txt.exe</TargetFilename>
				<TargetFilename condition="end with">.xls.exe</TargetFilename>
				<TargetFilename condition="end with">.xlsx.exe</TargetFilename>
				<TargetFilename condition="end with">.zip.exe</TargetFilename>
				<TargetFilename condition="end with">______.exe</TargetFilename>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
			<!--MITRE ATT&CK TECHNIQUE: Modify Cloud Compute Infrastructure-->
			<!--MITRE ATT&CK TECHNIQUE: Modify Registry-->
			<!--MITRE ATT&CK TECHNIQUE: Modify System Image-->
			<!--MITRE ATT&CK TECHNIQUE: Network Boundary Bridging-->
			<!--MITRE ATT&CK TECHNIQUE: Obfuscated Files or Information-->
			<!--MITRE ATT&CK TECHNIQUE: Plist File Modification-->
			<!--MITRE ATT&CK TECHNIQUE: Pre-OS Boot-->
			<!--MITRE ATT&CK TECHNIQUE: Process Injection-->
			<!--MITRE ATT&CK TECHNIQUE: Reflective Code Loading-->
			<!--MITRE ATT&CK TECHNIQUE: Rogue Domain Controller-->
			<!--MITRE ATT&CK TECHNIQUE: Rootkit-->
			<!--MITRE ATT&CK TECHNIQUE: Subvert Trust Controls-->
			<!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution-->
			<!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Compiled HTML File-->
			<TargetFilename name="Attack=T1223,Technique=Compiled HTML File,Tactic=Defense Evasion,DS=File: File Creation" condition="end with">.chm</TargetFilename>
			<!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Regsvr32-->
			<!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: MsiExec-->
			<!--MITRE ATT&CK TECHNIQUE: System Script Proxy Execution-->
			<!--MITRE ATT&CK TECHNIQUE: Template Injection-->
			<!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
			<!--MITRE ATT&CK TECHNIQUE: Trusted Developer Utilities Proxy Execution-->
			<TargetFilename name="Attack=T1127,Technique=Trusted Developer Utilities Proxy Execution,Tactic=Defense Evasion,DS=File: File Creation" condition="end with">proj</TargetFilename>
			<TargetFilename name="Attack=T1127,Technique=Trusted Developer Utilities Proxy Execution,Tactic=Defense Evasion,DS=File: File Creation" condition="end with">.sln</TargetFilename>
			<!--MITRE ATT&CK TECHNIQUE: Unused/Unsupported Cloud Regions-->
			<!--MITRE ATT&CK TECHNIQUE: Use Alternate Authentication Material-->
			<!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->
			<!--MITRE ATT&CK TECHNIQUE: Virtualization/Sandbox Evasion-->
			<!--MITRE ATT&CK TECHNIQUE: Weaken Encryption-->
			<!--MITRE ATT&CK TECHNIQUE: XSL Script Processing-->

			<!--MITRE ATT&CK TACTIC: Credential Access-->
			<!--MITRE ATT&CK TECHNIQUE: Adversary-in-the-Middle-->
			<!--MITRE ATT&CK TECHNIQUE: Brute Force-->
			<!--MITRE ATT&CK TECHNIQUE: Credentials from Password Stores-->
			<!--MITRE ATT&CK TECHNIQUE: Exploitation for Credential Access-->
			<!--MITRE ATT&CK TECHNIQUE: Forced Authentication-->
			<!--MITRE ATT&CK TECHNIQUE: Forge Web Credentials-->
			<!--MITRE ATT&CK TECHNIQUE: Input Capture-->
			<!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
			<!--MITRE ATT&CK TECHNIQUE: Multi-Factor Authentication Interception-->
			<!--MITRE ATT&CK TECHNIQUE: Multi-Factor Authentication Request Generation-->
			<!--MITRE ATT&CK TECHNIQUE: Network Sniffing-->
			<!--MITRE ATT&CK TECHNIQUE: OS Credential Dumping-->
			<!--MITRE ATT&CK TECHNIQUE: Steal Application Access Token-->
			<!--MITRE ATT&CK TECHNIQUE: Steal or Forge Kerberos Tickets-->
			<!--MITRE ATT&CK TECHNIQUE: Steal Web Session Cookie-->
			<!--MITRE ATT&CK TECHNIQUE: Unsecured Credentials-->

			<!--MITRE ATT&CK TACTIC: Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Account Discovery -->
			<!--MITRE ATT&CK TECHNIQUE: Application Window Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Browser Bookmark Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Cloud Infrastructure Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Cloud Service Dashboard-->
			<!--MITRE ATT&CK TECHNIQUE: Cloud Service Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Cloud Storage Object Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Container and Resource Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Debugger Evasion-->
			<!--MITRE ATT&CK TECHNIQUE: Domain Trust Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: File and Directory Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Group Policy Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Network Service Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Network Share Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Network Sniffing-->
			<!--MITRE ATT&CK TECHNIQUE: Password Policy Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Peripheral Device Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Permission Groups Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Process Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Query Registry-->
			<!--MITRE ATT&CK TECHNIQUE: Remote System Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Software Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: System Information Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: System Location Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: System Network Configuration Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: System Network Connections Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: System Owner/User Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: System Service Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: System Time Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Virtualization/Sandbox Evasion-->

			<!--MITRE ATT&CK TACTIC: Lateral Movement-->
			<!--MITRE ATT&CK TECHNIQUE: Exploitation of Remote Services-->
			<Rule name="Attack=T1203,Technique=Exploitation of Remote Services,Tactic=Lateral Movement,DS=File: File Creation,Level=4,Alert=Exchange Exploitation UM Service File Creation,Risk=80,CVE=CVE-2021-26858" groupRelation="and">
				<Image condition="contains any">UMWorkerProcess.exe;UMService.exe</Image>
				<TargetFilename condition="contains any">.</TargetFilename>
				<TargetFilename condition="excludes any">.log;.cfg;.txt;cleanup;.HealthCheck;\wp.active;.db</TargetFilename>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Internal Spearphishing-->
			<!--MITRE ATT&CK TECHNIQUE: Lateral Tool Transfer-->
			<!--MITRE ATT&CK TECHNIQUE: Remote Service Session Hijacking-->
			<!--MITRE ATT&CK TECHNIQUE: Remote Services-->
			<!--MITRE ATT&CK TECHNIQUE: Replication Through Removable Media-->
			<!--MITRE ATT&CK TECHNIQUE: Software Deployment Tools-->
			<!--MITRE ATT&CK TECHNIQUE: Taint Shared Content-->
			<!--MITRE ATT&CK TECHNIQUE: Use Alternate Authentication Material-->

			<!--MITRE ATT&CK TACTIC: Collection-->
			<!--MITRE ATT&CK TECHNIQUE: Adversary-in-the-Middle-->
			<!--MITRE ATT&CK TECHNIQUE: Archive Collected Data-->
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=7zip Archive" condition="end with">.7z</TargetFilename>
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=7zip Archive" condition="end with">.7zip</TargetFilename>
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=7zip Archive" condition="end with">.arj</TargetFilename>
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=7zip Archive" condition="end with">.s7z</TargetFilename>
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=.A Archive" condition="end with">.a</TargetFilename>
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=ACE Archive" condition="end with">.ace</TargetFilename>
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=AR Archive" condition="end with">.ar</TargetFilename>
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=ARC Archive" condition="end with">.arc</TargetFilename>
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=BIN" condition="end with">.bin</TargetFilename>
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=CAB Archive" condition="end with">.cab</TargetFilename>
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=Game PAK Archive" condition="end with">.pak</TargetFilename>
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=Gzip Archive" condition="end with">.gz</TargetFilename>
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=IMG Archive" condition="end with">.img</TargetFilename>
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=ISO Archive" condition="end with">.iso</TargetFilename>
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=LZM Archive" condition="end with">.lzm</TargetFilename>
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=LZMA Archive" condition="end with">.lzma</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=RAR Archive Extraction" condition="contains">Temp\Rar$</TargetFilename>
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=RAR Archive" condition="end with">.rar</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=RAR SFX Archive Extraction" condition="contains">RarSFX</TargetFilename>
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=SFX Archive" condition="end with">.sfx</TargetFilename>
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=SZ Archive" condition="end with">.sz</TargetFilename>
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=TAR Archive" condition="end with">.tar</TargetFilename>
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=TAR.GZ Archive" condition="end with">.tar.gz</TargetFilename>
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=TAR.GZ Archive" condition="end with">.tgz</TargetFilename>
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=XZ Archive" condition="end with">.xz</TargetFilename>
			<TargetFilename name="Attack=T1560,Technique=Archive Collected Data,Tactic=Collection,DS=File: File Creation,Level=0,Desc=ZIP Archive" condition="end with">.zip</TargetFilename>
			<!--MITRE ATT&CK TECHNIQUE: Audio Capture-->
			<!--MITRE ATT&CK TECHNIQUE: Automated Collection-->
			<!--MITRE ATT&CK TECHNIQUE: Browser Session Hijacking-->
			<!--MITRE ATT&CK TECHNIQUE: Clipboard Data-->
			<!--MITRE ATT&CK TECHNIQUE: Data from Cloud Storage Object-->
			<!--MITRE ATT&CK TECHNIQUE: Data from Configuration Repository-->
			<!--MITRE ATT&CK TECHNIQUE: Data from Information Repositories-->
			<!--MITRE ATT&CK TECHNIQUE: Data from Local System-->
			<!--MITRE ATT&CK TECHNIQUE: Data from Network Shared Drive-->
			<!--MITRE ATT&CK TECHNIQUE: Data from Removable Media-->
			<!--MITRE ATT&CK TECHNIQUE: Data Staged-->
			<!--MITRE ATT&CK TECHNIQUE: Email Collection-->
			<TargetFilename name="Attack=T1114,Technique=Email Collection,Tactic=Collection,DS=File: File Creation,Level=0,Desc=Possible Email Collection/Exfiltration: .OST Created,Risk=30" condition="end with">.ost</TargetFilename>
			<TargetFilename name="Attack=T1114,Technique=Email Collection,Tactic=Collection,DS=File: File Creation,Level=0,Desc=Possible Email Collection/Exfiltration: .PST Created,Risk=30" condition="end with">.eml</TargetFilename>
			<TargetFilename name="Attack=T1114,Technique=Email Collection,Tactic=Collection,DS=File: File Creation,Level=0,Desc=Possible Email Collection/Exfiltration: .PST Created,Risk=30" condition="end with">.msg</TargetFilename>
			<TargetFilename name="Attack=T1114,Technique=Email Collection,Tactic=Collection,DS=File: File Creation,Level=0,Desc=Possible Email Collection/Exfiltration: .PST Created,Risk=30" condition="end with">.pst</TargetFilename>
			<!--MITRE ATT&CK TECHNIQUE: Input Capture-->
			<!--MITRE ATT&CK TECHNIQUE: Screen Capture-->
			<!--MITRE ATT&CK TECHNIQUE: Video Capture-->

			<!--MITRE ATT&CK TACTIC: Command and Control-->
			<!--MITRE ATT&CK TECHNIQUE: Application Layer Protocol-->
			<!--MITRE ATT&CK TECHNIQUE: Communication Through Removable Media-->
			<!--MITRE ATT&CK TECHNIQUE: Data Encoding-->
			<Rule name="Attack=T1132,Technique=Data Encoding,Tactic=Command and Control,DS=File: File Creation,Level=4,Alert=Cyrillic Letter obfuscation,Risk=100" groupRelation="and">
				<TargetFilename condition="contains any">Г;И;К;П;д;и;к;л;л;н;н;о;ф;ե;թ;յ;ն;ն;ն;ն;տ;ւ;ք</TargetFilename>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Data Obfuscation-->
			<!--MITRE ATT&CK TECHNIQUE: Dynamic Resolution-->
			<!--MITRE ATT&CK TECHNIQUE: Encrypted Channel-->
			<!--MITRE ATT&CK TECHNIQUE: Fallback Channels-->
			<!--MITRE ATT&CK TECHNIQUE: Ingress Tool Transfer-->
			<Image name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=File: File Creation,Level=0,Desc=File Created by Teamviewer" condition="image">Teamviewer.exe</Image>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Created by rundll32" condition="image">rundll32.exe</Image>
			<Image name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=File: File Creation,Level=0,Desc=File Created with Remote Desktop Client" condition="image">mstsc.exe</Image>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Created with command shell,Risk=30" condition="image">cmd.exe</Image>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Dropped with IronPython.exe,Risk=50" condition="image">ipy.exe</Image>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Dropped with WScript.exe,Risk=30" condition="image">WScript.exe</Image>
			<Image name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=File: File Creation,Level=0,Desc=File Dropped with cscript.exe,Risk=30" condition="image">cscript.exe</Image>
			<Image name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=File: File Creation,Level=0,Desc=File Dropped with mshta.exe,Risk=100" condition="image">mshta.exe</Image>
			<Image name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=File: File Creation,Level=0,Desc=File Dropped with python.exe,Risk=30" condition="image">python.exe</Image>
			<Image name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=File: File Creation,Level=0,Desc=File Dropped with wmic.exe,Risk=30" condition="image">wmic.exe</Image>
			<Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=File: File Creation,Level=3,Alert=Suspicious Image loaded within Default or Public Directory,Risk=40" groupRelation="and">
				<TargetFilename condition="contains any">C:\Users\Default\;C:\Users\Public\</TargetFilename>
				<TargetFilename condition="end with">.dll</TargetFilename>
			</Rule>
			<Rule name="Attack=T1105,Technique=Ingress Tool Transfer,Tactic=Command and Control,DS=File: File Creation,Level=3,Alert=Suspicious Image loaded within Default or Public Directory,Risk=40" groupRelation="and">
				<TargetFilename condition="contains any">C:\Users\Default\;C:\Users\Public\</TargetFilename>
				<TargetFilename condition="end with">.exe</TargetFilename>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Multi-Stage Channels-->
			<!--MITRE ATT&CK TECHNIQUE: Non-Application Layer Protocol-->
			<!--MITRE ATT&CK TECHNIQUE: Non-Standard Port-->
			<!--MITRE ATT&CK TECHNIQUE: Protocol Tunneling-->
			<!--MITRE ATT&CK TECHNIQUE: Proxy-->
			<!--MITRE ATT&CK TECHNIQUE: Proxy: Multi-hop Proxy-->
			<TargetFilename name="Attack=T1090.003,Tactic=Command and Control,Technique=Multi-hop Proxy,DS=File: File Creation,Level=4,Alert=Potential Tor Hidden Service,Risk=100" condition="contains">HiddenService</TargetFilename>
			<TargetFilename name="Attack=T1090.003,Tactic=Command and Control,Technique=Multi-hop Proxy,DS=File: File Creation,Level=4,Alert=Potential Tor Files,Risk=100" condition="end with">torrc</TargetFilename> 
			<TargetFilename name="Attack=T1090.003,Tactic=Command and Control,Technique=Multi-hop Proxy,DS=File: File Creation,Level=4,Alert=Potential Tor Files,Risk=100" condition="contains">\tor.exe</TargetFilename> 
			<TargetFilename name="Attack=T1090.003,Tactic=Command and Control,Technique=Multi-hop Proxy,DS=File: File Creation,Level=4,Alert=Potential Tor Files,Risk=100" condition="contains">tor-gencert</TargetFilename> 
			<!--MITRE ATT&CK TECHNIQUE: Remote Access Software-->
			<!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
			<!--MITRE ATT&CK TECHNIQUE: Web Service-->

			<!--MITRE ATT&CK TACTIC: Exfiltration-->

			<!--MITRE ATT&CK TECHNIQUE: Automated Exfiltration-->
			<!--MITRE ATT&CK TECHNIQUE: Data Transfer Size Limits-->
			<!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Alternative Protocol-->
			<!--MITRE ATT&CK TECHNIQUE: Exfiltration Over C2 Channel-->
			<!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Other Network Medium-->
			<!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Physical Medium-->
			<!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Web Service-->
			<!--MITRE ATT&CK TECHNIQUE: Scheduled Transfer-->
			<!--MITRE ATT&CK TECHNIQUE: Transfer Data to Cloud Account-->
			<TargetFilename name="Attack=T1114,Technique=Email Collection,Tactic=Collection,DS=File: File Creation,Level=4,Alert=Possible rclone Exfiltration,Risk=30" condition="contains">rclone</TargetFilename>
			<TargetFilename name="Attack=T1114,Technique=Email Collection,Tactic=Collection,DS=File: File Creation,Level=4,Alert=Possible s3browser Exfiltration,Risk=30" condition="contains">s3browser</TargetFilename>
			<TargetFilename name="Attack=T1114,Technique=Email Collection,Tactic=Collection,DS=File: File Creation,Level=4,Alert=Browser Credential exfiltration,Risk=30" condition="contains">grabff.exe</TargetFilename>
			<TargetFilename name="Attack=T1114,Technique=Email Collection,Tactic=Collection,DS=File: File Creation,Level=4,Alert=Browser Credential exfiltration,Risk=30" condition="contains">grabff.exe</TargetFilename>
			<!--MITRE ATT&CK TACTIC: Impact-->
			<!--MITRE ATT&CK TECHNIQUE: Account Access Removal-->
			<!--MITRE ATT&CK TECHNIQUE: Data Destruction-->
			<!--MITRE ATT&CK TECHNIQUE: Data Encrypted for Impact-->
			<Rule name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=File: File Creation,Level=4,Alert=Snatch Ransomware Detected,Risk=100" groupRelation="and">
				<TargetFilename condition="contains all">RESTORE_;_FILES.txt</TargetFilename>
			</Rule>
			<Rule name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=File: File Creation,Level=4,Alert=Snatch2 Ransomware Detected,Risk=100" groupRelation="and">
				<TargetFilename condition="contains all">DECRYPT_;_FILES.txt</TargetFilename>
			</Rule>
			<Rule name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=File: File Creation,Level=4,Alert=Nanocore Detected,Risk=100" groupRelation="and">
				<TargetFilename condition="contains any">\run.dat;\task.dat;\storage.dat</TargetFilename>
				<TargetFilename condition="contains">AppData</TargetFilename>
				<TargetFilename condition="excludes any">Symantec</TargetFilename>
				<TargetFilename condition="excludes any">BlueJeans</TargetFilename>
			</Rule>
			<Rule name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=File: File Creation,Level=4,Alert=RagnarLocker Virtualbox files: susceptible to FP,Risk=40" groupRelation="and">
				<TargetFilename condition="contains any">VBoxRT.dll;VboxC.dll</TargetFilename>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Data Manipulation-->
			<!--MITRE ATT&CK TECHNIQUE: Defacement-->
			<!--MITRE ATT&CK TECHNIQUE: Disk Wipe-->
			<!--MITRE ATT&CK TECHNIQUE: Endpoint Denial of Service-->
			<!--MITRE ATT&CK TECHNIQUE: Firmware Corruption-->
			<!--MITRE ATT&CK TECHNIQUE: Inhibit System Recovery-->
			<!--MITRE ATT&CK TECHNIQUE: Network Denial of Service-->
			<!--MITRE ATT&CK TECHNIQUE: Resource Hijacking-->
			<!--MITRE ATT&CK TECHNIQUE: Service Stop-->
			<!--MITRE ATT&CK TECHNIQUE: System Shutdown/Reboot-->
			<!--UEBA Detections-->
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Suspicious files within Content.IE5,Risk=40" groupRelation="and">
				<TargetFilename condition="contains any">Content.IE5;INetCache</TargetFilename>
				<TargetFilename condition="contains any">.exe;.zip;.ps1;.bat;.rar;.dll</TargetFilename>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Unusual OLE ActiveX execution from Microsoft Office,Risk=20" groupRelation="and">
				<TargetFilename condition="contains any">MSForms.exd</TargetFilename>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=New Executable File Detected in System32" groupRelation="and">
				<TargetFilename condition="end with">.exe</TargetFilename> 
				<TargetFilename condition="begin with">C:\windows\system32\</TargetFilename> 
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=New Executable File Detected in Windows Directory" groupRelation="and">
				<TargetFilename condition="end with">.exe</TargetFilename> 
				<TargetFilename condition="begin with">C:\windows\</TargetFilename> 
				<TargetFilename condition="excludes">\system32\</TargetFilename> 
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=New Executable File Detected Outside Windows Directory" groupRelation="and">
				<TargetFilename condition="contains any">.dll;.exe</TargetFilename> 
				<TargetFilename condition="excludes">C:\windows\</TargetFilename> 
				<TargetFilename condition="excludes">C:\Users\</TargetFilename> 
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=New Executable File Detected Inside User Directory" groupRelation="and">
				<TargetFilename condition="contains any">.dll;.exe</TargetFilename> 
				<TargetFilename condition="begin with">C:\Users\</TargetFilename> 
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=WLL Office Application Startup" groupRelation="and">
				<TargetFilename condition="contains">\Microsoft\Word\Startup\</TargetFilename>
				<TargetFilename condition="end with">.wll</TargetFilename>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc= Windows Defender Application Control changes" groupRelation="and">
				<TargetFilename condition="begin with">C:\windows\system32\CodeIntegrity\</TargetFilename>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=XLL Office Application Startup" groupRelation="and">
				<TargetFilename condition="contains">\Microsoft\Excel\Startup\</TargetFilename>
				<TargetFilename condition="end with">.xll</TargetFilename>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Outlook Macro Execution,Risk=90" groupRelation="and">
				<TargetFilename condition="end with">\Microsoft\Outlook\VbaProject.OTM</TargetFilename>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Office Application Startup Generic" groupRelation="and">
				<TargetFilename condition="contains">\Microsoft\Addins\</TargetFilename>
				<TargetFilename condition="contains any">.xla</TargetFilename>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Office VSTO Addin detected,Risk=20" groupRelation="and">
				<TargetFilename condition="end with">.vsto</TargetFilename>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=New bat file dropped to C:\Windows\,Risk=70" groupRelation="and">
				<TargetFilename condition="end with">.bat</TargetFilename>
				<TargetFilename condition="begin with">C:\Windows\</TargetFilename>
				<Image condition="excludes any">C:\ProgramData\Lenovo\SystemUpdate\sessionSE\</Image>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=New dll file dropped to C:\Windows\" groupRelation="and">
				<TargetFilename condition="end with">.dll</TargetFilename>
				<TargetFilename condition="begin with">C:\Windows\</TargetFilename>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=New Driver sys file dropped to C:\Windows\" groupRelation="and">
				<TargetFilename condition="end with">.sys</TargetFilename>
				<TargetFilename condition="begin with">C:\Windows\</TargetFilename>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=New Exe file dropped to C:\Windows\" groupRelation="and">
				<TargetFilename condition="end with">.exe</TargetFilename>
				<TargetFilename condition="begin with">C:\Windows\</TargetFilename>
				<TargetFilename condition="excludes any">C:\Windows\System32\;C:\windows\syswow64\</TargetFilename>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=New Exe file dropped to C:\Windows\System32" groupRelation="and">
				<TargetFilename condition="end with">.exe</TargetFilename>
				<TargetFilename condition="begin with">C:\Windows\System32\</TargetFilename>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=New Exe file dropped to C:\Windows\System32" groupRelation="and">
				<TargetFilename condition="end with">.exe</TargetFilename>
				<TargetFilename condition="begin with">C:\Windows\SysWow64\</TargetFilename>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=New theme: Credential harvesting" groupRelation="and">
				<TargetFilename condition="end with">.theme</TargetFilename>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Interesting files: Microsoft Office Isolated Conversion Environment" groupRelation="and">
				<TargetFilename condition="contains">\Packages\oice_</TargetFilename>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Virtualbox VM Escape" groupRelation="and">
				<Image condition="image">VirtualboxVM.exe</Image>
			</Rule>
			<Image name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Files edited with Notepad Plus Plus" condition="is">notepad++.exe</Image>
			<TargetFilename name="Attack=T1023,Technique=Shortcut Modification,Tactic=Persistence,DS=File: File Creation,Level=4,Alert=Potential LNK Malware File Downloaded">.lnk:Zone.Identifier</TargetFilename>
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Execution: Susp ManagedCode Host Process" condition="end with">\UsageLogs\cscript.exe.log</TargetFilename>
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Execution: Susp ManagedCode Host Process" condition="end with">\UsageLogs\mshta.exe.log</TargetFilename>
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Execution: Susp ManagedCode Host Process" condition="end with">\UsageLogs\msiexec.exe.log</TargetFilename>
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Execution: Susp ManagedCode Host Process" condition="end with">\UsageLogs\regsvr32.exe.log</TargetFilename>
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Execution: Susp ManagedCode Host Process" condition="end with">\UsageLogs\rundll32.exe.log</TargetFilename>
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Execution: Susp ManagedCode Host Process" condition="end with">\UsageLogs\svchost.exe.log</TargetFilename>
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Execution: Susp ManagedCode Host Process" condition="end with">\UsageLogs\wmic.exe.log</TargetFilename>
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Execution: Susp ManagedCode Host Process" condition="end with">\UsageLogs\wscript.exe.log</TargetFilename>
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Execution: Susp ManagedCode Host Process" condition="end with">\regsvr32.exe.log</TargetFilename>
			<TargetFilename name="Attack=T1059,Technique=Command and Scripting Interpreter,Tactic=Execution,DS=File: File Creation,Level=0,Desc=Execution: Susp ManagedCode Winrm Host Process" condition="end with">\UsageLogs\wsmprovhost.exe.log</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Link">.lnk</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=URL">.url</TargetFilename>
			<!--Drivers dropped-->
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Driver" condition="end with">.sys</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Driver INF" condition="end with">.inf</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Driver File Dropped" condition="begin with">C:\Windows\SysWOW64\Drivers</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Driver File Dropped" condition="begin with">C:\Windows\System32\Drivers</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Driver File Dropped" condition="contains">\Drivers\</TargetFilename>
			<TargetFilename condition="end with">.drv</TargetFilename> 
			<!--Microsoft Office File Monitoring-->
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Excel Macro,Risk=30" condition="end with">.xlam</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Excel Macro,Risk=30" condition="end with">.xlsm</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Excel" condition="end with">.xla</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Excel" condition="end with">.xll</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Excel" condition="end with">.xls</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Excel" condition="end with">.xlsb</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Excel" condition="end with">.xlsx</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Excel" condition="end with">.xlt</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Excel" condition="end with">.xltm</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Excel" condition="end with">.xlw</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Office Template created" condition="contains">\Microsoft\Templates\</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Outlook EML" condition="end with">.eml</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Outlook MSG" condition="end with">.msg</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Powerpoint Macro" condition="end with">.pptm</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Powerpoint Macro,Risk=30" condition="end with">.potm</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Powerpoint Macro,Risk=30" condition="end with">.pptm</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Powerpoint Macro,Risk=30" condition="end with">.pptm</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Powerpoint OpenXML Filetype" condition="end with">.sldm</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Recent Office Files" condition="contains">\Microsoft\Office\Recent</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Forensic=Recent Office History" condition="contains">oleObject</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Forensic=Recent Jumplist Custom Destinations" condition="contains">\Recent\CustomDestinations\</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=User Downloaded Files" condition="contains">\Downloads\</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=User Outlook Attachments" condition="contains">\Content.Outlook\</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Word Macro,Risk=30" condition="end with">.docb</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Word Macro,Risk=30" condition="end with">.wbk</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Word Perfect" condition="end with">.ped</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Word Template" condition="end with">.dot</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Word Template" condition="end with">.dotx</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Word" condition="end with">.doc</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Word" condition="end with">.docm</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Word" condition="end with">.docx</TargetFilename>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Legacy Office files" groupRelation="or">
				<TargetFilename condition="end with">.accdb</TargetFilename>
				<TargetFilename condition="end with">.accde</TargetFilename>
				<TargetFilename condition="end with">.accdr</TargetFilename>
				<TargetFilename condition="end with">.accdt</TargetFilename>
				<TargetFilename condition="end with">.mdb</TargetFilename>
				<TargetFilename condition="end with">.mde</TargetFilename>
				<TargetFilename condition="end with">.msc</TargetFilename>
				<TargetFilename condition="end with">.mst</TargetFilename>
				<TargetFilename condition="end with">.potx</TargetFilename>
				<TargetFilename condition="end with">.ppam</TargetFilename>
				<TargetFilename condition="end with">.ppsm</TargetFilename>
				<TargetFilename condition="end with">.ppsx</TargetFilename>
				<TargetFilename condition="end with">.ppt</TargetFilename>
				<TargetFilename condition="end with">.pptm</TargetFilename>
				<TargetFilename condition="end with">.pptx</TargetFilename>
				<TargetFilename condition="end with">.pub</TargetFilename>
				<TargetFilename condition="end with">.sldm</TargetFilename>
				<TargetFilename condition="end with">.sldx</TargetFilename>
				<TargetFilename condition="end with">.xls</TargetFilename>
				<TargetFilename condition="end with">.xps</TargetFilename>
			</Rule>
			<!--SECTION: Certificates -->
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Certificate" groupRelation="or">
				<TargetFilename condition="end with">.pem</TargetFilename>
				<TargetFilename condition="end with">.crt</TargetFilename>
				<TargetFilename condition="end with">.ca-bundle</TargetFilename>
				<TargetFilename condition="end with">.cer</TargetFilename>
				<TargetFilename condition="end with">.csr</TargetFilename>
				<TargetFilename condition="end with">.der</TargetFilename>
				<TargetFilename condition="end with">.p7b</TargetFilename>
				<TargetFilename condition="end with">.p7r</TargetFilename>
				<TargetFilename condition="end with">.p7s</TargetFilename>
				<TargetFilename condition="end with">.pfx</TargetFilename>
				<TargetFilename condition="end with">.sto</TargetFilename>
				<TargetFilename condition="end with">.p12</TargetFilename>
				<TargetFilename condition="end with">.crl</TargetFilename>
				<TargetFilename condition="end with">.sst</TargetFilename>
				<TargetFilename condition="end with">.key</TargetFilename>
			</Rule>
			<!-- side loading -->
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Sideload Detection" groupRelation="or">
				<TargetFilename condition="end with">.hlp</TargetFilename>
				<TargetFilename condition="end with">ACLUI.DLL.UI</TargetFilename>
				<TargetFilename condition="end with">ACLUI.DLL</TargetFilename>
				<TargetFilename condition="end with">AFLogVw.exe</TargetFilename>
				<TargetFilename condition="end with">AShld.exe</TargetFilename>
				<TargetFilename condition="end with">AShldRes.DLL.asr</TargetFilename>
				<TargetFilename condition="end with">AShldRes.DLL</TargetFilename>
				<TargetFilename condition="end with">AhnI2.dll</TargetFilename>
				<TargetFilename condition="end with">CamMute.exe</TargetFilename>
				<TargetFilename condition="end with">CommFunc.dll</TargetFilename>
				<TargetFilename condition="end with">CommFunc.jax</TargetFilename>
				<TargetFilename condition="end with">DESqmWrapper.dll</TargetFilename>
				<TargetFilename condition="end with">DESqmWrapper.wrapper</TargetFilename>
				<TargetFilename condition="end with">FSPMAPI.dll.fsp</TargetFilename>
				<TargetFilename condition="end with">FSPMAPI.dll</TargetFilename>
				<TargetFilename condition="end with">Gadget.exe</TargetFilename>
				<TargetFilename condition="end with">LoLTWLauncher.exe</TargetFilename>
				<TargetFilename condition="end with">Mc.exe</TargetFilename>
				<TargetFilename condition="end with">McUtil.dll.ping</TargetFilename>
				<TargetFilename condition="end with">McUtil.dll.url</TargetFilename>
				<TargetFilename condition="end with">McUtil.dll</TargetFilename>
				<TargetFilename condition="end with">MpSvc.dll</TargetFilename>
				<TargetFilename condition="end with">MsMpEng.exe</TargetFilename>
				<TargetFilename condition="end with">NtUserEx.dat</TargetFilename>
				<TargetFilename condition="end with">NtUserEx.dat</TargetFilename>
				<TargetFilename condition="end with">NtUserEx.dll</TargetFilename>
				<TargetFilename condition="end with">NtUserEx.dll</TargetFilename>
				<TargetFilename condition="end with">NvSmart.exe</TargetFilename>
				<TargetFilename condition="end with">NvSmartMax.dll</TargetFilename>
				<TargetFilename condition="end with">NvSmartMax.dll</TargetFilename>
				<TargetFilename condition="end with">NvSmartMaxapp.dll</TargetFilename>
				<TargetFilename condition="end with">OInfo11.ISO</TargetFilename>
				<TargetFilename condition="end with">OInfo11.ocx</TargetFilename>
				<TargetFilename condition="end with">OInfoP11.exe</TargetFilename>
				<TargetFilename condition="end with">OleView.exe</TargetFilename>
				<TargetFilename condition="end with">OleView.exe</TargetFilename>
				<TargetFilename condition="end with">POETWLauncher.exe</TargetFilename>
				<TargetFilename condition="end with">RasTls.dll.config</TargetFilename>
				<TargetFilename condition="end with">RasTls.dll.msc</TargetFilename>
				<TargetFilename condition="end with">RasTls.dll</TargetFilename>
				<TargetFilename condition="end with">RasTls.exe</TargetFilename>
				<TargetFilename condition="end with">RunHelp.exe</TargetFilename>
				<TargetFilename condition="end with">Sidebar.dll.doc</TargetFilename>
				<TargetFilename condition="end with">Sidebar.dll</TargetFilename>
				<TargetFilename condition="end with">Ushata.dll</TargetFilename>
				<TargetFilename condition="end with">Ushata.exe</TargetFilename>
				<TargetFilename condition="end with">Ushata.fox</TargetFilename>
				<TargetFilename condition="end with">VeetlePlayer.exe</TargetFilename>
				<TargetFilename condition="end with">boot.ldr</TargetFilename>
				<TargetFilename condition="end with">chrome_frame_helper.dll.rom</TargetFilename>
				<TargetFilename condition="end with">chrome_frame_helper.dll</TargetFilename>
				<TargetFilename condition="end with">chrome_frame_helper.exe</TargetFilename>
				<TargetFilename condition="end with">dvcemumanager.exe</TargetFilename>
				<TargetFilename condition="end with">fsguidll.exe</TargetFilename>
				<TargetFilename condition="end with">fslapi.dll.gui</TargetFilename>
				<TargetFilename condition="end with">fslapi.dll</TargetFilename>
				<TargetFilename condition="end with">fsstm.exe</TargetFilename>
				<TargetFilename condition="end with">hccutils.dll.res</TargetFilename>
				<TargetFilename condition="end with">hccutils.dll</TargetFilename>
				<TargetFilename condition="end with">hha.dll.bak</TargetFilename>
				<TargetFilename condition="end with">hha.dll</TargetFilename>
				<TargetFilename condition="end with">hhc.exe</TargetFilename>
				<TargetFilename condition="end with">hkcmd.exe</TargetFilename>
				<TargetFilename condition="end with">iviewers.dll</TargetFilename>
				<TargetFilename condition="end with">jli.dll</TargetFilename>
				<TargetFilename condition="end with">libvlc.dll</TargetFilename>
				<TargetFilename condition="end with">mPclient.dll</TargetFilename>
				<TargetFilename condition="end with">mcf.ep</TargetFilename>
				<TargetFilename condition="end with">mcf.exe</TargetFilename>
				<TargetFilename condition="end with">mcupdui.exe</TargetFilename>
				<TargetFilename condition="end with">mcut.exe</TargetFilename>
				<TargetFilename condition="end with">mcutil.dll.bbc</TargetFilename>
				<TargetFilename condition="end with">mcvsmap.exe</TargetFilename>
				<TargetFilename condition="end with">msi.dll.dat</TargetFilename>
				<TargetFilename condition="end with">msi.dll</TargetFilename>
				<TargetFilename condition="end with">msseces.asm</TargetFilename>
				<TargetFilename condition="end with">msseces.exe</TargetFilename>
				<TargetFilename condition="end with">mtcReport.ktc</TargetFilename>
				<TargetFilename condition="end with">rc.dll</TargetFilename>
				<TargetFilename condition="end with">rc.exe</TargetFilename>
				<TargetFilename condition="end with">rc.hlp</TargetFilename>
				<TargetFilename condition="end with">sep_NE.exe</TargetFilename>
				<TargetFilename condition="end with">sep_NE.slf</TargetFilename>
				<TargetFilename condition="end with">tplcdclr.exe</TargetFilename>
				<TargetFilename condition="end with">winmm.dll</TargetFilename>
				<TargetFilename condition="end with">wts.chm</TargetFilename>
				<TargetFilename condition="end with">credwiz.exe</TargetFilename>
			</Rule>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Op cell phone: https://www.cybereason.com/blog/operation-soft-cell-a-worldwide-campaign-against-telecommunications-providers" condition="end with">ssMUIDLL.dll</TargetFilename>
			<TargetFilename name="Attack=T1574.002,Technique=Hijack Execution Flow: DLL Side-Loading,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Desc=Finfisher Sideload Detection" condition="end with">aepic.dll</TargetFilename>
			<TargetFilename name="Attack=T1574.002,Technique=Hijack Execution Flow: DLL Side-Loading,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Desc=Finfisher Sideload Detection" condition="end with">ftllib.dll</TargetFilename>
			<TargetFilename name="Attack=T1574.002,Technique=Hijack Execution Flow: DLL Side-Loading,Tactic=Defense Evasion,DS=File: File Creation,Level=0,Desc=Finfisher Sideload Detection" condition="end with">userenv.dll</TargetFilename>
			<TargetFilename name="Attack=T1021.001,Technique=Remote Services: Remote Desktop Protocol,Tactic=Lateral Movement,DS=File: File Creation,Level=0,Desc=RDP Bitmap Cache" condition="contains">\Terminal Server Client\Cache\</TargetFilename>
			<TargetFilename name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=File: File Creation,Forensic=Windows Prefetch Exec History" condition="begin with">C:\Windows\Prefetch</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Suspicious TSClient share file creation,Risk=30" condition="begin with">\\tsclient</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=WebDav Cache Files Created" condition="begin with">C:\Windows\ServiceProfiles\LocalService\AppData\Local\Temp\TfsStore\</TargetFilename>
			<TargetFilename name="Attack=T1087,Technique=Account Discovery,Tactic=Discovery,DS=File: File Creation,Level=4,Alert=SharpDump bin,Risk=100" condition="end with">\Temp\debug.bin</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=7zip Archive Extraction" condition="contains">Temp\7z</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Appcompat Shims" condition="begin with">C:\Windows\AppPatch\Custom</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=CHM Filetype" condition="end with">.chm</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=CIA Vault7: Control Panel Files https://wikileaks.org/ciav7p1/cms/page_16384212.html" condition="end with">.cpl</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=CIA Vault7: https://wikileaks.org/ciav7p1/cms/page_16384212.html" condition="contains">.mht</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Chrome Extensions" condition="contains">\Chrome\User Data\Default\Extensions\</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Chrome extension" condition="end with">.crx</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=ClickOnce extension" condition="end with">.appref-ms</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Desktop Gadget File" condition="end with">.gadget</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Encrypted JScript File type" condition="end with">.JSE</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Executable file" condition="end with">.exe</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Explorer Command" condition="end with">.scf</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Dropped to Exchange OWA: Webshell,Risk=70" condition="contains">Exchange Server\ClientAccess\Owa\</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File Dropped to shadow copy" condition="begin with">\Device\HarddiskVolumeShadowCopy</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=File created/accessed from Zip File" condition="contains">.zip\</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Font File Type" condition="end with">.FON</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Font File Type" condition="end with">.FOT</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Group Policy Script File Dropped" condition="begin with">C:\Windows\System32\GroupPolicy\Machine\Scripts</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Group Policy Script File Dropped" condition="begin with">C:\Windows\System32\GroupPolicy\User\Scripts</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=IQY file used to pull down dropper" condition="end with">.iqy</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Icon" condition="end with">.ico</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Internet settings" condition="end with">.isp</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=MMC Snapin" condition="end with">.msc</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Manifest File Crated" condition="end with">.manifest</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Memory dump" condition="end with">MEMORY.dmp</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Microsoft Installer" condition="end with">.msi</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Microsoft:dotNet: Executed by cvtres.exe" condition="end with">.cs</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Microsoft:dotNet: Executed by cvtres.exe" condition="end with">.customDestinations-ms</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Minidump Crash dump created" condition="begin with">C:\Windows\Minidump</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=PAF" condition="end with">.PAF</TargetFilename>
			<TargetFilename name="Attack=T1021.001,Technique=Remote Services: Remote Desktop Protocol,Tactic=Lateral Movement,DS=File: File Creation,Level=0,Desc=RDP Bitmap Cache" condition="end with">.bmc</TargetFilename>
			<TargetFilename name="Attack=T1021.001,Technique=Remote Services: Remote Desktop Protocol,Tactic=Lateral Movement,DS=File: File Creation,Level=0,Desc=RDP" condition="end with">.rdp</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=RTF files often 0day malware vectors when opened by Office,Risk=20" condition="end with">.rtf</TargetFilename> 
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Registry file" condition="end with">.reg</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=SHS Office File for copy pastes" condition="end with">.SHS</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=SLK file used for command execution" condition="end with">.slk</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Screensaver" condition="end with">.SCR</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Set" condition="end with">.set</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=SettingContent-ms" condition="end with">.SettingContent-ms</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Spooled Print Job" condition="end with">.SHD</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Spooled Print Job" condition="end with">.SPL</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Screensaver file created" condition="end with">.scr</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Vault7 file" condition="end with">HammerDrillStatus.dll</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Windows Error Dumps" condition="contains">Microsoft\Windows\WER\</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Windows Icon" condition="end with">.ICL</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Windows Registry Database" condition="end with">.sdb</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Windows Script File Component File" condition="end with">.SCT</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Windows Shell Scrap Object Handler File" condition="end with">.SHB</TargetFilename>
			<TargetFilename name="Attack=None,Technique=None,Tactic=None,DS=File: File Creation,Level=0,Desc=Zip File Extraction from explorer" condition="contains">Temp\Temp1_</TargetFilename>
			<!--Uncategorized-->
			<TargetFilename condition="contains all">\Microsoft\;CLR_v;\UsageLogs\</TargetFilename>
			<TargetFilename condition="end with">.ade</TargetFilename>
			<TargetFilename condition="end with">.adp</TargetFilename>
			<TargetFilename condition="end with">.application</TargetFilename>
			<TargetFilename condition="end with">.appref-ms</TargetFilename>
			<TargetFilename condition="end with">.asc</TargetFilename>
			<TargetFilename condition="end with">.bmf</TargetFilename>
			<TargetFilename condition="end with">.cer</TargetFilename>
			<TargetFilename condition="end with">.dmp</TargetFilename>
			<TargetFilename condition="end with">.gpg</TargetFilename>
			<TargetFilename condition="end with">.htm</TargetFilename>
			<TargetFilename condition="end with">.html</TargetFilename>
			<TargetFilename condition="end with">.json</TargetFilename>
			<TargetFilename condition="end with">.jsp</TargetFilename>
			<TargetFilename condition="end with">.key</TargetFilename>
			<TargetFilename condition="end with">.mof</TargetFilename>
			<TargetFilename condition="end with">.ocx</TargetFilename>
			<TargetFilename condition="end with">.p7b</TargetFilename>
			<TargetFilename condition="end with">.p12</TargetFilename>
			<TargetFilename condition="end with">.pem</TargetFilename>
			<TargetFilename condition="end with">.pfx</TargetFilename>
			<TargetFilename condition="end with">.pgp</TargetFilename>
			<TargetFilename condition="end with">.php</TargetFilename>
			<TargetFilename condition="end with">.ppk</TargetFilename>
			<TargetFilename condition="end with">.war</TargetFilename>
			<TargetFilename condition="end with">.xml</TargetFilename>
		</FileCreate>
	</RuleGroup>
	<!--SYSMON EVENT ID 12 & 13 & 14 : REGISTRY MODIFICATION [RegistryEvent]-->
	<RuleGroup name="RG=RegistryEvent Include Group" groupRelation="or">
		<RegistryEvent onmatch="include">
			<!--MITRE ATT&CK TACTIC: Reconnaissance-->
			<!--MITRE ATT&CK TECHNIQUE: Active Scanning-->
			<Rule name="ttack=T1595,Technique=Active Scanning,Tactic=Reconnaissance,DS=indows Registry: Windows Registry Key Modification,Level=4,Alert=Advanced IP Scanner Scan Detected" groupRelation="and">
				<TargetObject condition="contains">Software\Famatech\advanced_ip_scanner\State</TargetObject>
				<TargetObject condition="end with">LastRangeUsed</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Gather Victim Host Information-->
			<!--MITRE ATT&CK TECHNIQUE: Gather Victim Identity Information-->
			<!--MITRE ATT&CK TECHNIQUE: Gather Victim Network Information-->
			<!--MITRE ATT&CK TECHNIQUE: Gather Victim Org Information-->
			<!--MITRE ATT&CK TECHNIQUE: Phishing for Information-->
			<!--MITRE ATT&CK TECHNIQUE: Search Closed Sources-->
			<!--MITRE ATT&CK TECHNIQUE: Search Open Technical Databases-->
			<!--MITRE ATT&CK TECHNIQUE: Search Open Websites/Domains-->
			<!--MITRE ATT&CK TECHNIQUE: Search Victim-Owned Websites-->

			<!--MITRE ATT&CK TACTIC: Resource Development-->
			<!--MITRE ATT&CK TECHNIQUE: Acquire Infrastructure-->
			<!--MITRE ATT&CK TECHNIQUE: Compromise Accounts-->
			<!--MITRE ATT&CK TECHNIQUE: Compromise Infrastructure-->
			<!--MITRE ATT&CK TECHNIQUE: Develop Capabilities-->
			<!--MITRE ATT&CK TECHNIQUE: Establish Accounts-->
			<!--MITRE ATT&CK TECHNIQUE: Obtain Capabilities-->
			<!--MITRE ATT&CK TECHNIQUE: Stage Capabilities-->

			<!--MITRE ATT&CK TACTIC: Initial Access-->
			<!--MITRE ATT&CK TECHNIQUE: Drive-by Compromise-->
			<!--MITRE ATT&CK TECHNIQUE: Exploit Public-Facing Application-->
			<!--MITRE ATT&CK TECHNIQUE: External Remote Services-->
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=RDP Connection History Tracking" groupRelation="and">
				<TargetObject condition="contains">\Software\Microsoft\Terminal Server Client</TargetObject>
				<TargetObject condition="excludes">DefaultPrinter</TargetObject>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Hardware Additions-->
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Keyloggers and new Keyboards" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{4d36e96b-e325-11ce-bfc1-08002be10318}</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<Rule name="Attack=T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect USB Input Devices" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{745a17a0-74d3-11d0-b6fe-00a0c90f57da}</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<Rule name="Attack=T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect New Mice" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{4d36e96f-e325-11ce-bfc1-08002be10318}</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<Rule name="T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect New Composite Device" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{36fc9e60-c465-11cf-8056-444553540000}</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<Rule name="Attack=T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect New Bluetooth Device" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{e0cbf06c-cd8b-4647-bb8a-263b43f0f974</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<Rule name="T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect New Disk Drive" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{4d36e967-e325-11ce-bfc1-08002be10318}</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<Rule name="T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect New WPD Devices" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{eec5ad98-8080-425f-922a-dabf3de3f69a}</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<Rule name="T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect New Biometric Devices" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{53D29EF7-377C-4D14-864B-EB3A85769359}</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<Rule name="Attack=T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Alert=Virtual DVD-ROM Drive Mounted,Forensic=Virtual DVD-ROM Drive Mounted" groupRelation="and">
				<TargetObject condition="contains all">Root\InventoryDevicePnp;prod_virtual_dvd-rom</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<TargetObject name="T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Mounted Device Detection" condition="contains">MountedDevices</TargetObject>
			<TargetObject name="T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Mountpoints2 Mounted Device Detection" condition="contains">Mountpoints2</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Active Setup Installed Components" condition="contains">Active Setup\Installed Components</TargetObject>
			<!--MITRE ATT&CK TECHNIQUE: Phishing-->
			<!--MITRE ATT&CK TECHNIQUE: Replication Through Removable Media-->
			<!--MITRE ATT&CK TECHNIQUE: Supply Chain Compromise-->
			<!--MITRE ATT&CK TECHNIQUE: Trusted Relationship-->
			<!--MITRE ATT&CK TECHNIQUE: Valid Accounts -->
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Interactive Logon Detected" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\LogonUI\SessionData\</TargetObject>
				<TargetObject condition="end with">LoggedOnUser</TargetObject>
			</Rule>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Last Logged on User modification" condition="contains">LastLoggedOnUser</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Last Logged on Provider modification" condition="contains">LastLoggedOnProvider</TargetObject>
			<!--MITRE ATT&CK TACTIC: Execution-->
			<!--MITRE ATT&CK TECHNIQUE: Command and Scripting Interpreter-->
			<!--MITRE ATT&CK TECHNIQUE: Container Administration Command-->
			<!--MITRE ATT&CK TECHNIQUE: Deploy Container-->
			<!--MITRE ATT&CK TECHNIQUE: Exploitation for Client Execution-->
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Suspicious Set Value of MSDT in Registry: Dogwalk/follina,Risk=100,CVE=CVE-2022-30190" groupRelation="and">
				<TargetObject condition="begin with">HKCR\ms-msdt\</TargetObject>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Scripted Diagnostics Turn Off Check Enabled: Dogwalk/follina,Risk=100,CVE=CVE-2022-30190" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\ScriptedDiagnostics\TurnOffCheck</TargetObject>
				<Details condition="contains">DWORD (0x00000001)</Details>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Inter-Process Communication-->
			<!--MITRE ATT&CK TECHNIQUE: Native API-->
			<!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
			<!--MITRE ATT&CK TECHNIQUE: Shared Modules-->
			<!--MITRE ATT&CK TECHNIQUE: Software Deployment Tools-->
			<!--MITRE ATT&CK TECHNIQUE: System Services-->
			<Rule name="Attack=T1543.003,Tactic=Persistence,Technique=Create Windows Service,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=New SVCHost service,Risk=70" groupRelation="and">
				<TargetObject condition="contains">SOFTWARE\Microsoft\Windows NT\CurrentVersion\Svchost</TargetObject>
				<TargetObject condition="excludes">\print\</TargetObject>
				<TargetObject condition="excludes">\AzureAttestService\CoInitializeSecurityParam</TargetObject>
				<Image condition="excludes">C:\$WINDOWS.~BT\</Image>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: User Execution-->
			<Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=VBA Project Object Model Macro Settings,Risk=30" groupRelation="and">
				<TargetObject condition="end with">\AccessVBOM</TargetObject>
				<Image condition="excludes any">C:\Windows\system32\svchost.exe;C:\WINDOWS\system32\mmc.exe;C:\Windows\system32\userinit.exe</Image>
			</Rule>
			<Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=VBA Project VBA Warnings Macro Setting Change,Risk=40" groupRelation="and">
				<TargetObject condition="end with">Security\VBAWarnings</TargetObject>
				<Image condition="excludes any">C:\Windows\system32\svchost.exe;C:\WINDOWS\system32\mmc.exe;C:\Windows\system32\userinit.exe</Image>
			</Rule>
			<Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=VBA Project VBA Warnings Macro Setting Change,Risk=40" groupRelation="and">
				<TargetObject condition="end with">Security\VBAWarnings</TargetObject>
				<Image condition="excludes any">C:\Windows\system32\svchost.exe;C:\WINDOWS\system32\mmc.exe;C:\Windows\system32\userinit.exe</Image>
			</Rule>
			<Rule name="Attack=T1204,Technique=User Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Potential Office Macro Execution Detected" groupRelation="and">
				<Image condition="contains any">EXCEL.exe;WINWORD.exe</Image>
				<TargetObject condition="contains any">{8BD21D32-EC42-11CE-9E0D-00AA006002F3};{5B9D8FC8-4A71-101B-97A6-00000B65C08B}</TargetObject>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: User Execution: Malicious File-->
			<Rule name="Attack=T0000,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=NJRAT Detection,Risk=100" groupRelation="and">
				<TargetObject condition="is">HKCU\di</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Lokibot Detection" groupRelation="and">
				<TargetObject condition="contains">HKCU\�</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=AMSI Tamper Detection" groupRelation="or">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\AMSI\Providers\</TargetObject>
				<TargetObject condition="begin with">hklm\software\microsoft\windows script\settings\amsienable</TargetObject>
				<TargetObject condition="begin with">hkcu\software\microsoft\windows script\settings\amsienable</TargetObject>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Windows Management Instrumentation-->

			<!--MITRE ATT&CK TACTIC: Persistence-->
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Chrome Extension auditing" groupRelation="and">
				<TargetObject condition="contains">Google\Chrome\Extensions</TargetObject>
				<TargetObject condition="end with">update_url</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Account Manipulation-->
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Forced password reset detected" groupRelation="and">
				<TargetObject condition="contains">ForcePasswordReset</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Machine Password Change Detected" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SECURITY\Policy\Secrets\$MACHINE.ACC\CurrVal</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=User Last Password Changed" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SAM\SAM\DOMAINS\Account\Users\</TargetObject>
				<TargetObject condition="end with">Last Password Change</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Account Expiration" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SAM\SAM\DOMAINS\Account\Users\</TargetObject>
				<TargetObject condition="end with">Account Expiration</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Last Failed Logon" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SAM\SAM\DOMAINS\Account\Users\</TargetObject>
				<TargetObject condition="end with">Last Failed Logon</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=User Account Added to Local Admin" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SAM\SAM\Domains\Builtin\Aliases\00000220\</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=User Account Added to Remote Desktop User Group" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SAM\SAM\Domains\Builtin\Aliases\0000022B\</TargetObject>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: BITS Jobs-->
			<!--MITRE ATT&CK TECHNIQUE: Boot or Logon Autostart Execution-->
			<TargetObject name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Alert=Process Injection: injecting a 64-bit DLL into a 32-bit process" condition="contains">SOFTWARE\Microsoft\Wow64\x86\</TargetObject>
			<Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Alert=AutoRun Reg Keys,Risk=70" groupRelation="and">
				<EventType condition="is">SetValue</EventType>
				<TargetObject condition="contains">\CurrentVersion\Run\</TargetObject>
				<Image condition="excludes">Add_exclusions_here</Image>
			</Rule>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Logon Logoff Shutdown Scripts" condition="contains">\Microsoft\System\Scripts</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Logon Logoff Shutdown Scripts" condition="contains">\Windows\System\Scripts</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Service Command Line parameters" condition="begin with">HKLM\SYSTEM\Setup\CmdLine</TargetObject>
			<Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Service Start Mode Changed to: Boot" groupRelation="and">
				<TargetObject condition="end with">\Start</TargetObject>
				<Details condition="contains">DWORD (0x00000000)</Details>
			</Rule>
			<Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Service Start Mode Changed to: System" groupRelation="and">
				<TargetObject condition="end with">\Start</TargetObject>
				<Details condition="contains">DWORD (0x00000001)</Details>
			</Rule>
			<Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Service Start Mode Changed to: Automatic" groupRelation="and">
				<TargetObject condition="end with">\Start</TargetObject>
				<Details condition="contains">DWORD (0x00000002)</Details>
			</Rule>
			<Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Services: Service Start Mode Changed to: Manual" groupRelation="and">
				<TargetObject condition="end with">\Start</TargetObject>
				<Details condition="contains">DWORD (0x00000003)</Details>
			</Rule>
			<Rule name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Services: Service Start Mode Changed to: Disabled" groupRelation="and">
				<TargetObject condition="end with">\Start</TargetObject>
				<Details condition="contains">DWORD (0x00000004)</Details>
			</Rule>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Services: Services and autoruns imagepath" condition="end with">\ImagePath</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Service DLL changes" condition="end with">\ServiceDll</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Manifest pointing to service's DLL" condition="end with">\ServiceManifest</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Run Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification" condition="begin with">hkcu\software\microsoft\windows nt\currentversion\windows\run\</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Run Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification" condition="begin with">hkcu\software\microsoft\windows\currentversion\explorer\shell folders\common startup</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Run Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification" condition="begin with">hkcu\software\microsoft\windows\currentversion\explorer\shell folders\startup</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Run Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification" condition="begin with">hklm\software\microsoft\command processor\autorun</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Run Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification" condition="contains all">hkcu\software\microsoft\windows nt\currentversion\accessibility\ATs\\*(1)\StartExe</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Run Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification" condition="contains">Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders\Startup</TargetObject>
			<!--MITRE ATT&CK TECHNIQUE: Boot or Logon Autostart Execution: Print Processors-->
			<TargetObject name="Attack=T1013,Technique=Port Monitors,Tactic=Persistence/Privilege Escalation,DS=Windows Registry: Windows Registry Key Modification" condition="contains">\Print\Monitors</TargetObject>
			<!--<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Printer Registry Locations" condition="contains">\Printers\Connections</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Printer Registry Locations" condition="contains">\Print\Environments\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Printer Registry Locations" condition="contains">\Servers\Printers\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Printer Registry Locations" condition="contains">\Print\V4 Connections</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Printer Registry Locations" condition="contains">CurrentVersion\PrinterPorts</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Printer Registry Locations" condition="contains">SWD\PRINTENUM</TargetObject>-->
			<!--MITRE ATT&CK TECHNIQUE: Boot or Logon Initialization Scripts-->
			<!--MITRE ATT&CK TECHNIQUE: Browser Extensions-->
			<!--MITRE ATT&CK TECHNIQUE: Compromise Client Software Binary-->
			<!--MITRE ATT&CK TECHNIQUE: Create Account-->
			<Rule name="Attack=T1136,Technique=Create Account,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=New user created,Risk=40" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SAM\SAM\DOMAINS\Account\Users\Names\</TargetObject>
				<TargetObject condition="excludes">$</TargetObject>
				<EventType condition="is">CreateKey</EventType>
			</Rule>
			<Rule name="Attack=T1136,Technique=Create Account,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Creation,Level=0,Desc=Hidden New user created,Risk=40" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SAM\SAM\DOMAINS\Account\Users\Names\</TargetObject>
				<TargetObject condition="contains">$</TargetObject>
				<EventType condition="is">CreateKey</EventType>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Create or Modify System Process-->
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=Sysmon Manifest change detected,Risk=30" groupRelation="and">
				<TargetObject condition="begin with">HKLM\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\{5770385f-c22a-43e0-bf4c-06f5698ffbd9}</TargetObject>
				<Image condition="excludes">C:\WINDOWS\sysmon64.exe</Image>
				<Image condition="excludes">C:\WINDOWS\sysmon.exe</Image>
				<Image condition="excludes">C:\Programdata\sysmon\sysmon64.exe</Image>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Event Triggered Execution-->
			<Rule name="Attack=T1546.001,Technique=Event Triggered Execution: Change Default File Association,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor Endpoint Protocol Handlers" groupRelation="and">
				<TargetObject condition="begin with">HKCR\</TargetObject>
				<TargetObject condition="end with">(Default)</TargetObject>
				<TargetObject condition="excludes">\shell\open\command\(Default)</TargetObject>
				<Details condition="begin with">URL:</Details>
			</Rule>
			<Rule name="Attack=T1546.001,Technique=Event Triggered Execution: Change Default File Association,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor User Protocol Handlers" groupRelation="and">
				<TargetObject condition="begin with">HKCU\Software\Classes\</TargetObject>
				<TargetObject condition="end with">(Default)</TargetObject>
				<TargetObject condition="excludes">\shell\open\command\(Default)</TargetObject>
				<Details condition="begin with">URL:</Details>
			</Rule>
			<Rule name="Attack=T1546.001,Technique=Event Triggered Execution: Change Default File Association,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor Endpoint File Associations" groupRelation="and">
				<TargetObject condition="begin with">HKCR\</TargetObject>
				<TargetObject condition="end with">\shell\open\command\(Default)</TargetObject>
				<Details condition="contains">%1</Details>
			</Rule>
			<Rule name="Attack=T1546.001,Technique=Event Triggered Execution: Change Default File Association,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor User Default File Associations" groupRelation="and">
				<TargetObject condition="begin with">HKCU\Software\Classes\</TargetObject>
				<TargetObject condition="end with">\shell\open\command\(Default)</TargetObject>
				<Details condition="contains">%1</Details>
			</Rule>
			<Rule name="Attack=T1546.001,Technique=Event Triggered Execution: Change Default File Association,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor COM Hijacking" groupRelation="and">
				<TargetObject condition="end with">\shell\open\command\DelegateExecute</TargetObject>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Event Triggered Execution: Accessibility Features-->
			<Rule name="Attack=T1015,Technique=Accessibility Features,Tactic=Persistence/Privilege Escalation,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=Utilman Priv Escalation,Risk=100" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\utilman.exe</TargetObject>
			</Rule>
			<Rule name="Attack=T1015,Technique=Accessibility Features,Tactic=Persistence/Privilege Escalation,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=sethc.exe Priv Escalation,Risk=100" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\sethc.exe</TargetObject>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: External Remote Services-->
			<!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=KnownDLLs" condition="contains">Session Manager\KnownDlls</TargetObject>
			<!--MITRE ATT&CK TECHNIQUE: Implant Internal Image-->
			<!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
			<!--MITRE ATT&CK TECHNIQUE: Office Application Startup-->
			<Rule name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Microsoft Outlook Addins" groupRelation="and">
				<TargetObject condition="contains">Outlook\Addins</TargetObject>
			</Rule>
			<Rule name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Microsoft Word Addins" groupRelation="and">
				<TargetObject condition="contains">Word\Addins</TargetObject>
			</Rule>
			<Rule name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Microsoft Excel Addins" groupRelation="and">
				<TargetObject condition="contains">Excel\Addins</TargetObject>
			</Rule>
			<Rule name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Microsoft Powerpoint Addins" groupRelation="and">
				<TargetObject condition="contains">Powerpoint\Addins</TargetObject>
			</Rule>
			<Rule name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Microsoft VSTO Inclusions" groupRelation="and">
				<TargetObject condition="contains">Software\Microsoft\VSTO\Security\Inclusion\</TargetObject>
			</Rule>
			<Rule name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Microsoft VSTO Solution Metadata" groupRelation="and">
				<TargetObject condition="contains">Software\Microsoft\VSTO\SolutionMetadata\</TargetObject>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Pre-OS Boot-->
			<!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
			<!--MITRE ATT&CK TECHNIQUE: Server Software Component-->
			<!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
			<!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->

			<!--MITRE ATT&CK TACTIC: Privilege Escalation-->
			<!--MITRE ATT&CK TECHNIQUE: Abuse Elevation Control Mechanism-->
			<Rule name="Attack=T1548,Tactic=Defense Evasion,Technique=Abuse Elevation Control Mechanism,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=CMSTPLUA UAC Bypass" groupRelation="and">
				<TargetObject condition="contains any">cmmgr32.exe</TargetObject>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Access Token Manipulation-->
			<!--MITRE ATT&CK TECHNIQUE: Boot or Logon Autostart Execution-->
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" condition="begin with">HKLU\Software\Microsoft\Command Processor\AutoRun</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" condition="begin with">HKLM\System\CurrentControlSet\Control\Session Manager\SetupExecute</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" condition="begin with">HKLM\System\CurrentControlSet\Control\Session Manager\Execute</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" condition="begin with">HKLM\Software\Wow6432Node\Microsoft\Command Processor\AutoRun</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" condition="begin with">HKLM\Software\Wow6432Node\Microsoft\Command Processor\AutoRun</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" condition="begin with">HKLM\Software\Microsoft\WindowsNT\CurrentVersion\Winlogon</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\AeDebug</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" condition="begin with">HKLM\Software\Microsoft\Command Processor\AutoRun</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\BootExecute</TargetObject> <!--Microsoft:Windows: Autorun | Credit @ion-storm | [ https://www.cylance.com/windows-registry-persistence-part-2-the-run-keys-and-search-order ] -->
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\SafeDllSearchMode</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\VmApplet</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit\</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\AppSetup</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=AutoRun Keys,Risk=70" condition="contains">UserInitMprLogonScript</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=BootVerificationProgram Autorun" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\BootVerificationProgram\ImagePath</TargetObject>
			<!--MITRE ATT&CK TECHNIQUE: Boot or Logon Autostart Execution: Security Support Provider-->
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor LSA Authentication Packages" condition="begin with">HKLM\System\CurrentControlSet\Control\Lsa\Authentication Packages</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor LSA Notification Packages" condition="begin with">HKLM\System\CurrentControlSet\Control\Lsa\Notification Packages</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor LSA Security Packages" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor OS Config LSA Authentication Packages" condition="begin with">HKLM\System\CurrentControlSet\Control\Lsa\OSConfig\Authentication Packages</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor OS Config LSA Notification Packages" condition="begin with">HKLM\System\CurrentControlSet\Control\Lsa\OSConfig\Notification Packages</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor OS Config LSA Security Packages" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\OSConfig\Security Packages</TargetObject>
			<!--MITRE ATT&CK TECHNIQUE: Boot or Logon Initialization Scripts-->
			<!--MITRE ATT&CK TECHNIQUE: Create or Modify System Process-->
			<!--MITRE ATT&CK TECHNIQUE: Domain Policy Modification-->
			<!--MITRE ATT&CK TECHNIQUE: Escape to Host-->
			<!--MITRE ATT&CK TECHNIQUE: Event Triggered Execution-->
			<!--Microsoft:Windows:COM Object Hijacking [ https://blog.gdatasoftware.com/2014/10/23941-com-object-hijacking-the-discreet-way-of-persistence ] | Credit @ion-storm -->
			<Rule name="Attack=T1546.015,Technique=Event Triggered Execution,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=Suspicious Com Object Hijacking Locations,Risk=30" groupRelation="and">
				<TargetObject condition="contains any">\InprocServer32\(Default);\LocalServer32\(Default);\ScriptletURL\(Default)</TargetObject>
				<Details condition="contains any">C:\Users\Public\;$Recyclebin;\temp\;\Desktop\;\Downloads\;\Content.Outlook\;\Microsoft\Office\</Details>
				<Details condition="excludes">C:\WINDOWS\SYSTEM32\UpdateDeploy.dll</Details>
			</Rule>
			<Rule name="Attack=T1546.015,Technique=Event Triggered Execution,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Com Object Hijacking Locations,Risk=30" groupRelation="and">
				<TargetObject condition="contains any">\InprocServer32\(Default);\LocalServer32\(Default);\ScriptletURL\(Default)</TargetObject>
				<Details condition="excludes">C:\WINDOWS\SYSTEM32\UpdateDeploy.dll</Details>
			</Rule>
			<Rule name="Attack=T1546.015,Technique=Event Triggered Execution,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=TreatAs/ProgID Friendly Name Com Hijacking Evasion - check for following rundll32 -sta,Risk=30" groupRelation="and">
				<TargetObject condition="contains any">\ProgID\(Default);\TreatAs\(Default)</TargetObject>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Event Triggered Execution: Image File Execution Options Injection-->
			<Rule name="Attack=T1183,Technique=Image File Execution Options Injection,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=1,Alert=Image File Execution Options,Risk=30" groupRelation="and">
				<TargetObject condition="contains">\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\</TargetObject>
				<TargetObject condition="contains any">Debugger;ReportingMode;MonitorProcess</TargetObject>
			</Rule>
			<Rule name="Attack=T1183,Technique=Image File Execution Options Injection,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Alert=SilentProcessExit Globalflag Set,Risk=75" groupRelation="and">
				<TargetObject condition="contains">\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\</TargetObject>
				<TargetObject condition="contains">GlobalFlag</TargetObject>
				<Details condition="contains">DWORD (0x00000200)</Details> <!--SilentProcessExit Dword Value-->
			</Rule>
			<Rule name="Attack=T1183,Technique=Image File Execution Options Injection,Tactic=Privilege Escalation/Persistence/Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Alert=SilentProcessExit Process Execution entry,Risk=100" groupRelation="and">
				<TargetObject condition="contains">\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\</TargetObject>
				<TargetObject condition="contains">MonitorProcess</TargetObject> <!--SilentProcessExit Monitor Process from werfault-->
			</Rule>
			<Rule name="Attack=T1183,Technique=Image File Execution Options Injection,Tactic=Privilege Escalation/Persistence/Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Alert=SilentProcessExit Reporting Mode Enabled,Risk=100" groupRelation="and">
				<TargetObject condition="contains">\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\</TargetObject>
				<TargetObject condition="contains">ReportingMode</TargetObject>
				<Details condition="contains">DWORD (0x00000001)</Details> <!--SilentProcessExit Reporting Mode Enabled-->
			</Rule>
			<Rule name="Attack=T1183,Technique=Image File Execution Options Injection,Tactic=Privilege Escalation/Persistence/Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Alert=SilentProcessExit Process Added,Risk=100" groupRelation="and">
				<TargetObject condition="contains">\Microsoft\Windows NT\CurrentVersion\SilentProcessExit</TargetObject>
				<EventType condition="is">CreateKey</EventType>
			</Rule>
			<Rule name="Attack=T1546,Technique=Event Triggered Execution,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=Monitor Runtime Exception Handler execution on crash,Risk=100" groupRelation="and">
				<TargetObject condition="contains">\Microsoft\Windows\Windows Error Reporting\RuntimeExceptionHelperModules\</TargetObject>
				<Image condition="excludes all">C:\Program Files (x86)\Microsoft\EdgeUpdate\Install\{;}\EDGEMITMP_;.tmp\setup.exe</Image>
				<Image condition="excludes">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeClickToRun.exe</Image>
				<Image condition="excludes">C:\Program Files\Microsoft Office\root\integration\integrator.exe</Image>
				<Image condition="excludes all">C:\Program Files\Google\Chrome Beta\Application\;\Installer\setup.exe</Image>
				<Image condition="excludes all">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\Updates\;\OfficeClickToRun.exe</Image>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Exploitation for Privilege Escalation-->
			<!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
			<!--MITRE ATT&CK TECHNIQUE: Process Injection-->
			<!--MITRE ATT&CK TECHNIQUE: Scheduled Task/Job-->
			<Rule name="Attack=T1053,Technique=Scheduled Task,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=New Scheduled Task Created,Risk=80" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree</TargetObject>
				<TargetObject condition="end with">SD</TargetObject>
				<TargetObject condition="is not">Microsoft\Windows\UpdateOrchestrator</TargetObject>
				<TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Windows\Setup\SD</TargetObject>
				<TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\OneDrive Per-Machine Standalone Update Task\SD</TargetObject>
				<TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Office\Office Feature Updates\SD</TargetObject>
				<TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Office\Office Feature Updates Logon\SD</TargetObject>
				<TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Office\Office Performance Monitor\SD</TargetObject>
				<TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Windows\Setup\SnapshotCleanupTask\SD</TargetObject>
				<TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Office\Office ClickToRun Service Monitor\SD</TargetObject>
				<TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Office\Office Automatic Updates 2.0\SD</TargetObject>
				<TargetObject condition="excludes">Microsoft\Windows\UpdateOrchestrator</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Scheduled Task Creation ID Key" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree</TargetObject>
				<TargetObject condition="end with">ID</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Scheduled Task Creation Author Key" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks</TargetObject>
				<TargetObject condition="end with">Author</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Scheduled Task Creation Path Key" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks</TargetObject>
				<TargetObject condition="end with">Path</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Scheduled Task Creation Date Key" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks</TargetObject>
				<TargetObject condition="end with">Date</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Scheduled Task Added to Logon" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Logon</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Scheduled Task Added to Boot Time" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Boot</TargetObject>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->

			<!--MITRE ATT&CK TACTIC: Defense Evasion-->
			<Rule name="Attack=T0000,Technique=Environment Value Modification,Tactic=Defense Evasion/Privilege Escalation,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Environment Value Modification" groupRelation="and">
				<EventType condition="is">SetValue</EventType>
				<TargetObject condition="contains">\Environment\</TargetObject>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Abuse Elevation Control Mechanism-->
			<!--MITRE ATT&CK TECHNIQUE: Abuse Elevation Control Mechanism: Bypass User Account Control-->
			<Rule name="Attack=T1548.002,Technique=Abuse Elevation Control Mechanism: Bypass User Account Control,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=UAC Disablement Detected" groupRelation="and">
				<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\EnableLUA</TargetObject>
				<Details condition="contains">DWORD (0x00000000)</Details>
			</Rule>
			<Rule name="Attack=T1548.002,Technique=Abuse Elevation Control Mechanism: Bypass User Account Control,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=ConsentPromptBehaviorAdmin Disablement Detected" groupRelation="and">
				<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\ConsentPromptBehaviorAdmin</TargetObject>
				<Details condition="contains">DWORD (0x00000000)</Details>
			</Rule>
			<Rule name="Attack=T1548.002,Technique=Abuse Elevation Control Mechanism: Bypass User Account Control,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=PromptOnSecureDesktop Disablement Detected" groupRelation="and">
				<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\PromptOnSecureDesktop</TargetObject>
				<Details condition="contains">DWORD (0x00000000)</Details>
			</Rule>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect UAC Tampering" condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy</TargetObject>
			<TargetObject name="Attack=T1548.002,Technique=Abuse Elevation Control Mechanism: Bypass User Account Control,Tactic=Defense Evasion/Privilege Escalation,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=UAC Bypass,Risk=70" condition="end with">\Software\Microsoft\Windows\CurrentVersion\App Paths\control.exe</TargetObject>
			<TargetObject name="Attack=T1548.002,Technique=Abuse Elevation Control Mechanism: Bypass User Account Control,Tactic=Defense Evasion/Privilege Escalation,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=UAC Bypass,Risk=70" condition="end with">exefile\shell\runas\command\isolatedCommand</TargetObject>			
			<!--MITRE ATT&CK TECHNIQUE: Access Token Manipulation-->
			<!--MITRE ATT&CK TECHNIQUE: BITS Jobs-->
			<!--MITRE ATT&CK TECHNIQUE: Build Image on Host-->
			<!--MITRE ATT&CK TECHNIQUE: Debugger Evasion-->
			<!--MITRE ATT&CK TECHNIQUE: Deobfuscate/Decode Files or Information-->
			<!--MITRE ATT&CK TECHNIQUE: Deploy Container-->
			<!--MITRE ATT&CK TECHNIQUE: Direct Volume Access-->
			<!--MITRE ATT&CK TECHNIQUE: Domain Policy Modification-->
			<!--MITRE ATT&CK TECHNIQUE: Execution Guardrails-->
			<!--MITRE ATT&CK TECHNIQUE: Exploitation for Defense Evasion-->
			<!--MITRE ATT&CK TECHNIQUE: File and Directory Permissions Modification-->
			<!--MITRE ATT&CK TECHNIQUE: Hide Artifacts-->
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Hidden File Explorer Setting modification" condition="end with">\Hidden</TargetObject>
			<Rule name="Attack=T1564.002,Technique=Hide Artifacts: Hidden Users,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=User Account Hidden From Logon Screen,Risk=100" groupRelation="and">
				<TargetObject condition="contains">SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\Userlist\</TargetObject>
				<TargetObject condition="end with">$</TargetObject>
 				<Details condition="contains">DWORD (0x00000000)</Details>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Hijack Execution Flow-->
			<!--MITRE ATT&CK TECHNIQUE: Impair Defenses-->
			<Rule name="Attack=T1562,Technique=Impair Defenses,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Stealth Sysmon Change Detected,Risk=100" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\SysmonDrv\Parameters</TargetObject>
				<Image condition="excludes">C:\WINDOWS\sysmon64.exe</Image>
				<Image condition="excludes">C:\WINDOWS\sysmon.exe</Image>
				<Image condition="excludes">C:\Programdata\sysmon\sysmon64.exe</Image>
				<!--Customize: Add your configuration directory above-->
			</Rule>
			<Rule name="Technique=Disabling Security Tools,Tactic=Defense Evasion,Attack=1089,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Modification to System Exploit Protection,Risk=30" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel</TargetObject>
				<TargetObject condition="contains any">MitigationOptions;MitigationAuditOptions</TargetObject>
			</Rule>
			<Rule name="Technique=Disabling Security Tools,Tactic=Defense Evasion,Attack=1089,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Modification to Per-Process Exploit Protection,Risk=30" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</TargetObject>
				<TargetObject condition="contains any">MitigationOptions;MitigationAuditOptions</TargetObject>
				<TargetObject condition="excludes">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\vmcompute.exe\0\MitigationOptions</TargetObject>
				<TargetObject condition="excludes">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\vmwp.exe\0\MitigationOptions</TargetObject>
				<Image condition="excludes">msiexec.exe</Image>
				<Image condition="excludes">TiWorker.exe</Image>
			</Rule>
			<Rule name="Technique=Disabling Security Tools,Tactic=Defense Evasion,Attack=1089,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Modification to WOW64 Per-Process Exploit Protection Mitigation Options,Risk=30" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</TargetObject>
				<TargetObject condition="contains any">MitigationOptions;MitigationAuditOptions</TargetObject>
				<Image condition="excludes">C:\Program Files\Microsoft Office 15\root\integration\integrator.exe</Image>
				<TargetObject condition="excludes">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\Acro</TargetObject>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Impair Defenses: Disable or Modify Tools-->
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Task Manager Disablement Detection" groupRelation="and">
				<TargetObject condition="end with">DisableTaskMgr</TargetObject>
				<Image condition="excludes">C:\WINDOWS\system32\svchost.exe</Image>
				<Image condition="excludes">C:\windows\SysWOW64\svchost.exe</Image>
			</Rule>
			<Rule name="Attack=T1562.001,Technique=Impair Defenses: Disable or Modify Tools,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Driver Altitude Change Detected - Causes Driver load failure on boot" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\</TargetObject>
				<TargetObject condition="contains all">\Instances\;Altitude</TargetObject>
				<TargetObject condition="is not">HKLM\System\CurrentControlSet\Services\CldFlt\Instances\CldFlt\Altitude</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<!--Detect Malware & Unauthorized Changes to Outlook, Excel, Powerpoint, and Access Security to enable execution of scripts/Macros -->
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=All Office Macros Enabled!,Risk=100" groupRelation="and">
				<TargetObject condition="contains">\Security\Level</TargetObject>
				<Details condition="contains">DWORD (0x00000001)</Details>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Notifications for all macros,Risk=50" groupRelation="and">
				<TargetObject condition="contains">\Security\Level</TargetObject>
				<Details condition="contains">DWORD (0x00000002)</Details>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Notifications for digitally signed macros - all other macros disabled,Risk=0" groupRelation="and">
				<TargetObject condition="contains">\Security\Level</TargetObject>
				<Details condition="contains">DWORD (0x00000003)</Details>
			</Rule>
			<Rule name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=All Office Macros Disabled without notification,Risk=0" groupRelation="and">
				<TargetObject condition="contains">\Security\Level</TargetObject>
				<Details condition="contains">DWORD (0x00000004)</Details>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Outlook Security Changes" groupRelation="and">
				<TargetObject condition="contains">\Outlook\Security</TargetObject>
				<!--Allow Outlook Details rules to fire-->
				<TargetObject condition="excludes">\Security\Level</TargetObject>
			</Rule>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Word Security Changes" condition="contains">\Word\Security</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Excel Security Changes" condition="contains">\Excel\Security</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detected Unauthorized changes to Office Security" condition="contains">\Security\Level1Remove</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Microsoft:Windows:Security Center: HideSCAHealth" condition="end with">\HideSCAHealth</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Security Center AV Disabled Notifications" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\AntiVirusDisableNotify</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Security Center Disable UAC Notify Monitoring" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\UacDisableNotify</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Security Center Disabled Monitoring" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\DisableMonitoring</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Security Center Disabled Monitoring" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\FirewallDisableNotify</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Security Center Disablement of Update notifications" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\UpdatesDisableNotify</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Security Center Firewall Override Monitoring" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\FirewallOverride</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Security Center Tampering: All Alerts Disabled" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\AllAlertsDisabled</TargetObject>
			<TargetObject name="Technique=Disabling Security Tools,Tactic=Defense Evasion,Attack=1089,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Detected disablement of System Restore,Risk=70" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SystemRestore\RPSessionInterval</TargetObject>
			<TargetObject name="Technique=Disabling Security Tools,Tactic=Defense Evasion,Attack=1089,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Detected disablement of System Restore,Risk=70" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SystemRestore\SystemRestorePointCreationFrequency</TargetObject>
			<TargetObject name="Technique=Disabling Security Tools,Tactic=Defense Evasion,Attack=1089,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detected disablement of machine password,Risk=70" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\DisablePasswordChange</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor Secure Channel Protection changes,Risk=30" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\FullSecureChannelProtection</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Refuse PW Change for workstations" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\RefusePasswordChange</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Defender AntiSpyware Disablement Detection" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\DisableAntiSpyware</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Defender Behavior Monitoring Disablement Detection" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableBehaviorMonitoring</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Defender Real Time Protection Disablement Detection" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection\DisableOnAccessProtection</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Defender Spynet Reporting Disablement Detection" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet\SpyNetReporting</TargetObject>
			<!--MITRE ATT&CK TECHNIQUE: Impair Defenses: Disable Windows Event Logging-->
			<Rule name="Attack=T1070.001,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Disabling of Windows Event Log Source,Risk=100" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\</TargetObject>
				<TargetObject condition="end with">\Enabled</TargetObject>
				<Details condition="contains">DWORD (0x00000000)</Details>
			</Rule>
			<Rule name="Attack=T1562.002,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Enabling of Windows Event Log Source" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\</TargetObject>
				<TargetObject condition="end with">\Enabled</TargetObject>
				<Details condition="contains">DWORD (0x00000001)</Details>
			</Rule>
			<Rule name="Attack=T1562.002,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Event log system integrity and ACL Modifications" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\</TargetObject>
				<TargetObject condition="excludes">\Enabled</TargetObject>
			</Rule>
			<Rule name="Attack=T1562.002,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Change Winevt Event Access Permission Via Registry,Author=frack113" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\Channels\</TargetObject>
				<TargetObject condition="end with">\ChannelAccess</TargetObject>
				<Details condition="contains any">(A;;0x1;;;SY);(A;;0x5;;;BA);(A;;0x1;;;LA)</Details>
				<Image condition="excludes any">C:\Windows\servicing\TrustedInstaller.exe;\TiWorker.exe</Image>
			</Rule>
			<Rule name="Attack=T1070.001,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Disabling of Powershell Event Logging,Risk=100" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\Powershell\ScriptBlockLogging</TargetObject>
				<TargetObject condition="end with">\EnableScriptBlockLogging</TargetObject>
				<Details condition="contains">DWORD (0x00000000)</Details>
			</Rule>
			<Rule name="Attack=T1070.001,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Disabling of Powershell Event Logging,Risk=100" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\Powershell\ScriptBlockLogging</TargetObject>
				<TargetObject condition="end with">\EnableScriptBlockLogging</TargetObject>
				<EventType condition="is any">DeleteKey;DeleteValue</EventType>
			</Rule>
			<Rule name="Attack=T1070.001,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Disabling of cmdline Event Logging,Risk=100" groupRelation="and">
				<TargetObject condition="begin with">hklm\software\microsoft\windows\currentversion\policies\system\audit</TargetObject>
				<TargetObject condition="end with">\ProcessCreationIncludeCmdLine_Enabled</TargetObject>
				<Details condition="contains">DWORD (0x00000000)</Details>
			</Rule>
			<Rule name="Attack=T1070.001,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Disabling of cmdline Event Logging,Risk=100" groupRelation="and">
				<TargetObject condition="begin with">hklm\software\microsoft\windows\currentversion\policies\system\audit</TargetObject>
				<TargetObject condition="end with">\ProcessCreationIncludeCmdLine_Enabled</TargetObject>
				<EventType condition="is any">DeleteKey;DeleteValue</EventType>
			</Rule>
			<Rule name="Attack=T1070.001,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Eventlog Security Descriptor Modification,Risk=100" groupRelation="and">
				<TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\Eventlog</TargetObject>
				<TargetObject condition="end with">\CustomSD</TargetObject>
			</Rule>
			<Rule name="Attack=T1070.001,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Eventlog Size Modification,Risk=100" groupRelation="and">
				<TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\Eventlog</TargetObject>
				<TargetObject condition="end with">\MaxSize</TargetObject>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Impair Defenses: Disable or Modify System Firewall-->
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Globally Opened Firewall port exceptions" groupRelation="and">
				<TargetObject condition="contains">globallyopenports</TargetObject>
			</Rule>
			<TargetObject name="Technique=Disabling Security Tools,Tactic=Defense Evasion,Attack=1089,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor Firewall Enablement or Disablement" condition="end with">EnableFirewall</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=App added to Firewall Auth list" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile\AuthorizedApplications\List</TargetObject>

			<!--MITRE ATT&CK TECHNIQUE: Indicator Removal on Host-->
			<Rule name="Attack=T1070,Technique=Impair Defenses: Indicator Removal on Host,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=ETWEnabled Env Tampering,Risk=70" groupRelation="and">
				<TargetObject condition="contains">\Microsoft\.NETFramework\ETWEnabled</TargetObject>
				<Details condition="contains">DWORD (0x00000000)</Details>
			</Rule>
			<Rule name="Attack=T1070,Technique=Impair Defenses: Indicator Removal on Host,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=Usagelog Tampering,Risk=70" groupRelation="and">
				<TargetObject condition="contains">\Microsoft\.NETFramework\NGenAssemblyUsageLog</TargetObject>
			</Rule>
			<Rule name="Attack=T1070,Technique=Impair Defenses: Indicator Removal on Host,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=Usagelog Env Tampering,Risk=70" groupRelation="and">
				<EventType condition="is">SetValue</EventType>
				<TargetObject condition="contains">\Environment\NGenAssemblyUsageLog</TargetObject>
			</Rule>
			<Rule name="Attack=T1070,Technique=Impair Defenses: Indicator Removal on Host,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=COMPlus_ETWEnabled Env Tampering,Risk=70" groupRelation="and">
				<EventType condition="is">SetValue</EventType>
				<TargetObject condition="contains">\Environment\COMPlus_ETWEnabled</TargetObject>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Indirect Command Execution-->
			<!--MITRE ATT&CK TECHNIQUE: Masquerading-->
			<!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
			<!--MITRE ATT&CK TECHNIQUE: Modify Cloud Compute Infrastructure-->
			<!--MITRE ATT&CK TECHNIQUE: Modify Registry-->
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=Regedit history Detection,Risk=30" groupRelation="and">
				<TargetObject condition="end with">\LastKey</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Symbolic Registry Link Created" groupRelation="and">
				<TargetObject condition="contains">SymbolicLinkValue</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Suspicious Location Registry Change Detected" groupRelation="and">
				<TargetObject condition="contains">\Software\Microsoft\Windows\CurrentVersion\Explorer</TargetObject>
				<Image condition="contains any">\AppData\;\ProgramData\;\Temp\;C:\users</Image>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Right to Left hidden Registry key,Risk=40" groupRelation="and">
				<TargetObject condition="contains">&#x202e;</TargetObject>
			</Rule>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor Remote Registry Setting Keys" condition="begin with">HKLM\System\CurrentControlSet\Control\SecurePipeServers\winreg</TargetObject>

			<!--MITRE ATT&CK TECHNIQUE: Modify System Image-->
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect System Certificate Modifications" groupRelation="and">
				<TargetObject condition="contains any">\Software\Policies\Microsoft\SystemCertificates\;\SOFTWARE\Microsoft\EnterpriseCertificates\;HKLM\SOFTWARE\Microsoft\SystemCertificates\;HKLM\Software\Microsoft\Cryptography\Services\ServiceName\SystemCertificates\</TargetObject>
				<EventType condition="is not">CreateKey</EventType>
				<Image condition="excludes">C:\WINDOWS\Sysmon64.exe</Image>
				<Image condition="excludes">C:\WINDOWS\Sysmon.exe</Image>
				<Image condition="excludes">C:\WINDOWS\system32\certsrv.exe</Image>
				<Image condition="excludes">C:\WINDOWS\system32\CompatTelRunner.exe</Image>
				<Image condition="excludes">C:\WINDOWS\system32\svchost.exe</Image>
				<Image condition="excludes">C:\Windows\SysWOW64\SearchProtocolHost.exe</Image>
				<Image condition="excludes">C:\Windows\system32\SearchProtocolHost.exe</Image>
				<Image condition="excludes">C:\Windows\system32\taskhost.exe</Image>
				<Image condition="excludes">C:\windows\SysWOW64\svchost.exe</Image>
				<Image condition="excludes">C:\WINDOWS\System32\DriverStore\FileRepository\asus</Image>
				<Image condition="excludes">C:\ProgramData\Microsoft\Windows Defender\Platform\</Image>
				<Image condition="excludes">C:\Program Files\ASUS\ARMOURY CRATE Service\ArmouryCrate.Service.exe</Image>
				<Image condition="excludes">C:\Program Files\NVIDIA Corporation\NvContainer\nvcontainer.exe</Image>
			</Rule>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Remote Desktop fDenyTSConnections modification" condition="contains">fDenyTSConnections</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Remote Desktop Settings keys" condition="contains">Terminal Server\WinStations\RDP-Tcp</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Remote Desktop port modification" condition="end with">RDP-tcp\PortNumber</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Enablement of Multiple RDP Sessions" condition="end with">Control\Terminal Server\fSingleSessionPerUser</TargetObject>
			<!--MITRE ATT&CK TECHNIQUE: Network Boundary Bridging-->
			<!--MITRE ATT&CK TECHNIQUE: Obfuscated Files or Information-->
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Unicode Replacement Character in Registry key,Risk=20" groupRelation="and">
				<TargetObject condition="contains">&#xfffd;</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Cryillic Character in Registry key,Risk=100" groupRelation="and">
				<TargetObject condition="contains any">Й;ќ;Л;я;К</TargetObject>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Plist File Modification-->
			<!--MITRE ATT&CK TECHNIQUE: Pre-OS Boot-->
			<!--MITRE ATT&CK TECHNIQUE: Process Injection-->
			<!--MITRE ATT&CK TECHNIQUE: Reflective Code Loading-->
			<!--MITRE ATT&CK TECHNIQUE: Rogue Domain Controller-->
			<!--MITRE ATT&CK TECHNIQUE: Rootkit-->
			<TargetObject name="Attack=T1109,Technique=Component Firmware,Tactic=Defense Escalation/Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect ACPI Rootkits" condition="begin with">HKLM\HARDWARE\ACPI\DSDT</TargetObject>
			<!--MITRE ATT&CK TECHNIQUE: Subvert Trust Controls-->
			<!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution-->
			<!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: Regsvr32-->
			<!--MITRE ATT&CK TECHNIQUE: System Binary Proxy Execution: MsiExec-->
			<!--MITRE ATT&CK TECHNIQUE: System Script Proxy Execution-->
			<!--MITRE ATT&CK TECHNIQUE: Template Injection-->
			<!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
			<!--MITRE ATT&CK TECHNIQUE: Trusted Developer Utilities Proxy Execution-->
			<!--MITRE ATT&CK TECHNIQUE: Unused/Unsupported Cloud Regions-->
			<!--MITRE ATT&CK TECHNIQUE: Use Alternate Authentication Material-->
			<!--MITRE ATT&CK TECHNIQUE: Valid Accounts-->
			<!--MITRE ATT&CK TECHNIQUE: Virtualization/Sandbox Evasion-->
			<!--MITRE ATT&CK TECHNIQUE: Weaken Encryption-->
			<!--MITRE ATT&CK TECHNIQUE: XSL Script Processing-->

			<!--MITRE ATT&CK TACTIC: Credential Access-->
			<!--MITRE ATT&CK TECHNIQUE: Adversary-in-the-Middle-->
			<!--MITRE ATT&CK TECHNIQUE: Brute Force-->
			<!--MITRE ATT&CK TECHNIQUE: Credentials from Password Stores-->
			<!--MITRE ATT&CK TECHNIQUE: Exploitation for Credential Access-->
			<!--MITRE ATT&CK TECHNIQUE: Forced Authentication-->
			<!--MITRE ATT&CK TECHNIQUE: Forge Web Credentials-->
			<!--MITRE ATT&CK TECHNIQUE: Input Capture-->
			<!--MITRE ATT&CK TECHNIQUE: Modify Authentication Process-->
			<!--MITRE ATT&CK TECHNIQUE: Multi-Factor Authentication Interception-->
			<!--MITRE ATT&CK TECHNIQUE: Multi-Factor Authentication Request Generation-->
			<!--MITRE ATT&CK TECHNIQUE: Network Sniffing-->
			<!--MITRE ATT&CK TECHNIQUE: OS Credential Dumping-->
			<!--MITRE ATT&CK TECHNIQUE: Steal Application Access Token-->
			<!--MITRE ATT&CK TECHNIQUE: Steal or Forge Kerberos Tickets-->
			<!--MITRE ATT&CK TECHNIQUE: Steal Web Session Cookie-->
			<!--MITRE ATT&CK TECHNIQUE: Unsecured Credentials-->
			<!--MITRE ATT&CK TECHNIQUE: Unsecured Credentials: Credentials in Registry-->
			<TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Account Name</TargetObject>
			<TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Display Name</TargetObject>
			<TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Email</TargetObject>
			<TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\HTTP User</TargetObject>
			<TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\IMAP User</TargetObject>
			<TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\MAPI Provider</TargetObject>
			<TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\POP3 User</TargetObject>
			<TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\SMTP User</TargetObject>
			<TargetObject name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Credentials in Registry,DS=Windows Registry: Windows Registry Key Modification,Risk=100" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\DefaultPassword</TargetObject>
			<TargetObject name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Credentials in Registry,DS=Windows Registry: Windows Registry Key Modification,Risk=100" condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\HTTP Password</TargetObject>
			<TargetObject name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Credentials in Registry,DS=Windows Registry: Windows Registry Key Modification,Risk=100" condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\IMAP Password</TargetObject>
			<TargetObject name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Credentials in Registry,DS=Windows Registry: Windows Registry Key Modification,Risk=100" condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\POP3 Password</TargetObject>
			<TargetObject name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Credentials in Registry,DS=Windows Registry: Windows Registry Key Modification,Risk=100" condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\SMTP Password</TargetObject>
			<TargetObject name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,Desc=Credentials in Registry,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Credentials in Registry: Domain" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\DefaultDomainName</TargetObject>
			<TargetObject name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,Desc=Credentials in Registry,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Credentials in Registry: Username" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\DefaultUserName</TargetObject>
			<TargetObject name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Teamviewer Password Exposed in Plain Text 1,Risk=70" condition="contains">SecurityPasswordAES</TargetObject>
			<TargetObject name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Teamviewer Password Exposed in Plain Text 2,Risk=70" condition="contains">OptionsPasswordAES</TargetObject>
			<TargetObject name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Teamviewer Password Exposed in Plain Text 3,Risk=70" condition="contains">SecurityPasswordExported</TargetObject>
			<TargetObject name="Attack=T1214,Technique=Credentials in Registry,Tactic=Credential Access,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Teamviewer Password Exposed in Plain Text 4,Risk=70" condition="contains">PermanentPassword</TargetObject>
			<!--MITRE ATT&CK TACTIC: Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Account Discovery -->
			<!--MITRE ATT&CK TECHNIQUE: Application Window Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Browser Bookmark Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Cloud Infrastructure Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Cloud Service Dashboard-->
			<!--MITRE ATT&CK TECHNIQUE: Cloud Service Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Cloud Storage Object Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Container and Resource Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Debugger Evasion-->
			<!--MITRE ATT&CK TECHNIQUE: Domain Trust Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: File and Directory Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Group Policy Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Network Service Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Network Share Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Network Sniffing-->
			<!--MITRE ATT&CK TECHNIQUE: Password Policy Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Peripheral Device Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Permission Groups Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Process Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Query Registry-->
			<!--MITRE ATT&CK TECHNIQUE: Remote System Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Software Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: System Information Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: System Location Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: System Network Configuration Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: System Network Connections Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: System Owner/User Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: System Service Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: System Time Discovery-->
			<!--MITRE ATT&CK TECHNIQUE: Virtualization/Sandbox Evasion-->

			<!--MITRE ATT&CK TACTIC: Lateral Movement-->
			<!--MITRE ATT&CK TECHNIQUE: Exploitation of Remote Services-->
			<!--MITRE ATT&CK TECHNIQUE: Internal Spearphishing-->
			<!--MITRE ATT&CK TECHNIQUE: Lateral Tool Transfer-->
			<!--MITRE ATT&CK TECHNIQUE: Remote Service Session Hijacking-->
			<!--MITRE ATT&CK TECHNIQUE: Remote Services-->

			<!--MITRE ATT&CK TECHNIQUE: Replication Through Removable Media-->
			<!--MITRE ATT&CK TECHNIQUE: Software Deployment Tools-->
			<!--MITRE ATT&CK TECHNIQUE: Taint Shared Content-->
			<!--MITRE ATT&CK TECHNIQUE: Use Alternate Authentication Material-->

			<!--MITRE ATT&CK TACTIC: Collection-->
			<!--MITRE ATT&CK TECHNIQUE: Adversary-in-the-Middle-->
			<!--MITRE ATT&CK TECHNIQUE: Archive Collected Data-->
			<!--MITRE ATT&CK TECHNIQUE: Audio Capture-->
			<!--MITRE ATT&CK TECHNIQUE: Automated Collection-->
			<!--MITRE ATT&CK TECHNIQUE: Browser Session Hijacking-->
			<!--MITRE ATT&CK TECHNIQUE: Clipboard Data-->
			<!--MITRE ATT&CK TECHNIQUE: Data from Cloud Storage Object-->
			<!--MITRE ATT&CK TECHNIQUE: Data from Configuration Repository-->
			<!--MITRE ATT&CK TECHNIQUE: Data from Information Repositories-->
			<!--MITRE ATT&CK TECHNIQUE: Data from Local System-->
			<!--MITRE ATT&CK TECHNIQUE: Data from Network Shared Drive-->
			<!--MITRE ATT&CK TECHNIQUE: Data from Removable Media-->
			<!--MITRE ATT&CK TECHNIQUE: Data Staged-->
			<!--MITRE ATT&CK TECHNIQUE: Email Collection-->
			<!--MITRE ATT&CK TECHNIQUE: Input Capture-->
			<!--MITRE ATT&CK TECHNIQUE: Screen Capture-->
			<!--MITRE ATT&CK TECHNIQUE: Video Capture-->

			<!--MITRE ATT&CK TACTIC: Command and Control-->
			<!--MITRE ATT&CK TECHNIQUE: Application Layer Protocol-->
			<!--MITRE ATT&CK TECHNIQUE: Communication Through Removable Media-->
			<!--MITRE ATT&CK TECHNIQUE: Data Encoding-->
			<!--MITRE ATT&CK TECHNIQUE: Data Obfuscation-->
			<!--MITRE ATT&CK TECHNIQUE: Dynamic Resolution-->
			<!--MITRE ATT&CK TECHNIQUE: Encrypted Channel-->
			<!--MITRE ATT&CK TECHNIQUE: Fallback Channels-->
			<!--MITRE ATT&CK TECHNIQUE: Ingress Tool Transfer-->
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Git For Windows Detection: Revil: Sodinokibi,Risk=50" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\GitForWindows</TargetObject>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Multi-Stage Channels-->
			<!--MITRE ATT&CK TECHNIQUE: Non-Application Layer Protocol-->
			<!--MITRE ATT&CK TECHNIQUE: Non-Standard Port-->
			<!--MITRE ATT&CK TECHNIQUE: Protocol Tunneling-->
			<!--MITRE ATT&CK TECHNIQUE: Proxy-->
			<!--MITRE ATT&CK TECHNIQUE: Remote Access Software-->
			<!--MITRE ATT&CK TECHNIQUE: Traffic Signaling-->
			<!--MITRE ATT&CK TECHNIQUE: Web Service-->

			<!--MITRE ATT&CK TACTIC: Exfiltration-->

			<!--MITRE ATT&CK TECHNIQUE: Automated Exfiltration-->
			<!--MITRE ATT&CK TECHNIQUE: Data Transfer Size Limits-->
			<!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Alternative Protocol-->
			<!--MITRE ATT&CK TECHNIQUE: Exfiltration Over C2 Channel-->
			<!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Other Network Medium-->
			<!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Physical Medium-->
			<!--MITRE ATT&CK TECHNIQUE: Exfiltration Over Web Service-->
			<!--MITRE ATT&CK TECHNIQUE: Scheduled Transfer-->
			<!--MITRE ATT&CK TECHNIQUE: Transfer Data to Cloud Account-->
			<!--MITRE ATT&CK TACTIC: Impact-->
			<!--MITRE ATT&CK TECHNIQUE: Account Access Removal-->
			<Rule name="Attack=T1531,Technique=Account Access Removal,Tactic=Impact,DS=Windows Registry: Windows Registry Key Deletion,Level=1,Desc=User Account Deleted" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SAM\SAM\DOMAINS\Account\Users\Names\</TargetObject>
				<EventType condition="is">DeleteKey</EventType>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Data Destruction-->
			<Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=0,Desc=Bitlocker Drive Encryption Enabled on System Drive" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\BitlockerStatus\BootStatus</TargetObject>
				<Details condition="contains">DWORD (0x00000001)</Details>
			</Rule>
			<Rule name="Attack=T1485,Technique=Data Destruction,Tactic=Impact,DS=Process: Process Creation,Level=0,Alert=Bitlocker Drive Encryption Disabled on System Drive" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\BitlockerStatus\BootStatus</TargetObject>
				<Details condition="contains">DWORD (0x00000000)</Details>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Data Encrypted for Impact-->
			<!--MITRE ATT&CK TECHNIQUE: Data Manipulation-->
			<!--MITRE ATT&CK TECHNIQUE: Defacement-->
			<!--MITRE ATT&CK TECHNIQUE: Disk Wipe-->
			<!--MITRE ATT&CK TECHNIQUE: Endpoint Denial of Service-->
			<!--MITRE ATT&CK TECHNIQUE: Firmware Corruption-->
			<!--MITRE ATT&CK TECHNIQUE: Inhibit System Recovery-->
			<Rule name="Attack=T1485,Technique=Inhibit System Recovery,Tactic=Impact,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=VSS Disablement Detection,Risk=70" groupRelation="and">
				<TargetObject condition="contains">\Services\VSS\Diag\(Default)</TargetObject>
			</Rule>
			<!--MITRE ATT&CK TECHNIQUE: Network Denial of Service-->
			<!--MITRE ATT&CK TECHNIQUE: Resource Hijacking-->
			<!--MITRE ATT&CK TECHNIQUE: Service Stop-->
			<!--MITRE ATT&CK TECHNIQUE: System Shutdown/Reboot-->
			<!-- UEBA/Uncategorized Detections-->
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Lanmanserver Parameters Registry Change Detected" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Lanmanworkstation Parameters Registry Change Detected" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\Lanmanworkstation\Parameters</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=Regedit history Detection,Risk=30" groupRelation="and">
				<TargetObject condition="end with">\LastKey</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=TS Farm Disable RDP Detection" groupRelation="and">
				<TargetObject condition="end with">\WinStationsDisabled</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=TS Farm Drain Mode Modification Detection" groupRelation="and">
				<TargetObject condition="end with">\TSServerDrainMode</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=IE history Detection" groupRelation="and">
				<TargetObject condition="end with">\TypedURLs</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=IPv6 Changes detected: Disabled Components" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\services\TCPIP6\Parameters\disabledcomponents</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=IPv6 Changes detected" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\Tcpip6\Linkage\Bind</TargetObject>
				<Details condition="excludes">Binary Data</Details>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Network Card Changes detected" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkCards</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Service Listening Ports with URL ACL INFO" groupRelation="and">
				<TargetObject condition="contains">services\http\parameters\urlaclinf</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=Adobe Recent File List History" groupRelation="and">
				<TargetObject condition="contains">cRecentFiles\c1\</TargetObject>
				<TargetObject condition="end with">tDIText</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=Office History MRU" groupRelation="and">
				<TargetObject condition="end with">\File MRU\Item 1</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Sysmon Config Hash Modification Monitoring" groupRelation="and">
				<TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\SysmonDrv\Parameters\ConfigHash</TargetObject>
			</Rule>
			<!--Common Malware Persistence locations-->
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Registry AutoRun Keys,Risk=70" condition="begin with">HKLM\SOFTWARE\Classes\ CLSID\{73E709EA-5D93-4B2E-BBB0-99B7938DA9E4}\LocalServer32</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Registry AutoRun Keys,Risk=70" condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Registry AutoRun Keys,Risk=70" condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\RunService</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Registry AutoRun Keys,Risk=70" condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Registry AutoRun Keys,Risk=70" condition="contains">CurrentVersion\Windows\Load</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Registry AutoRun Keys,Risk=70" condition="contains">CurrentVersion\Windows\Run</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Registry AutoRun Keys,Risk=70" condition="contains">CurrentVersion\Winlogon\Shell</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Registry AutoRun Keys,Risk=70" condition="contains">CurrentVersion\Winlogon\System</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Registry AutoRun Keys,Risk=70" condition="contains">\Software\Microsoft\Windows NT\CurrentVersion\Windows\load</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Registry AutoRun Keys,Risk=70" condition="contains">\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Registry AutoRun Keys,Risk=70" condition="contains">\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</TargetObject>
			<TargetObject name="Attack=T1562.006,Technique=Impair Defenses: Indicator Blocking,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=ETW Tampering,Risk=70" condition="end with">SOFTWARE\Microsoft\.NETFramework\ETWEnabled</TargetObject>
			<TargetObject condition="contains">\Group Policy\Scripts</TargetObject>
			<TargetObject name="Attack=T1060,Technique=Registry Autorun Keys,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=2,Alert=AutoRun Keys,Risk=70" condition="contains">Terminal Server\Wds\rdpwd\StartupPrograms</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Alternate Shell AvailableShells Hijack" condition="contains">Winlogon\AlternateShells\AvailableShells</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Alternative Shell Policy" condition="contains">Policies\System\Shell</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=AutoStart on Connect" condition="contains">Windows CE Services\AutoStartOnConnect</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=AutoStart on Disconnect" condition="contains">Windows CE Services\AutoStartOnDisconnect</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Chrome Extensions" condition="contains">PreferenceMACs\Default\extensions.settings</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=CurrentVersion URL Key" condition="contains">CurrentVersion\URL</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Font Drivers" condition="end with">\CurrentVersion\Font Drivers</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Group Policy Shutdown scripts" condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Shutdown</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Icon Service Lib" condition="contains">CurrentVersion\Windows\IconServiceLib</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Installed Components" condition="contains">Active Setup\Installed Components</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Lateral Movement: New Named Pipe added to NullSession" condition="contains">NullSessionShares</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Lateral Movement: New Named Pipe added to NullSession" condition="end with">NullSessionPipes</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Password Expiry Info" condition="contains">PasswordExpiryNotification</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Safeboot Alternative Shell hijack" condition="contains">SafeBoot\AlternateShell</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Screen Save on Desktop" condition="contains">Desktop\Scrnsave.exe</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Software Installed or DisplayVersion modified" condition="end with">\DisplayVersion</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Software Installed or Modify String modified" condition="end with">\ModifyPath</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Software Installed or Uninstall String modified" condition="contains">\Microsoft\Windows\CurrentVersion\Uninstall\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Software Installed or Uninstall String modified" condition="end with">\UninstallString</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Terminal Services Initial Program Key" condition="contains">Terminal Server\WinStations\RDP-Tcp\InitialProgram</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Winlogon Taskman Key" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Taskman</TargetObject>
			<!--CLSID launch commands and file association changes-->
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=File Extension Mapping" condition="contains">\Explorer\FileExts\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Command Shell install Key" condition="contains">\shell\install\command\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=User SID History for Forensics" condition="end with">\ProfileImagePath</TargetObject>
			<!--Windows shell hijack-->
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=AllFileSystemObjects Classes" condition="contains">\Classes\AllFilesystemObjects\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Asterisk Classes" condition="contains">\Classes\*\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=CFT LangBarAddin" condition="contains">\Software\Microsoft\Ctf\LangBarAddin</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=ContextMenuHandlers" condition="contains">\ContextMenuHandlers\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=CurrentVersion Shell Keys" condition="contains">\CurrentVersion\Shell</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect ShellExecuteHooks" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\explorer\ShellIconOverlayIdentifiers</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Directory Classes" condition="contains">\Classes\Directory\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Drive Classes" condition="contains">\Classes\Drive\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Explorer Shell Execute Hooks" condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\explorer\ShellExecuteHooks</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Folder Classes" condition="contains">\Classes\Folder\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Hidden File Explorer Setting modification" condition="end with">\Hidden</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Hidden File Extensions Explorer Setting modification" condition="end with">\HideFileExt</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Internet Explorer Desktop Components" condition="contains">\SOFTWARE\Microsoft\Internet Explorer\Desktop\Components</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Protocol Filter Classes" condition="contains">\SOFTWARE\Classes\Protocols\Filter</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Protocol Handler Classes" condition="contains">\SOFTWARE\Classes\Protocols\Handler</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=SharedTaskScheduler" condition="contains">\SharedTaskScheduler</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Super Hidden File Explorer Setting modification" condition="end with">\ShowSuperHidden</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Shell Hijack: ColumnHandlers" condition="contains">\ColumnHandlers</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Shell Hijack: CopyHookHandlers" condition="contains">\CopyHookHandlers</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Shell Hijack: ExtShellFolderView" condition="contains">\ExtShellFolderViews</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Shell Hijack: PropertySheetHandlers" condition="contains">\PropertySheetHandlers</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Shell Hijack: ShellServiceObjectDelayLoad" condition="contains">\ShellServiceObjectDelayLoad</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Shell Hijack: ShellServiceObjects" condition="contains">\ShellServiceObjects</TargetObject>
			<!--AppPaths hijacking-->
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect AppPaths Hijacking,Author=Hexacorn" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect AppPaths Hijacking,Author=Hexacorn" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\AppCertDlls\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect AppPaths Hijacking,Author=Hexacorn" condition="begin with">HKLM\System\CurrentControlSet\Control\Session Manager\S0InitialCommand</TargetObject>
			<!--Terminal service boobytraps-->
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Terminal Services BoobyTraps" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp\InitialProgram</TargetObject>
			<!--Group Policy interity-->
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Group Policy interity Detection" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\</TargetObject>
			<!--Winsock and Winsock2-->
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect IE Popup Blocker Changes" condition="end with">\3\1809</TargetObject> 
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect IE Protected Mode Changes" condition="end with">\3\2500</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect IE Scripting Mode in Internet Zone Changes" condition="end with">\3\1206</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect IE Security Setting Check Warning Changes" condition="end with">\DisableSecuritySettingsCheck</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Winsock Catalog Changes" condition="begin with">HKLM\System\CurrentControlSet\Services\WinSock2\Parameters\NameSpace_Catalog5\Catalog_Entries64</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Winsock Catalog Changes" condition="begin with">HKLM\System\CurrentControlSet\Services\WinSock2\Parameters\Protocol_Catalog9\Catalog_Entries64</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Winsock Catalog Changes" condition="begin with">HKLM\System\CurrentControlSet\Services\WinSock2\Parameters\Protocol_Catalog9\Catalog_Entries</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Winsock Changes" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WinSock\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Winsock Proxy Server Changes" condition="end with">\ProxyServer</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detected IE Legacy setting modifications" condition="end with">SavedLegacySettings</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detected IE Proxy setting modifications" condition="contains">Software\Microsoft\Windows\CurrentVersion\Internet Settings\Proxy</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detected Modifications of Console Tracing" condition="end with">EnableConsoleTracing</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detected Modifications of File Tracing" condition="end with">EnableFileTracing</TargetObject>
			<!--Credential providers-->
			<TargetObject name="Attack=T1177,Tactic=Execution/Persistence,Technique=LSASS Driver,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=Detection of Modification of LSASS Protection" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\RunAsPPL</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Authentication PLAP Provider Changes" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\PLAP Providers</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Authentication Provider Changes" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\Credential Provider</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Credential provider Filter Changes" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\Credential Provider Filters</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect LSA Credential Provider Changes" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect NETSH Helper DLL Changes" condition="begin with">HKLM\SOFTWARE\Microsoft\Netsh</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Security Provider Changes" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SecurityProviders\</TargetObject>
			<!--Networking-->
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor Network Interface Priority ordering" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\NetworkProvider\Order\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=Monitor Network History" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles</TargetObject>
			<!--DLLs that get injected into every process launch-->
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=AppInitDLL Moninitoring: DLLs that get injected into every process launch" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\Appinit_Dlls\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=AppInitDLL Moninitoring: DLLs that get injected into every process launch" condition="begin with">HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Windows\Appinit_Dlls\</TargetObject>
			<!--Office-->
			<!--Microsoft Office-->
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Office Test Autorun Location Monitoring,Risk=40,Author=Hexacorn" condition="contains">Office Test\</TargetObject>
			<!--IE-->
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Changes to Internet Explorer Toolbars" condition="contains">\Internet Explorer\Toolbar\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Changes to Internet Explorer Extensions" condition="contains">\Internet Explorer\Extensions\</TargetObject>
			<!--Magic registry keys-->
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Browser Helper Object Modifications" condition="contains">\Browser Helper Objects\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Changes to Thumbnail cache autostart" condition="contains">{AB8902B4-09CA-4bb6-B78D-A8F59079A8D5}\</TargetObject>
			<!--Infection artifacts-->
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=ClickOnce URL Update Artifact" condition="end with">\UrlUpdateInfo</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Installer Source Artifact" condition="end with">\InstallSource</TargetObject>
			<!--Windows internals integrity monitoring-->
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Legacy Drivers Loaded" condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows NT\CurrentVersion\Drivers32</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect System Policy Changes" condition="contains">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Windows Defender Policy Changes" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\</TargetObject>
			<TargetObject name="Attack=T1562.001,Technique=Impair Defenses: Disable or Modify Tools,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Detect Windows Defender Exclusion Path Changes,Risk=100" condition="contains">\Exclusions\Paths</TargetObject>
			<TargetObject name="Attack=T1562.001,Technique=Impair Defenses: Disable or Modify Tools,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Detect Windows Defender Exclusion Extension Changes,Risk=100" condition="contains">\Exclusions\Extensions</TargetObject>
			<TargetObject name="Attack=T1562.001,Technique=Impair Defenses: Disable or Modify Tools,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Detect Windows Defender Exclusion Processes Changes,Risk=100" condition="contains">\Exclusions\Processes</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Windows Defender Tamper Protection Modifications" condition="begin with">TamperProtection</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect malware changes to UAC prompt level" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\</TargetObject>
			<!--Group Policy Scripts-->
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Group Policy Logoff Scripts" condition="contains">\Software\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Logoff</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Group Policy Logoff Scripts" condition="contains">\Software\Policies\Microsoft\Windows\System\Scripts\Logoff</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Group Policy Logon Scripts" condition="contains">\Software\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Logon</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Group Policy Logon Scripts" condition="contains">\Software\Policies\Microsoft\Windows\System\Scripts\Logon</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Group Policy Shutdown Scripts" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\State\Machine\Scripts\Shutdown</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Group Policy Shutdown Scripts" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\System\Scripts\Shutdown</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Group Policy Startup Scripts" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\State\Machine\Scripts\Startup</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Group Policy Startup Scripts" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\System\Scripts\Startup</TargetObject>
			<!--Detect Network History-->
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect AD Domain Change" condition="end with">Domain</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect DHCP Default Gateway" condition="end with">DHCPDefaultGateway</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect DHCP IP Address" condition="end with">DhcpIPAddress</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect DHCP Name Server Changes" condition="end with">DhcpNameserver</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect DHCP Server Change" condition="end with">Dhcpserver</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect DHCP Subnet mask Change" condition="end with">DhcpSubnetMask</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect DNS Server Changes" condition="end with">Nameserver</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Default Gateway" condition="end with">\DefaultGateway</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Network Persistent Route Change" condition="end with">PersistentRoutes</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Network Type Change" condition="end with">}\Category</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Network profile Changes" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect Subnet Mask Change" condition="end with">SubnetMask</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=User added Macro document to Trusted Records,Risk=30" condition="contains">\Trusted Documents\TrustRecords</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=User added Macro document to Trusted Records 2,Risk=30" condition="contains">Software\Microsoft\VBA\7.1\Common</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=User added Macro trusted certificate,Risk=30" condition="contains">Software\Microsoft\VBA\7.1\Trusted</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Office Security Settings: Monitor changes of security prompts" condition="contains">\Security\DontTrustInstalledFiles</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Office Trusted Location Changes" condition="contains">\Security\Trusted Locations</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Office Keys: Monitor Disabling of Internet files in Protected View" condition="end with">Security\ProtectedView\DisableInternetFilesInPV</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Office Keys: Monitor Disabling of attackments in Protected View" condition="end with">Security\ProtectedView\DisableAttachmentsInPV</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Office Keys: Monitor Disabling of Unsafe Locations in Protected View" condition="end with">Security\ProtectedView\DisableUnsafeLocationsInPV</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=WinRAR History" condition="contains">Software\WinRAR\ArcHistory</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=Winzip History" condition="contains">WinZip\mru\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=Misc Recent File List History" condition="contains">Recent File List</TargetObject>
			<TargetObject name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=Office Homepage Attack,Risk=70" condition="contains">Outlook\WebView\Inbox</TargetObject>
			<TargetObject name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=Office Homepage Attack,Risk=70" condition="contains">Outlook\Today\UserDefinedUrl</TargetObject>
			<TargetObject name="Attack=T1203,Technique=Exploitation for Client Execution,Tactic=Execution,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=Office Calendar Homepage Attack,Risk=70" condition="contains">Outlook\WebView\Calendar</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=Office History" condition="contains">\Place MRU</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache InvDB-CompileTimeClaim" condition="end with">\LinkDate</TargetObject>
			<TargetObject name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache InvDB-DriverVer" condition="end with">\DriverVerVersion</TargetObject>
			<TargetObject name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache InvDB-DriverVer" condition="end with">\DriverVersion</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache InvDB-Path" condition="end with">\LowerCaseLongPath</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache InvDB-Pub" condition="end with">\Publisher</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache InvDB-Store" condition="contains">Compatibility Assistant\Store\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache InvDB-Ver" condition="end with">\BinProductVersion</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache Application Shortcuts" condition="contains">Root\InventoryApplicationShortcut\</TargetObject>
			<TargetObject name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache Driver Binary Info" condition="contains">Root\InventoryDriverBinary</TargetObject>
			<TargetObject name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache Driver Package Info" condition="contains">Root\InventoryDriverPackage</TargetObject>
			<TargetObject name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache PNP Device Info,Desc=Services: New or Updated Drivers" condition="contains">Root\InventoryDevicePnp</TargetObject>
			<TargetObject name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache Device Info" condition="contains">Root\InventoryDeviceContainer</TargetObject>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache Application Installation Info" groupRelation="and">
				<TargetObject condition="contains">Root\InventoryApplication\</TargetObject>
				<TargetObject condition="contains any">ProgramID;Name;Version;Publisher;Language;InstallDate;Source;RootDirPath;HiddenArp;UninstallString;RegistryKeyPath;UserSID;sha256</TargetObject>
			</Rule>			
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache Application File Info" groupRelation="and">
				<TargetObject condition="contains">Root\InventoryApplicationFile\</TargetObject>
				<TargetObject condition="contains any">ProgramId;FileId;LowerCaseLongPath;Name;OriginalFileName;Publisher;Version;binfileversion;LinkDate;Size;Language;USN;IsPeFile;IsOsComponent;sha256;AppxPackageFullName</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache AppV Application Inventory" groupRelation="and">
				<TargetObject condition="contains">Root\InventoryApplicationAppV\</TargetObject>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AmCache Office Information" groupRelation="and">
				<TargetObject condition="contains any">Root\InventoryMiscellaneousOfficeAddIn;Root\InventoryMiscellaneousOfficeIdentifiers;Root\InventoryMiscellaneousOfficeIESettings;Root\InventoryMiscellaneousOfficeInsights;Root\InventoryMiscellaneousOfficeProducts;Root\InventoryMiscellaneousOfficeSettings;Root\InventoryMiscellaneousOfficeVBA;Root\InventoryMiscellaneousOfficeVBARuleViolations</TargetObject>
			</Rule>
			<Rule name="Attack=T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=ISO Drive Mounted" groupRelation="and">
				<TargetObject condition="contains">\Software\Microsoft\Windows\CurrentVersion\Explorer\CD Burning\Drives\Volume</TargetObject>
				<TargetObject condition="end with">Drive Type</TargetObject>
				<Details condition="contains">DWORD (0x00000011)</Details>
			</Rule>
			<TargetObject name="Attack=T1200,Technique=Hardware Additions,Tactic=Initial Access,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=User Mount Points" condition="end with">\Explorer\MountPoints2</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Monitor DOS Devices Virtual Registry Paths" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\DOS Devices</TargetObject>
			<Rule name="Attack=T1489,Technique=Service Stop,Tactic=Impact,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Service Set for Deletion" groupRelation="and">
				<TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
				<TargetObject condition="end with">\DeleteFlag</TargetObject>
				<Details condition="contains">DWORD (0x00000001)</Details>
			</Rule>
			<Rule name="Attack=Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: New Kernel Device Driver" groupRelation="and">
				<TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
				<TargetObject condition="end with">\Type</TargetObject>
				<Details condition="contains">DWORD (0x00000001)</Details>
			</Rule>
			<Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: New File System Driver" groupRelation="and">
				<TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
				<TargetObject condition="end with">\Type</TargetObject>
				<Details condition="contains">DWORD (0x00000002)</Details>
			</Rule>
			<Rule name="Attack=Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: New Adapter Driver" groupRelation="and">
				<TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
				<TargetObject condition="end with">\Type</TargetObject>
				<Details condition="contains">DWORD (0x00000004)</Details>
			</Rule>
			<Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Alert=Services: New System Service: Own Process" groupRelation="and">
				<TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
				<TargetObject condition="end with">\Type</TargetObject>
				<Details condition="contains">DWORD (0x00000020)</Details>
			</Rule>
			<Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Alert=Services: New System Service: Share Process" groupRelation="and">
				<TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
				<TargetObject condition="end with">\Type</TargetObject>
				<Details condition="contains">DWORD (0x00000020)</Details>
			</Rule>
			<Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Alert=Services: New System Service: Interactive" groupRelation="and">
				<TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
				<TargetObject condition="end with">\Type</TargetObject>
				<Details condition="contains">DWORD (0x00000100)</Details>
			</Rule>
			<Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Monitor Driver Group" groupRelation="and">
				<TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
				<TargetObject condition="end with">\Group</TargetObject>
			</Rule>
			<Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Monitor Driver DependOnService" groupRelation="and">
				<TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
				<TargetObject condition="end with">\DependOnService</TargetObject>
			</Rule>
			<Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Monitor Driver BinaryPathName" groupRelation="and">
				<TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
				<TargetObject condition="end with">\BinaryPathName</TargetObject>
			</Rule>
			<Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Monitor Driver RequiredPrivileges" groupRelation="and">
				<TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
				<TargetObject condition="end with">\RequiredPrivileges</TargetObject>
			</Rule>
			<Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Monitor Driver Owners: Correlation to Amcache" groupRelation="and">
				<TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
				<TargetObject condition="end with">\Owners</TargetObject>
			</Rule>
			<Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Monitor Driver ObjectName: User Service Runs as specified in ServiceStartName" groupRelation="and">
				<TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
				<TargetObject condition="end with">\ObjectName</TargetObject>
			</Rule>
			<Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Monitor Driver ObjectName: User Service Runs as" groupRelation="and">
				<TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
				<TargetObject condition="end with">\ServiceStartName</TargetObject>
			</Rule>
			<Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Monitor Driver ErrorControl" groupRelation="and">
				<TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
				<TargetObject condition="end with">\ErrorControl</TargetObject>
				<!--<Details name="Critical if lastknown good fails bugcheck" condition="contains">DWORD (0x00000003)</Details>
				<Details name="Severe last known good" condition="contains">DWORD (0x00000002)</Details>
				<Details name="Normal Boot on failure" condition="contains">DWORD (0x00000001)</Details>
				<Details name="Ignore Failure"condition="contains">DWORD (0x00000000)</Details>
				<Details condition="contains">DWORD (0x00000001)</Details>-->
			</Rule>
			<Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Monitor Driver DependOnGroup" groupRelation="and">
				<TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
				<TargetObject condition="end with">\DependOnGroup</TargetObject>
			</Rule>
			<Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Monitor Driver DisplayName" groupRelation="and">
				<TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
				<TargetObject condition="end with">\DisplayName</TargetObject>
			</Rule>
			<Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Service Group Order Modifications" groupRelation="and">
				<TargetObject condition="contains">HKLM\SYSTEM\CurrentControlSet\Control\ServiceGroupOrder</TargetObject>
				<TargetObject condition="end with">\List</TargetObject>
			</Rule>
			<Rule name="Attack=T1543.003,Technique=Create or Modify System Process: Windows Service,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=Services: Service Set for Deletion" groupRelation="and">
				<TargetObject condition="contains">HKLM\System\CurrentControlSet\services\</TargetObject>
				<TargetObject condition="end with">\Type</TargetObject>
				<Details condition="contains">DWORD (0x00000001)</Details>
			</Rule>
			<!--Detect User Activity-->
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Detect Bluetooth Audio Capture" condition="contains">\ConsentStore\bluetooth</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Detect Contacts Accesses" condition="contains">\ConsentStore\contacts</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Detect Input Capture Accesses/Keyloggers" condition="contains">\ConsentStore\hunmanInterfaceDevice</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Detect Location Accesses" condition="contains">\ConsentStore\location</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Detect Microphone Accesses" condition="contains">\ConsentStore\microphone</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Detect USB Accesses" condition="contains">\ConsentStore\usb\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Detect Webcam Accesses" condition="contains">\ConsentStore\webcam</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Detect humanInterfaceDevice Accesses" condition="contains">\ConsentStore\humanInterfaceDevice</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Explorer Last Visited MRU" condition="contains">LastVisitedMRU</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=Regedit Applets" condition="contains">SOFTWARE\Microsoft\Windows\CurrentVersion\Applets\RegEdit</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=Run MRU" condition="contains">\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=USBStor USB Device History" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Enum\USBSTOR</TargetObject>
			<TargetObject name="Attack=T1112,Technique=Modify Registry,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Safeboot Service Added" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Safeboot\</TargetObject>
			<TargetObject name="Attack=T1198,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Crypto Trust Providers" condition="begin with">HKLM\SOFTWARE\Microsoft\Cryptography\Providers\Trust</TargetObject>
			<TargetObject name="Attack=T1198,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Crypto Trust Providers" condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Cryptography\Providers\Trust</TargetObject>
			<TargetObject name="Attack=T1198,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Cryptography OID Key" condition="begin with">HKLM\SOFTWARE\Microsoft\Cryptography\OID</TargetObject>
			<TargetObject name="Attack=T1198,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Cryptography OID Key" condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Cryptography\OID</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect: Dns Server dll injection" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\DNS\Parameters\ServerLevelPluginDll</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Detect: UAC Bypass" condition="contains">Classes\exefile\shell\runas\command\isolatedCommand</TargetObject> 
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=New Device Connected" condition="end with">\FriendlyName</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Providers notified by Winlogon" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Winlogon\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Proxy Autoconfig URL" condition="contains">\Software\Microsoft\Windows\CurrentVersion\Internet Settings\AutoConfigURL</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Shell Service Object Delay Load" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\ShellServiceObjectDelayLoad</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Windows Installer Engaged" condition="is">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Installer\InProgress\(Default)</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AppCompat Shims" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Custom</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Forensic=AppCompat Shims" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\InstalledSDB</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Process Tracing Modifications,,Risk=30" condition="begin with">HKLM\SOFTWARE\Microsoft\Tracing\</TargetObject>
			<Rule name="Alert=Detect PoisonTap,FP=2,Comment=May be noisy" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{4d36e972-e325-11ce-bfc1-08002be10318}</TargetObject>
				<Details condition="contains any">ndis;rndis</Details>
			</Rule>
			<TargetObject name="Attack=T1090,Technique=Connection Proxy,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=NetSH PortProxy Detected" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\PortProxy\v4tov4</TargetObject>
			<Rule name="Attack=T1112,Technique=Modify Registry,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Alert=Possible Ursniff Malware Detected,FP=1" groupRelation="and">
				<TargetObject condition="contains">\Software\AppDataLow\Software\Microsoft\</TargetObject>
				<Details condition="contains any">.exe;.dll;powershell;wmic</Details>
			</Rule>
			<Rule name="Attack=T1562.010,Technique=Impair Defenses: Downgrade Attack,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=0,Alert=NetNTLM downgrade attack" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\lmcompatibilitylevel</TargetObject>
				<Details name="You should have this set to 5" condition="excludes">DWORD (0x00000005)</Details>
			</Rule>
			<TargetObject name="Attack=T1137,Technique=Office Application Startup,Tactic=Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Office Persistence Location,Risk=70" condition="end with">Software\Microsoft\Office test\Special\Perf</TargetObject>
			<TargetObject name="Attack=T1177,Technique=LSASS Driver,Tactic=Execution/Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Undocumented LSASS DLL Loading" condition="contains">\CurrentControlSet\Services\NTDS\LsaDbExtPt</TargetObject>
			<TargetObject name="Attack=T1177,Technique=LSASS Driver,Tactic=Execution/Persistence,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Undocumented LSASS DLL Loading" condition="contains">\Services\NTDS\DirectoryServiceExtPt</TargetObject>
			<TargetObject name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Forensic=GoToMyPC File Transfer History,Risk=70" condition="contains">GoToMyPc\FileTransfer\history</TargetObject>
			<TargetObject name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Forensic=GoToMyPC Guest Invite,Risk=70" condition="contains">GoToMyPc\GuestInvite</TargetObject>
			<TargetObject name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Forensic=LogMeIn File Transfer Recipient" condition="contains">Filesharing</TargetObject>
			<TargetObject name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Forensic=LogMeIn Guest Recipient" condition="contains">DesktopSharing</TargetObject>
			<TargetObject name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Forensic=Teamviewer LogIncomingConnections Registry Key modification" condition="contains">LogIncomingConnections</TargetObject>
			<TargetObject name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Forensic=Teamviewer LogOutgoingConnection Registry Key modification" condition="contains">LogOutgoingConnections</TargetObject>
			<TargetObject name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Forensic=Teamviewer Password Registry Key date" condition="contains">PermanentPasswordDate</TargetObject>
			<TargetObject name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Teamviewer adminrights Key modification,Risk=70" condition="contains">Security_Adminrights</TargetObject>
			<TargetObject name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Level=3,Alert=VNC Incoming Connection History,Risk=70" condition="contains">vncviewer\MRU</TargetObject>
			<TargetObject name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Teamviewer Autostart Key modification" condition="contains">Autostart_GUI</TargetObject>
			<TargetObject name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Teamviewer Meeting Username Registry Key modification" condition="end with">Meeting_UserName</TargetObject>
			<TargetObject name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Teamviewer Persistence Login Name" condition="end with">BuddyLoginName</TargetObject>
			<TargetObject name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Teamviewer Persistence Token ID modification" condition="end with">BuddyLoginTokenID</TargetObject>
			<TargetObject name="Attack=T1219,Technique=Remote Access Tools,Tactic=Command And Control,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Teamviewer persistence Key modification" condition="contains">Always_Online</TargetObject>
			<TargetObject name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Potential Ransomware Indicator: EnableLinkedConnections Registry key,Risk=100" condition="begin with">HKLM\SOFTWARE\Microsoft\CurrentVersion\Policies\System\EnableLinkedConnections</TargetObject>
			<TargetObject name="Attack=T1486,Technique=Data Encrypted for Impact,Tactic=Impact,DS=Windows Registry: Windows Registry Key Modification,Level=4,Alert=Potential Ransomware Indicator: REvil Sodinokibi Sodin Ransomware,Risk=100" condition="contains">Software\recfg</TargetObject>
			<TargetObject name="Attack=T0000,Technique=Keyboard Layout,Tactic=N/A,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Suspicious Keyboard Layout Load" condition="contains">\Keyboard Layout\Preload\</TargetObject>
			<TargetObject name="Attack=T0000,Technique=Keyboard Layout,Tactic=N/A,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=Suspicious Keyboard Layout Load" condition="contains">\Keyboard Layout\Substitutes\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=IIS Crypto Keys" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Cryptography\Configuration\SSL\00010002</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=IIS Crypto Keys" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\FipsAlgorithmPolicy</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=IIS Crypto Keys" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=IIS Crypto Keys" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Hashes\</TargetObject> 
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=IIS Crypto Keys" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\KeyExchangeAlgorithms\Diffie-Hellman</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=IIS Crypto Keys" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=IIS Crypto Keys" condition="end with">\Client\Enabled</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=IIS Crypto Keys" condition="end with">\Server\Enabled</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=Kitty Sessions,Risk=30" condition="contains">Kitty\Sessions</TargetObject>
			<TargetObject name="Attack=T1562.010,Technique=Impair Defenses: Downgrade Attack,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=NetNTLM downgrade attack" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\NtlmMinClientSec</TargetObject>
			<TargetObject name="Attack=T1562.010,Technique=Impair Defenses: Downgrade Attack,Tactic=Defense Evasion,DS=Windows Registry: Windows Registry Key Modification,Level=1,Desc=NetNTLM downgrade attack" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\RestrictSendingNTLMTraffic</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Forensic=Putty Sessions,Risk=30" condition="contains">PuTTY\Sessions</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=RDP History,Risk=10" condition="contains">Terminal Server Client\Servers</TargetObject>
			<TargetObject name="Attack=None,Technique=None,Tactic=None,DS=Windows Registry: Windows Registry Key Modification,Level=0,Desc=WINSCP Sessions,Risk=30" condition="contains">WinSCP 2\Sessions</TargetObject>
			<Rule name="Antivirus" groupRelation="or">
				<Image condition="begin with">C:\Program Files (x86)\Kaspersky Lab</Image> 
				<Image condition="begin with">C:\Program Files\Kaspersky Lab</Image>
				<Image condition="begin with">C:\Program Files (x86)\ESET</Image>
				<Image condition="begin with">C:\Program Files\ESET</Image>
			</Rule>
		</RegistryEvent>
	</RuleGroup>
	<!--SYSMON EVENT ID 15 : ALTERNATE DATA STREAM CREATED [FileCreateStreamHash]-->
	<!--EVENT 15: "File stream created"-->
	<RuleGroup name="RG=ADS Include Group" groupRelation="or">
		<FileCreateStreamHash onmatch="include">
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Metadata,Level=0,Desc=Interesting Files temp locations,Risk=10" groupRelation="and">
				<TargetFilename condition="contains any">Content.IE5;INetCache</TargetFilename>
				<TargetFilename condition="contains any">.exe;.zip;.ps1;.bat;.rar;.vbs;.hta</TargetFilename>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=File: File Metadata,Level=4,Alert=HTML_Smuggling,Risk=50" groupRelation="and">
				<TargetFilename condition="end with">:Zone.Identifier</TargetFilename>
				<Contents condition="contains any">blob:;about:internet</Contents>
			</Rule>
			<Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=File: File Metadata,Level=4,Alert=FireEye sunburst file hashes,Risk=100" groupRelation="and">
				<Hash condition="contains any">56ceb6d0011d87b6e4d7023d7ef85676;4f2eb62fa529c0283b28d05ddd311fae;b91ce2fa41029f6955bff20079468448;b91ce2fa41029f6955bff20079468448;846e27a652a5e1bfbd0ddd38a16dc865;2c4a910a1299cdae2a4e55988a2f102e</Hash><!-- exclude non executable files -->
			</Rule>
			<Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=File: File Metadata,Level=4,Alert=Sept 2022 Exchange 0day DLL detection,Risk=100" groupRelation="or">
				<Hash condition="contains">SHA256=074eb0e75bb2d8f59f1fd571a8c5b76f9c899834893da6f7591b68531f2b5d82</Hash><!--Exchange Zero Day Dropped DLL-->
				<Hash condition="contains">SHA256=45c8233236a69a081ee390d4faa253177180b2bd45d8ed08369e07429ffbe0a9</Hash><!--Exchange Zero Day Dropped DLL-->
				<Hash condition="contains">SHA256=9ceca98c2b24ee30d64184d9d2470f6f2509ed914dafb87604123057a14c57c0</Hash><!--Exchange Zero Day Dropped DLL-->
				<Hash condition="contains">SHA256=29b75f0db3006440651c6342dc3c0672210cfb339141c75e12f6c84d990931c3</Hash><!--Exchange Zero Day Dropped DLL-->
				<Hash condition="contains">SHA256=c8c907a67955bcdf07dd11d35f2a23498fb5ffe5c6b5d7f36870cf07da47bff2</Hash><!--Exchange Zero Day Dropped DLL-->
				<Hash condition="contains">SHA256=76a2f2644cb372f540e179ca2baa110b71de3370bb560aca65dcddbd7da3701e</Hash><!--Exchange Zero Day Dropped DLL-->
			</Rule>
			<Rule name="Attack=T1096,Technique=Alternate Data Streams,Tactic=Defense Evasion,DS=File: File Metadata,Level=0,Desc=Alternate Data Streams,Risk=10" groupRelation="and">
				<TargetFilename condition="contains any">Content.Outlook;Downloads;Recycle;\Users\;\ProgramData\;\Windows\;Temp\7z;Temp\;Startup;.vb;.vbe;.vbs;.application;.appref-ms;.bat;.cmd;.cmdline;.docm;.exe;.lnk;.eml;.dll;.sys;.hta;.pptm;.ps1;.sys;.reg;.docm;.xlsm;.xlam;.pptm;.potm;.pptm;.sldm;.scf;.appref-ms;.rdp;.vbs;.js;.pem;.crt;.ca-bundle;.cer;.csr;.der;.p7b;.p7r;.p7s;.pfx;.sto;.p12;.crl;.sst;.key;:bin;.mht;.manifest;.cpl;.scr;.inf</TargetFilename>
			</Rule>
			<Rule name="Attack=T1562.002,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=File: File Metadata,Level=4,Alert=SysmonEnte Detection,DS=File: File Metadata,Level=4,Risk=100" groupRelation="and">
				<Hash condition="contains">IMPHASH=84B763C45C0E4A3E7CA5548C710DB4EE</Hash>
			</Rule>
			<Rule name="Attack=T1562.002,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=File: File Metadata,Level=4,Alert=SysmonQuiet Detection,DS=File: File Metadata,Level=4,Risk=100" groupRelation="and">
				<Hash condition="contains">IMPHASH=19584675D94829987952432E018D5056</Hash>
			</Rule>
			<Rule name="Attack=T1562.002,Technique=Impair Defenses: Disable Windows Event Logging,Tactic=Defense Evasion,DS=File: File Metadata,Level=4,Alert=SharpEvtMute Detection,DS=File: File Metadata,Level=4,Risk=100" groupRelation="and">
				<Hash condition="contains">IMPHASH=330768a4f172e10acb6287b87289d83b</Hash>
			</Rule>
		</FileCreateStreamHash>
	</RuleGroup>
	<RuleGroup name="RG=ADS Exclude Group" groupRelation="or">
		<FileCreateStreamHash onmatch="exclude">
			<Hash condition="contains">IMPHASH=00000000000000000000000000000000</Hash>
			<TargetFilename condition="contains">AppData\Local\Microsoft\Windows\AppCache\</TargetFilename>
			<TargetFilename condition="contains">\Microsoft\Windows\INetCache\</TargetFilename>
			<TargetFilename condition="contains">\Microsoft\Windows\Temporary Internet Files\Content.IE5</TargetFilename> 
			<TargetFilename condition="contains">\Mozilla\Firefox\Profiles\</TargetFilename>
			<TargetFilename condition="end with">.default\prefs-1.js</TargetFilename>
			<TargetFilename condition="end with">Microsoft\Windows\Start Menu\Programs\Startup</TargetFilename>
		</FileCreateStreamHash>
	</RuleGroup>
	<!--SYSMON EVENT ID 16 : SYSMON CONFIGURATION CHANGE-->
	<!--EVENT 16: "Sysmon config state changed"-->
	<!--COMMENT:	This ONLY logs if the hash of the configuration changes. Running "sysmon.exe -c" with the current configuration will not be logged with Event 16-->
	<!--DATA: RuleName, UtcTime, Configuration, ConfigurationFileHash-->
	<!--Cannot be filtered.-->

	<!--SYSMON EVENT ID 17 & 18 : PIPE CREATED / PIPE CONNECTED [PipeEvent]-->
	<!--EVENT 17: "Pipe Created"-->
	<!--EVENT 18: "Pipe Connected"-->
	<!--DATA: RuleName, UtcTime, ProcessGuid, ProcessId, PipeName, Image-->
	<RuleGroup name="RG=PipeEvent Include Group" groupRelation="or">
		<PipeEvent onmatch="include">
			<Rule name="Attack=T1071,Technique=Application Layer Protocol,Tactic=Command and Control,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Cobalt Strike named pipe detected,Risk=100" groupRelation="and">
				<PipeName condition="contains any">msagent_;\MSSE-;postex;\status_</PipeName>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=NA,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Turla Advanced Persistent Threat Named Pipe Detection,Risk=100" groupRelation="and">
				<PipeName condition="contains any">\atctl;\userpipe;\iehelper;\sdlrpc;\comnap</PipeName>
			</Rule>
			<Rule name="Attack=T1077,Technique=Windows Admin Shares,Tactic=Lateral Movement,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=lateral movement: psexec named pipe detected" groupRelation="or">
				<PipeName condition="contains">\PSEXESVC</PipeName>
				<PipeName condition="end with">-stdin</PipeName>
				<PipeName condition="end with">-stdout</PipeName>
			</Rule>
			<Rule name="Attack=T1077,Technique=Windows Admin Shares,Tactic=Lateral Movement,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Impacket PSExec.py Named Pipe Detected" groupRelation="and">
				<PipeName condition="contains">RemCom_</PipeName>
				<PipeName condition="contains any">stdin;stdout;stderr;communication</PipeName>
			</Rule>
			<Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Named Pipe: Named Pipe Metadata,Level=3,Alert=MS-SCMR Execution" groupRelation="or">
				<PipeName condition="contains">\svcctl</PipeName>
			</Rule>
			<Rule name="Attack=T1021,Technique=Remote Services,Tactic=Lateral Movement,DS=Named Pipe: Named Pipe Metadata,Level=3,Alert=NTSVCS Execution" groupRelation="or">
				<PipeName condition="contains">\ntsvcs</PipeName>
				<EventType condition="is">ConnectPipe</EventType>
			</Rule>
			<PipeName name="Attack=T1003,Technique=OS Credential Dumping,Tactic=Credential Access,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Credential Dumping Command Mimikatz,Risk=100" condition="contains any">\lsadump;\cachedump;\wceservicepipe</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=9f81f59bc58452127884ce513865ed20 Named Pipe Detection,Risk=100" condition="contains">\9f81f59bc58452127884ce513865ed20</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=46a676ab7f179e511e30dd2dc41bd388 Named Pipe Detection,Risk=100" condition="contains">\46a676ab7f179e511e30dd2dc41bd388</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Kekeo Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" condition="contains">tssmp_endpoint</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=NamePipe_MoreWindows Named Pipe Detection,Risk=100,Risk=100,Author=@Cyb3rops/@olafhartong" condition="contains">\NamePipe_MoreWindows</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=WCEServicePipe detected,Risk=,Author=@Cyb3rops/@olafhartong" condition="contains">\WCEServicePipe</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=ahexec Named Pipe Detection,Risk=,Author=@Cyb3rops/@olafhartong" condition="contains">\ahexec</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=cachedump detected,Risk=100,Author=@Cyb3rops/@olafhartong" condition="contains">\cachedumppipe</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=csexec Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" condition="contains">\csexec</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=e710f28d59aa529d6792ca6ff0ca1b34 Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" condition="contains">\e710f28d59aa529d6792ca6ff0ca1b34</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=isapi_dg2 Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" condition="contains">\isapi_dg</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=isapi_http Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" condition="contains">\isapi_http</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=isapi_http Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" condition="contains">\isapi_http</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=lsadump detected,Risk=100,Author=@Cyb3rops/@olafhartong" condition="contains">\lsadump</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=lsassw Named Pipe Detectio,Risk=10,Author=@Cyb3rops/@olafhartong" condition="contains">\lsassw</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=paexec Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" condition="contains">\paexec</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=pcheap_reuse Named Pipe Detection,Author=@Cyb3rops/@olafhartong" condition="contains">\pcheap_reuse</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Covanant C2 Named Pipe Detection,Author=@Cyb3rops/@olafhartong" condition="contains">\gruntsvc</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=remcom Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" condition="contains">\remcom</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=rpchlp_3 Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" condition="contains">\rpchlp_3</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=sdlrpc Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" condition="contains">\sdlrpc</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=winsession Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" condition="contains">\winsession</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Turla HyperStack Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" condition="begin with">\adschemerpc</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Hidden Cobra Hoplight Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" condition="begin with">\AnonymousPipe</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Pacifier Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" condition="begin with">\bc367</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Pacifier Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" condition="begin with">\bc31a7</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Emissary Panda Hyerbri Named Pipe Detection,Risk=100,Author=@Cyb3rops/@olafhartong" condition="begin with">\testPipe</PipeName>
			<PipeName name="Attack=T1077,Technique=Windows Admin Shares,Tactic=Lateral Movement,DS=Named Pipe: Named Pipe Metadata,Alert=lateral movement -meterpreter named pipe detected,Risk=100" condition="contains">msf-pipe</PipeName>
			<PipeName name="Attack=None,Technique=None,Tactic=None,DS=Named Pipe: Named Pipe Metadata,Level=0,Desc=LM or EXEC over atsvc named pipe" condition="contains">\atsvc</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Malicious Named Pipe Detection 1" condition="contains any">\isapi_http;\isapi_dg;\isapi_dg2;\sdlrpc;\ahexec;\winsession;\lsassw;\46a676ab7f179e511e30dd2dc41bd388;\9f81f59bc58452127884ce513865ed20;\e710f28d59aa529d6792ca6ff0ca1b34;\rpchlp_3;\NamePipe_MoreWindows;\pcheap_reuse;\gruntsvc;\583da945-62af-10e8-4902-a8f205c72b2e;\bizkaz;\Posh;\jaccdpqnvbrrxlaf;\csexecsvc</PipeName>
			<PipeName name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Malicious Named Pipe Detection 2" condition="contains any">\atctl;\userpipe;\iehelper;\sdlrpc;\comnap</PipeName>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Cobalt Strike Named Pipe Detection 1" groupRelation="and">
				<PipeName condition="contains any">\DserNamedPipe;\mypipe-;\windows.update.manager;\ntsvcs_;scerpc_;\demoagent;\PGMessagePipe;\MsFTeWds;\f4c3;\fullduplex_;\msrpc_;\f53f;\rpc_;\spoolss_;\win_svc;\SearchTextHarvester;demoagent_</PipeName>
				<PipeName condition="is not">\wkssvc</PipeName>
				<PipeName condition="is not">\spoolss</PipeName>
				<PipeName condition="is not">\scerpc</PipeName>
				<PipeName condition="is not">\ntsvcs</PipeName>
				<PipeName condition="is not">\SearchTextHarvester</PipeName>
				<PipeName condition="is not">\PGMessagePipe</PipeName>
				<PipeName condition="is not">\MsFteWds</PipeName>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Named Pipe: Named Pipe Metadata,Level=4,Forensic=Detect suspicious named pipe connections to an AD FS WID,Author=Florian Roth" groupRelation="and"> 
				<EventType condition="is">ConnectPipe</EventType>
				<PipeName condition="is">\MICROSOFT##WID\tsql\query</PipeName>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=Cobalt Strike Named Pipe Detection 2" groupRelation="and">
				<PipeName condition="begin with">\Winsock2\CatalogChangeListener-</PipeName>
				<PipeName condition="end with">-0,</PipeName>
			</Rule>
			<Rule name="Attack=T1055,Technique=Process Injection,Tactic=Defense Evasion/Privilege Escalation,DS=Named Pipe: Named Pipe Metadata,Level=4,Alert=EFSPotato Named Pipe Detection" groupRelation="and">
				<PipeName condition="contains any">\pipe\</PipeName>
				<PipeName condition="excludes">CtxSharefilepipe0</PipeName>
			</Rule>
			<!-- Noisy
			<PipeName name="Attack=None,Technique=None,Tactic=None,DS=Named Pipe: Named Pipe Metadata,Level=0,Desc=SMB Session Enumeration" condition="contains">\srvsvc</PipeName>
			-->
			<PipeName name="Attack=None,Technique=None,Tactic=None,DS=Named Pipe: Named Pipe Metadata,Level=0,Desc=Remote Registry access and enumeration" condition="contains">\winreg</PipeName>
			<PipeName name="Attack=None,Technique=None,Tactic=None,DS=Named Pipe: Named Pipe Metadata,Level=0,Desc=Anonymous Named Pipe Detected" condition="contains">Anonymous Pipe</PipeName>
			<!--Include Everything else to mark above rules-->
			<!-- Disabled for now
			<PipeName name="Attack=None,Technique=None,Tactic=None,DS=Named Pipe: Named Pipe Metadata,Level=0,Desc=Uncategorized Events" condition="contains">\</PipeName>
			-->
		</PipeEvent>
	</RuleGroup>
	<RuleGroup name="RG=PipeEvent Exclude Group" groupRelation="or">
		<PipeEvent onmatch="exclude">
		<EventType name="Exclude ConnectPipe for noise reduction" condition="is">ConnectPipe</EventType>
		<!--COMMENT: Exclude known-good pipe users-->
				<!--ADDITIONAL REFERENCE: [ https://www.cobaltstrike.com/help-smb-beacon ] -->
				<!--ADDITIONAL REFERENCE: [ https://blog.cobaltstrike.com/2015/10/07/named-pipe-pivoting/ ] -->
			<!--SECTION: Microsoft-->
			<PipeName condition="contains">lsass</PipeName>
			<PipeName condition="is">\SQLLocal\RTCLOCAL</PipeName>
			<PipeName condition="is">\spoolss</PipeName>
			<Image name="This is noisy" condition="image">C:\Windows\system32\wbem\wmiprvse.exe</Image>
			<Image name="WSL" condition="image">C:\Windows\System32\LxRun.exe</Image>
			<Image condition="image">C:\Windows\System32\SearchIndexer.exe</Image>
			<Image condition="image">C:\Windows\System32\smss.exe</Image>
			<Image condition="image">C:\Windows\System32\spoolsv.exe</Image>
			<Image condition="image">C:\Windows\System32\wininit.exe</Image>
			<Image condition="image">C:\Windows\system32\DFSRs.exe</Image>
			<Image condition="begin with">C:\Windows\SystemApps\Microsoft.Windows</Image>
			<Rule name="ngen excludes" groupRelation="and">
				<Image condition="begin with">C:\Windows\Microsoft.NET\Framework</Image>
				<Image condition="image">ngen.exe</Image>
			</Rule>
			<Rule name="ShellExperienceHost excludes" groupRelation="and">
				<Image condition="begin with">C:\Windows\SystemApps\ShellExperienceHost_</Image>
				<Image condition="image">ShellExperienceHost.exe</Image>
			</Rule>
			<Image condition="image">C:\Windows\system32\SearchProtocolHost.exe</Image>
			<Image condition="image">\System</Image>
			<PipeName condition="contains">ProtectedPrefix\LocalService\FTHPIPE</PipeName>
			<!--SECTION: Microsoft Exchange Server -->
			<Image condition="contains">Exchange Server</Image>
			<!--SECTION: Microsoft IIS -->
			<Image condition="image">C:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\15\BIN\OWSTIMER.EXE</Image>
			<Image condition="image">C:\Windows\syswow64\snmp.exe</Image>
			<Image condition="image">c:\windows\system32\inetsrv\w3wp.exe</Image>
			<PipeName condition="begin with">\M.E.C.Core.WinRMDataCommunicator.NamedPipe.</PipeName>
			<!--SECTION: Microsoft DNS Server -->
			<Image condition="image">C:\Windows\system32\dns.exe</Image>
			<!--SECTION: Microsoft SQL Server -->
			<PipeName condition="is">\sql\query</PipeName>
			<Image condition="image">C:\Program Files\Microsoft SQL Server\90\Shared\sqlwriter.exe</Image>
			<PipeName condition="contains">\TDLN-</PipeName>
			<PipeName condition="contains">vmware-</PipeName>
			<PipeName condition="is">\InitShutdown</PipeName>
			<PipeName condition="is">\MsFteWds</PipeName>
			<PipeName condition="is">\W32TIME_ALT</PipeName>
			<PipeName condition="is">\WiFiNetworkManagerTask</PipeName>
			<PipeName condition="is">\Winsock2CatelogChangeListener</PipeName>
			<PipeName condition="is">\browser</PipeName>
			<PipeName condition="is">\epmapper</PipeName>
			<PipeName condition="is">\eventlog</PipeName>
			<PipeName condition="is">\scerpc</PipeName>
			<PipeName condition="is">\wkssvc</PipeName>
			<PipeName condition="is">\ntapvsrq</PipeName>
			<PipeName condition="contains">Anonymous Pipe</PipeName>
		</PipeEvent>
	</RuleGroup>
	<!--SYSMON EVENT ID 19 & 20 & 21 : WMI EVENT MONITORING [WmiEvent]-->
	<!--EVENT 19: "WmiEventFilter activity detected"-->
	<!--EVENT 20: "WmiEventConsumer activity detected"-->
	<!--EVENT 21: "WmiEventConsumerToFilter activity detected"-->
	<!--DATA: EventType, UtcTime, Operation, User, Name, Type, Destination, Consumer, Filter-->
	<RuleGroup name="RG=WmiEvent Include Group" groupRelation="or">
		<WmiEvent onmatch="include">
			<Operation name="Attack=T1047,Technique=Windows Management Instrumentation,Tactic=Execution,DS=WMI: WMI Creation" condition="is">Created</Operation>
		</WmiEvent>
	</RuleGroup>
	<!-- SYSMON EVENT ID 22 : DNS Queries-->
	<RuleGroup name="RG=DNS Query Includes" groupRelation="or">
		<DnsQuery onmatch="include">
			<Rule name="Attack=T1048,Technique=Exfiltration Over Alternative Protocol,Tactic=Exfiltration,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Powershell TXT Record exfiltration" groupRelation="and">
				<QueryResults condition="contains any">type: 16;type:  16</QueryResults>
				<Image condition="image">powershell.exe</Image>
			</Rule>
			<Rule name="Attack=T1059,Technique=Powershell,Tactic=Execution,DS=Network Traffic: Network Traffic Content,Level=4,Alert=Powershell Connection to github" groupRelation="and">
				<QueryName condition="contains">github</QueryName>
				<Image condition="image">powershell.exe</Image>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Suspicious DNS Requests" groupRelation="and">
				<Image condition="contains any">powershell;cscript.exe;wscript.exe;mshta.exe;bitsadmin.exe;\cmd.exe</Image>
				<QueryName condition="contains">.</QueryName>
			</Rule>
			<Rule name="Attack=T1567.002,Technique=Exfiltration Over Web Service: Exfiltration to Cloud Storage,Tactic=Exfiltration,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Dropbox Cloud Exfiltration" groupRelation="and">
				<QueryName condition="end with">dropboxapi.com</QueryName>
				<Image condition="excludes any">\Dropbox\Client\Dropbox.exe;\Dropbox\bin\Dropbox.exe;\Oracle\Java\</Image>
			</Rule>
			<Rule name="Attack=T1567.002,Technique=Exfiltration Over Web Service: Exfiltration to Cloud Storage,Tactic=Exfiltration,DS=Network Traffic: Network Traffic Content,Level=0,Desc=OneDrive Cloud Exfiltration" groupRelation="and">
				<QueryName condition="contains">1drv</QueryName>
				<Image condition="excludes any">\AppData\Local\Microsoft\OneDrive\OneDrive.exe;C:\Program Files (x86)\Google\Chrome\Application\chrome.exe;\Internet Explorer\iexplore.exe;C:\Windows\System32\AppHostRegistrationVerifier.exe;C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe;C:\Program Files (x86)\BraveSoftware\Brave-Browser\Application\brave.exe;C:\Program Files (x86)\Microsoft OneDrive\OneDrive.exe;C:\Program Files\Mozilla Firefox\firefox.exe</Image>
			</Rule>
			<Rule name="Attack=T1567.002,Technique=Exfiltration Over Web Service: Exfiltration to Cloud Storage,Tactic=Exfiltration,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Box.com Cloud Exfiltration" groupRelation="and">
				<QueryName condition="contains all">.box.com;upload</QueryName>
			</Rule>
			<Rule name="Attack=T1567.002,Technique=Exfiltration Over Web Service: Exfiltration to Cloud Storage,Tactic=Exfiltration,DS=Network Traffic: Network Traffic Content,Level=4,Alert=Mega.co.nz Cloud Exfiltration" groupRelation="and">
				<QueryName condition="contains any">mega.nz;mega.co.nz</QueryName>
			</Rule>
			<Rule name="Attack=T1567.002,Technique=Exfiltration Over Web Service: Exfiltration to Cloud Storage,Tactic=Exfiltration,DS=Network Traffic: Network Traffic Content,Level=4,Alert=Privatlab Cloud Exfiltration" groupRelation="and">
				<QueryName condition="contains any">privatlab.com</QueryName>
			</Rule>
			<Rule name="Attack=T1195,Technique=Supply Chain Compromise,Tactic=Initial Access,DS=Network Traffic: Network Traffic Content,Level=4,Alert=Solarwinds/FireEye sunburst domains,Risk=100" groupRelation="or">
				<QueryName condition="contains any">thedoccloud.com;deftsecurity.com;websitetheme.com;highdatabase.com;incomeupdate.com;zupertech.com;panhardware.com;databasegalore.com;avsvmcloud.com;freescanonline.com</QueryName>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Social Networking" groupRelation="or">
				<QueryName condition="contains any">tiktok;parler.com;gab.com;mewe.com;4chan;8chan;facebook;fbcdn;twitter;instagram;snapchat</QueryName>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Internet Relay Chat,Risk=70" groupRelation="or">
				<QueryName condition="contains any">efnet;undernet;freenode;ircnet;.rizon;quakenet;oftc.net;dalnet</QueryName>
			</Rule>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Internet Chat,Risk=20" groupRelation="and">
				<QueryName condition="contains any">.slack.com;discord.;telegram.;rocketchat.;mattermost.;flock.com</QueryName>
			</Rule>
			<Rule name="Attack=T1595,Technique=Active Scanning,Tactic=Reconnaissance,DS=Network Traffic: Network Traffic Content,Level=4,Alert=Advanced IP scanner Detected,Risk=90"  groupRelation="or">
				<QueryName condition="contains any">advanced-ip-scanner.com</QueryName>
			</Rule>
			<Rule name="Attack=T1595,Technique=Active Scanning,Tactic=Reconnaissance,DS=Network Traffic: Network Traffic Content,Level=4,Alert=Kali Linux Distribution Download/Apt URL,Risk=90"  groupRelation="or">
				<QueryName condition="contains any">kali.download</QueryName>
			</Rule>
			<!--Crypto Currency Mining pools-->
			<Rule name="Attack=T1496,Technique=Resource Hijacking,Tactic=Impact,DS=Network Traffic: Network Traffic Content,Level=4,Alert=Crypto Currency Miner Detected,Risk=85"  groupRelation="or">
				<QueryName condition="contains any">0x1f4b0.com;1q2w3.life;1q2w3.website;31.187.64.216;185.193.38.148;aalbbh84.info;adfreetv.ch;adless.io;adplusplus.fr;adrenali.gq;ajcryptominer.com;ajplugins.com;allfontshere.press;altavista.ovh;amhixwqagiz.ru;appelamule.com;arizona-miner.tk;aster18cdn.nl;aster18prx.nl;avero.xyz;averoconnector.com;bauersagtnein.myeffect.net;bhzejltg.info;blazepool;blockmasters;blockmasterscoins;bmnr.pw;bmst.pw;bohemianpool;carry.myeffect.net;cashbeet.com;cdn-code.host;cfceu.duckdns.org;cfcnet.gdn;cfcnet.top;cfcs1.duckdns.org;chainblock.science;cieh.mx;coin-hive.com;coin-service.com;coin-services.info;coiner.site;coinpirate.cf;coinrail.io;coinwebmining.com;cpu2cash.link;cryptaloot.pro;cryptmonero;crypto-loot.com;crypto-pool;crypto-webminer.com;cryptoloot.pro;d-ns.ga;dataservices.download;directprimal.com;dwarfpool;encoding.ovh;eth-pocket.com;eth-pocket.de;eth-pocket.eu;ethereum-pocket.de;ethereum-pocket.eu;ethtrader.de;eu.nimpool.io;eu.sushipool.com;f1tbit.com;flnqmin.org;freecontent.bid;freecontent.date;freecontent.loan;freecontent.racing;freecontent.stream;freecontent.win;gnrdomimplementation.com;graftpool.ovh;greenindex.dynamic-dns.net;gustaver.ddns.net;hashrefinery;hashvault.pro;herphemiste.com;hide.ovh;hk.rs;hlpidkr.ru;hodlers.party;hodling.faith;hostingcloud.win;hrfziiddxa.ru;ihdvilappuxpgiv.ru;imhvlhaelvvbrq.ru;insdrbot.com;irrrymucwxjl.ru;istlandoll.com;ivuovhsn.ru;iwanttoearn.money;ixvenhgwukn.ru;jqassets.download;jqr-cdn.download;jqrcdn.download;jquerrycdn.download;jqwww.download;jqxrrygqnagn.ru;jscoinminer.com;jwduahujge.ru;ksimdw.ru;l33tsite.info;laferia.cr;ledhenone.com;ltstyov.ru;mepirtedic.com;mine.bz;minercircle.com;minercry.pt;minergate;minero.cc;miners.pro;minescripts.info;mininghub.club;miningpoolhubcoins;minr.pw;mixpools.org;mmc.center;mollnia.com;monerise.com;monero.lindon-pool.win;monero;moriaxmr.com;munero.me;mxcdn1.now.sh;mxcdn2.now.sh;myadstats.com;mypool.online;nablabee.com;nanopool.org;nathetsof.com;nicehash;nimiqpool.com;node.philpool.com;npcdn1.now.sh;nunu-001.now.sh;ogondkskyahxa.ru;ogrid.org;oinkinns.tk;olecintri.com;omine.org;onvid.club;open-hive-server-1.pp.ua;oxwwoeukjispema.ru;pcejuyhjucmkiny.ru;pool.nimiq.watch;pool.nimiqchain.info;pool.porkypool.com;pool.xmr;poolto.be;prohash.net;prohash;proj2018.xyz;pzoifaum.info;ratchetmining.com;realnetwrk.com;reauthenticator.com;rove.cl;ruvuryua.ru;s7ven.com;scaleway.ovh;sentemanactri.com;sickrage.ca/ch;sighash.info;slushpool;soodatmish.com;sparechange.io;statdynamic.com;stati.bid;staticsfs.host;streamplay.to;suprnova.cc;svivqrhrh.ru;sxcdn02.now.sh;sxcdn3.now.sh;sxcdn4.now.sh;sxcdn6.now.sh;synconnector.com;teracycle.net;tercabilis.info;thelifeisbinary.ddns.net;thersprens.com;torrent.pw;ulnawoyyzbljc.ru;unrummaged.com;uoldid.ru;usxmrpool;viaxmr.com;vpzccwpyilvoyg.ru;vzzexalcirfgrf.ru;wbmwss.beetv.net;webmine.cz;webmine.pro;webminepool.tk;webminerpool.com;webwidgetz.duckdns.org;wmemsnhgldd.ru;wmtech.website;wmwmwwfmkvucbln.ru;wrxgandsfcz.ru;xmrm.pw;xmrminingproxy.com;xmrpool;yiimp;yuyyio.com;zavzlen.ru;zergpool;zergpoolcoins;ziykrgc.ru;zlx.com.br;zpool;analytics.blue;estream.to</QueryName>
			</Rule>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Microsoft Graph API Lookup" condition="is">graph.microsoft.com</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Dropbox Download Detected" condition="is">dl.dropboxusercontent.com</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=OneDrive API Lookup" condition="is">api.onedrive.com</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Zoom Hostname Lookup" condition="contains">zoom.us</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Teamviewer Hostname Lookup" condition="contains">teamviewer</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Screenconnect Hostname Lookup" condition="contains">Screenconnect</QueryName>
			<!--Public Port Scan Detection-->
			<!--MITRE ATT&CK TECHNIQUE: Active Scanning-->
			<QueryName name="Attack=T1595,Technique=Active Scanning,Tactic=Discovery,DS=Network Traffic: Network Traffic Content" condition="contains">census</QueryName>
			<QueryName name="Attack=T1595,Technique=Active Scanning,Tactic=Discovery,DS=Network Traffic: Network Traffic Content,Level=0,Desc=ResearchScan DNS Query" condition="contains">researchscan</QueryName>
			<QueryName name="Attack=T1595,Technique=Active Scanning,Tactic=Discovery,DS=Network Traffic: Network Traffic Content,Level=0,Desc=ScanHub DNS Query" condition="contains">scanhub</QueryName>
			<QueryName name="Attack=T1595,Technique=Active Scanning,Tactic=Discovery,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Shadow DNS Query,Risk=20" condition="contains">shadow</QueryName>
			<QueryName name="Attack=T1595,Technique=Active Scanning,Tactic=Discovery,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Shodan.IO DNS Query,Risk=20" condition="contains">shodan</QueryName>
			<!--Domain TLD's to log-->
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Download TLD DNS Query" condition="end with">.download</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=North Korea TLD DNS Query" condition="end with">.kp</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Soviet Union TLD DNS Query" condition="end with">.su</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Sudan TLD DNS Query" condition="end with">.ss</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Suspicious TLD .xn DNS Query" condition="end with">.xn</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Syria TLD DNS Query" condition="end with">.sy</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Venezuela TLD DNS Query" condition="end with">.ve</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=XXX TLD DNS Query" condition="end with">.xxx</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=China TLD DNS Query" condition="end with">.cn</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Click TLD DNS Query" condition="end with">.click</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Club TLD DNS Query" condition="end with">.club</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=IRAN TLD DNS Query" condition="end with">.ir</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Russian TLD DNS Query" condition="end with">.ru</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Suspicious TLD .Host DNS Query" condition="end with">.host</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Suspicious TLD .ICU DNS Query" condition="end with">.icu</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Suspicious TLD .PW DNS Query" condition="end with">.pw</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Suspicious TLD .WEBSITE DNS Query" condition="end with">.website</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Suspicious TLD .ninja DNS Query" condition="end with">.ninja</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Suspicious TLD .rocks DNS Query" condition="end with">.rocks</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Top TLD DNS Query" condition="end with">.top</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Ukraine TLD DNS Query" condition="end with">.ua</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=XYZ TLD DNS Query" condition="end with">.xyz</QueryName>
			<!--Malware Domains-->
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Suspicious Domain,Risk=20" groupRelation="and">
				<QueryName condition="contains any">kuternull.com;rimrun.com;0ffice36o;asushotfix;infestexe;rahasn.webhop.org;rahasn.akamake.net;rahasn.homewealth.biz;winodwsupdates;israirairlines</QueryName>
			</Rule>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=DNS Query to Github,Risk=20" condition="contains any">githubusercontent.com;github.com</QueryName> 
			<!--Common Suspicious destinations-->
			<QueryName name="Attack=T1311,Technique=Dynamic DNS,Tactic=Adversary Opsec,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Malware IP Check,Risk=30" condition="contains any">api.ipify.org;whatismyipaddress.com;edns.ip-api.com;checkip.dyndns.org;icanhazip.com;ifconfig.me;ifconfig.co;ipaddress.com;ipecho.net;ident.me;api.ip.sb;www.myexternalip.com;ip.anysrc.net;wtfismyip.com;myexternalip.com;ipecho.net;checkip.amazonaws.com;goo.gl;git.io;bit.ly;ow.ly;ip-api.com</QueryName> <!--Malware uses to get external IP address-->
			<!-- Malicious/Suspicious hosting domains-->
			<QueryName name="Attack=T1311,Technique=Dynamic DNS,Tactic=Adversary Opsec,DS=Network Traffic: Network Traffic Content,Level=4,Alert=Common Malware Hosting Domain: Tiny-share.com,Risk=30" condition="contains any">tiny-share.com;paste.ee;pastebin.com</QueryName>
			<!--Dynamic DNS Lookups-->
			<QueryName name="Attack=T1311,Technique=Dynamic DNS,Tactic=Adversary Opsec,DS=Network Traffic: Network Traffic Content,Level=3,Alert=Dynamic DNS Query" condition="contains any">afraid.org;duckdns.org;changeip.com;ddns.net;hopto.org;zapto.org;servehttp.com;sytes.net;whoer.net;bravica.net;ip.webmasterhome.cn;whatsmyip.us;myip.kz;ip-addr.es;curlmyip;anysrc.net;anysrc.net;dlinkddns.com;no-ip.com;no-ip.org;no-ip.biz;no-ip.info;noip.com</QueryName>
			<QueryName name="Attack=T1188,Technique=Multi-hop Proxy,Tactic=Command And Control,DS=Network Traffic: Network Traffic Content,Level=4,Alert=Tor2Web,Risk=100" condition="contains any">darknet.to;hiddenservice.net;onion.cab;onion.city;onion.direct;onion.nu;onion.pet;onion.plus;onion.rip;onion.sh;onion.si;onion.to;onion.top;onion.ws;tor-gateways.de;tor2net.com;tor2web.blutmagie.de;tor2web.fi;tor2web.info;tor2web.io;tor2web.org</QueryName>
			<QueryName name="Attack=T1048,Technique=Exfiltration Over Alternative Protocol,Tactic=Exfiltration,DS=Network Traffic: Network Traffic Content,Level=0,Desc=DNS Over HTTPS Detected" condition="contains any">adblock.mydns.network;ibksturm.synology.me;jcdns.fun;ibuki.cgnat.net;dns.twnic.tw;commons.host;doh.dnswarden.com;dns-nyc.aaflalo.me;dns.aaflalo.me;doh.appliedprivacy.net;doh.captnemo.in;doh.tiar.app;doh.tiarap.org;doh.defaultroutes.de;doh.dns.sb;dns.oszx.co;2.dnscrypt-cert.oszx.co;dnscrypt;edns.233py.com;hk-dns.233py.com;hk2dns.233py.com;hkdns.233py.com;hkdns.233py.com;ndns.233py.com;sdns.233py.com;wdns.233py.com;pastebin.com;dns.adguard.com;dns-family.adguard.com;security-filter-dns.cleanbrowsing.org;family-filter-dns.cleanbrowsing.org;adult-filter-dns.cleanbrowsing.org;cloudflare-dns.com;mozilla.cloudflare-dns.com;dns.233py.com;dns.aaflalo.me;dns.google;doh.opendns.com;dns.quad9.net;dns9.quad9.net;dns10.quad9.net;dns11.quad9.net;doh.xfinity.com;dns.nextdns.io;dns.dnsoverhttps.net;doh.crypto.sx;doh.powerdns.org;doh-ch.blahdns.com;doh-de.blahdns.com;dns.rubyfish.cn;dns.containerpi.com;doh-2.seby.io;doh.seby.io;rdns.faelix.net;doh.li;doh.armadillodns.net;doh.netweaver.uk;doh.42l.fr;dns.aa.net.uk</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=DC Global Catalog Lookup" condition="begin with">gc._msdcs.</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Kerberos Server Lookup" condition="begin with">_kerberos._tcp.dc._msdcs.</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Kerberos Server Lookup" condition="begin with">_kerberos._udp.dc._msdcs.</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Primary DC Lookup" condition="begin with">_ldap._tcp.pdc._msdcs.</QueryName>
			<QueryName name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Web Proxy Auto-Discovery Protocol Lookup" condition="begin with">wpad</QueryName>
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=3,Desc=Suspicious LDAP Lookup - Useful for identifying tools like sharphound,Risk=90" groupRelation="and">
				<QueryName condition="begin with">_ldap.</QueryName>
				<Image condition="excludes">C:\Windows\</Image>
				<Image condition="excludes">unknown process</Image>
				<Image condition="excludes all">C:\ProgramData\Microsoft\Windows Defender\Platform\;\Windows Defender\MsMpEng.exe;C:\Windows\</Image>
			</Rule>
			<!--
			<QueryResults name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=AAAA Lookup" condition="begin with">type:  28</QueryResults>
			<QueryResults name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=CNAME Lookup" condition="begin with">type:  5</QueryResults>
			<QueryResults name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=MX Lookup" condition="begin with">type:  15</QueryResults>
			<QueryResults name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Name Server" condition="begin with">type:  2</QueryResults>
			<QueryResults name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=PTR Lookup" condition="begin with">type:  12</QueryResults>
			<QueryResults name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=SOA Lookup" condition="begin with">type:  6</QueryResults>
			<QueryResults name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=SPF Lookup" condition="begin with">type:  99</QueryResults>
			<QueryResults name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=SRV Lookup" condition="begin with">type:  33</QueryResults>
			-->
			<Image name="Attack=None,Technique=None,Tactic=None,DS=None,Information=Uncategorized Events" condition="contains any">System;svchost.exe;services.exe;unknown process;\;;</Image>
		</DnsQuery>
	</RuleGroup>
	<RuleGroup name="RG=DNS Query Excludes" groupRelation="or">
		<DnsQuery onmatch="exclude">
			<!-- Image Exclusions -->
			<Image condition="begin with">C:\Program Files (x86)\Admin Arsenal\</Image>
			<Image condition="begin with">C:\Program Files (x86)\CheckPoint\</Image>
			<Image condition="begin with">C:\Program Files (x86)\Fortinet\</Image>
			<Image condition="begin with">C:\Program Files (x86)\OpenDNS\OpenDNS Connector</Image>
			<Image condition="begin with">C:\Program Files (x86)\Razer\Razer Services\</Image>
			<Image condition="begin with">C:\Program Files (x86)\Trend Micro\</Image>
			<Image condition="begin with">C:\Program Files (x86)\VMware</Image>
			<Image condition="begin with">C:\Program Files (x86)\Veeam\</Image>
			<Image condition="begin with">C:\Program Files\CheckPoint\</Image>
			<Image condition="begin with">C:\Program Files\Trend Micro\</Image>
			<Image condition="image">Slack.exe</Image>
			<Image condition="image">ConnectWise.exe</Image>
			<Image condition="image">git-remote-https.exe</Image>
			<Image condition="image">C:\Program Files (x86)\Enpass\Enpass.exe</Image>
			<Image condition="image">C:\Program Files (x86)\Fiserv\Vision\VisionGUI.NET.exe</Image>
			<Image condition="image">C:\Program Files (x86)\Fortinet\FortiClient\update_task.exe</Image>
			<Image condition="image">C:\Program Files (x86)\Lenovo\System Update\Tvsukernel.exe</Image>
			<Image condition="image">C:\Program Files\VMware\vCenter Server\jre\bin\java.exe</Image>
			<Image condition="image">C:\Program Files\VMware\vCenter Server\python\python.exe</Image>
			<Image condition="image">C:\Windows\SysWOW64\SearchProtocolHost.exe</Image>
			<Image condition="image">C:\Windows\System32\dsregcmd.exe</Image>
			<Image condition="image">C:\Windows\sysmon64.exe</Image>
			<Image condition="image">C:\Windows\sysmon.exe</Image>
			<QueryName condition="begin with">brave-sync.s3.dualstack.</QueryName>
			<QueryName condition="end with">.salesforceliveagent.com</QueryName>
			<QueryName condition="is">ads-serve.brave.com</QueryName>
			<!--Network noise-->
			<QueryName condition="end with">.msftncsi.com</QueryName> <!--Microsoft proxy detection | Microsoft default exclusion-->
			<QueryName condition="is">..localmachine</QueryName>
			<!--Microsoft-->
			<QueryName condition="end with">-pushp.svc.ms</QueryName> <!--Microsoft: Doesn't appear to host customer content or subdomains-->
			<QueryName condition="end with">.b-msedge.net</QueryName> <!--Microsoft: Doesn't appear to host customer content or subdomains-->
			<QueryName condition="end with">.bing.com</QueryName> <!-- Microsoft | Microsoft default exclusion -->
			<QueryName condition="end with">.hotmail.com</QueryName> <!--Microsoft | Microsoft default exclusion-->
			<QueryName condition="end with">.live.com</QueryName> <!--Microsoft | Microsoft default exclusion-->
			<QueryName condition="end with">.live.net</QueryName> <!--Microsoft | Microsoft default exclusion-->
			<QueryName condition="end with">.microsoft.com</QueryName> <!--Microsoft | Microsoft default exclusion-->
			<QueryName condition="end with">.microsoftonline.com</QueryName> <!--Microsoft | Microsoft default exclusion-->
			<QueryName condition="end with">.microsoftstore.com</QueryName> <!--Microsoft | Microsoft default exclusion-->
			<QueryName condition="end with">.ms-acdc.office.com</QueryName> <!--Microsoft: Doesn't appear to host customer content or subdomains-->
			<QueryName condition="end with">.msedge.net</QueryName> <!--Microsoft: Doesn't appear to host customer content or subdomains-->
			<QueryName condition="end with">.msn.com</QueryName> <!--Microsoft | Microsoft default exclusion-->
			<QueryName condition="end with">.msocdn.com</QueryName> <!--Microsoft-->
			<QueryName condition="end with">.s-microsoft.com</QueryName> <!--Microsoft-->
			<QueryName condition="end with">.skype.com</QueryName> <!--Microsoft | Microsoft default exclusion-->
			<QueryName condition="end with">.skype.net</QueryName> <!--Microsoft | Microsoft default exclusion-->
			<QueryName condition="end with">.windows.com</QueryName> <!--Microsoft-->
			<QueryName condition="end with">.windows.net.nsatc.net</QueryName> <!--Microsoft-->
			<QueryName condition="end with">.windowsupdate.com</QueryName> <!--Microsoft-->
			<QueryName condition="end with">.xboxlive.com</QueryName> <!--Microsoft-->
			<QueryName condition="is">login.windows.net</QueryName> <!--Microsoft-->
			<!--Microsoft:Office365/AzureAD-->
			<QueryName condition="end with">.activedirectory.windowsazure.com</QueryName> <!--Microsoft: AzureAD-->
			<QueryName condition="end with">.msauth.net</QueryName>
			<QueryName condition="end with">.msftauth.net</QueryName>
			<QueryName condition="end with">.opinsights.azure.com</QueryName> <!--Microsoft: AzureAD/InTune client event monitoring-->
			<QueryName condition="is">management.azure.com</QueryName> <!--Microsoft: AzureAD/InTune-->
			<QueryName condition="is">outlook.office365.com</QueryName> <!--Microsoft: Protected by HSTS-->
			<QueryName condition="is">portal.azure.com</QueryName> <!--Microsoft: AzureAD/InTune-->
			<!--3rd-party applications-->
			<QueryName condition="end with">.mozaws.net</QueryName> <!--Mozilla-->
			<QueryName condition="end with">.mozilla.com</QueryName> <!--Mozilla-->
			<QueryName condition="end with">.mozilla.net</QueryName> <!--Mozilla-->
			<QueryName condition="end with">.mozilla.org</QueryName> <!--Mozilla-->
			<QueryName condition="end with">.spotify.com</QueryName> <!--Spotify-->
			<QueryName condition="end with">.spotify.map.fastly.net</QueryName> <!--Spotify-->
			<QueryName condition="end with">googleapis.com</QueryName> <!--Google-->
			<QueryName condition="is">clients1.google.com</QueryName> <!--Google-->
			<QueryName condition="is">clients2.google.com</QueryName> <!--Google-->
			<QueryName condition="is">clients3.google.com</QueryName> <!--Google-->
			<QueryName condition="is">clients4.google.com</QueryName> <!--Google-->
			<QueryName condition="is">clients5.google.com</QueryName> <!--Google-->
			<QueryName condition="is">clients6.google.com</QueryName> <!--Google-->
			<QueryName condition="is">cloudsearch.googleapis.com</QueryName> <!--Google-->
			<QueryName condition="is">id.google.com</QueryName> <!--Google-->
			<QueryName condition="is">safebrowsing.googleapis.com</QueryName> <!--Google-->
			<QueryName condition="is">www.googleapis.com</QueryName> <!--Google-->
			<!--Goodlist CDN-->
			<QueryName condition="end with">.akadns.net</QueryName> <!--AkamaiCDN, extensively used by Microsoft | Microsoft default exclusion-->
			<QueryName condition="end with">.netflix.com</QueryName>
			<QueryName condition="end with">.typekit.net</QueryName> <!--Adobe fonts-->
			<QueryName condition="end with">aspnetcdn.com</QueryName> <!--Microsoft [ https://docs.microsoft.com/en-us/aspnet/ajax/cdn/overview ]-->
			<QueryName condition="is">ajax.googleapis.com</QueryName>
			<QueryName condition="is">cdnjs.cloudflare.com</QueryName>
			<QueryName condition="is">cdnjs.cloudflare.com</QueryName> <!--Cloudflare: Hosts popular javascript libraries-->
			<QueryName condition="is">fonts.googleapis.com</QueryName> <!--Google fonts-->
			<!--Personal-->
			<QueryName condition="end with">.steamcontent.com</QueryName> <!--If you seriously host malware C2 in game binaries in Steam, I give up-->
			<!--Web resources-->
			<QueryName condition="end with">.disqus.com</QueryName> <!--Microsoft default exclusion-->
			<QueryName condition="end with">.fontawesome.com</QueryName>
			<QueryName condition="is">disqus.com</QueryName> <!--Microsoft default exclusion-->
			<!--Ads-->
			<QueryName condition="end with">.1rx.io</QueryName> <!--Ads-->
			<QueryName condition="end with">.2mdn.net</QueryName> <!--Ads: Google | Microsoft default exclusion-->
			<QueryName condition="end with">.adadvisor.net</QueryName> <!--Ads: Neustar [ https://better.fyi/trackers/adadvisor.net/ ] -->
			<QueryName condition="end with">.adap.tv</QueryName> <!--Ads:AOL | Microsoft default exclusion [ https://www.crunchbase.com/organization/adap-tv ] -->
			<QueryName condition="end with">.addthis.com</QueryName> <!--Ads:Oracle | Microsoft default exclusion [ https://en.wikipedia.org/wiki/AddThis ] -->
			<QueryName condition="end with">.adform.net</QueryName> <!--Ads-->
			<QueryName condition="end with">.adnxs.com</QueryName> <!--Ads: AppNexus | Microsoft default exclusion-->
			<QueryName condition="end with">.adroll.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.adrta.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.adsafeprotected.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.adsrvr.org</QueryName> <!--Ads-->
			<QueryName condition="end with">.advertising.com</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.amazon-adsystem.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.amazon-adsystem.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.analytics.yahoo.com</QueryName> <!--Ads:Yahoo-->
			<QueryName condition="end with">.aol.com</QueryName> <!--Ads | Microsoft default exclusion -->
			<QueryName condition="end with">.betrad.com</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.bidswitch.net</QueryName> <!--Ads-->
			<QueryName condition="end with">.casalemedia.com</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.chartbeat.net</QueryName> <!--Ads | Microsoft default exclusion [ https://better.fyi/trackers/chartbeat.com/ ]-->
			<QueryName condition="end with">.cnn.com</QueryName> <!-- Microsoft default exclusion-->
			<QueryName condition="end with">.convertro.com</QueryName> <!--Ads:Verizon-->
			<QueryName condition="end with">.criteo.com</QueryName> <!--Ads [ https://better.fyi/trackers/criteo.com/ ] -->
			<QueryName condition="end with">.criteo.net</QueryName> <!--Ads [ https://better.fyi/trackers/criteo.com/ ] -->
			<QueryName condition="end with">.crwdcntrl.net</QueryName> <!--Ads: Lotame [ https://better.fyi/trackers/crwdcntrl.net/ ] -->
			<QueryName condition="end with">.demdex.net</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.domdex.com</QueryName> 
			<QueryName condition="end with">.dotomi.com</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.doubleclick.net</QueryName> <!--Ads:Conversant | Microsoft default exclusion [ https://www.crunchbase.com/organization/dotomi ] -->
			<QueryName condition="end with">.doubleverify.com</QueryName> <!--Ads: Google-->
			<QueryName condition="end with">.emxdgt.com</QueryName> <!--Ads: EMX-->
			<QueryName condition="end with">.exelator.com</QueryName> <!--Ads:Nielson Marketing Cloud-->
			<QueryName condition="end with">.google-analytics.com</QueryName> <!--Ads:Google | Microsoft default exclusion-->
			<QueryName condition="end with">.googleadservices.com</QueryName> <!--Google-->
			<QueryName condition="end with">.googlesyndication.com</QueryName> <!--Ads:Google, sometimes called during malicious ads, but not directly responsible | Microsoft default exclusion [ https://www.hackread.com/wp-content/uploads/2018/06/Bitdefender-Whitepaper-Zacinlo.pdf ]-->
			<QueryName condition="end with">.googletagmanager.com</QueryName> <!--Google-->
			<QueryName condition="end with">.googlevideo.com</QueryName> <!--Google | Microsoft default exclusion-->
			<QueryName condition="end with">.gstatic.com</QueryName> <!--Google | Microsoft default exclusion-->
			<QueryName condition="end with">.gvt1.com</QueryName> <!--Google-->
			<QueryName condition="end with">.gvt2.com</QueryName> <!--Google-->
			<QueryName condition="end with">.ib-ibi.com</QueryName> <!--Ads: Offerpath [ https://better.fyi/trackers/ib-ibi.com/ ] -->
			<QueryName condition="end with">.jivox.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.mathtag.com</QueryName> <!--Microsoft default exclusion-->
			<QueryName condition="end with">.moatads.com</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.moatpixel.com</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.mookie1.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.myvisualiq.net</QueryName> <!--Ads-->
			<QueryName condition="end with">.netmng.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.nexac.com</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.nexac.com</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.openx.net</QueryName> <!--Ads-->
			<QueryName condition="end with">.optimizely.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.outbrain.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.pardot.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.phx.gbl</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.pinterest.com</QueryName> <!--Pinerest-->
			<QueryName condition="end with">.pubmatic.com</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.quantcount.com</QueryName>
			<QueryName condition="end with">.quantserve.com</QueryName>
			<QueryName condition="end with">.revsci.net</QueryName> <!--Ads:Omniture | Microsoft default exclusion-->
			<QueryName condition="end with">.rfihub.net</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.rlcdn.com</QueryName> <!--Ads: Rapleaf [ https://better.fyi/trackers/rlcdn.com/ ] -->
			<QueryName condition="end with">.rubiconproject.com</QueryName> <!--Ads: Rubicon Project | Microsoft default exclusion [ https://better.fyi/trackers/rubiconproject.com/ ] -->
			<QueryName condition="end with">.scdn.co</QueryName> <!--Spotify-->
			<QueryName condition="end with">.scorecardresearch.com</QueryName> <!--Ads: Comscore | Microsoft default exclusion-->
			<QueryName condition="end with">.serving-sys.com</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.sharethrough.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.simpli.fi</QueryName>
			<QueryName condition="end with">.sitescout.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.smartadserver.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.snapads.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.spotxchange.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.taboola.com</QueryName> <!--Ads:Taboola-->
			<QueryName condition="end with">.taboola.map.fastly.net</QueryName> <!--Ads:Taboola-->
			<QueryName condition="end with">.tapad.com</QueryName>
			<QueryName condition="end with">.tidaltv.com</QueryName> <!--Ads: Videology [ https://better.fyi/trackers/tidaltv.com/ ] -->
			<QueryName condition="end with">.trafficmanager.net</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.tremorhub.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.tribalfusion.com</QueryName> <!--Ads: Exponential [ https://better.fyi/trackers/tribalfusion.com/ ] -->
			<QueryName condition="end with">.turn.com</QueryName> <!--Ads | Microsoft default exclusion [ https://better.fyi/trackers/turn.com/ ] -->
			<QueryName condition="end with">.twimg.com</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.tynt.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.w55c.net</QueryName> <!--Ads:dataxu-->
			<QueryName condition="end with">.ytimg.com</QueryName> <!--Google-->
			<QueryName condition="end with">.zorosrv.com</QueryName> <!--Ads:Taboola-->
			<QueryName condition="end with">ads.yahoo.com</QueryName> <!--Ads: Yahoo-->
			<QueryName condition="is">1rx.io</QueryName>
			<QueryName condition="is">adservice.google.com</QueryName> <!--Google-->
			<QueryName condition="is">ampcid.google.com</QueryName> <!--Google-->
			<QueryName condition="is">clientservices.googleapis.com</QueryName> <!--Google-->
			<QueryName condition="is">d29x207vrinatv.cloudfront.net</QueryName> <!--Amazon-developed applications-->
			<QueryName condition="is">googleadapis.l.google.com</QueryName> <!--Google-->
			<QueryName condition="is">imasdk.googleapis.com</QueryName> <!--Google [ https://developers.google.com/interactive-media-ads/docs/sdks/html5/ ] -->
			<QueryName condition="is">l.google.com</QueryName> <!--Google-->
			<QueryName condition="is">ml314.com</QueryName> <!--Ads-->
			<QueryName condition="is">mtalk.google.com</QueryName> <!--Google-->
			<QueryName condition="is">update.googleapis.com</QueryName> <!--Google-->
			<QueryName condition="is">www.googletagservices.com</QueryName>
			<!--SocialNet-->
			<QueryName condition="end with">.pscp.tv</QueryName> <!--Twitter:Periscope-->
			<!--OSCP/CRL Common-->
			<QueryName condition="contains">adsniper.ru</QueryName>
			<QueryName condition="contains">cdnvideo.ru</QueryName>
			<QueryName condition="contains">chat.minergate.com</QueryName>
			<QueryName condition="contains">cwsa.minergate.com</QueryName>
			<QueryName condition="contains">forum.minergate.com</QueryName>
			<QueryName condition="contains">leadlab.click</QueryName>
			<QueryName condition="contains">mc.yandex.ru</QueryName>
			<QueryName condition="contains">pool.ntp.org</QueryName>
			<QueryName condition="contains">vmg.host</QueryName>
			<QueryName condition="contains">yandex.ru</QueryName>
			<QueryName condition="end with">.adobe.com</QueryName>
			<QueryName condition="end with">.autodesk.com</QueryName>
			<QueryName condition="end with">.avast.com</QueryName>
			<QueryName condition="end with">.avcdn.net</QueryName>
			<QueryName condition="end with">.cdn.bitdefender.net</QueryName>
			<QueryName condition="end with">.digicert.com</QueryName>
			<QueryName condition="end with">.eset.com</QueryName>
			<QueryName condition="end with">.globalsign.com</QueryName>
			<QueryName condition="end with">.globalsign.net</QueryName>
			<QueryName condition="end with">.intuit.com</QueryName>
			<QueryName condition="end with">.java.com</QueryName>
			<QueryName condition="end with">.macromedia.com</QueryName>
			<QueryName condition="end with">.oracle.com</QueryName>
			<QueryName condition="end with">.quickbooks.com</QueryName>
			<QueryName condition="end with">.usertrust.com</QueryName>
			<QueryName condition="end with">amazontrust.com</QueryName>
			<QueryName condition="end with">ocsp.identrust.com</QueryName>
			<QueryName condition="end with">pki.goog</QueryName>
			<QueryName condition="is">ads.playground.xyz</QueryName>
			<QueryName condition="is">citrixupdates.cloud.com</QueryName>
			<QueryName condition="is">forticlient.fortinet.net</QueryName>
			<QueryName condition="is">mft10.onbaseonline.com</QueryName>
			<QueryName condition="is">msocsp.com</QueryName> <!--Microsoft:OCSP-->
			<QueryName condition="is">ocsp.comodoca.com</QueryName>
			<QueryName condition="is">ocsp.cybertrust.ne.jp</QueryName>
			<QueryName condition="is">ocsp.entrust.net</QueryName>
			<QueryName condition="is">ocsp.entrust.net</QueryName>
			<QueryName condition="is">ocsp.godaddy.com</QueryName>
			<QueryName condition="is">ocsp.int-x3.letsencrypt.org</QueryName>
			<QueryName condition="is">ocsp.intel.com</QueryName>
			<QueryName condition="is">ocsp.msocsp.com</QueryName> <!--Microsoft:OCSP-->
			<QueryName condition="is">ocsp.quovadisglobal.com</QueryName>
			<QueryName condition="is">ocsp.quovadisoffshore.com</QueryName>
			<QueryName condition="is">ocsp.sectigo.com</QueryName>
			<QueryName condition="is">ocsp.starfieldtech.com</QueryName>
			<QueryName condition="is">ocsp.thawte.com</QueryName>
			<QueryName condition="is">ocsp.trustwave.com</QueryName>
			<QueryName condition="is">ocsp.verisign.com</QueryName>
			<QueryName condition="is">pki-goog.l.google.com</QueryName>
			<QueryName condition="is">pki.intel.com</QueryName>
			<QueryName condition="is">scrootca1.ocsp.secomtrust.net</QueryName>
			<QueryName condition="is">scrootca2.ocsp.secomtrust.net</QueryName>
			<QueryName condition="is">stats.anchor.host</QueryName>
			<QueryName condition="is">status.rapidssl.com</QueryName>
			<QueryName condition="is">status.thawte.com</QueryName>
			<QueryName condition="is">ts-ocsp.ws.symantec.com</QueryName>
			<QueryName condition="is">upgrade.bitdefender.com</QueryName>
		</DnsQuery>
	</RuleGroup>
	<!-- SYSMON EVENT ID 23 : File Delete and overwrite events which saves a copy to the archivedir: Includes -->
	<!-- Default set to disabled due to disk space implications, enable with care!-->
	<RuleGroup groupRelation="or">
	  <FileDelete onmatch="include" />
	</RuleGroup>
	<!-- SYSMON EVENT ID 24 : Clipboard change events, only captures text, not files: Includes -->
	<!-- Default set to disabled due to privacy implications and potential data you leave for attackers, enable with care!-->
	<RuleGroup groupRelation="or">
	  <ClipboardChange onmatch="include" />
	</RuleGroup>
	<!--SYSMON EVENT ID 25 : Process tampering events-->
	<RuleGroup name="RG=Process Tampering Includes" groupRelation="or">
		<ProcessTampering onmatch="include">
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=Process Tampering Detected" groupRelation="and">
				<Image condition="contains any">.;&gt;;unknown;anonymous</Image>
				<Image condition="excludes">C:\Program Files (x86)\Google\Chrome\Application\chrome.exe</Image>
				<Image condition="excludes">C:\Program Files (x86)\Symantec\</Image>
				<Image condition="excludes">C:\Program Files\Google\Chrome\Application\chrome.exe</Image>
				<Image condition="excludes">C:\Program Files\Symantec\</Image>
			</Rule>
		</ProcessTampering>
	</RuleGroup>
	<RuleGroup name="RG=Process Tampering Excludes" groupRelation="or">
		<ProcessTampering onmatch="exclude">
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=exclude common noise" groupRelation="and">
				<Image condition="contains any">\BHO\ie_to_edge_stub.exe;\Microsoft\Teams\;\Vivaldi\Application\;Google\Chrome\;Google\Update;BraveSoftware\Brave-Browser\;Edge\Application\;EdgeUpdate\Install\;Program Files\SmartGit\</Image>
			</Rule>
		</ProcessTampering>
	</RuleGroup>
	<!-- SYSMON EVENT ID 26 : File Delete and overwrite events, does NOT save the file: Includes -->
	<RuleGroup groupRelation="or">
		<FileDeleteDetected onmatch="include">
		</FileDeleteDetected>
	</RuleGroup>
	<RuleGroup groupRelation="or">
		<FileDeleteDetected onmatch="exclude">
			<Image condition="contains all">\appdata\local\google\chrome\user data\swreporter\;software_reporter_tool.exe</Image>
			<Image condition="is">C:\Program Files (x86)\Google\Chrome\Application\chrome.exe</Image>
			<User condition="contains any">NETWORK SERVICE; LOCAL SERVICE</User>
		</FileDeleteDetected>
	</RuleGroup>
	</EventFiltering>
</Sysmon>